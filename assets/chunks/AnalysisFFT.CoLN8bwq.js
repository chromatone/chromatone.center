import{aG as f}from"./theme.DKUtGHOP.js";import{u as m}from"./useElementary.kwxWhjY9.js";import{D as g,M as r,r as p,o as v,I as x,q as F,f as M,s as _}from"./framework.Bbwy4zmA.js";function w(s="main:fft"){const{FFTs:n,meters:a}=m(),t=g({sr:r(()=>a["main:sample-rate"]?.max||44100),freq:r(()=>t.data[0].map((l,e)=>e*t.sr/(t.data[0].length||1))),colors:r(()=>t.freq.map(l=>f(l))),data:r(()=>n?.[s]||[[],[]]),total:r(()=>t.data[0].map((l,e)=>Math.log2(1+Math.abs(l)+Math.abs(t.data[1][e]))))});return{FFT:t}}const b={class:"flex is-group p-2 bg-light-200 dark-bg-dark-200 shadow rounded gap-4"},B={__name:"AnalysisFFT",props:{name:{default:"main:fft",type:String}},setup(s){const n=s,{FFT:a}=w(n.name);let t=p(null);v(l),x(a,l,{deep:!0});function l(){if(!t.value||!a?.total)return;let e=t.value.getContext("2d");e.clearRect(0,0,t.value.width,t.value.height);for(let o=0;o<a.total.length;o++){let i=a.total[o],h=Math.pow(i,2)*t.value.height/50,c=Math.log2(o+1)*t.value.width/Math.log2(a.total.length+1),u=Math.log2(o+2)*t.value.width/Math.log2(a.total.length+1)-c,d=t.value.height-h;e.fillStyle=a.colors[o],e.fillRect(c,d,u,h)}}return(e,o)=>(M(),F("div",b,[_("canvas",{class:"max-w-full",ref_key:"canvas",ref:t,height:"512",width:"2048"},null,512)]))}};export{B as _};
