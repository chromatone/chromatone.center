var at=Object.defineProperty;var T=I=>{throw TypeError(I)};var ct=(I,s,t)=>s in I?at(I,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):I[s]=t;var w=(I,s,t)=>ct(I,typeof s!="symbol"?s+"":s,t),H=(I,s,t)=>s.has(I)||T("Cannot "+t);var e=(I,s,t)=>(H(I,s,"read from private field"),t?t.call(I):s.get(I)),d=(I,s,t)=>s.has(I)?T("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(I):s.set(I,t),c=(I,s,t,g)=>(H(I,s,"write to private field"),g?g.call(I,t):s.set(I,t),t),G=(I,s,t)=>(H(I,s,"access private method"),t);import{q as nt,r as D,o as dt,w as lt,c as rt,h as At,n as Gt,x as bt,y as Bt,C as vt,D as Zt,A as P,H as mt,E as k}from"./framework.BjEhsXnI.js";import{D as Wt,C as pt,N as wt,L as ut}from"./theme.Bw6rsLYr.js";function Yt(I,s,t){var g=function(l,Z){return atob(l)}(I),i=g.indexOf(`
`,10)+1,a=g.substring(i)+"",o=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(o)}var j,f,yt=(j="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLy8gY29sb3VyIGluZGljZXMgcGVyIHBpeGVsCiAgY29uc3QgUiA9IDA7CiAgY29uc3QgRyA9IDE7CiAgY29uc3QgQiA9IDI7CiAgY29uc3QgQSA9IDM7CgogIGNvbnN0IFBJWEVMID0gNDsKICBjb25zdCBUUkFOU1BBUkVOVCA9IDA7CiAgY29uc3QgT1BBUVVFID0gMjU1OwoKICBjb25zdCBoZXhUb1JnYiA9IChoZXhDb2xvcikgPT4gewogICAgLy8gU2luY2UgaW5wdXQgdHlwZSBjb2xvciBwcm92aWRlcyBoZXggYW5kIEltYWdlRGF0YSBhY2NlcHRzIFJHQiBuZWVkIHRvIHRyYW5zZm9ybQogICAgY29uc3QgbSA9IGhleENvbG9yLm1hdGNoKC9eIz8oW1xkYS1mXXsyfSkoW1xkYS1mXXsyfSkoW1xkYS1mXXsyfSkkL2kpOwogICAgcmV0dXJuIFsKICAgICAgcGFyc2VJbnQobVsxXSwgMTYpLAogICAgICBwYXJzZUludChtWzJdLCAxNiksCiAgICAgIHBhcnNlSW50KG1bM10sIDE2KSwKICAgIF07CiAgfTsKCiAgLy8gUGl4ZWwgY29sb3IgZXF1YWxzIGNvbXAgY29sb3I/CiAgY29uc3QgY29sb3JNYXRjaGVyID0gKGRhdGEsIGNvbXBSLCBjb21wRywgY29tcEIsIGNvbXBBKSA9PiAocGl4ZWxQb3MpID0+ICgKICAgIGRhdGFbcGl4ZWxQb3MgKyBSXSA9PT0gY29tcFIKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBHXSA9PT0gY29tcEcKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBCXSA9PT0gY29tcEIKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBBXSA9PT0gY29tcEEKICApOwoKICBjb25zdCBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYSA9IChkYXRhLCAuLi5hcmdzKSA9PiB7CiAgICBjb25zdCBtYXRjaCA9IGNvbG9yTWF0Y2hlcihkYXRhLCAuLi5hcmdzKTsKCiAgICByZXR1cm4gKHBpeGVsUG9zKSA9PiB7CiAgICAgIGNvbnN0IGFscGhhID0gZGF0YVtwaXhlbFBvcyArIEFdOwogICAgICBpZiAoYWxwaGEgIT09IFRSQU5TUEFSRU5UICYmIGFscGhhICE9PSBPUEFRVUUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIG1hdGNoKHBpeGVsUG9zKTsKICAgIH07CiAgfTsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi8KICBjb25zdCBwaXhlbFBhaW50ZXIgPSAoZGF0YSwgZmlsbFIsIGZpbGxHLCBmaWxsQiwgZmlsbEEpID0+IChwaXhlbFBvcykgPT4gewogICAgZGF0YVtwaXhlbFBvcyArIFJdID0gZmlsbFI7CiAgICBkYXRhW3BpeGVsUG9zICsgR10gPSBmaWxsRzsKICAgIGRhdGFbcGl4ZWxQb3MgKyBCXSA9IGZpbGxCOwogICAgZGF0YVtwaXhlbFBvcyArIEFdID0gZmlsbEE7CiAgfTsKCiAgY29uc3QgcGl4ZWxQYWludGVyTWl4QWxwaGEgPSAoZGF0YSwgZmlsbFIsIGZpbGxHLCBmaWxsQiwgZmlsbEEpID0+IChwaXhlbFBvcykgPT4gewogICAgY29uc3Qgb2xkQWxwaGEgPSBkYXRhW3BpeGVsUG9zICsgQV07CiAgICAvLyBjYWxjdWxhdGUgcmF0aW8gb2Ygb2xkIHZzLiBuZXcgY29sb3VyIHRvIGJlIGFscGhhLW1peGVkCiAgICBjb25zdCBtaXhBbHBoYU9sZCA9IG9sZEFscGhhID09PSBPUEFRVUUKICAgICAgPyBUUkFOU1BBUkVOVAogICAgICA6IG9sZEFscGhhIC8gT1BBUVVFOwogICAgY29uc3QgbWl4QWxwaGFOZXcgPSAxIC0gbWl4QWxwaGFPbGQ7CgogICAgY29uc3QgcGFpbnQgPSBwaXhlbFBhaW50ZXIoCiAgICAgIGRhdGEsCiAgICAgIE1hdGguZmxvb3IobWl4QWxwaGFPbGQgKiBkYXRhW3BpeGVsUG9zICsgUl0gKyBtaXhBbHBoYU5ldyAqIGZpbGxSKSwKICAgICAgTWF0aC5mbG9vcihtaXhBbHBoYU9sZCAqIGRhdGFbcGl4ZWxQb3MgKyBHXSArIG1peEFscGhhTmV3ICogZmlsbEcpLAogICAgICBNYXRoLmZsb29yKG1peEFscGhhT2xkICogZGF0YVtwaXhlbFBvcyArIEJdICsgbWl4QWxwaGFOZXcgKiBmaWxsQiksCiAgICAgIGZpbGxBLAogICAgKTsKCiAgICByZXR1cm4gcGFpbnQocGl4ZWxQb3MpOwogIH07CiAgLyogZXNsaW50LWVuYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqLwoKICAvKioKICAgKiBTdGFjay0gYW5kIHNwYW4tYmFzZWQgZmxvb2QgZmlsbCBhbGdvcml0aG0KICAgKiBzZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRmxvb2RfZmlsbCNTcGFuX2ZpbGxpbmcKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIG9wdGlvbnMgb2JqZWN0CiAgICogQHJldHVybnMge1VJbnQ4Q2xhbXBlZEFycmF5fSB0aGUgbW9kaWZpZWQgcGl4ZWxzCiAgICovCiAgY29uc3QgZmxvb2RGaWxsID0gKHsKICAgIGltYWdlLAogICAgd2lkdGgsCiAgICBoZWlnaHQsCiAgICBjb2xvciwKICAgIGdsb2JhbEFscGhhLAogICAgc3RhcnRYLAogICAgc3RhcnRZLAogICAgc3RhcnRDb2xvciwKICB9KSA9PiB7CiAgICBjb25zdCByb3cgPSB3aWR0aCAqIFBJWEVMOwogICAgLy8gbWFrZSBzdXJlIHN0YXJ0IGNvb3JkaW5hdGVzIGFyZSBpbnRlZ2VycwogICAgY29uc3Qgc3RhcnRYQ29vcmQgPSBNYXRoLmZsb29yKHN0YXJ0WCk7CiAgICBjb25zdCBzdGFydFlDb29yZCA9IE1hdGguZmxvb3Ioc3RhcnRZKTsKICAgIC8vIGhleCBuZWVkcyB0byBiZSB0cmFzZm9ybWVkIHRvIHJnYiBzaW5jZSBJbWFnZURhdGEgdXNlcyBSR0IKICAgIGNvbnN0IGZpbGxDb2xvciA9IGhleFRvUmdiKGNvbG9yKTsKICAgIC8vIGVuc3VyZSBhbHBoYSBpcyBhbiBpbnRlZ2VyIGluIHRoZSByYW5nZSBvZiAwLTI1NQogICAgY29uc3QgZmlsbEFscGhhID0gTWF0aC5mbG9vcihNYXRoLm1heCgwLCBNYXRoLm1pbihnbG9iYWxBbHBoYSAqIE9QQVFVRSwgT1BBUVVFKSkpOwogICAgLy8gd2UgbmVlZCBkaWZmZXJlbnQgYmVoYXZpb3VyIGluIGNhc2Ugd2UncmUgZmlsbGluZyBhIG5vbi1vcGFxdWUgYXJlYQogICAgY29uc3QgZmlsbGluZ05vbk9wYXF1ZSA9IHN0YXJ0Q29sb3JbQV0gIT09IE9QQVFVRTsKICAgIC8vIG91ciBwaXhlbCBwYWludGVyIHNob3VsZCBvbmx5IG1peCBhbHBoYSBpZiB3ZSdyZSBzdGFydGluZyBpbiBhIG5vbi1vcGFxdWUgYXJlYQogICAgY29uc3QgcGl4ZWxQYWludGVyT2ZDaG9pY2UgPSBmaWxsaW5nTm9uT3BhcXVlID8gcGl4ZWxQYWludGVyTWl4QWxwaGEgOiBwaXhlbFBhaW50ZXI7CiAgICBjb25zdCBwYWludFBpeGVsID0gcGl4ZWxQYWludGVyT2ZDaG9pY2UoaW1hZ2UsIC4uLmZpbGxDb2xvciwgZmlsbEFscGhhKTsKICAgIC8vIHdoZW4gbG9va2luZyBmb3IgdGhlIHNwYW4gc3RhcnQsIHdlIGlnbm9yZSB0aGUgYWxwaGEgdmFsdWUgaWYgZmlsbGluZyBhIG5vbi1vcGFxdWUgYXJlYQogICAgLy8gdGhpcyBlbnN1cmVzIHRoYXQgd2UnbGwgbWl4IHRoZSBmaWxsIGludG8gYW50aWFsaWFzZWQgZWRnZXMKICAgIGNvbnN0IGNvbG9yTWF0Y2hlclNwYW5TdGFydCA9IGZpbGxpbmdOb25PcGFxdWUgPyBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYSA6IGNvbG9yTWF0Y2hlcjsKICAgIGNvbnN0IG1hdGNoU3BhblN0YXJ0Q29sb3IgPSBjb2xvck1hdGNoZXJTcGFuU3RhcnQoaW1hZ2UsIC4uLnN0YXJ0Q29sb3IpOwogICAgLy8gZm9yIGFsbCBvdGhlciBjYXNlcywgd2UgbG9vayBmb3IgdGhlIHN0YXJ0IGNvbG91ciBleGFjdGx5CiAgICBjb25zdCBtYXRjaFN0YXJ0Q29sb3IgPSBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYShpbWFnZSwgLi4uc3RhcnRDb2xvcik7CgogICAgLy8gY2hlY2sgaWYgd2UncmUgdHJ5aW5nIHRvIGZpbGwgd2l0aCB0aGUgc2FtZSBjb2xvdXIsIGlmIHNvLCBzdG9wCiAgICBjb25zdCBtYXRjaEZpbGxDb2xvciA9IGNvbG9yTWF0Y2hlcihpbWFnZSwgLi4uWy4uLmZpbGxDb2xvciwgT1BBUVVFXSk7CiAgICBpZiAobWF0Y2hGaWxsQ29sb3IoKHN0YXJ0WUNvb3JkICogd2lkdGggKyBzdGFydFhDb29yZCkgKiBQSVhFTCkpIHsKICAgICAgcmV0dXJuIGltYWdlOwogICAgfQogICAgLy8gYmVnaW4gd2l0aCBvdXIgc3RhcnQgcGl4ZWwKICAgIGNvbnN0IHBpeGVsU3RhY2sgPSBbW3N0YXJ0WENvb3JkLCBzdGFydFlDb29yZF1dOwogICAgd2hpbGUgKHBpeGVsU3RhY2subGVuZ3RoKSB7CiAgICAgIGNvbnN0IFt4LCB5XSA9IHBpeGVsU3RhY2sucG9wKCk7CiAgICAgIC8vIGNvbHVtbiBwb3NpdGlvbiBpcyBpbiBjYXJ0ZXNpYW4gc3BhY2UgKHgseSkKICAgICAgbGV0IGNvbHVtblBvc2l0aW9uID0geTsKICAgICAgLy8gcGl4ZWwgcG9zaXRpb24gaXMgaW4gMUQgc3BhY2UgKHRoZSByYXcgaW1hZ2UgZGF0YSBVSW50OENsYW1wZWRBcnJheSkKICAgICAgbGV0IHBpeGVsUG9zID0gKGNvbHVtblBvc2l0aW9uICogd2lkdGggKyB4KSAqIFBJWEVMOwogICAgICAvLyBzdGFydCBtb3ZpbmcgZGlyZWN0bHkgdXAgZnJvbSBvdXIgc3RhcnQgcG9zaXRpb24KICAgICAgLy8gdW50aWwgd2UgZmluZCBhIGRpZmZlcmVudCBjb2xvdXIgdG8gdGhlIHN0YXJ0IGNvbG91cgogICAgICAvLyB0aGlzIGlzIHRoZSBiZWdpbm5pbmcgb2Ygb3VyIHNwYW4KICAgICAgd2hpbGUgKGNvbHVtblBvc2l0aW9uLS0gPj0gMCAmJiBtYXRjaFNwYW5TdGFydENvbG9yKHBpeGVsUG9zKSkgewogICAgICAgIHBpeGVsUG9zIC09IHJvdzsKICAgICAgfQogICAgICAvLyBtb3ZlIG9uZSByb3cgZG93biAodG9wbW9zdCBwaXhlbCBvZiBmaWxsYWJsZSBhcmVhKQogICAgICBwaXhlbFBvcyArPSByb3c7CgogICAgICBsZXQgcmVhY2hMZWZ0ID0gZmFsc2U7CiAgICAgIGxldCByZWFjaFJpZ2h0ID0gZmFsc2U7CiAgICAgIC8vIGZvciBlYWNoIHJvdywgY2hlY2sgaWYgdGhlIGZpcnN0IHBpeGVsIHN0aWxsIGhhcyB0aGUgc3RhcnQgY29sb3VyCiAgICAgIC8vIGlmIGl0IGRvZXMsIHBhaW50IGl0IGFuZCBwdXNoIHN1cnJvdW5kaW5nIHBpeGVscyB0byB0aGUgc3RhY2sgb2YgcGl4ZWxzIHRvIGNoZWNrCiAgICAgIHdoaWxlICgrK2NvbHVtblBvc2l0aW9uIDwgaGVpZ2h0IC0gMSAmJiBtYXRjaFN0YXJ0Q29sb3IocGl4ZWxQb3MpKSB7CiAgICAgICAgcGFpbnRQaXhlbChwaXhlbFBvcyk7CiAgICAgICAgLy8gY2hlY2sgdGhlIHBpeGVsIHRvIHRoZSBsZWZ0CiAgICAgICAgaWYgKHggPiAwKSB7CiAgICAgICAgICBpZiAobWF0Y2hTdGFydENvbG9yKHBpeGVsUG9zIC0gUElYRUwpKSB7CiAgICAgICAgICAgIGlmICghcmVhY2hMZWZ0KSB7CiAgICAgICAgICAgICAgcGl4ZWxTdGFjay5wdXNoKFt4IC0gMSwgY29sdW1uUG9zaXRpb25dKTsKICAgICAgICAgICAgICByZWFjaExlZnQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHJlYWNoTGVmdCkgewogICAgICAgICAgICByZWFjaExlZnQgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gY2hlY2sgdGhlIHBpeGVsIHRvIHRoZSByaWdodAogICAgICAgIGlmICh4IDwgd2lkdGggLSAxKSB7CiAgICAgICAgICBpZiAobWF0Y2hTdGFydENvbG9yKHBpeGVsUG9zICsgUElYRUwpKSB7CiAgICAgICAgICAgIGlmICghcmVhY2hSaWdodCkgewogICAgICAgICAgICAgIHBpeGVsU3RhY2sucHVzaChbeCArIDEsIGNvbHVtblBvc2l0aW9uXSk7CiAgICAgICAgICAgICAgcmVhY2hSaWdodCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAocmVhY2hSaWdodCkgewogICAgICAgICAgICByZWFjaFJpZ2h0ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIG1vdmUgdG8gdGhlIG5leHQgcm93CiAgICAgICAgcGl4ZWxQb3MgKz0gcm93OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGltYWdlOwogIH07CgogIGdsb2JhbFRoaXMuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsICh7IGRhdGEgfSkgPT4gewogICAgY29uc3QgcmVzdWx0ID0gZmxvb2RGaWxsKGRhdGEpOwoKICAgIGdsb2JhbFRoaXMucG9zdE1lc3NhZ2UoeyB0eXBlOiAnZmlsbC1yZXN1bHQnLCByZXN1bHQgfSwgW3Jlc3VsdC5idWZmZXJdKTsKICB9KTsKCn0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXdvcmtlci5qcy5tYXAKCg==",function(I){return f=f||Yt(j),new Worker(f,I)});class Q{constructor(s,t){this.x=s,this.y=t}set(s,t){this.x=s,this.y=t}}class St extends Q{constructor(){super(0,0),this.down=!1,this.previous=new Q(0,0)}}class Ft{constructor(){this.eventListeners=new Map}addEventListener(s,t){const g=this.eventListeners.get(s)||new Set;g.add(t),this.eventListeners.set(s,g)}removeEventListener(s,t){const g=this.eventListeners.get(s);g&&g.delete(t)}dispatchEvent(s,t){const g=this.eventListeners.get(s);g&&[...g].forEach(i=>i(t))}}const M=(I,s,t,g)=>{const i=(t-I)**2,a=(g-s)**2;return Math.sqrt(i+a)},E=I=>s=>{s.isPrimary&&(s.cancelable&&s.preventDefault(),I(s))},u=Symbol("atrament mode - draw"),X=Symbol("atrament mode - erase"),N=Symbol("atrament mode - fill"),O=Symbol("atrament mode - disabled"),q=[u,X],Xt=["weight","smoothing","adaptiveStroke","mode"];var C,p,Y,y,K,b,h,V,R,S,B,v,n,_,F,$,tt,L,et,gt,st,it,J;const x=class x extends Ft{constructor(t,g={}){var i,a;if(typeof window>"u")throw new Error("atrament: looks like we're not running in a browser");super();d(this,n);w(this,"adaptiveStroke",!0);w(this,"canvas");w(this,"recordStrokes",!1);w(this,"smoothing",.85);w(this,"thickness",2);d(this,C);d(this,p,!1);d(this,Y,!1);d(this,y,[]);d(this,K,new yt);d(this,b,u);d(this,h,new St);d(this,V,.5);d(this,R);d(this,S,[]);d(this,B,2);d(this,v,2);this.canvas=G(i=x,F,$).call(i,t,g),c(this,C,G(a=x,F,tt).call(a,this.canvas,g)),G(this,n,st).call(this),c(this,R,(({canvas:o,move:l,down:Z,up:W})=>{const m=E(l),A=E(Z),r=E(W);return o.addEventListener("pointermove",m),o.addEventListener("pointerdown",A),document.addEventListener("pointerup",r),document.addEventListener("pointerout",r),()=>{o.removeEventListener("pointermove",m),o.removeEventListener("pointerdown",A),document.removeEventListener("pointerup",r),document.removeEventListener("pointerout",r)}})({canvas:this.canvas,move:G(this,n,L).bind(this),down:G(this,n,et).bind(this),up:G(this,n,gt).bind(this)})),Xt.forEach(o=>{g[o]!==void 0&&(this[o]=g[o])})}beginStroke(t,g){e(this,C).moveTo(t,g),c(this,B,e(this,v)),this.recordStrokes&&(this.strokeTimestamp=performance.now()),this.dispatchEvent("strokestart",{x:t,y:g})}endStroke(t,g){this.dispatchEvent("strokeend",{x:t,y:g}),this.recordStrokes&&this.dispatchEvent("strokerecorded",{stroke:this.currentStroke}),c(this,S,[]),delete this.strokeTimestamp}draw(t,g,i,a){const o=i||t,l=a||g,Z=this.getSmoothingFactor(M(t,g,o,l)),W=t-(t-o)*Z,m=g-(g-l)*Z,A=M(W,m,o,l);if(this.adaptiveStroke){const r=(A-2)/(98*(1-e(this,V)))*(e(this,n,_)-e(this,v))+e(this,v);e(this,B)>r?c(this,B,e(this,B)-.25):e(this,B)<r&&c(this,B,e(this,B)+.25)}else c(this,B,e(this,v));return e(this,C).lineWidth=e(this,B),e(this,C).beginPath(),e(this,C).moveTo(o,l),e(this,C).quadraticCurveTo(o,l,W,m),e(this,C).closePath(),e(this,C).stroke(),this.recordStrokes&&(e(this,S).push({point:new Q(t,g),time:performance.now()-this.strokeTimestamp}),this.dispatchEvent("segmentdrawn",{stroke:this.currentStroke})),e(this,p)||e(this,b)!==u||(c(this,p,!0),this.dispatchEvent("dirty")),{x:W,y:m}}clear(){c(this,p,!1),this.dispatchEvent("clean");const t=this.mode===X;t&&(this.mode=u),e(this,C).save(),e(this,C).setTransform(1,0,0,1,0,0),e(this,C).clearRect(0,0,this.canvas.width,this.canvas.height),e(this,C).restore(),t&&(this.mode=X)}destroy(){var t;this.clear(),(t=e(this,R))==null||t.call(this)}get color(){return e(this,C).strokeStyle}set color(t){if(typeof t!="string")throw new Error("atrament: wrong argument type setting color");e(this,C).strokeStyle=t}get weight(){return e(this,v)}set weight(t){if(typeof t!="number")throw new Error("atrament: wrong argument type setting weight");c(this,B,t),c(this,v,t)}getSmoothingFactor(t){return Math.min(.87,this.smoothing+(t-60)/3e3)}get mode(){return e(this,b)}set mode(t){switch(t){case X:c(this,b,X),e(this,C).globalCompositeOperation="destination-out";break;case N:c(this,b,N),e(this,C).globalCompositeOperation="source-over";break;case O:c(this,b,O);break;case u:c(this,b,u),e(this,C).globalCompositeOperation="source-over";break;default:throw new Error("atrament: mode is not one of the allowed modes.")}}get currentStroke(){return{segments:e(this,S).slice(),mode:this.mode,weight:this.weight,smoothing:this.smoothing,color:this.color,adaptiveStroke:this.adaptiveStroke}}get dirty(){return e(this,p)}};C=new WeakMap,p=new WeakMap,Y=new WeakMap,y=new WeakMap,K=new WeakMap,b=new WeakMap,h=new WeakMap,V=new WeakMap,R=new WeakMap,S=new WeakMap,B=new WeakMap,v=new WeakMap,n=new WeakSet,_=function(){return e(this,v)+30},F=new WeakSet,$=function(t,g){let i;if(t instanceof window.Node&&t.tagName==="CANVAS")i=t;else{if(typeof t!="string")throw new Error(`atrament: can't look for canvas based on '${t}'`);i=document.querySelector(t)}if(!i)throw new Error("atrament: canvas not found");return i.width=(g.width||i.width)*window.devicePixelRatio,i.height=(g.height||i.height)*window.devicePixelRatio,i.style.touchAction="none",i},tt=function(t,g){const i=t.getContext("2d");return i.scale(window.devicePixelRatio,window.devicePixelRatio),i.globalCompositeOperation="source-over",i.globalAlpha=1,i.strokeStyle=g.color||"rgba(0,0,0,1)",i.lineCap="round",i.lineJoin="round",i},L=function(t){var g;(((g=t.getCoalescedEvents)==null?void 0:g.call(t))||[t]).forEach(i=>{const a=i.offsetX,o=i.offsetY;if(e(this,h).down&&q.includes(e(this,b))){const{x:l,y:Z}=this.draw(a,o,e(this,h).previous.x,e(this,h).previous.y);e(this,h).set(a,o),e(this,h).previous.set(l,Z),c(this,V,i.pressure===1?.5:i.pressure||.5)}else e(this,h).set(a,o),e(this,h).previous.set(a,o)})},et=function(t){this.mode!==N?(e(this,h).down=!0,G(this,n,L).call(this,t),this.beginStroke(e(this,h).previous.x,e(this,h).previous.y)):G(this,n,it).call(this)},gt=function(t){e(this,b)!==N&&e(this,h).down&&(e(this,h).down=!1,e(this,h).x===t.offsetX&&e(this,h).y===t.offsetY&&q.includes(this.mode)&&this.draw(e(this,h).x,e(this,h).y,e(this,h).previous.x,e(this,h).previous.y),e(this,h).previous.set(0,0),this.endStroke(e(this,h).x,e(this,h).y))},st=function(){e(this,K).addEventListener("message",({data:t})=>{if(t.type==="fill-result"){c(this,Y,!1),this.dispatchEvent("fillend",{});const g=new ImageData(t.result,this.canvas.width,this.canvas.height);e(this,C).putImageData(g,0,0),e(this,y).length>0&&G(this,n,J).call(this,e(this,y).shift())}})},it=function(){const{x:t,y:g}=e(this,h);this.dispatchEvent("fillstart",{x:t,y:g});const i=Array.from(e(this,C).getImageData(t,g,1,1).data),a={color:this.color,globalAlpha:e(this,C).globalAlpha,width:this.canvas.width,height:this.canvas.height,startColor:i,startX:t*window.devicePixelRatio,startY:g*window.devicePixelRatio};e(this,Y)?e(this,y).push(a):(c(this,Y,!0),G(this,n,J).call(this,a))},J=function(t){const g=e(this,C).getImageData(0,0,this.canvas.width,this.canvas.height).data;e(this,K).postMessage({image:g,...t},[g.buffer])},d(x,F);let U=x;const xt={class:"p-0 relative min-h-90vh"},Kt={__name:"Atrament",setup(I){const s=D(),t=D(!1);let g;dt(()=>{g=new U(s.value,{width:s.value.offsetWidth,height:s.value.offsetHeight,color:"currentColor"}),lt(()=>{g.color=a.value,g.weight=i.value}),g.addEventListener("strokestart",()=>t.value=!0),g.addEventListener("strokeend",()=>t.value=!1)});const i=Wt(30,.1,3e3),a=rt(()=>{var A,r;return pt((A=o==null?void 0:o.note)==null?void 0:A.pitch,(r=o==null?void 0:o.note)==null?void 0:r._octave)}),{midi:o}=wt();ut({onWheel:Z},{...{wheel:{preventWindowScrollY:!0},eventOptions:{capture:!1,passive:!1}},domTarget:s});function Z(A){const{delta:[r,It],wheeling:ot,shiftKey:ht,event:z}=A;if(!ot)return;z&&z.preventDefault();let Ct=It/(ht?12:8);i.value+=Ct}At("Enter",A=>{g.clear()});const{elementX:W,elementY:m}=Gt(s);return(A,r)=>(bt(),Bt("div",xt,[vt(P("div",{class:"z-1000 pointer-events-none rounded-full absolute top-10 left-10 w-30",style:mt({backgroundColor:a.value,transform:"translate(-50%, -50%)",width:`${k(i)}px`,height:`${k(i)}px`,top:`${k(m)}px`,left:`${k(W)}px`})}," ",4),[[Zt,!t.value]]),P("canvas",{ref_key:"canvas",ref:s,width:"800",height:"800"},null,512)]))}},Ht=nt(Kt,[["__scopeId","data-v-a82adee9"]]);export{Ht as default};
