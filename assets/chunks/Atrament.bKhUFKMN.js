var at=Object.defineProperty;var T=o=>{throw TypeError(o)};var ct=(o,g,t)=>g in o?at(o,g,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[g]=t;var p=(o,g,t)=>ct(o,typeof g!="symbol"?g+"":g,t),H=(o,g,t)=>g.has(o)||T("Cannot "+t);var s=(o,g,t)=>(H(o,g,"read from private field"),t?t.call(o):g.get(o)),l=(o,g,t)=>g.has(o)?T("Cannot add the same private member more than once"):g instanceof WeakSet?g.add(o):g.set(o,t),c=(o,g,t,e)=>(H(o,g,"write to private field"),e?e.call(o,t):g.set(o,t),t),A=(o,g,t)=>(H(o,g,"access private method"),t);import{_ as nt,r as D,o as lt,O as rt,G as dt,a2 as Gt,a5 as At,c as bt,h as Bt,R as vt,S as Zt,i as P,l as mt,u as k}from"./framework.DqGUeSFU.js";import{D as Wt,C as pt,N as ut,L as wt}from"./theme.CMLB9bsx.js";function Yt(o,g,t){var e=function(r,Z){return atob(r)}(o),i=e.indexOf(`
`,10)+1,h=e.substring(i)+"",I=new Blob([h],{type:"application/javascript"});return URL.createObjectURL(I)}var j,f,yt=(j="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLy8gY29sb3VyIGluZGljZXMgcGVyIHBpeGVsCiAgY29uc3QgUiA9IDA7CiAgY29uc3QgRyA9IDE7CiAgY29uc3QgQiA9IDI7CiAgY29uc3QgQSA9IDM7CgogIGNvbnN0IFBJWEVMID0gNDsKICBjb25zdCBUUkFOU1BBUkVOVCA9IDA7CiAgY29uc3QgT1BBUVVFID0gMjU1OwoKICBjb25zdCBoZXhUb1JnYiA9IChoZXhDb2xvcikgPT4gewogICAgLy8gU2luY2UgaW5wdXQgdHlwZSBjb2xvciBwcm92aWRlcyBoZXggYW5kIEltYWdlRGF0YSBhY2NlcHRzIFJHQiBuZWVkIHRvIHRyYW5zZm9ybQogICAgY29uc3QgbSA9IGhleENvbG9yLm1hdGNoKC9eIz8oW1xkYS1mXXsyfSkoW1xkYS1mXXsyfSkoW1xkYS1mXXsyfSkkL2kpOwogICAgcmV0dXJuIFsKICAgICAgcGFyc2VJbnQobVsxXSwgMTYpLAogICAgICBwYXJzZUludChtWzJdLCAxNiksCiAgICAgIHBhcnNlSW50KG1bM10sIDE2KSwKICAgIF07CiAgfTsKCiAgLy8gUGl4ZWwgY29sb3IgZXF1YWxzIGNvbXAgY29sb3I/CiAgY29uc3QgY29sb3JNYXRjaGVyID0gKGRhdGEsIGNvbXBSLCBjb21wRywgY29tcEIsIGNvbXBBKSA9PiAocGl4ZWxQb3MpID0+ICgKICAgIGRhdGFbcGl4ZWxQb3MgKyBSXSA9PT0gY29tcFIKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBHXSA9PT0gY29tcEcKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBCXSA9PT0gY29tcEIKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBBXSA9PT0gY29tcEEKICApOwoKICBjb25zdCBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYSA9IChkYXRhLCAuLi5hcmdzKSA9PiB7CiAgICBjb25zdCBtYXRjaCA9IGNvbG9yTWF0Y2hlcihkYXRhLCAuLi5hcmdzKTsKCiAgICByZXR1cm4gKHBpeGVsUG9zKSA9PiB7CiAgICAgIGNvbnN0IGFscGhhID0gZGF0YVtwaXhlbFBvcyArIEFdOwogICAgICBpZiAoYWxwaGEgIT09IFRSQU5TUEFSRU5UICYmIGFscGhhICE9PSBPUEFRVUUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIG1hdGNoKHBpeGVsUG9zKTsKICAgIH07CiAgfTsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi8KICBjb25zdCBwaXhlbFBhaW50ZXIgPSAoZGF0YSwgZmlsbFIsIGZpbGxHLCBmaWxsQiwgZmlsbEEpID0+IChwaXhlbFBvcykgPT4gewogICAgZGF0YVtwaXhlbFBvcyArIFJdID0gZmlsbFI7CiAgICBkYXRhW3BpeGVsUG9zICsgR10gPSBmaWxsRzsKICAgIGRhdGFbcGl4ZWxQb3MgKyBCXSA9IGZpbGxCOwogICAgZGF0YVtwaXhlbFBvcyArIEFdID0gZmlsbEE7CiAgfTsKCiAgY29uc3QgcGl4ZWxQYWludGVyTWl4QWxwaGEgPSAoZGF0YSwgZmlsbFIsIGZpbGxHLCBmaWxsQiwgZmlsbEEpID0+IChwaXhlbFBvcykgPT4gewogICAgY29uc3Qgb2xkQWxwaGEgPSBkYXRhW3BpeGVsUG9zICsgQV07CiAgICAvLyBjYWxjdWxhdGUgcmF0aW8gb2Ygb2xkIHZzLiBuZXcgY29sb3VyIHRvIGJlIGFscGhhLW1peGVkCiAgICBjb25zdCBtaXhBbHBoYU9sZCA9IG9sZEFscGhhID09PSBPUEFRVUUKICAgICAgPyBUUkFOU1BBUkVOVAogICAgICA6IG9sZEFscGhhIC8gT1BBUVVFOwogICAgY29uc3QgbWl4QWxwaGFOZXcgPSAxIC0gbWl4QWxwaGFPbGQ7CgogICAgY29uc3QgcGFpbnQgPSBwaXhlbFBhaW50ZXIoCiAgICAgIGRhdGEsCiAgICAgIE1hdGguZmxvb3IobWl4QWxwaGFPbGQgKiBkYXRhW3BpeGVsUG9zICsgUl0gKyBtaXhBbHBoYU5ldyAqIGZpbGxSKSwKICAgICAgTWF0aC5mbG9vcihtaXhBbHBoYU9sZCAqIGRhdGFbcGl4ZWxQb3MgKyBHXSArIG1peEFscGhhTmV3ICogZmlsbEcpLAogICAgICBNYXRoLmZsb29yKG1peEFscGhhT2xkICogZGF0YVtwaXhlbFBvcyArIEJdICsgbWl4QWxwaGFOZXcgKiBmaWxsQiksCiAgICAgIGZpbGxBLAogICAgKTsKCiAgICByZXR1cm4gcGFpbnQocGl4ZWxQb3MpOwogIH07CiAgLyogZXNsaW50LWVuYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqLwoKICAvKioKICAgKiBTdGFjay0gYW5kIHNwYW4tYmFzZWQgZmxvb2QgZmlsbCBhbGdvcml0aG0KICAgKiBzZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRmxvb2RfZmlsbCNTcGFuX2ZpbGxpbmcKICAgKgogICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIG9wdGlvbnMgb2JqZWN0CiAgICogQHJldHVybnMge1VJbnQ4Q2xhbXBlZEFycmF5fSB0aGUgbW9kaWZpZWQgcGl4ZWxzCiAgICovCiAgY29uc3QgZmxvb2RGaWxsID0gKHsKICAgIGltYWdlLAogICAgd2lkdGgsCiAgICBoZWlnaHQsCiAgICBjb2xvciwKICAgIGdsb2JhbEFscGhhLAogICAgc3RhcnRYLAogICAgc3RhcnRZLAogICAgc3RhcnRDb2xvciwKICB9KSA9PiB7CiAgICBjb25zdCByb3cgPSB3aWR0aCAqIFBJWEVMOwogICAgLy8gbWFrZSBzdXJlIHN0YXJ0IGNvb3JkaW5hdGVzIGFyZSBpbnRlZ2VycwogICAgY29uc3Qgc3RhcnRYQ29vcmQgPSBNYXRoLmZsb29yKHN0YXJ0WCk7CiAgICBjb25zdCBzdGFydFlDb29yZCA9IE1hdGguZmxvb3Ioc3RhcnRZKTsKICAgIC8vIGhleCBuZWVkcyB0byBiZSB0cmFzZm9ybWVkIHRvIHJnYiBzaW5jZSBJbWFnZURhdGEgdXNlcyBSR0IKICAgIGNvbnN0IGZpbGxDb2xvciA9IGhleFRvUmdiKGNvbG9yKTsKICAgIC8vIGVuc3VyZSBhbHBoYSBpcyBhbiBpbnRlZ2VyIGluIHRoZSByYW5nZSBvZiAwLTI1NQogICAgY29uc3QgZmlsbEFscGhhID0gTWF0aC5mbG9vcihNYXRoLm1heCgwLCBNYXRoLm1pbihnbG9iYWxBbHBoYSAqIE9QQVFVRSwgT1BBUVVFKSkpOwogICAgLy8gd2UgbmVlZCBkaWZmZXJlbnQgYmVoYXZpb3VyIGluIGNhc2Ugd2UncmUgZmlsbGluZyBhIG5vbi1vcGFxdWUgYXJlYQogICAgY29uc3QgZmlsbGluZ05vbk9wYXF1ZSA9IHN0YXJ0Q29sb3JbQV0gIT09IE9QQVFVRTsKICAgIC8vIG91ciBwaXhlbCBwYWludGVyIHNob3VsZCBvbmx5IG1peCBhbHBoYSBpZiB3ZSdyZSBzdGFydGluZyBpbiBhIG5vbi1vcGFxdWUgYXJlYQogICAgY29uc3QgcGl4ZWxQYWludGVyT2ZDaG9pY2UgPSBmaWxsaW5nTm9uT3BhcXVlID8gcGl4ZWxQYWludGVyTWl4QWxwaGEgOiBwaXhlbFBhaW50ZXI7CiAgICBjb25zdCBwYWludFBpeGVsID0gcGl4ZWxQYWludGVyT2ZDaG9pY2UoaW1hZ2UsIC4uLmZpbGxDb2xvciwgZmlsbEFscGhhKTsKICAgIC8vIHdoZW4gbG9va2luZyBmb3IgdGhlIHNwYW4gc3RhcnQsIHdlIGlnbm9yZSB0aGUgYWxwaGEgdmFsdWUgaWYgZmlsbGluZyBhIG5vbi1vcGFxdWUgYXJlYQogICAgLy8gdGhpcyBlbnN1cmVzIHRoYXQgd2UnbGwgbWl4IHRoZSBmaWxsIGludG8gYW50aWFsaWFzZWQgZWRnZXMKICAgIGNvbnN0IGNvbG9yTWF0Y2hlclNwYW5TdGFydCA9IGZpbGxpbmdOb25PcGFxdWUgPyBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYSA6IGNvbG9yTWF0Y2hlcjsKICAgIGNvbnN0IG1hdGNoU3BhblN0YXJ0Q29sb3IgPSBjb2xvck1hdGNoZXJTcGFuU3RhcnQoaW1hZ2UsIC4uLnN0YXJ0Q29sb3IpOwogICAgLy8gZm9yIGFsbCBvdGhlciBjYXNlcywgd2UgbG9vayBmb3IgdGhlIHN0YXJ0IGNvbG91ciBleGFjdGx5CiAgICBjb25zdCBtYXRjaFN0YXJ0Q29sb3IgPSBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYShpbWFnZSwgLi4uc3RhcnRDb2xvcik7CgogICAgLy8gY2hlY2sgaWYgd2UncmUgdHJ5aW5nIHRvIGZpbGwgd2l0aCB0aGUgc2FtZSBjb2xvdXIsIGlmIHNvLCBzdG9wCiAgICBjb25zdCBtYXRjaEZpbGxDb2xvciA9IGNvbG9yTWF0Y2hlcihpbWFnZSwgLi4uWy4uLmZpbGxDb2xvciwgT1BBUVVFXSk7CiAgICBpZiAobWF0Y2hGaWxsQ29sb3IoKHN0YXJ0WUNvb3JkICogd2lkdGggKyBzdGFydFhDb29yZCkgKiBQSVhFTCkpIHsKICAgICAgcmV0dXJuIGltYWdlOwogICAgfQogICAgLy8gYmVnaW4gd2l0aCBvdXIgc3RhcnQgcGl4ZWwKICAgIGNvbnN0IHBpeGVsU3RhY2sgPSBbW3N0YXJ0WENvb3JkLCBzdGFydFlDb29yZF1dOwogICAgd2hpbGUgKHBpeGVsU3RhY2subGVuZ3RoKSB7CiAgICAgIGNvbnN0IFt4LCB5XSA9IHBpeGVsU3RhY2sucG9wKCk7CiAgICAgIC8vIGNvbHVtbiBwb3NpdGlvbiBpcyBpbiBjYXJ0ZXNpYW4gc3BhY2UgKHgseSkKICAgICAgbGV0IGNvbHVtblBvc2l0aW9uID0geTsKICAgICAgLy8gcGl4ZWwgcG9zaXRpb24gaXMgaW4gMUQgc3BhY2UgKHRoZSByYXcgaW1hZ2UgZGF0YSBVSW50OENsYW1wZWRBcnJheSkKICAgICAgbGV0IHBpeGVsUG9zID0gKGNvbHVtblBvc2l0aW9uICogd2lkdGggKyB4KSAqIFBJWEVMOwogICAgICAvLyBzdGFydCBtb3ZpbmcgZGlyZWN0bHkgdXAgZnJvbSBvdXIgc3RhcnQgcG9zaXRpb24KICAgICAgLy8gdW50aWwgd2UgZmluZCBhIGRpZmZlcmVudCBjb2xvdXIgdG8gdGhlIHN0YXJ0IGNvbG91cgogICAgICAvLyB0aGlzIGlzIHRoZSBiZWdpbm5pbmcgb2Ygb3VyIHNwYW4KICAgICAgd2hpbGUgKGNvbHVtblBvc2l0aW9uLS0gPj0gMCAmJiBtYXRjaFNwYW5TdGFydENvbG9yKHBpeGVsUG9zKSkgewogICAgICAgIHBpeGVsUG9zIC09IHJvdzsKICAgICAgfQogICAgICAvLyBtb3ZlIG9uZSByb3cgZG93biAodG9wbW9zdCBwaXhlbCBvZiBmaWxsYWJsZSBhcmVhKQogICAgICBwaXhlbFBvcyArPSByb3c7CgogICAgICBsZXQgcmVhY2hMZWZ0ID0gZmFsc2U7CiAgICAgIGxldCByZWFjaFJpZ2h0ID0gZmFsc2U7CiAgICAgIC8vIGZvciBlYWNoIHJvdywgY2hlY2sgaWYgdGhlIGZpcnN0IHBpeGVsIHN0aWxsIGhhcyB0aGUgc3RhcnQgY29sb3VyCiAgICAgIC8vIGlmIGl0IGRvZXMsIHBhaW50IGl0IGFuZCBwdXNoIHN1cnJvdW5kaW5nIHBpeGVscyB0byB0aGUgc3RhY2sgb2YgcGl4ZWxzIHRvIGNoZWNrCiAgICAgIHdoaWxlICgrK2NvbHVtblBvc2l0aW9uIDwgaGVpZ2h0IC0gMSAmJiBtYXRjaFN0YXJ0Q29sb3IocGl4ZWxQb3MpKSB7CiAgICAgICAgcGFpbnRQaXhlbChwaXhlbFBvcyk7CiAgICAgICAgLy8gY2hlY2sgdGhlIHBpeGVsIHRvIHRoZSBsZWZ0CiAgICAgICAgaWYgKHggPiAwKSB7CiAgICAgICAgICBpZiAobWF0Y2hTdGFydENvbG9yKHBpeGVsUG9zIC0gUElYRUwpKSB7CiAgICAgICAgICAgIGlmICghcmVhY2hMZWZ0KSB7CiAgICAgICAgICAgICAgcGl4ZWxTdGFjay5wdXNoKFt4IC0gMSwgY29sdW1uUG9zaXRpb25dKTsKICAgICAgICAgICAgICByZWFjaExlZnQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHJlYWNoTGVmdCkgewogICAgICAgICAgICByZWFjaExlZnQgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gY2hlY2sgdGhlIHBpeGVsIHRvIHRoZSByaWdodAogICAgICAgIGlmICh4IDwgd2lkdGggLSAxKSB7CiAgICAgICAgICBpZiAobWF0Y2hTdGFydENvbG9yKHBpeGVsUG9zICsgUElYRUwpKSB7CiAgICAgICAgICAgIGlmICghcmVhY2hSaWdodCkgewogICAgICAgICAgICAgIHBpeGVsU3RhY2sucHVzaChbeCArIDEsIGNvbHVtblBvc2l0aW9uXSk7CiAgICAgICAgICAgICAgcmVhY2hSaWdodCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAocmVhY2hSaWdodCkgewogICAgICAgICAgICByZWFjaFJpZ2h0ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIG1vdmUgdG8gdGhlIG5leHQgcm93CiAgICAgICAgcGl4ZWxQb3MgKz0gcm93OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGltYWdlOwogIH07CgogIGdsb2JhbFRoaXMuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsICh7IGRhdGEgfSkgPT4gewogICAgY29uc3QgcmVzdWx0ID0gZmxvb2RGaWxsKGRhdGEpOwoKICAgIGdsb2JhbFRoaXMucG9zdE1lc3NhZ2UoeyB0eXBlOiAnZmlsbC1yZXN1bHQnLCByZXN1bHQgfSwgW3Jlc3VsdC5idWZmZXJdKTsKICB9KTsKCn0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXdvcmtlci5qcy5tYXAKCg==",function(o){return f=f||Yt(j),new Worker(f,o)});class U{constructor(g,t){this.x=g,this.y=t}set(g,t){this.x=g,this.y=t}}class St extends U{constructor(){super(0,0),this.down=!1,this.previous=new U(0,0)}}class Ft{constructor(){this.eventListeners=new Map}addEventListener(g,t){const e=this.eventListeners.get(g)||new Set;e.add(t),this.eventListeners.set(g,e)}removeEventListener(g,t){const e=this.eventListeners.get(g);e&&e.delete(t)}dispatchEvent(g,t){const e=this.eventListeners.get(g);e&&[...e].forEach(i=>i(t))}}const M=(o,g,t,e)=>{const i=(t-o)**2,h=(e-g)**2;return Math.sqrt(i+h)},Q=o=>g=>{!g.isPrimary||g.button>0||(g.cancelable&&g.preventDefault(),o(g))},w=Symbol("atrament mode - draw"),X=Symbol("atrament mode - erase"),N=Symbol("atrament mode - fill"),O=Symbol("atrament mode - disabled"),q=[w,X],Xt=["weight","smoothing","adaptiveStroke","mode"];var a,u,Y,y,K,b,C,V,R,S,B,v,n,_,F,$,tt,L,st,et,gt,it,J;const x=class x extends Ft{constructor(t,e={}){var i,h;if(typeof window>"u")throw new Error("atrament: looks like we're not running in a browser");super();l(this,n);p(this,"adaptiveStroke",!0);p(this,"canvas");p(this,"recordStrokes",!1);p(this,"resolution",window.devicePixelRatio);p(this,"smoothing",.85);p(this,"thickness",2);l(this,a);l(this,u,!1);l(this,Y,!1);l(this,y,[]);l(this,K,new yt);l(this,b,w);l(this,C,new St);l(this,V,.5);l(this,R);l(this,S,[]);l(this,B,2);l(this,v,2);this.canvas=A(i=x,F,$).call(i,t,e),c(this,a,A(h=x,F,tt).call(h,this.canvas,e)),A(this,n,gt).call(this),c(this,R,(({canvas:I,move:r,down:Z,up:W})=>{const m=Q(r),G=Q(Z),d=Q(W);return I.addEventListener("pointermove",m),I.addEventListener("pointerdown",G),document.addEventListener("pointerup",d),document.addEventListener("pointerout",d),()=>{I.removeEventListener("pointermove",m),I.removeEventListener("pointerdown",G),document.removeEventListener("pointerup",d),document.removeEventListener("pointerout",d)}})({canvas:this.canvas,move:A(this,n,L).bind(this),down:A(this,n,st).bind(this),up:A(this,n,et).bind(this)})),Xt.forEach(I=>{e[I]!==void 0&&(this[I]=e[I])})}beginStroke(t,e){s(this,a).moveTo(t,e),c(this,B,s(this,v)),this.recordStrokes&&(this.strokeTimestamp=performance.now()),this.dispatchEvent("strokestart",{x:t,y:e})}endStroke(t,e){this.dispatchEvent("strokeend",{x:t,y:e}),this.recordStrokes&&this.dispatchEvent("strokerecorded",{stroke:this.currentStroke}),c(this,S,[]),delete this.strokeTimestamp}draw(t,e,i,h){const I=i||t,r=h||e,Z=this.getSmoothingFactor(M(t,e,I,r)),W=t-(t-I)*Z,m=e-(e-r)*Z,G=M(W,m,I,r);if(this.adaptiveStroke){const d=(G-2)/(98*(1-s(this,V)))*(s(this,n,_)-s(this,v))+s(this,v);s(this,B)>d?c(this,B,s(this,B)-.25):s(this,B)<d&&c(this,B,s(this,B)+.25)}else c(this,B,s(this,v));return s(this,a).lineWidth=s(this,B),s(this,a).beginPath(),s(this,a).moveTo(I,r),s(this,a).quadraticCurveTo(I,r,W,m),s(this,a).closePath(),s(this,a).stroke(),this.recordStrokes&&(s(this,S).push({point:new U(t,e),time:performance.now()-this.strokeTimestamp}),this.dispatchEvent("segmentdrawn",{stroke:this.currentStroke})),s(this,u)||s(this,b)!==w||(c(this,u,!0),this.dispatchEvent("dirty")),{x:W,y:m}}clear(){c(this,u,!1),this.dispatchEvent("clean");const t=this.mode===X;t&&(this.mode=w),s(this,a).save(),s(this,a).setTransform(1,0,0,1,0,0),s(this,a).clearRect(0,0,this.canvas.width,this.canvas.height),s(this,a).restore(),t&&(this.mode=X)}destroy(){var t;this.clear(),(t=s(this,R))==null||t.call(this)}get color(){return s(this,a).strokeStyle}set color(t){if(typeof t!="string")throw new Error("atrament: wrong argument type setting color");s(this,a).strokeStyle=t}get weight(){return s(this,v)}set weight(t){if(typeof t!="number")throw new Error("atrament: wrong argument type setting weight");c(this,B,t),c(this,v,t)}getSmoothingFactor(t){return Math.min(.87,this.smoothing+(t-60)/3e3)}get mode(){return s(this,b)}set mode(t){switch(t){case X:c(this,b,X),s(this,a).globalCompositeOperation="destination-out";break;case N:c(this,b,N),s(this,a).globalCompositeOperation="source-over";break;case O:c(this,b,O);break;case w:c(this,b,w),s(this,a).globalCompositeOperation="source-over";break;default:throw new Error("atrament: mode is not one of the allowed modes.")}}get currentStroke(){return{segments:s(this,S).slice(),mode:this.mode,weight:this.weight,smoothing:this.smoothing,color:this.color,adaptiveStroke:this.adaptiveStroke}}get dirty(){return s(this,u)}};a=new WeakMap,u=new WeakMap,Y=new WeakMap,y=new WeakMap,K=new WeakMap,b=new WeakMap,C=new WeakMap,V=new WeakMap,R=new WeakMap,S=new WeakMap,B=new WeakMap,v=new WeakMap,n=new WeakSet,_=function(){return s(this,v)+30},F=new WeakSet,$=function(t,e){let i;if(t instanceof window.Node&&t.tagName==="CANVAS")i=t;else{if(typeof t!="string")throw new Error(`atrament: can't look for canvas based on '${t}'`);i=document.querySelector(t)}if(!i)throw new Error("atrament: canvas not found");const h=e.resolution||window.devicePixelRatio;return i.width=(e.width||i.width)*h,i.height=(e.height||i.height)*h,i.style.touchAction="none",i},tt=function(t,e){const i=t.getContext("2d"),h=e.resolution||window.devicePixelRatio;return i.scale(h,h),i.globalCompositeOperation="source-over",i.globalAlpha=1,i.strokeStyle=e.color||"rgba(0,0,0,1)",i.lineCap="round",i.lineJoin="round",i},L=function(t){var e;(((e=t.getCoalescedEvents)==null?void 0:e.call(t))||[t]).forEach(i=>{const h=i.offsetX,I=i.offsetY;if(s(this,C).down&&q.includes(s(this,b))){const{x:r,y:Z}=this.draw(h,I,s(this,C).previous.x,s(this,C).previous.y);s(this,C).set(h,I),s(this,C).previous.set(r,Z),c(this,V,i.pressure===1?.5:i.pressure||.5)}else s(this,C).set(h,I),s(this,C).previous.set(h,I)})},st=function(t){this.mode!==N?(s(this,C).down=!0,A(this,n,L).call(this,t),this.beginStroke(s(this,C).previous.x,s(this,C).previous.y)):A(this,n,it).call(this)},et=function(t){s(this,b)!==N&&s(this,C).down&&(s(this,C).down=!1,s(this,C).x===t.offsetX&&s(this,C).y===t.offsetY&&q.includes(this.mode)&&this.draw(s(this,C).x,s(this,C).y,s(this,C).previous.x,s(this,C).previous.y),s(this,C).previous.set(0,0),this.endStroke(s(this,C).x,s(this,C).y))},gt=function(){s(this,K).addEventListener("message",({data:t})=>{if(t.type==="fill-result"){c(this,Y,!1),this.dispatchEvent("fillend",{});const e=new ImageData(t.result,this.canvas.width,this.canvas.height);s(this,a).putImageData(e,0,0),s(this,y).length>0&&A(this,n,J).call(this,s(this,y).shift())}})},it=function(){const{x:t,y:e}=s(this,C);this.dispatchEvent("fillstart",{x:t,y:e});const i=Array.from(s(this,a).getImageData(t,e,1,1).data),h={color:this.color,globalAlpha:s(this,a).globalAlpha,width:this.canvas.width,height:this.canvas.height,startColor:i,startX:t*this.resolution,startY:e*this.resolution};s(this,Y)?s(this,y).push(h):(c(this,Y,!0),A(this,n,J).call(this,h))},J=function(t){const e=s(this,a).getImageData(0,0,this.canvas.width,this.canvas.height).data;s(this,K).postMessage({image:e,...t},[e.buffer])},l(x,F);let E=x;const xt={class:"p-0 relative min-h-90vh"},Kt={__name:"Atrament",setup(o){const g=D(),t=D(!1);let e;lt(()=>{e=new E(g.value,{width:g.value.offsetWidth,height:g.value.offsetHeight,color:"currentColor"}),rt(()=>{e.color=h.value,e.weight=i.value}),e.addEventListener("strokestart",()=>t.value=!0),e.addEventListener("strokeend",()=>t.value=!1)});const i=Wt(30,.1,3e3),h=dt(()=>{var G,d;return pt((G=I==null?void 0:I.note)==null?void 0:G.pitch,(d=I==null?void 0:I.note)==null?void 0:d._octave)}),{midi:I}=ut();wt({onWheel:Z},{...{wheel:{preventWindowScrollY:!0},eventOptions:{capture:!1,passive:!1}},domTarget:g});function Z(G){const{delta:[d,ot],wheeling:It,shiftKey:ht,event:z}=G;if(!It)return;z&&z.preventDefault();let Ct=ot/(ht?12:8);i.value+=Ct}Gt("Enter",G=>{e.clear()});const{elementX:W,elementY:m}=At(g);return(G,d)=>(bt(),Bt("div",xt,[vt(P("div",{class:"z-1000 pointer-events-none rounded-full absolute top-10 left-10 w-30",style:mt({backgroundColor:h.value,transform:"translate(-50%, -50%)",width:`${k(i)}px`,height:`${k(i)}px`,top:`${k(m)}px`,left:`${k(W)}px`})}," ",4),[[Zt,!t.value]]),P("canvas",{ref_key:"canvas",ref:g,width:"800",height:"800"},null,512)]))}},Ht=nt(Kt,[["__scopeId","data-v-a82adee9"]]);export{Ht as default};
