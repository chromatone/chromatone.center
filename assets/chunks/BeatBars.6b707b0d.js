import{_ as X}from"./BeatBarsBar.217b49bc.js";import{_ as j}from"./StateTransport.c4adc36b.js";import{r as S}from"./midiRender.b18e39bb.js";import{m as $,t as M}from"./sequence.2d94d1ea.js";import{N as z,z as E,r as L,J as h,K as R,C as V,o as t,c as o,f as F,w as I,g as k,q as c,F as d,d as m,u as v,a as i,E as O,t as x,D as g,n as q}from"./framework.a2b37741.js";const a=z("tempo-bar-loops-object",{0:{over:8,under:8,volume:1,sound:"A"},1:{over:3,under:3,volume:.5,sound:"B"}}),J={class:"flex flex-wrap items-center w-full p-4 has-bg rounded-xl relative gap-6 bg-light-600 dark-bg-dark-500",id:"screen"},K={key:1,class:"flex flex-col p-2 my-2 is-group"},P={class:"flex flex"},G={class:"flex flex-wrap justify-center"},H={class:"font-bold mx-2"},Q={key:0},T={class:"flex flex-wrap justify-center is-group m-1 text-xl p-2",style:{flex:"1 1 100%"}},U=i("div",{class:"i-la-plus"},null,-1),W=[U],Y=i("div",{class:"i-la-file-download"},null,-1),Z=[Y],ee={key:1,class:"is-group m-2"},te=["onClick"],oe=["onClick"],ie={__name:"BeatBars",props:{meters:{type:Array,default:null},patterns:{type:Object,default:null},accents:{type:String,default:"XxXxXxXx"},mute:{type:String,delault:""},secondary:{type:Boolean,default:!1}},setup(s){const f=s,u=E(f.accents),C=L({over:4,under:4,volume:1,sound:"A"});h(()=>f.meters,n=>{if(n){let l=n[0].split("/");a.value={0:{over:Number(l[0]),under:Number(l[1]),volume:f.secondary?0:1,sound:"A"}}}},{immediate:!0}),h(()=>f.patterns,n=>{n&&(u.value=Object.keys(n)[0])},{immediate:!0});function w(n,l){a.value[0].over=n.length,a.value[0].under=l?l.split("/")[1]:n.length,u.value=n}function B(){a.value[Math.floor(Math.random()*1e4)]={...C}}return(n,l)=>{const D=j,A=X,N=R("client-only"),_=V("tooltip");return t(),o("div",J,[F(N,null,{default:I(()=>{var y;return[s.secondary?c("",!0):(t(),k(D,{key:0,secondary:!0})),(t(!0),o(d,null,m(v(a),(e,r)=>(t(),k(A,{class:"my-1 rounded-3xl shadow-lg min-h-36 max-h-30vh",style:{flex:"1 1 420px"},key:r,order:r,loop:e,maxRatio:v($),onDel:p=>delete v(a)[r],editable:!s.meters,accents:u.value,mute:s.mute},null,8,["order","loop","maxRatio","onDel","editable","accents","mute"]))),128)),s.patterns?(t(),o("div",K,[i("div",P,[(t(!0),o(d,null,m(u.value,(e,r)=>(t(),o("div",{class:"flex-1 p-1 border-1 border-current rounded-lg m-1 opacity-50",key:r,style:O({opacity:e=="X"?1:.5,backgroundColor:e=="1"||e=="X"||e=="x"?"currentColor":"transparent"})},null,4))),128))]),i("div",G,[(t(!0),o(d,null,m((y=s.patterns[u.value])==null?void 0:y.names,e=>(t(),o("div",{class:"p-1",key:e},[i("span",H,x(e.name),1),e.place?(t(),o("span",Q,"("+x(e.place)+")",1)):c("",!0)]))),128))])])):c("",!0),i("div",T,[s.meters?c("",!0):g((t(),o("button",{key:0,class:"text-button",onClick:l[0]||(l[0]=e=>B())},W)),[[_,"Add new track",void 0,{bottom:!0}]]),g((t(),o("button",{class:"text-button flex items-center",onClick:l[1]||(l[1]=e=>v(S)(v(M)))},Z)),[[_,"Export MIDI file",void 0,{bottom:!0}]]),s.meters&&s.meters.length>1?(t(),o("div",ee,[(t(!0),o(d,null,m(s.meters,e=>(t(),o("button",{class:"text-button",onClick:r=>a.value=[{over:e.split("/")[0],under:e.split("/")[1],sound:"A",volume:1}]},x(e),9,te))),256))])):c("",!0),(t(!0),o(d,null,m(s.patterns,(e,r)=>{var p,b;return t(),o("button",{class:q(["text-button",{active:u.value==r}]),onClick:se=>w(r,e.meter)},x(((b=(p=e==null?void 0:e.names)==null?void 0:p[0])==null?void 0:b.name)||r),11,oe)}),256))])]}),_:1})])}}};export{ie as _};
