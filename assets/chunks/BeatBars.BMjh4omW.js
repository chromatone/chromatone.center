import{_ as J}from"./trash.aQwZknfE.js";import{_ as K,a as Q,b as W,c as Y,d as Z}from"./angle-right.BSj26fzG.js";import{v as s,x as i,z as l,af as P,c as V,d as z,V as R,D as o,E as C,F as _,A as B,B as x,H as g,b as U,I as O,q as ee,r as T,W as N,L as M,M as L,ak as te,J as oe,K as ne,u as se,a4 as le,G as re,y as ae}from"./framework.5yygNDZN.js";import{aL as q,L as E,Q as H,al as ie,n as ue,aM as de,aN as ce,aO as me,U as he}from"./theme.BJf4skTF.js";const fe={style:{"vertical-align":"middle"},viewBox:"0 0 32 32",width:"1.2em",height:"1.2em"},ve=l("path",{fill:"currentColor",d:"M15 4.594L13.281 6.28L8.562 11H4v10h4.563l4.718 4.719L15 27.406zm-2 4.843v13.126L9.719 19.28L9.406 19H6v-6h3.406l.313-.281zm7.219 2.344L18.78 13.22L21.563 16l-2.782 2.781l1.438 1.438L23 17.437l2.781 2.782l1.438-1.438L24.437 16l2.782-2.781l-1.438-1.438L23 14.562z"},null,-1),ye=[ve];function pe(e,k){return s(),i("svg",fe,[...ye])}const xe={name:"la-volume-off",render:pe},be=["transform"],we=["opacity"],ge=["width","fill"],ke=["stroke","fill"],$e=["fill"],_e=["stroke"],Ce=["onDblclick","data-sub"],Ne=["transform"],Be=["width","x","fill"],Ve=["transform","fill","opacity"],Me=["x"],Se=["fill","stroke"],ze={key:0,class:"transition-all duration-100 ease-out pointer-events-none",cx:0,cy:100,r:"3",fill:"currentColor",opacity:"0.8"},De={__name:"BeatBarsStep",props:{proportion:{type:Number,default:1},step:{type:Number,default:1},subdivisions:{type:[Array,String],default:""},muted:{type:Boolean,default:!1},total:{type:Number,default:4},current:{type:[Number,String],default:0},mutes:{type:Object,default:{}},accented:{type:Boolean,default:!1},width:{type:Number,default:900},pad:{type:Number,default:50}},emits:["mute","subdivide","accent"],setup(e,{emit:k}){const{isDark:y}=P(),c=e,r=k,t=V(()=>q(c.step+E.pitch/12*c.total,c.total,1));V(()=>c.subdivisions[0].includes("!"));const h=H(0,40,640),f=V(()=>Math.floor(h.value/40));z(f,(n,d)=>{if(n==d)return;let p=[];for(let a=0;a<n;a++)p.push(`${c.step}-${a}`);r("subdivide",p)});function b(n){if(n.tap){let d=n.event.currentTarget.dataset.sub;c.mutes[d]=!c.mutes[d]}h.value+=n.delta[0]-n.delta[1]}const u=V(()=>{let n=c.subdivisions[0]==c.current,d=c.subdivisions[0].split("-")[0],p=c.current.split("-")[0];return!c.mutes[c.subdivisions[0]]&&(n||d==p)});return(n,d)=>{const p=R("drag");return s(),i("g",{class:"cursor-pointer",transform:`translate(${e.proportion*e.step*e.width+e.pad},0)`},[l("g",{class:"step",opacity:e.muted?.1:1},[l("rect",{class:"transition-fill duration-100",onMousedown:d[0]||(d[0]=a=>n.$emit("mute")),width:e.proportion*e.width,height:"180",rx:"10",fill:u.value?e.muted?"transparent":t.value:"transparent"},null,40,ge),l("circle",{class:"transition-all duration-100 ease-out",onMousedown:d[1]||(d[1]=a=>e.muted?n.$emit("mute"):n.$emit("accent")),cy:"35",cx:"0",r:"25","stroke-width":"4",stroke:t.value,fill:u.value?e.muted?"transparent":"currentColor":e.accented?t.value:o(y)?"#333":"#eee"},null,40,ke),l("text",{class:"pointer-events-none transition-all duration-100 ease-out",y:"48","font-size":"40","text-anchor":"middle",x:"0",fill:u.value?o(y)?"#333":"#eee":"currentColor"},C(e.step+1),9,$e),l("line",{class:"pointer-events-none",y1:"60",y2:"100","stroke-width":"8",stroke:t.value},null,8,_e),(s(!0),i(_,null,B(e.subdivisions,(a,v)=>x((s(),i("g",{class:"sub",key:a,onDblclick:D=>{n.$emit("subdivide",[`${a}-1`]),h.value=40},"data-sub":a},[l("line",{transform:`translate(${v*e.proportion*e.width/e.subdivisions.length}, 0)`,y1:"100",y2:"150","stroke-width":"1",stroke:"currentColor"},null,8,Ne),l("rect",{class:"transition-fill duration-100",width:e.proportion*e.width/e.subdivisions.length,height:"80",y:"100",rx:"10",x:v*e.proportion*e.width/e.subdivisions.length,fill:`hsla(0,0%,${90-v*80/e.subdivisions.length}%,${a==e.current?.9:.4})`},null,8,Be),l("circle",{class:"transition-all duration-100 ease-out pointer-events-none",transform:`translate(${v*e.proportion*e.width/e.subdivisions.length}, 0)`,cx:0,cy:100,r:6,fill:a==e.current?"currentColor":e.muted?"transparent":t.value,opacity:e.mutes[a]?0:1,"stroke-width":"4","stroke-linecap":"round"},null,8,Ve),e.mutes[a]?g("",!0):(s(),i("text",{key:0,y:"140","font-size":"40","text-anchor":"middle",x:15+v*e.proportion*e.width/e.subdivisions.length,fill:"currentColor"},C(v+1),9,Me))],40,Ce)),[[p,b]])),128)),l("circle",{class:"transition-all duration-100 ease-out pointer-events-none",cx:"0",cy:100,r:"10",fill:t.value,stroke:u.value?"currentColor":"transparent","stroke-width":"4",opacity:"0.8"},null,8,Se)],8,we),e.muted?(s(),i("circle",ze)):g("",!0)],8,be)}}},Le={class:"bar cursor-pointer","font-size":"32px"},Ae=["x1","x2","y1","y2","stroke-width","stroke"],Re=["x2","y1","y2","stroke"],Ie=["x1","x2","y1","y2","stroke-width","stroke"],je={key:0,class:"all"},Ee=["cx","cy","r"],Pe=["cx","cy"],Xe=["transform"],Ue=["fill"],Oe={transform:"translate(0 10)",fill:"currentColor","text-anchor":"middle"},Te={__name:"BeatControlBar",props:{modelValue:{type:[Number,String],default:.1},step:{type:Number,default:.1},min:{type:Number,default:0},max:{type:Number,default:1},width:{type:Number,default:100},height:{type:Number,default:50},vector:{type:Array,default:[1,-1]},showPositions:{type:Boolean,default:!1},ratio:{type:Number,default:200},every:{type:Number,default:null},showCenter:{type:Boolean,default:!1},inverted:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:k}){const{isDark:y}=P(),c=k,r=e,t=U({inner:H((Number(r.modelValue)-r.min)/(r.max-r.min),0,1),proportion:V(()=>r.inverted?(Number(r.modelValue)-r.max)/(r.min-r.max):(Number(r.modelValue)-r.min)/(r.max-r.min)),pos:V(()=>t.proportion*r.width)});function h(u){t.inner+=(r.vector[0]*u.delta[0]+r.vector[1]*u.delta[1])/r.ratio}function f(u){t.inner+=u*r.step/(r.max-r.min)}z(()=>t.inner,u=>{let n=u*(r.max-r.min)+r.min;c("update:modelValue",Math.round(n/r.step)*r.step)});const b=V(()=>{let u=(r.max-r.min)/r.step,n=[];for(let d=0;d<=1;d+=1/u)n.push(d*r.width);return n});return(u,n)=>{const d=R("drag");return x((s(),i("g",Le,[l("line",{class:"add",onMousedown:n[0]||(n[0]=p=>f(1)),x1:e.inverted?0:t.pos,x2:e.inverted?t.pos:e.width,y1:e.height/2,y2:e.height/2,"stroke-linecap":"round","stroke-width":e.height,stroke:o(y)?"#1114":"#fff8"},null,40,Ae),l("line",{class:"pointer-events-none",x1:0,x2:e.width,y1:e.height/2,y2:e.height/2,"stroke-linecap":"round","stroke-width":18,stroke:o(y)?"#2228":"#eee"},null,8,Re),l("line",{class:"subtract",onMousedown:n[1]||(n[1]=p=>f(-1)),x1:e.inverted?e.width:e.showCenter?e.width/2:0,x2:t.pos,y1:e.height/2,y2:e.height/2,"stroke-linecap":"round","stroke-width":e.height,stroke:o(y)?"#3338":"#ddd8"},null,40,Ie),e.showPositions?(s(),i("g",je,[(s(!0),i(_,null,B(b.value,(p,a)=>(s(),i("circle",{key:p,cx:p,cy:e.height/2,r:e.every&&a%e.every==0?4:2,fill:"currentColor",opacity:"0.5"},null,8,Ee))),128))])):g("",!0),e.showCenter?(s(),i("circle",{key:1,cx:e.width/2,cy:e.height/2,r:"4",opacity:"0.5",fill:"currentColor"},null,8,Pe)):g("",!0),l("g",{class:"mover",transform:`translate(${t.pos} ${e.height/2})`},[l("circle",{r:"25","stroke-width":"0","stroke-opacity":"0.5",stroke:"currentColor",style:{filter:"url(#shadowButton)"},fill:o(y)?"#333":"#eee"},null,8,Ue),l("g",Oe,[O(u.$slots,"default",{},()=>[l("text",null,C(e.modelValue),1)])])],8,Xe)])),[[d,h]])}}},I=e=>(oe("data-v-28dbaefe"),e=e(),ne(),e),qe={class:"w-full bg-light-300 dark-bg-dark-800",version:"1.1",baseProfile:"full",viewBox:"0 0 1000 350",xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"}},He=I(()=>l("defs",null,[l("filter",{id:"shadowButton",x:"-50%",height:"200%",width:"300%"},[l("feDropShadow",{dx:"0",dy:"3",stdDeviation:"3","flood-color":"#2225"})])],-1)),Fe={key:0,class:"meter-bars",transform:"translate(40,15)"},Ge={class:"info",transform:"translate(500,53)"},Je={class:"signature"},Ke=I(()=>l("text",{fill:"currentColor","font-size":"45","text-anchor":"middle",y:"2"},"/",-1)),Qe={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"40px","text-anchor":"end",x:-10},We={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"40px","text-anchor":"start",x:10},Ye=I(()=>l("circle",{r:"18",fill:"#5553"},null,-1)),Ze=I(()=>l("circle",{r:"18",fill:"#5553"},null,-1)),et={"text-anchor":"middle",style:{"user-select":"none",transition:"all 300ms ease"}},tt=["opacity"],ot={class:"lines",transform:"translate(0,100)"},nt=["x1","x2"],st=["x1","x2","stroke"],lt={class:"arrows pointer-events-none"},rt=["transform"],at=["cx","r","fill"],it={class:"bottom",transform:"translate(40,290)"},ut={transform:"translate(-20 -30)"},dt=["fill"],ct=["fill"],mt={__name:"BeatBarsBar",props:{order:{type:Number,default:0},loop:{type:Object,default:{over:4,under:4,sound:"A",volume:1}},maxRatio:{type:Number,default:1},editable:{type:Boolean,default:!1},mute:{type:String,default:null},accents:{type:String,default:null},width:{type:Number,default:920}},emits:["del","sound"],setup(e,{emit:k}){const{isDark:y}=P(),c=e,r=V(()=>(1e3-c.width)/2),{seq:t}=ie(c.loop,c.order,"bars"),h=["A","B","C","D","E"],f=T(h.findIndex(u=>{var n;return u==((n=t.meter)==null?void 0:n.sound)}));z(f,u=>{t.meter.sound=h[u]});const b=V(()=>{const u=1/t.meter.over;return u>=c.maxRatio?c.maxRatio:u});return z(()=>c.loop,u=>{t.meter={...c.loop}},{immediate:!0}),z(()=>c.accents,u=>{u&&u.split("").forEach((n,d)=>{t.mutes[d]=n=="0"||n==".",t.accents[d]=n=="2"||n=="X"})},{immediate:!0}),(u,n)=>{const d=Te,p=K,a=Q,v=De,D=xe,A=W,X=Y,F=Z,G=J,$=R("tooltip");return s(),i(_,null,[O(u.$slots,"default",{},void 0,!0),(s(),i("svg",qe,[He,e.editable?(s(),i("g",Fe,[x(N(d,{class:"over",modelValue:o(t).meter.over,"onUpdate:modelValue":n[0]||(n[0]=m=>o(t).meter.over=m),width:340,step:1,min:2,max:16,"show-positions":"",ratio:500,every:4},null,8,["modelValue"]),[[$,"Number of steps",void 0,{top:!0}]]),x(N(d,{class:"under",transform:"translate(580,0)",modelValue:o(t).meter.under,"onUpdate:modelValue":n[1]||(n[1]=m=>o(t).meter.under=m),width:340,step:1,min:1,max:16,"show-positions":"",ratio:500,every:4,inverted:"",vector:[-1,-1]},null,8,["modelValue"]),[[$,"Measure subdivision",void 0,{top:!0}]])])):g("",!0),l("g",Ge,[x((s(),i("g",Je,[Ke,l("text",Qe,C(o(t).meter.over),1),l("text",We,C(o(t).meter.under),1)])),[[$,"Time signature",void 0,{top:!0}]]),x((s(),i("g",{class:"cursor-pointer opacity-50 transition-all duration-200 ease hover-opacity-100",transform:"translate(70,-10)",onMousedown:n[2]||(n[2]=m=>o(t).rotateAccents(-1))},[Ye,N(p,{"font-size":"28",x:"-17",y:"-17"})],32)),[[$,"Rotate pattern backward",void 0,{top:!0}]]),x((s(),i("g",{class:"cursor-pointer opacity-50 transition-all duration-200 ease hover-opacity-100",transform:"translate(-70,-10)",onMousedown:n[3]||(n[3]=m=>o(t).rotateAccents(1))},[Ze,N(a,{"font-size":"28",x:"-17",y:"-17"})],32)),[[$,"Rotate pattern forward",void 0,{top:!0}]])]),l("g",et,[l("g",{class:"steps",opacity:o(t).volume*.9+.1,transform:"translate(0,90)"},[l("g",ot,[l("line",{x1:r.value,x2:b.value*o(t).steps.length*e.width+r.value,stroke:"currentColor","stroke-width":"2"},null,8,nt),(s(!0),i(_,null,B(o(t).activeSteps,(m,w)=>(s(),i("line",{key:w,x1:b.value*Number(m)*e.width+r.value,x2:b.value*(o(t).activeSteps[w+1]||o(t).steps.length)*e.width+r.value,"stroke-width":"6",stroke:o(q)(Number(m)+Number(o(E).pitch)/12*o(t).steps.length,o(t).steps.length,1)},null,8,st))),128))]),(s(!0),i(_,null,B(o(t).steps,(m,w)=>(s(),M(v,{key:w,onMute:j=>o(t).mutes[w]=!o(t).mutes[w],onSubdivide:j=>o(t).steps[w]=j,onAccent:j=>o(t).accents[w]=!o(t).accents[w],muted:o(t).mutes[w],step:w,accented:!!o(t).accents[w],mutes:o(t).mutes,current:o(t).current,subdivisions:m,proportion:b.value,total:o(t).steps.length,width:e.width,pad:r.value},null,8,["onMute","onSubdivide","onAccent","muted","step","accented","mutes","current","subdivisions","proportion","total","width","pad"]))),128)),l("g",lt,[l("line",{class:"progress",transform:`translate(${r.value+o(t).progress*e.width*b.value*o(t).meter.over}, 0)`,"stroke-width":"4",stroke:"currentColor","stroke-linecap":"round",y2:180},null,8,rt)]),l("circle",{cx:b.value*o(t).steps.length*e.width+r.value,cy:100,r:o(t).mutes[1]?4:8,fill:o(t).mutes[1]?"currentColor":o(ue)(Number(o(E).pitch),4)},null,8,at)],8,tt),l("g",it,[x((s(),M(d,{class:"volume",modelValue:o(t).volume,"onUpdate:modelValue":n[4]||(n[4]=m=>o(t).volume=m),width:200,step:.01},{default:L(()=>[l("g",ut,[o(t).volume==0?(s(),M(D,{key:0})):(s(),M(A,{key:1}))])]),_:1},8,["modelValue"])),[[$,"Track volume",void 0,{bottom:!0}]]),x((s(),M(d,{class:"pan",transform:"translate(270,0)",modelValue:o(t).pan,"onUpdate:modelValue":n[5]||(n[5]=m=>o(t).pan=m),min:-1,max:1,width:200,step:.01,"show-center":""},{default:L(()=>[N(X,{x:-18,y:-30})]),_:1},8,["modelValue"])),[[$,"Track panning",void 0,{bottom:!0}]]),x((s(),M(d,{class:"sound",transform:"translate(540,0)",modelValue:f.value,"onUpdate:modelValue":n[6]||(n[6]=m=>f.value=m),width:265,step:1,min:0,max:4,"show-positions":"",every:1},{default:L(()=>{var m;return[l("text",null,C((m=o(t).meter)==null?void 0:m.sound),1)]}),_:1},8,["modelValue"])),[[$,"Click sound select",void 0,{bottom:!0}]]),N(te,{name:"fade"},{default:L(()=>[e.editable&&!o(t).isEuclidean?x((s(),i("g",{key:0,class:"reset cursor-pointer",onMousedown:n[7]||(n[7]=m=>o(t).reset()),transform:"translate(840, 0)"},[l("rect",{style:{filter:"url(#shadowButton)"},width:"50",height:"50","stroke-width":"3",rx:"40",fill:o(y)?"hsla(0,0%,30%,1)":"hsla(0,0%,100%,1)"},null,8,dt),N(F,{"stroke-width":"0",y:"9",x:"9","font-size":"26"})],32)),[[$,"Reset to Euclidean pattern",void 0,{bottom:!0}]]):g("",!0)]),_:1}),e.editable?x((s(),i("g",{key:0,class:"del cursor-pointer",onMousedown:n[8]||(n[8]=m=>u.$emit("del")),transform:"translate(900, 0)"},[l("rect",{style:{filter:"url(#shadowButton)"},width:"50",height:"50","stroke-width":"3",rx:"40",fill:o(y)?"hsla(0,0%,30%,1)":"hsla(0,0%,100%,1)"},null,8,ct),N(G,{color:"hsla(0,25%,50%,1)","stroke-width":"0",y:"9",x:"9","font-size":"26"})],32)),[[$,"Remove track",void 0,{bottom:!0}]]):g("",!0)])])]))],64)}}},ht=ee(mt,[["__scopeId","data-v-28dbaefe"]]),S=se("tempo-bar-loops-object",{0:{over:8,under:8,volume:1,sound:"A"},1:{over:3,under:3,volume:.5,sound:"B"}}),ft={class:"flex flex-wrap items-center w-full p-4 has-bg rounded-xl relative gap-6 bg-light-600 dark-bg-dark-500",id:"screen"},vt={key:1,class:"flex flex-col p-2 my-2 is-group"},yt={class:"flex flex"},pt={class:"flex flex-wrap justify-center"},xt={class:"font-bold mx-2"},bt={key:0},wt={class:"flex flex-wrap justify-center is-group m-1 text-xl p-2",style:{flex:"1 1 100%"}},gt=l("div",{class:"i-la-plus"},null,-1),kt=[gt],$t=l("div",{class:"i-la-file-download"},null,-1),_t=[$t],Ct={key:1,class:"is-group m-2"},Nt=["onClick"],Bt=["onClick"],Dt={__name:"BeatBars",props:{meters:{type:Array,default:null},patterns:{type:Object,default:null},accents:{type:String,default:"XxXxXxXx"},mute:{type:String,delault:""},secondary:{type:Boolean,default:!1}},setup(e){const k=e,y=T(k.accents),c=U({over:4,under:4,volume:1,sound:"A"});z(()=>k.meters,h=>{if(h){let f=h[0].split("/");S.value={0:{over:Number(f[0]),under:Number(f[1]),volume:k.secondary?0:1,sound:"A"}}}},{immediate:!0}),z(()=>k.patterns,h=>{h&&(y.value=Object.keys(h)[0])},{immediate:!0});function r(h,f){S.value[0].over=h.length,S.value[0].under=f?f.split("/")[1]:h.length,y.value=h}function t(){S.value[Math.floor(Math.random()*1e4)]={...c}}return(h,f)=>{const b=he,u=ht,n=le("client-only"),d=R("tooltip");return s(),i("div",ft,[N(n,null,{default:L(()=>{var p;return[e.secondary?g("",!0):(s(),M(b,{key:0,secondary:!0})),(s(!0),i(_,null,B(o(S),(a,v)=>(s(),M(u,{class:"my-1 rounded-3xl shadow-lg min-h-36 max-h-30vh",style:{flex:"1 1 420px"},key:v,order:v,loop:a,maxRatio:o(de),onDel:D=>delete o(S)[v],editable:!e.meters,accents:y.value,mute:e.mute},null,8,["order","loop","maxRatio","onDel","editable","accents","mute"]))),128)),e.patterns?(s(),i("div",vt,[l("div",yt,[(s(!0),i(_,null,B(y.value,(a,v)=>(s(),i("div",{class:"flex-1 p-1 border-1 border-current rounded-lg m-1 opacity-50",key:v,style:re({opacity:a=="X"?1:.5,backgroundColor:a=="1"||a=="X"||a=="x"?"currentColor":"transparent"})},null,4))),128))]),l("div",pt,[(s(!0),i(_,null,B((p=e.patterns[y.value])==null?void 0:p.names,a=>(s(),i("div",{class:"p-1",key:a},[l("span",xt,C(a.name),1),a.place?(s(),i("span",bt,"("+C(a.place)+")",1)):g("",!0)]))),128))])])):g("",!0),l("div",wt,[e.meters?g("",!0):x((s(),i("button",{key:0,class:"text-button",onClick:f[0]||(f[0]=a=>t())},kt)),[[d,"Add new track",void 0,{bottom:!0}]]),x((s(),i("button",{class:"text-button flex items-center",onClick:f[1]||(f[1]=a=>o(ce)(o(me)))},_t)),[[d,"Export MIDI file",void 0,{bottom:!0}]]),e.meters&&e.meters.length>1?(s(),i("div",Ct,[(s(!0),i(_,null,B(e.meters,a=>(s(),i("button",{class:"text-button",onClick:v=>S.value=[{over:a.split("/")[0],under:a.split("/")[1],sound:"A",volume:1}]},C(a),9,Nt))),256))])):g("",!0),(s(!0),i(_,null,B(e.patterns,(a,v)=>{var D,A;return s(),i("button",{class:ae(["text-button",{active:y.value==v}]),onClick:X=>r(v,a.meter)},C(((A=(D=a==null?void 0:a.names)==null?void 0:D[0])==null?void 0:A.name)||v),11,Bt)}),256))])]}),_:1})])}}};export{Dt as _};
