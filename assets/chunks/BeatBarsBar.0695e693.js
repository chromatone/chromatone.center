import{_ as O}from"./trash.21251a55.js";import{_ as Q,a as X,b as G,c as J,d as K}from"./angle-right.49192cfa.js";import{o as i,c as d,a as r,b as y,H as N,A,u as n,t as C,F as V,d as M,B as v,l as $,ac as P,r as W,Q as E,x as Y,f as x,g as _,w as S,ab as Z,p as tt,q as et,_ as ot}from"./framework.c7ad3ca2.js";import{j as I,n as nt}from"./colors.394b294c.js";import{i as g}from"./state.94f7e80e.js";import{t as D}from"./tempo.4bdd83c1.js";import{u as T}from"./index.098dc14b.js";import{u as st}from"./sequence.c07c6f83.js";const lt={style:{"vertical-align":"middle"},viewBox:"0 0 32 32",width:"1.2em",height:"1.2em"},rt=r("path",{fill:"currentColor",d:"M15 4.594L13.281 6.28L8.562 11H4v10h4.563l4.718 4.719L15 27.406zm-2 4.843v13.126L9.719 19.28L9.406 19H6v-6h3.406l.313-.281zm7.219 2.344L18.78 13.22L21.563 16l-2.782 2.781l1.438 1.438L23 17.437l2.781 2.782l1.438-1.438L24.437 16l2.782-2.781l-1.438-1.438L23 14.562z"},null,-1),it=[rt];function at(t,B){return i(),d("svg",lt,it)}const ut={name:"la-volume-off",render:at},dt=["transform"],ct=["opacity"],mt=["width","fill"],ht=["stroke","fill"],ft=["fill"],vt=["stroke"],pt=["onDblclick","data-sub"],yt=["transform"],wt=["width","x","fill"],xt=["transform","fill","opacity"],gt=["x"],bt=["fill","stroke"],kt={key:0,class:"transition-all duration-100 ease-out pointer-events-none",cx:0,cy:100,r:"3",fill:"currentColor",opacity:"0.8"},$t={__name:"BeatBarsStep",props:{proportion:{type:Number,default:1},step:{type:Number,default:1},subdivisions:{type:[Array,String],default:""},muted:{type:Boolean,default:!1},total:{type:Number,default:4},current:{type:[Number,String],default:0},mutes:{type:Object,default:{}},accented:{type:Boolean,default:!1},width:{type:Number,default:900},pad:{type:Number,default:50}},emits:["mute","subdivide","accent"],setup(t,{emit:B}){const e=t,a=y(()=>I(e.step+D.pitch/12*e.total,e.total,1));y(()=>e.subdivisions[0].includes("!"));const o=T(0,40,640),b=y(()=>Math.floor(o.value/40));N(b,(l,s)=>{if(l==s)return;let m=[];for(let h=0;h<l;h++)m.push(`${e.step}-${h}`);B("subdivide",m)});function k(l){if(l.tap){let s=l.event.currentTarget.dataset.sub;e.mutes[s]=!e.mutes[s]}o.value+=l.delta[0]-l.delta[1]}const u=y(()=>{let l=e.subdivisions[0]==e.current,s=e.subdivisions[0].split("-")[0],m=e.current.split("-")[0];return!e.mutes[e.subdivisions[0]]&&(l||s==m)});return(l,s)=>{const m=A("drag");return i(),d("g",{class:"cursor-pointer",transform:`translate(${t.proportion*t.step*t.width+t.pad},0)`},[r("g",{class:"step",opacity:t.muted?.1:1},[r("rect",{class:"transition-fill duration-100",onMousedown:s[0]||(s[0]=h=>l.$emit("mute")),width:t.proportion*t.width,height:"180",rx:"10",fill:u.value?t.muted?"transparent":a.value:"transparent"},null,40,mt),r("circle",{class:"transition-all duration-100 ease-out",onMousedown:s[1]||(s[1]=h=>t.muted?l.$emit("mute"):l.$emit("accent")),cy:"35",cx:"0",r:"25","stroke-width":"4",stroke:a.value,fill:u.value?t.muted?"transparent":"currentColor":t.accented?a.value:n(g)?"#333":"#eee"},null,40,ht),r("text",{class:"pointer-events-none transition-all duration-100 ease-out",y:"48","font-size":"40","text-anchor":"middle",x:"0",fill:u.value?n(g)?"#333":"#eee":"currentColor"},C(t.step+1),9,ft),r("line",{class:"pointer-events-none",y1:"60",y2:"100","stroke-width":"8",stroke:a.value},null,8,vt),(i(!0),d(V,null,M(t.subdivisions,(h,w)=>v((i(),d("g",{class:"sub",key:h,onDblclick:R=>{l.$emit("subdivide",[`${h}-1`]),o.value=40},"data-sub":h},[r("line",{transform:`translate(${w*t.proportion*t.width/t.subdivisions.length}, 0)`,y1:"100",y2:"150","stroke-width":"1",stroke:"currentColor"},null,8,yt),r("rect",{class:"transition-fill duration-100",width:t.proportion*t.width/t.subdivisions.length,height:"80",y:"100",rx:"10",x:w*t.proportion*t.width/t.subdivisions.length,fill:`hsla(0,0%,${90-w*80/t.subdivisions.length}%,${h==t.current?.9:.4})`},null,8,wt),r("circle",{class:"transition-all duration-100 ease-out pointer-events-none",transform:`translate(${w*t.proportion*t.width/t.subdivisions.length}, 0)`,cx:0,cy:100,r:6,fill:h==t.current?"currentColor":t.muted?"transparent":a.value,opacity:t.mutes[h]?0:1,"stroke-width":"4","stroke-linecap":"round"},null,8,xt),t.mutes[h]?$("",!0):(i(),d("text",{key:0,y:"140","font-size":"40","text-anchor":"middle",x:15+w*t.proportion*t.width/t.subdivisions.length,fill:"currentColor"},C(w+1),9,gt))],40,pt)),[[m,k]])),128)),r("circle",{class:"transition-all duration-100 ease-out pointer-events-none",cx:"0",cy:100,r:"10",fill:a.value,stroke:u.value?"currentColor":"transparent","stroke-width":"4",opacity:"0.8"},null,8,bt)],8,ct),t.muted?(i(),d("circle",kt)):$("",!0)],8,dt)}}},_t={class:"bar cursor-pointer","font-size":"32px"},Ct=["x1","x2","y1","y2","stroke-width","stroke"],Bt=["x2","y1","y2","stroke"],Nt=["x1","x2","y1","y2","stroke-width","stroke"],Vt={key:0,class:"all"},St=["cx","cy","r"],Mt=["cx","cy"],zt=["transform"],Lt=["fill"],Dt={transform:"translate(0 10)",fill:"currentColor","text-anchor":"middle"},At=P({__name:"BeatControlBar",props:{modelValue:{type:[Number,String],default:.1},step:{type:Number,default:.1},min:{type:Number,default:0},max:{type:Number,default:1},width:{type:Number,default:100},height:{type:Number,default:50},vector:{type:Array,default:[1,-1]},showPositions:{type:Boolean,default:!1},ratio:{type:Number,default:200},every:{type:Number,default:null},showCenter:{type:Boolean,default:!1},inverted:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:B}){const e=t,a=W({inner:T((Number(e.modelValue)-e.min)/(e.max-e.min),0,1),proportion:y(()=>e.inverted?(Number(e.modelValue)-e.max)/(e.min-e.max):(Number(e.modelValue)-e.min)/(e.max-e.min)),pos:y(()=>a.proportion*e.width)});function o(u){a.inner+=(e.vector[0]*u.delta[0]+e.vector[1]*u.delta[1])/e.ratio}function b(u){a.inner+=u*e.step/(e.max-e.min)}N(()=>a.inner,u=>{let l=u*(e.max-e.min)+e.min;B("update:modelValue",Math.round(l/e.step)*e.step)});const k=y(()=>{let u=(e.max-e.min)/e.step,l=[];for(let s=0;s<=1;s+=1/u)l.push(s*e.width);return l});return(u,l)=>{const s=A("drag");return v((i(),d("g",_t,[r("line",{class:"add",onMousedown:l[0]||(l[0]=m=>b(1)),x1:t.inverted?0:a.pos,x2:t.inverted?a.pos:t.width,y1:t.height/2,y2:t.height/2,"stroke-linecap":"round","stroke-width":t.height,stroke:n(g)?"#1114":"#fff8"},null,40,Ct),r("line",{class:"pointer-events-none",x1:0,x2:t.width,y1:t.height/2,y2:t.height/2,"stroke-linecap":"round","stroke-width":18,stroke:n(g)?"#2228":"#eee"},null,8,Bt),r("line",{class:"subtract",onMousedown:l[1]||(l[1]=m=>b(-1)),x1:t.inverted?t.width:t.showCenter?t.width/2:0,x2:a.pos,y1:t.height/2,y2:t.height/2,"stroke-linecap":"round","stroke-width":t.height,stroke:n(g)?"#3338":"#ddd8"},null,40,Nt),t.showPositions?(i(),d("g",Vt,[(i(!0),d(V,null,M(k.value,(m,h)=>(i(),d("circle",{key:m,cx:m,cy:t.height/2,r:t.every&&h%t.every==0?4:2,fill:"currentColor",opacity:"0.5"},null,8,St))),128))])):$("",!0),t.showCenter?(i(),d("circle",{key:1,cx:t.width/2,cy:t.height/2,r:"4",opacity:"0.5",fill:"currentColor"},null,8,Mt)):$("",!0),r("g",{class:"mover",transform:`translate(${a.pos} ${t.height/2})`},[r("circle",{r:"25","stroke-width":"0","stroke-opacity":"0.5",stroke:"currentColor",style:{filter:"url(#shadowButton)"},fill:n(g)?"#333":"#eee"},null,8,Lt),r("g",Dt,[E(u.$slots,"default",{},()=>[r("text",null,C(t.modelValue),1)])])],8,zt)])),[[s,o]])}}}),z=t=>(tt("data-v-f88558eb"),t=t(),et(),t),Rt={class:"w-full bg-light-300 dark-bg-dark-800",version:"1.1",baseProfile:"full",viewBox:"0 0 1000 350",xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"}},Pt=z(()=>r("defs",null,[r("filter",{id:"shadowButton",x:"-50%",height:"200%",width:"300%"},[r("feDropShadow",{dx:"0",dy:"3",stdDeviation:"3","flood-color":"#2225"})])],-1)),Et={key:0,class:"meter-bars",transform:"translate(40,15)"},It=["transform"],Tt={class:"signature"},Ut=z(()=>r("text",{fill:"currentColor","font-size":"45","text-anchor":"middle",y:"2"},"/",-1)),jt={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"40px","text-anchor":"end",x:-10},qt={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"40px","text-anchor":"start",x:10},Ht=z(()=>r("circle",{r:"18",fill:"#5553"},null,-1)),Ft=z(()=>r("circle",{r:"18",fill:"#5553"},null,-1)),Ot={"text-anchor":"middle",style:{"user-select":"none",transition:"all 300ms ease"}},Qt=["opacity"],Xt={class:"lines",transform:"translate(0,100)"},Gt=["x1","x2"],Jt=["x1","x2","stroke"],Kt={class:"arrows pointer-events-none"},Wt=["transform"],Yt=["cx","r","fill"],Zt={class:"bottom",transform:"translate(40,290)"},te={transform:"translate(-20 -30)"},ee=["transform"],oe=["fill"],ne=["transform"],se=["fill"],le=P({__name:"BeatBarsBar",props:{order:{type:Number,default:0},loop:{type:Object,default:{over:4,under:4,sound:"A",volume:1}},maxRatio:{type:Number,default:1},editable:{type:Boolean,default:!1},mute:{type:String,default:null},accents:{type:String,default:null},width:{type:Number,default:920}},emits:["del","sound"],setup(t,{emit:B}){const e=t,a=y(()=>(1e3-e.width)/2),{seq:o}=st(e.loop,e.order,"bars"),b=["A","B","C","D","E"],k=Y(b.findIndex(l=>{var s;return l==((s=o.meter)==null?void 0:s.sound)}));N(k,l=>{o.meter.sound=b[l]});const u=y(()=>{const l=1/o.meter.over;return l>=e.maxRatio?e.maxRatio:l});return N(()=>e.loop,l=>{o.meter={...e.loop}},{immediate:!0}),N(()=>e.accents,l=>{l&&l.split("").forEach((s,m)=>{o.mutes[m]=s=="0"||s==".",o.accents[m]=s=="2"||s=="X"})},{immediate:!0}),(l,s)=>{const m=At,h=Q,w=X,R=$t,U=ut,j=G,q=J,H=K,F=O,p=A("tooltip");return i(),d(V,null,[E(l.$slots,"default",{},void 0,!0),(i(),d("svg",Rt,[Pt,t.editable?(i(),d("g",Et,[v(x(m,{class:"over",modelValue:n(o).meter.over,"onUpdate:modelValue":s[0]||(s[0]=c=>n(o).meter.over=c),width:340,step:1,min:2,max:16,"show-positions":"",ratio:500,every:4},null,8,["modelValue"]),[[p,"Number of steps",void 0,{top:!0}]]),v(x(m,{class:"under",transform:"translate(580,0)",modelValue:n(o).meter.under,"onUpdate:modelValue":s[1]||(s[1]=c=>n(o).meter.under=c),width:340,step:1,min:1,max:16,"show-positions":"",ratio:500,every:4,inverted:"",vector:[-1,-1]},null,8,["modelValue"]),[[p,"Measure subdivision",void 0,{top:!0}]])])):$("",!0),r("g",{class:"info",transform:"translate(500,53)"},[v((i(),d("g",Tt,[Ut,r("text",jt,C(n(o).meter.over),1),r("text",qt,C(n(o).meter.under),1)])),[[p,"Time signature",void 0,{top:!0}]]),v((i(),d("g",{class:"cursor-pointer opacity-50 transition-all duration-200 ease hover-opacity-100",transform:"translate(70,-10)",onMousedown:s[2]||(s[2]=c=>n(o).rotateAccents(-1))},[Ht,x(h,{"font-size":"28",x:"-17",y:"-17"})],32)),[[p,"Rotate pattern backward",void 0,{top:!0}]]),v((i(),d("g",{class:"cursor-pointer opacity-50 transition-all duration-200 ease hover-opacity-100",transform:"translate(-70,-10)",onMousedown:s[3]||(s[3]=c=>n(o).rotateAccents(1))},[Ft,x(w,{"font-size":"28",x:"-17",y:"-17"})],32)),[[p,"Rotate pattern forward",void 0,{top:!0}]])],8,It),r("g",Ot,[r("g",{class:"steps",opacity:n(o).volume*.9+.1,transform:"translate(0,90)"},[r("g",Xt,[r("line",{x1:a.value,x2:u.value*n(o).steps.length*t.width+a.value,stroke:"currentColor","stroke-width":"2"},null,8,Gt),(i(!0),d(V,null,M(n(o).activeSteps,(c,f)=>(i(),d("line",{key:f,x1:u.value*Number(c)*t.width+a.value,x2:u.value*(n(o).activeSteps[f+1]||n(o).steps.length)*t.width+a.value,"stroke-width":"6",stroke:n(I)(Number(c)+Number(n(D).pitch)/12*n(o).steps.length,n(o).steps.length,1)},null,8,Jt))),128))]),(i(!0),d(V,null,M(n(o).steps,(c,f)=>(i(),_(R,{key:f,onMute:L=>n(o).mutes[f]=!n(o).mutes[f],onSubdivide:L=>n(o).steps[f]=L,onAccent:L=>n(o).accents[f]=!n(o).accents[f],muted:n(o).mutes[f],step:f,accented:!!n(o).accents[f],mutes:n(o).mutes,current:n(o).current,subdivisions:c,proportion:u.value,total:n(o).steps.length,width:t.width,pad:a.value},null,8,["onMute","onSubdivide","onAccent","muted","step","accented","mutes","current","subdivisions","proportion","total","width","pad"]))),128)),r("g",Kt,[r("line",{class:"progress",transform:`translate(${a.value+n(o).progress*t.width*u.value*n(o).meter.over}, 0)`,"stroke-width":"4",stroke:"currentColor","stroke-linecap":"round",y2:180},null,8,Wt)]),r("circle",{cx:u.value*n(o).steps.length*t.width+a.value,cy:100,r:n(o).mutes[1]?4:8,fill:n(o).mutes[1]?"currentColor":n(nt)(Number(n(D).pitch),4)},null,8,Yt)],8,Qt),r("g",Zt,[v((i(),_(m,{class:"volume",modelValue:n(o).volume,"onUpdate:modelValue":s[4]||(s[4]=c=>n(o).volume=c),width:200,step:.01},{default:S(()=>[r("g",te,[n(o).volume==0?(i(),_(U,{key:0})):(i(),_(j,{key:1}))])]),_:1},8,["modelValue"])),[[p,"Track volume",void 0,{bottom:!0}]]),v((i(),_(m,{class:"pan",transform:"translate(270,0)",modelValue:n(o).pan,"onUpdate:modelValue":s[5]||(s[5]=c=>n(o).pan=c),min:-1,max:1,width:200,step:.01,"show-center":""},{default:S(()=>[x(q,{x:-18,y:-30})]),_:1},8,["modelValue"])),[[p,"Track panning",void 0,{bottom:!0}]]),v((i(),_(m,{class:"sound",transform:"translate(540,0)",modelValue:k.value,"onUpdate:modelValue":s[6]||(s[6]=c=>k.value=c),width:265,step:1,min:0,max:4,"show-positions":"",every:1},{default:S(()=>{var c;return[r("text",null,C((c=n(o).meter)==null?void 0:c.sound),1)]}),_:1},8,["modelValue"])),[[p,"Click sound select",void 0,{bottom:!0}]]),x(Z,{name:"fade"},{default:S(()=>[t.editable&&!n(o).isEuclidean?v((i(),d("g",{key:0,class:"reset cursor-pointer",onMousedown:s[7]||(s[7]=c=>n(o).reset()),transform:"translate(840, 0)"},[r("rect",{style:{filter:"url(#shadowButton)"},width:"50",height:"50","stroke-width":"3",rx:"40",fill:n(g)?"hsla(0,0%,30%,1)":"hsla(0,0%,100%,1)"},null,8,oe),x(H,{"stroke-width":"0",y:"9",x:"9","font-size":"26"})],40,ee)),[[p,"Reset to Euclidean pattern",void 0,{bottom:!0}]]):$("",!0)]),_:1}),t.editable?v((i(),d("g",{key:0,class:"del cursor-pointer",onMousedown:s[8]||(s[8]=c=>l.$emit("del")),transform:"translate(900, 0)"},[r("rect",{style:{filter:"url(#shadowButton)"},width:"50",height:"50","stroke-width":"3",rx:"40",fill:n(g)?"hsla(0,0%,30%,1)":"hsla(0,0%,100%,1)"},null,8,se),x(F,{color:"hsla(0,25%,50%,1)","stroke-width":"0",y:"9",x:"9","font-size":"26"})],40,ne)),[[p,"Remove track",void 0,{bottom:!0}]]):$("",!0)])])]))],64)}}});const fe=ot(le,[["__scopeId","data-v-f88558eb"]]);export{fe as _};
