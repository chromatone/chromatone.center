import{I as a,o as e,U as g,c as h,T as d,E as b,d as m,B as k,ad as f,G as c,P as x,ae as w,e as y}from"./index.d775f97e.js";import{N as u,E as p}from"./audio.c2db36c4.js";class n extends a{constructor(){super(e(n.getDefaults(),arguments)),this.name="NoiseSynth";const t=e(n.getDefaults(),arguments);this.noise=new u(Object.assign({context:this.context},t.noise)),this.envelope=new g(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(a.getDefaults(),{envelope:Object.assign(h(b.getDefaults(),Object.keys(d.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(h(u.getDefaults(),Object.keys(m.getDefaults())),{type:"white"})})}triggerAttack(t,s=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,s),this.noise.start(t),this.envelope.sustain===0&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,s,o=1){return s=this.toSeconds(s),t=this.toSeconds(t),this.triggerAttack(s,o),this.triggerRelease(s+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}class l extends d{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=k;const s=URL.createObjectURL(new Blob([f()],{type:"text/javascript"})),o=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(s).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(o,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}class r extends p{constructor(){super(e(r.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=e(r.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new i({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(p.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class i extends l{constructor(){super(e(i.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=e(i.getDefaults(),arguments);this.input=new c({context:this.context}),this.output=new c({context:this.context}),this.bits=new x({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(l.getDefaults(),{bits:12})}_audioWorkletName(){return w}onReady(t){y(this.input,t,this.output);const s=t.parameters.get("bits");this.bits.setParam(s)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}export{r as B,n as N,l as T};
