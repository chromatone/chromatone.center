import{r as D,b as m,aZ as M,c as x,w as P,Y as E,v as l,x as r,z as n,D as s,B as F,a2 as L,E as b,F as f,A as y,H as R}from"./framework.BnmkQ2kF.js";import{g as c,j as V,A as z,I as A,ak as u,k as C,b4 as N,L as B,m as T,d as j,S as _,C as v}from"./theme.u_z9G0Y0.js";const H={class:"absolute flex flex-wrap gap-1 w-full p-1 select-none"},K=n("div",{class:"i-la-stop"},null,-1),O=[K],Y={key:0,class:"i-la-play"},Z={key:1,class:"i-la-pause"},q={class:"cursor-pointer p-2 border-1 border-dark-100 dark-border-light-300"},G=n("div",{class:"flex-1"},null,-1),J={class:"p-2 text-xs font-mono border-1 border-dark-100 dark-border-light-300"},Q=["width","height"],U=["stroke","x","y","y2","width","fill"],W=["transform"],X=["transform","y1","y2"],ee=["stroke","x1","y1","x2","y2"],te=["transform"],se=["cx","cy","fill"],oe={__name:"Bounce",setup(ae){const k=D(),e=m({w:1e3,h:1e3});M(k,t=>{e.w=t[0].contentRect.width,e.h=t[0].contentRect.height});const w=x(()=>c.pcs.length),d=x(()=>V.numeric([-w.value,w.value]).map(z.steps(c.full.name))),h=m([]),g=A(1,0,16);function I(t){g.value+=t.delta[0]/100-t.delta[1]/100}P(()=>{h.length=0;for(let t=0;t<d.value.length;t++){const o={x:(t+1)/(d.value.length+2),y:Math.abs(Math.sin(Math.PI/2+Math.PI*u.ticks/(768+g.value*t*8))),note:d.value[t],midi:C.midi(d.value[t])};o.y<.05&&S(o.note),h.push(o)}});const p=m({});function S(t){N(()=>{const o=C.midi(t);p[t]||(p[t]=!0,B(t.slice(0,-1),parseInt(t.slice(-1))-4,!1,.5,.5),T(o,{attack:1}),N(()=>{p[t]=!1,B(t.slice(0,-1),parseInt(t.slice(-1))-4,!0),j(o)},120))},2)}return(t,o)=>{const $=E("drag");return l(),r(f,null,[n("div",H,[n("button",{class:"p-2 border-1 border-dark-100 dark-border-light-300",onClick:o[0]||(o[0]=a=>s(u).stopped=!0)},O),n("button",{class:"p-2 border-1 border-dark-100 dark-border-light-300",onClick:o[1]||(o[1]=a=>s(u).playing=!s(u).playing)},[s(u).playing?(l(),r("div",Z)):(l(),r("div",Y))]),F((l(),r("div",q,[L(b(s(g).toFixed(2)),1)])),[[$,I]]),G,n("div",J,b(s(u).ticks),1)]),(l(),r("svg",{class:"select-none min-h-100svh min-w-full",id:"bounce",ref_key:"svg",ref:k,version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"}},[n("rect",{width:e.w,height:e.h,stroke:"white",fill:"#2222"},null,8,Q),(l(!0),r(f,null,y(h,(a,i)=>(l(),r("g",{key:a},[n("rect",{class:"op-80 transition","stroke-width":"1",stroke:s(_)(s(v)[s(c).pcs[i%s(c).pcs.length]],5,1,.5),x:a.x*e.w,y:e.h-100,y2:e.h-100,width:e.w/(d.value.length+2)-10,height:40,rx:"2",fill:p[a.note]?s(_)(a.midi+3,4):"transparent"},null,8,U)]))),128)),(l(!0),r(f,null,y(h,(a,i)=>(l(),r("g",{key:a,transform:`translate(${e.w/(d.value.length+4)/2} 0)`},[n("line",{class:"op-20",transform:`translate(${a.x*e.w} 0)`,y1:e.h/3-100,y2:e.h-100,stroke:"currentColor"},null,8,X),i>0?(l(),r("line",{key:0,"stroke-width":"1",stroke:s(_)(s(v)[s(c).pcs[i%s(c).pcs.length]],5),x1:h[i-1].x*e.w,y1:-h[i-1].y*e.h/1.5+e.h-100,x2:a.x*e.w,y2:-a.y*e.h/1.5+e.h-100},null,8,ee)):R("",!0)],8,W))),128)),(l(!0),r(f,null,y(h,(a,i)=>(l(),r("g",{key:a,transform:`translate(${e.w/(d.value.length+4)/2} 0)`},[n("circle",{cx:a.x*e.w,cy:-a.y*e.h/1.5+e.h-100,r:8,fill:s(_)(s(v)[s(c).pcs[i%s(c).pcs.length]],5)},null,8,se)],8,te))),128))],512))],64)}}};export{oe as default};
