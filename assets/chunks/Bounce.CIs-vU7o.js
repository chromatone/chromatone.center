import{r as N,b as y,aW as $,c as v,w as B,v as r,x as o,z as n,D as s,E as I,F as f,A as _,H as M}from"./framework.0GAYKUFI.js";import{g as c,j as P,A as E,L as d,k as x,W as b,m as L,d as R,ad as m,C as g}from"./theme.BDvniH2-.js";const S={class:"absolute flex flex-wrap gap-1 w-full p-1"},z=n("div",{class:"i-la-stop"},null,-1),A=[z],D={key:0,class:"i-la-play"},F={key:1,class:"i-la-pause"},T=n("div",{class:"flex-1"},null,-1),V={class:"p-2 text-xs font-mono border-1 border-dark-100 dark-border-light-300"},W=["width","height"],j=["stroke","x","y","y2","width","fill"],H=["transform"],K=["transform","y1","y2"],O=["stroke","x1","y1","x2","y2"],q=["transform"],G=["cx","cy","fill"],X={__name:"Bounce",setup(J){const k=N(),t=y({w:1e3,h:1e3});$(k,e=>{t.w=e[0].contentRect.width,t.h=e[0].contentRect.height});const w=v(()=>c.pcs.length),h=v(()=>P.numeric([-w.value,w.value]).map(E.steps(c.full.name))),u=y([]);B(()=>{u.length=0;for(let e=0;e<h.value.length;e++){const a={x:(e+1)/(h.value.length+2),y:Math.abs(Math.sin(Math.PI/2+Math.PI*d.ticks/(768+e*8))),note:h.value[e],midi:x.midi(h.value[e])};a.y<.05&&C(a.note),u.push(a)}});const p=y({});function C(e){setTimeout(()=>{const a=x.midi(e);p[e]||(p[e]=!0,b(e.slice(0,-1),parseInt(e.slice(-1))-4,!1,.5,.5),L(a,{attack:1}),setTimeout(()=>{p[e]=!1,b(e.slice(0,-1),parseInt(e.slice(-1))-4,!0),R(a)},120))},2)}return(e,a)=>(r(),o(f,null,[n("div",S,[n("button",{class:"p-2 border-1 border-dark-100 dark-border-light-300",onClick:a[0]||(a[0]=l=>s(d).stopped=!0)},A),n("button",{class:"p-2 border-1 border-dark-100 dark-border-light-300",onClick:a[1]||(a[1]=l=>s(d).playing=!s(d).playing)},[s(d).playing?(r(),o("div",F)):(r(),o("div",D))]),T,n("div",V,I(s(d).ticks),1)]),(r(),o("svg",{class:"select-none min-h-100svh min-w-full",id:"bounce",ref_key:"svg",ref:k,version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"}},[n("rect",{width:t.w,height:t.h,stroke:"white",fill:"#2222"},null,8,W),(r(!0),o(f,null,_(u,(l,i)=>(r(),o("g",{key:l},[n("rect",{class:"op-80 transition","stroke-width":"1",stroke:s(m)(s(g)[s(c).pcs[i%s(c).pcs.length]],5,1,.5),x:l.x*t.w,y:t.h-100,y2:t.h-100,width:t.w/(h.value.length+2)-10,height:40,rx:"2",fill:p[l.note]?s(m)(l.midi+3,4):"transparent"},null,8,j)]))),128)),(r(!0),o(f,null,_(u,(l,i)=>(r(),o("g",{key:l,transform:`translate(${t.w/(h.value.length+4)/2} 0)`},[n("line",{class:"op-20",transform:`translate(${l.x*t.w} 0)`,y1:t.h/3-100,y2:t.h-100,stroke:"currentColor"},null,8,K),i>0?(r(),o("line",{key:0,"stroke-width":"1",stroke:s(m)(s(g)[s(c).pcs[i%s(c).pcs.length]],5),x1:u[i-1].x*t.w,y1:-u[i-1].y*t.h/1.5+t.h-100,x2:l.x*t.w,y2:-l.y*t.h/1.5+t.h-100},null,8,O)):M("",!0)],8,H))),128)),(r(!0),o(f,null,_(u,(l,i)=>(r(),o("g",{key:l,transform:`translate(${t.w/(h.value.length+4)/2} 0)`},[n("circle",{cx:l.x*t.w,cy:-l.y*t.h/1.5+t.h-100,r:8,fill:s(m)(s(g)[s(c).pcs[i%s(c).pcs.length]],5)},null,8,G)],8,q))),128))],512))],64))}};export{X as default};
