import{r as V,b as v,aX as D,c as y,d as F,P as R,f as n,g as a,h as i,l as e,k as S,au as T,m as N,F as k,j as x,q as j}from"./framework.BX1Y-ISu.js";import{g as h,aO as I,aT as L,H as q,ak as g,aU as z,e as E,aV as G,G as f,k as _}from"./theme.T-vkwoWg.js";const H={class:"absolute flex flex-wrap gap-1 w-full p-1 select-none"},U={key:0,class:"i-la-play"},X={key:1,class:"i-la-pause"},A={class:"cursor-pointer p-2 border-1 border-dark-100 dark-border-light-300"},J={class:"px-4 text-sm font-mono border-1 border-dark-100 dark-border-light-300 flex items-center"},K=["width","height"],Q=["x","width","height","rx","fill"],W=["onClick","stroke","x","y","y2","width","rx","fill"],Y=["transform"],Z=["transform","y2"],tt=["stroke","x1","y1","x2","y2"],et=["transform"],st=["cx","cy","fill"],at={__name:"Bounce",setup(lt){const b=V(),t=v({w:1e3,h:1e3});D(b,s=>{t.w=s[0].contentRect.width,t.h=s[0].contentRect.height});const C=y(()=>h.pcs.length),c=y(()=>I([-C.value,C.value]).map(L(h.full.name))),u=v([]),w=q(1,0,16);function $(s){w.value+=s.delta[0]/100-s.delta[1]/100}const p=v([]),m=v({}),d={x:0,y:0,note:"",midi:0},M=y(()=>{const s=[];for(let l=0;l<c.value.length;l++)d.x=(l+1)/(c.value.length+2),d.y=Math.abs(Math.sin(Math.PI/2+Math.PI*g.ticks/(192*4+w.value*l*8))),d.note=c.value[l],d.midi=z(c.value[l]),d.y<.02&&!p[l]&&B(d.note),s.push({...d});return s});F(M,s=>{u.splice(0,u.length,...s)});function B(s){m[s]=!0,E(s),G(()=>{m[s]=!1},120)}function O(s){p[s]=!p[s]}return(s,l)=>{const P=R("drag");return n(),a(k,null,[i("div",H,[i("button",{class:"p-2 border-1 border-dark-100 dark-border-light-300",onClick:l[0]||(l[0]=r=>e(g).stopped=!0)},l[2]||(l[2]=[i("div",{class:"i-la-stop"},null,-1)])),i("button",{class:"p-2 border-1 border-dark-100 dark-border-light-300",onClick:l[1]||(l[1]=r=>e(g).playing=!e(g).playing)},[e(g).playing?(n(),a("div",X)):(n(),a("div",U))]),S((n(),a("div",A,[T(N(e(w).toFixed(2)),1)])),[[P,$]]),l[3]||(l[3]=i("div",{class:"flex-1"},null,-1)),i("div",J,N(e(g).ticks),1)]),(n(),a("svg",{class:"select-none min-h-100svh min-w-full",id:"bounce",ref_key:"svg",ref:b,version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"}},[i("rect",{width:t.w,height:t.h,stroke:"white",fill:"#2222"},null,8,K),(n(!0),a(k,null,x(u,(r,o)=>(n(),a("g",{key:o},[i("rect",{class:"op-80 transition-fill duration-200","stroke-width":"0",x:r.x*t.w,y:100,width:t.w/(c.value.length+2)-10,height:t.h-200,rx:t.w/(c.value.length*8),fill:e(f)(r.midi+3,4,void 0,m[r.note]?.9:p[o]?0:.2)},null,8,Q),i("rect",{class:"op-80 transition cursor-pointer","stroke-width":"1",onClick:rt=>O(o),stroke:e(f)(e(_)[e(h).pcs[o%e(h).pcs.length]],5,1,.5),x:r.x*t.w,y:t.h-100,y2:t.h-100,width:t.w/(c.value.length+2)-10,height:40,rx:t.w/(c.value.length*8),fill:m[r.note]?e(f)(r.midi+3,4):p[o]?e(f)(r.midi+3,3,0,.2):"transparent"},null,8,W)]))),128)),(n(!0),a(k,null,x(u,(r,o)=>(n(),a("g",{key:o,transform:`translate(${t.w/(c.value.length+4)/2} 0)`},[i("line",{class:"op-20",transform:`translate(${r.x*t.w} 0)`,y1:100,y2:t.h-100,stroke:"currentColor"},null,8,Z),o>0?(n(),a("line",{key:0,"stroke-width":"1",stroke:e(f)(e(_)[e(h).pcs[o%e(h).pcs.length]],5),x1:u[o-1].x*t.w,y1:t.h-100-u[o-1].y*(t.h-200),x2:r.x*t.w,y2:t.h-100-r.y*(t.h-200)},null,8,tt)):j("",!0)],8,Y))),128)),(n(!0),a(k,null,x(u,(r,o)=>(n(),a("g",{key:o,transform:`translate(${t.w/(c.value.length+4)/2} 0)`},[i("circle",{cx:r.x*t.w,cy:t.h-100-r.y*(t.h-200),r:8,fill:e(f)(e(_)[e(h).pcs[o%e(h).pcs.length]],5,p[o]?0:1)},null,8,st)],8,et))),128))],512))],64)}}};export{at as default};
