import{r as C,b as m,aW as N,f as B,c as d,w as D,v as i,x as o,z as h,E,D as l,F as _,A as R,H as S}from"./framework.0GAYKUFI.js";import{g as f,j as T,A as z,k as x,W as g,m as A,d as F,ad as v,C as I}from"./theme.BDvniH2-.js";const L={class:"absolute text-xs"},M=["width","height"],P=["transform","x","y","y2","width","fill"],V=["x1","y1","x2","y2"],W=["cx","cy","fill"],O={__name:"Bounce",setup(j){const p=C(),t=m({w:1e3,h:1e3});N(p,e=>{t.w=e[0].contentRect.width,t.h=e[0].contentRect.height});const w=B({offset:-Date.now()}),k=d(()=>f.pcs.length),n=d(()=>k.value*2+1),y=d(()=>T.numeric([0,n.value]).map(z.steps(f.full.name))),c=m([]);D(()=>{c.length=0;for(let e=0;e<=n.value;e++){const a={x:(e+1)/(n.value+2),y:Math.abs(Math.sin(-10+w.value/(1e3+e*10))),note:y.value[e],midi:x.midi(y.value[e])};a.y<.05&&b(a.note),c.push(a)}});const r=m({});function b(e){setTimeout(()=>{const a=x.midi(e);r[e]||(r[e]=!0,g(e.slice(0,-1),parseInt(e.slice(-1))-4,!1,.5,.5),A(a,{attack:1}),setTimeout(()=>{r[e]=!1,g(e.slice(0,-1),parseInt(e.slice(-1))-4,!0),F(a)},120))},2)}return(e,a)=>(i(),o(_,null,[h("p",L,E(l(w)),1),(i(),o("svg",{class:"select-none min-h-100svh min-w-full",id:"bounce",ref_key:"svg",ref:p,version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"}},[h("rect",{width:t.w,height:t.h,stroke:"white",fill:"#2222"},null,8,M),(i(!0),o(_,null,R(c,(s,u)=>(i(),o("g",{key:s},[h("rect",{transform:`translate(${-t.w/n.value/2} 0)`,"stroke-width":"2",stroke:"currentColor",x:s.x*t.w+5,y:t.h-100,y2:t.h-100,width:t.w/(n.value+2)-10,height:40,rx:"2",fill:r[s.note]?l(v)(s.midi+3,4):"transparent"},null,8,P),u>0?(i(),o("line",{key:0,"stroke-width":"1",stroke:"currentColor",x1:c[u-1].x*t.w,y1:-c[u-1].y*t.h/1.5+t.h-100,x2:s.x*t.w,y2:-s.y*t.h/1.5+t.h-100},null,8,V)):S("",!0),h("circle",{cx:s.x*t.w,cy:-s.y*t.h/1.5+t.h-100,r:8,fill:l(v)(l(I)[l(f).pcs[u%l(f).pcs.length]],5)},null,8,W)]))),128))],512))],64))}};export{O as default};
