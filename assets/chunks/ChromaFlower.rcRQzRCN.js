import{o,c as i,a as t,_ as Z,j as U,a2 as ee,E as te,i as B,ae as le,af as se,x as oe,g as e,y,z as H,b as f,A as q,W as K,F as C,r as b,l as R,t as N,f as z,n as W,T as Y,J as ie,p as ae,d as ne}from"./framework.HVt1h3pg.js";import{n as re}from"./theory.kDp-YHKa.js";import{h as c,i as P,n as p}from"./colors.im4OGed9.js";import{g as ce}from"./calculations.uITx2GSi.js";import{c as d,p as ue}from"./midi.OEToXt3d.js";import{u as de}from"./tuner.2_hyc7-6.js";import{w as V}from"./index.kn6emmbE.js";const me={style:{"vertical-align":"middle"},viewBox:"0 0 32 32",width:"1.2em",height:"1.2em"},he=t("path",{fill:"currentColor",d:"m13.188 3l-.157.813l-.594 2.968a9.939 9.939 0 0 0-2.593 1.532l-2.906-1l-.782-.25l-.406.718l-2 3.438l-.406.719l.594.53l2.25 1.97C6.104 14.948 6 15.46 6 16s.105 1.05.188 1.563l-2.25 1.968l-.594.532l.406.718l2 3.438l.406.718l.782-.25l2.906-1a9.939 9.939 0 0 0 2.594 1.532l.593 2.968l.156.813h5.626l.156-.813l.593-2.968a9.939 9.939 0 0 0 2.594-1.532l2.907 1l.78.25l.407-.718l2-3.438l.406-.718l-.593-.532l-2.25-1.968C25.895 17.05 26 16.538 26 16c0-.54-.105-1.05-.188-1.563l2.25-1.968l.594-.531l-.406-.72l-2-3.437l-.406-.718l-.782.25l-2.906 1a9.939 9.939 0 0 0-2.593-1.532l-.594-2.968L18.812 3zm1.624 2h2.376l.5 2.594l.125.593l.562.188a8.017 8.017 0 0 1 3.031 1.75l.438.406l.562-.187l2.532-.875l1.187 2.031l-2 1.781l-.469.375l.157.594c.128.57.187 1.152.187 1.75c0 .598-.059 1.18-.188 1.75l-.125.594l.438.375l2 1.781l-1.188 2.031l-2.53-.875l-.563-.187l-.438.406a8.017 8.017 0 0 1-3.031 1.75l-.563.188l-.125.593l-.5 2.594h-2.375l-.5-2.594l-.124-.593l-.563-.188a8.017 8.017 0 0 1-3.031-1.75l-.438-.406l-.562.187l-2.531.875L5.875 20.5l2-1.781l.469-.375l-.156-.594A7.901 7.901 0 0 1 8 16c0-.598.059-1.18.188-1.75l.156-.594l-.469-.375l-2-1.781l1.188-2.031l2.53.875l.563.187l.438-.406a8.017 8.017 0 0 1 3.031-1.75l.563-.188l.124-.593zM16 11c-2.75 0-5 2.25-5 5s2.25 5 5 5s5-2.25 5-5s-2.25-5-5-5zm0 2c1.668 0 3 1.332 3 3s-1.332 3-3 3s-3-1.332-3-3s1.332-3 3-3z"},null,-1),ve=[he];function _e(a,$){return o(),i("svg",me,[...ve])}const fe={name:"la-cog",render:_e},ye={style:{"vertical-align":"middle"},viewBox:"0 0 32 32",width:"1.2em",height:"1.2em"},pe=t("path",{fill:"currentColor",d:"M13 4c-1.094 0-2 .906-2 2v12c0 1.094.906 2 2 2h6c1.094 0 2-.906 2-2V6c0-1.094-.906-2-2-2zm0 2h6v12h-6zm-6 8v4c0 3.3 2.7 6 6 6h2v2h-4v2h10v-2h-4v-2h2c3.3 0 6-2.7 6-6v-4h-2v4c0 2.219-1.781 4-4 4h-6c-2.219 0-4-1.781-4-4v-4z"},null,-1),ge=[pe];function xe(a,$){return o(),i("svg",ye,[...ge])}const ke={name:"la-microphone",render:xe},v=a=>(ae("data-v-3802a670"),a=a(),ne(),a),we={class:"max-w-150 relative flex items-center flex-col justify-center"},Ce=v(()=>t("div",{class:"i-la-copy text-xl"},null,-1)),be=v(()=>t("div",{class:"p-0"},"COPY",-1)),ze=[Ce,be],$e={key:1,class:"absolute opacity-50 hover-opacity-100 transition bottom-0 right-5 flex items-center gap-1 bg-light-100 dark-bg-dark-100 rounded-xl shadow-lg","aria-label":"Paste custom schema"},Me=v(()=>t("div",{class:"i-la-paste text-xl absolute ml-1"},null,-1)),Se=["viewBox"],Te=v(()=>t("defs",null,[t("filter",{id:"shadow"},[t("feDropShadow",{dx:"0",dy:"0",stdDeviation:"8","flood-opacity":"0.3"})]),t("filter",{id:"blur",x:"-1",y:"-1",width:"300",height:"300"},[t("feGaussianBlur",{i:"",n:"SourceGraphic",stdDeviation:20})]),t("filter",{id:"blur-less",x:"-1",y:"-1",width:"300",height:"300"},[t("feGaussianBlur",{i:"",n:"SourceGraphic",stdDeviation:15})])],-1)),Be=["transform"],Ne=["onMousedownPassive","onMouseupPassive","onTouchstart","onTouchend","onMouseleave"],Pe=["transform","fill","opacity"],Ve=v(()=>t("path",{d:"M 0,0 a 30,30,0,0,0,25,-20 l 70 -260 a 120,120,0,0,0,2,-20 a 100,100,0,0,0,-200,0 a 120,120,0,0,0,2,20 l 70,260 a 30,30,0,0,0,25,20z"},null,-1)),De=[Ve],Ae=["transform","onClick"],Ge=["fill","opacity"],Ie=v(()=>t("g",{"stroke-width":"4","stroke-linecap":"round"},[t("line",{stroke:"black",x1:"-10",y1:"-10",x2:"10",y2:"10"}),t("line",{stroke:"black",x1:"10",y1:"-10",x2:"-10",y2:"10"})],-1)),je=["transform"],Le={x:"10",y:"10",width:"100",height:"100"},Oe=["onUpdate:modelValue"],Ee=["transform"],Fe=["fill","r"],Je={key:0},Ue=["fill","r"],He=["font-size","fill"],qe={dy:"5","text-anchor":"middle","dominant-baseline":"middle"},Ke={class:"spiral pointer-events-none"},Re=["x1","y1","x2","y2","stroke"],We=["cx","cy","fill"],Ye={class:"controls"},Qe=v(()=>t("circle",{class:"transition",r:"32",cy:"-68",fill:"#3331"},null,-1)),Xe={key:1,class:"tuner transition","aria-label":"Calculated fundamental frequency"},Ze=["fill"],et=v(()=>t("circle",{r:"32",cy:"70",fill:"#3333"},null,-1)),tt=["aria-label"],lt=v(()=>t("rect",{fill:"#0001",x:"-100",y:"-32",width:"200",height:"70",rx:"10"},null,-1)),st={y:"6","font-size":"40",fill:"currentColor"},ot={key:1,class:"center"},it=v(()=>t("circle",{r:"3",fill:"currentColor"},null,-1)),at=[it],nt={__name:"ChromaFlower",props:{letters:{type:Boolean,default:!0},size:{type:Number,default:1e3},pad:{type:Number,default:50}},setup(a){const $=a,D=U(()=>re.map((u,s)=>({note:u,pitch:s,coord:_(s,.42),middle:_(s,.28),inside:_(s,.15)}))),r=ee();te(()=>{r.value=de()});function Q(u){return u>r.value.tuner.chromaAvg?r.value.tuner.note.silent?0:u:0}U(()=>new Array(127).fill(null).map((u,s)=>(s+3)%12));function _(u=0,s=.5){return ce(u%12,12,$.size*s,0)}const X=B();function x(u,s,g,S){X.value=!g,ue(D.value[u].note,u>=3?0:-1,g,S)}const{copy:A,copied:G}=le(),w=B(""),M=B(null);return se(w,u=>{try{let s=JSON.parse(u);if(s.length==12&&s.every(g=>V(g).isValid()))c.custom=s,w.value="",c.customize=!1;else throw"Invalid scheme"}catch{M.value=!0,setTimeout(()=>M.value=null,1e3),console.error("Loaded color scheme is not valid")}}),(u,s)=>{var I,j,L,O,E,F,J;const g=ke,S=fe,k=oe("tooltip");return o(),i("div",we,[e(c).customize?y((o(),i("button",{key:0,class:H(["absolute opacity-50 hover-opacity-100 transition cursor-pointer bottom-0 left-5 flex items-center gap-1 bg-light-100 dark-bg-dark-100 rounded-xl p-2 shadow-lg",{customize:e(G)}]),"aria-label":"Copy custom schema",onClick:s[0]||(s[0]=n=>e(A)(JSON.stringify(e(c).custom)))},ze,2)),[[k,"Copy custom schema",void 0,{bottom:!0}]]):f("",!0),e(c).customize?y((o(),i("div",$e,[Me,y(t("input",{class:"w-25 p-2 pl-8 rounded-xl","onUpdate:modelValue":s[1]||(s[1]=n=>w.value=n),placeholder:"PASTE",style:q({backgroundColor:M.value?"red":""})},null,4),[[K,w.value]])])),[[k,"Paste custom schema",void 0,{bottom:!0}]]):f("",!0),(o(),i("svg",{class:"w-full min-w-full",version:"1.1",baseProfile:"full",viewBox:`${-a.pad} ${-a.pad} ${a.size+2*a.pad} ${a.size+2*a.pad}`,xmlns:"http://www.w3.org/2000/svg","text-anchor":"middle","dominant-baseline":"middle"},[Te,t("g",{transform:`translate(${a.size/2}, ${a.size/2}) `},[(o(!0),i(C,null,b(D.value,(n,l)=>{var T,m;return o(),i("g",{class:"keys",key:n},[t("g",{class:"key cursor-pointer",onMousedownPassive:h=>{x(l)},onMouseupPassive:h=>x(l,h,!0),onTouchstart:R(h=>x(l),["prevent","stop"]),onTouchend:R(h=>x(l,h,!0),["prevent","stop"]),onMouseleave:h=>x(l,h,!0)},[t("g",{class:"petal",transform:`rotate(${l*30}) translate(2,-120) `,fill:n.note.length>1?"#222":"#eee",opacity:e(d).activeChromaMidi[l]?1:.9,style:{transition:"all 100ms ease-out"},filter:"url(#shadow)"},De,8,Pe),t("g",null,[e(c).custom[l]!=e(P)[l]?(o(),i("g",{key:0,class:"note select-none","stroke-width":"4","stroke-linecap":"round",transform:`translate(${n.inside.x}, ${n.inside.y})`,onClick:h=>e(c).custom[l]=e(P)[l]},[t("circle",{class:"transition",fill:e(P)[l],r:"20",opacity:e(c).customize?1:.1},null,8,Ge),Ie],8,Ae)):f("",!0),e(c).customize?(o(),i("g",{key:1,class:"note select-none",transform:`translate(${n.middle.x-36}, ${n.middle.y-36})`},[(o(),i("foreignObject",Le,[y(t("input",{class:"h-30 w-30 rounded-xl",type:"color","onUpdate:modelValue":h=>e(c).custom[l]=h},null,8,Oe),[[K,e(c).custom[l]]])]))],8,je)):f("",!0)]),t("g",{class:"note select-none",transform:`translate(${n.coord.x}, ${n.coord.y})`},[t("circle",{style:{transition:"all 100ms ease-out"},fill:e(p)(l,e(d).activeChromaMidi[l]?4:3),r:a.size/12},null,8,Fe),(m=(T=r.value)==null?void 0:T.tuner)!=null&&m.initiated?(o(),i("g",Je,[t("circle",{style:{transition:"all 80ms ease-out"},fill:e(p)(l,7,2,Q(r.value.tuner.aChroma[l])),r:a.size/12,filter:"url(#blur)"},null,8,Ue)])):f("",!0),a.letters?(o(),i("text",{key:1,class:"transition","font-size":a.size/20,"font-weight":"bold",fill:e(d).activeChromaMidi[l]?"black":"white"},[t("tspan",qe,N(n.note),1)],8,He)):f("",!0)],8,Ee)],40,Ne)])}),128)),t("g",Ke,[(o(!0),i(C,null,b(e(d).activeNotes,(n,l)=>(o(),i("g",{class:"interval",key:l},[z(Y,{name:"fade"},{default:W(()=>[(o(!0),i(C,null,b(e(d).activeNotes,(T,m)=>(o(),i("line",{key:m,x1:_((l-9)%12,l/700+.145).x,y1:_((l-9)%12,l/700+.145).y,x2:_((m-9)%12,m/700+.145).x,y2:_((m-9)%12,m/700+.145).y,stroke:e(V)(e(p)(l-9,2)).mix(e(p)(m-9,2)).toHex(),"stroke-width":"20","stroke-linecap":"round",style:q({filter:`drop-shadow(0px 0px 4px ${e(V)(e(p)(l-9,3)).mix(e(p)(m-9,3)).alpha(.5).toHex()}`})},null,12,Re))),128))]),_:2},1024)]))),128)),z(Y,{name:"fade"},{default:W(()=>[(o(!0),i(C,null,b(e(d).activeNotes,(n,l)=>(o(),i("g",{class:"note",key:l},[t("circle",{style:{transition:"all 100ms ease-out"},cx:_((l-9)%12,l/700+.145).x,cy:_((l-9)%12,l/700+.145).y,fill:e(c).custom[(l-9)%12],r:12},null,8,We)]))),128))]),_:1})]),t("g",Ye,[(I=r.value)!=null&&I.tuner&&!r.value.tuner.initiated?y((o(),i("g",{key:0,class:"mic transition cursor-pointer opacity-40 hover-opacity-100","aria-label":"Start input audio analysis",onClick:s[2]||(s[2]=n=>r.value.init())},[Qe,z(g,{"font-size":"42",x:"-25",y:"-90"})])),[[k,"Start input audio analysis",void 0,{top:!0}]]):f("",!0),(L=(j=r.value)==null?void 0:j.tuner)!=null&&L.initiated?(o(),i("g",Xe,[t("circle",{class:"transition",filter:"url(#blur)",style:{transition:"all 500ms ease"},r:"32",cy:"0",fill:!((O=r.value.tuner.note)!=null&&O.silent)&&r.value.tuner.initiated?e(p)((r.value.tuner.note.value+3)%12,4):"transparent"},null,8,Ze),(F=(E=r.value)==null?void 0:E.tuner)!=null&&F.initiated?y((o(),i("text",{key:0,class:"opacity-50 select-none",y:"-67","font-size":"28",fill:"currentColor"},N(r.value.tuner.note.name),513)),[[ie,!((J=r.value.tuner.note)!=null&&J.silent)]]):f("",!0)])):f("",!0),y((o(),i("g",{class:"customize opacity-20 hover-opacity-100 transition cursor-pointer",onClick:s[3]||(s[3]=n=>e(c).customize=!e(c).customize),"aria-label":"Customize colors sitewide"},[et,z(S,{"font-size":"42",x:"-25",y:"44",class:H({customize:e(c).customize})},null,8,["class"])])),[[k,"Customize colors",void 0,{top:!0}]])]),e(d).guessChords[0]?y((o(),i("g",{key:0,class:"chord cursor-pointer","aria-label":"Guessed chord: "+e(d).guessChords[0],onClick:s[4]||(s[4]=n=>e(A)(e(d).guessChords[0]))},[lt,t("text",st,N(e(d).guessChords[0]),1)],8,tt)),[[k,e(d).guessChords.length>1&&"or "+e(d).guessChords.slice(1).join(", ")||e(G)?"Copied!":"Click to copy",void 0,{top:!0}]]):(o(),i("g",ot,at))],8,Be)],8,Se))])}}},_t=Z(nt,[["__scopeId","data-v-3802a670"]]);export{_t as _};
