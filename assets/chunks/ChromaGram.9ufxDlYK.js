import{au as R,r as $,H as E,an as B}from"./theme.CWHaFdN0.js";import{_ as I}from"./ControlStart.DFGBqsN9.js";import{b as M,c as g,u as c,o as N,W as T,v as h,x as f,z as s,M as D,N as F,ar as H,H as m,E as z,B as O,X as w,k as U}from"./framework.C3BURm3f.js";const W={class:"flex flex-col items-center w-full"},j={class:"flex flex-col justify-center items-center relative bg-light-600 dark-bg-dark-700",id:"screen"},A={key:0,class:"i-la-arrow-up"},G={key:1,class:"i-la-arrow-left"},P=s("div",{class:"i-la-trash-alt"},null,-1),X=[P],q={class:"absolute top-4 left-4 text-xl text-white"},J=["width","height"],K={class:"flex items-center gap-2 p-2 flex-wrap"},L={class:"is-group flex flex-wrap gap-2"},te={__name:"ChromaGram",setup(Q){const{init:_,tuner:x}=R();let d,t,l,u;const e=M({initiated:!1,width:1920,height:1080,speed:g(()=>Math.floor(e.speedCount/100)),direction:c("chromagram-direction",0),notes:g(()=>$(x.chroma,-3)),speedCount:E(c("chromagram-speed",100),100,1200),pow:c("chromagram-pow",3),offset:c("chromagram-offset",0)});N(()=>{d=document.getElementById("spectrogram"),t=d.getContext("2d"),l=document.createElement("canvas"),u=l.getContext("2d"),l.width=e.width,l.height=e.height,t.fillStyle="#333",t.fillRect(0,0,e.width,e.height)});function v(i){e.speedCount+=i.delta[0]-i.delta[1]}function y(){e.initiated||(e.initiated=!0,_(),U(C))}function C(){e.direction==1?k():S()}function k(){u.drawImage(d,0,0,e.width,e.height),t.fillStyle="#33333399",t.fillRect(0,0,e.width,e.speed),t.translate(0,-e.speed),t.drawImage(l,0,0,e.width,e.height),e.notes.forEach((i,o)=>{let a=o*e.width/12;t.fillStyle=p(o,i,.5),t.fillRect(a,e.height-e.speed,e.width/12,e.speed)}),t.setTransform(1,0,0,1,0,0)}function S(){u.drawImage(d,0,0,e.width,e.height),t.fillStyle="#33333399",t.fillRect(e.width-e.speed,0,e.speed,e.height),e.notes.forEach((i,o)=>{let a=(o+1)*e.height/12;t.fillStyle=p(o,i,.5),t.fillRect(e.width-e.speed,e.height-a,e.width,e.height/12)}),t.translate(-e.speed,0),t.drawImage(l,0,0,e.width,e.height),t.setTransform(1,0,0,1,0,0)}function p(i=0,o=1,a=1){let r=Math.pow(o+e.offset,e.pow);return`hsla(${i*30}, ${r*100}%, ${r*60}%, ${a})`}function V(){t.fillStyle="#333",t.fillRect(0,0,e.width,e.height)}return(i,o)=>{const a=I,r=B,b=T("drag");return h(),f("div",W,[s("div",j,[e.initiated?m("",!0):(h(),D(a,{key:0,class:"absolute",onClick:o[0]||(o[0]=n=>y())},{default:F(()=>[H("Start")]),_:1})),s("button",{class:"absolute bottom-4 left-4 text-xl text-white",onClick:o[1]||(o[1]=n=>e.direction?e.direction=0:e.direction=1)},[e.direction==1?(h(),f("div",A)):m("",!0),e.direction==0?(h(),f("div",G)):m("",!0)]),s("button",{class:"absolute top-4 right-4 text-xl select-none cursor-pointer",onMousedown:o[2]||(o[2]=n=>V())},X,32),s("div",q,"x"+z(e.speed),1),O(s("canvas",{class:"w-full cursor-pointer max-h-100svh",id:"spectrogram",width:e.width,height:e.height},null,8,J),[[b,v]])]),s("div",K,[s("div",L,[w(r,{modelValue:e.pow,"onUpdate:modelValue":o[3]||(o[3]=n=>e.pow=n),min:1,max:10,step:1,fixed:0,param:"POW"},null,8,["modelValue"]),w(r,{modelValue:e.offset,"onUpdate:modelValue":o[4]||(o[4]=n=>e.offset=n),min:-.25,max:.25,step:1e-4,param:"OFFSET",fixed:2},null,8,["modelValue"])])])])}}};export{te as default};
