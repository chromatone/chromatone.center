import{aQ as I,r as B,E as T,an as D}from"./theme.DF4Pw-XN.js";import{_ as M}from"./ControlStart.DiU-I8GO.js";import{ak as N,H as F,G as _,E as u,o as z,J as G,a0 as H,c as f,h as p,i as s,e as O,s as U,aI as W,k as g,B as j,R as A,u as v,t as y,V as J}from"./framework.D_pKV3Tc.js";const P={class:"flex flex-col items-center w-full relative"},Q={class:"flex flex-col justify-center items-center relative bg-light-600 dark-bg-dark-700",id:"screen"},q={key:0,class:"i-la-arrow-up"},K={key:1,class:"i-la-arrow-left"},L={class:"absolute top-4 left-4 text-xl text-white"},X=["width","height"],Y={class:"flex items-center gap-2 p-2 flex-wrap absolute bottom-4 right-4"},Z={class:"is-group flex flex-wrap gap-2"},at={__name:"ChromaGram",setup(tt){const{width:d,height:c}=N(),{init:C,tuner:k}=I();let h,o,i,m;const t=F({initiated:!1,width:d,height:c,speed:_(()=>Math.floor(t.speedCount/100)),direction:u("chromagram-direction",0),notes:_(()=>B(k.chroma,-3)),speedCount:T(u("chromagram-speed",100),100,1200),pow:u("chromagram-pow",3),offset:u("chromagram-offset",0)});z(()=>{h=document.getElementById("spectrogram"),o=h.getContext("2d"),i=document.createElement("canvas"),m=i.getContext("2d"),i.width=t.width,i.height=t.height,o.fillStyle="#333",o.fillRect(0,0,t.width,t.height)}),G([d,c],()=>{i&&(i.width=d.value,i.height=c.value)});function S(a){t.speedCount+=a.delta[0]-a.delta[1]}function V(){t.initiated||(t.initiated=!0,C(),J(b))}function b(){t.direction==1?R():E()}function R(){m.drawImage(h,0,0,t.width,t.height),o.fillStyle="#33333399",o.fillRect(0,0,t.width,t.speed),o.translate(0,-t.speed),o.drawImage(i,0,0,t.width,t.height),t.notes.forEach((a,e)=>{let l=e*t.width/12;o.fillStyle=w(e,a,.5),o.fillRect(l,t.height-t.speed,t.width/12,t.speed)}),o.setTransform(1,0,0,1,0,0)}function E(){m.drawImage(h,0,0,t.width,t.height),o.fillStyle="#33333399",o.fillRect(t.width-t.speed,0,t.speed,t.height),t.notes.forEach((a,e)=>{let l=(e+1)*t.height/12;o.fillStyle=w(e,a,.5),o.fillRect(t.width-t.speed,t.height-l,t.width,t.height/12)}),o.translate(-t.speed,0),o.drawImage(i,0,0,t.width,t.height),o.setTransform(1,0,0,1,0,0)}function w(a=0,e=1,l=1){let r=Math.pow(e+t.offset,t.pow);return`hsla(${a*30}, ${r*100}%, ${r*60}%, ${l})`}function x(){o.fillStyle="#333",o.fillRect(0,0,t.width,t.height)}return(a,e)=>{const l=M,r=D,$=H("drag");return f(),p("div",P,[s("div",Q,[t.initiated?g("",!0):(f(),O(l,{key:0,class:"absolute",onClick:e[0]||(e[0]=n=>V())},{default:U(()=>e[5]||(e[5]=[W("Start")])),_:1})),s("button",{class:"absolute bottom-4 left-4 text-xl text-white",onClick:e[1]||(e[1]=n=>{t.direction?t.direction=0:t.direction=1,x()})},[t.direction==1?(f(),p("div",q)):g("",!0),t.direction==0?(f(),p("div",K)):g("",!0)]),s("button",{class:"absolute top-4 right-4 text-xl select-none cursor-pointer",onMousedown:e[2]||(e[2]=n=>x())},e[6]||(e[6]=[s("div",{class:"i-la-trash-alt"},null,-1)]),32),s("div",L,"x"+j(t.speed),1),A(s("canvas",{class:"w-full cursor-pointer",id:"spectrogram",width:v(d),height:v(c)},null,8,X),[[$,S]])]),s("div",Y,[s("div",Z,[y(r,{modelValue:t.pow,"onUpdate:modelValue":e[3]||(e[3]=n=>t.pow=n),min:1,max:10,step:1,fixed:0,param:"POW"},null,8,["modelValue"]),y(r,{modelValue:t.offset,"onUpdate:modelValue":e[4]||(e[4]=n=>t.offset=n),min:-.25,max:.25,step:1e-4,param:"OFFSET",fixed:2},null,8,["modelValue"])])])])}}};export{at as default};
