import{af as I,aY as B,u,r as T,F as D,I as F,as as M}from"./theme.BArAxVsh.js";import{_ as N}from"./ControlStart.BAfrouiT.js";import{r as O,e as _,o as W,w as z,O as H,B as f,C as p,E as s,V as U,W as j,af as A,L as w,J as G,H as J,u as v,R as C}from"./framework.B_b_ZswS.js";const L={class:"flex flex-col items-center w-full relative"},P={class:"flex flex-col justify-center items-center relative bg-light-600 dark-bg-dark-700",id:"screen"},Y={key:0,class:"i-la-arrow-up"},q={key:1,class:"i-la-arrow-left"},K={class:"absolute top-4 left-4 text-xl text-white"},Q=["width","height"],X={class:"flex items-center gap-2 p-2 flex-wrap absolute bottom-4 right-4"},Z={class:"is-group flex flex-wrap gap-2"},ae={__name:"ChromaGram",setup(ee){const{width:d,height:c}=I(),{init:y,tuner:S}=B();let h,o,i,m;const e=O({initiated:!1,width:d,height:c,speed:_(()=>Math.floor(e.speedCount/100)),direction:u("chromagram-direction",0),notes:_(()=>T(S.chroma,-3)),speedCount:D(u("chromagram-speed",100),100,1200),pow:u("chromagram-pow",3),offset:u("chromagram-offset",0)});W(()=>{h=document.getElementById("spectrogram"),o=h.getContext("2d"),i=document.createElement("canvas"),m=i.getContext("2d"),i.width=e.width,i.height=e.height,o.fillStyle="#333",o.fillRect(0,0,e.width,e.height)}),z([d,c],()=>{i&&(i.width=d.value,i.height=c.value)});function V(a){e.speedCount+=a.delta[0]-a.delta[1]}function b(){e.initiated||(e.initiated=!0,y(),F(k))}function k(){e.direction==1?R():$()}function R(){m.drawImage(h,0,0,e.width,e.height),o.fillStyle="#33333399",o.fillRect(0,0,e.width,e.speed),o.translate(0,-e.speed),o.drawImage(i,0,0,e.width,e.height),e.notes.forEach((a,t)=>{let l=t*e.width/12;o.fillStyle=g(t,a,.5),o.fillRect(l,e.height-e.speed,e.width/12,e.speed)}),o.setTransform(1,0,0,1,0,0)}function $(){m.drawImage(h,0,0,e.width,e.height),o.fillStyle="#33333399",o.fillRect(e.width-e.speed,0,e.speed,e.height),e.notes.forEach((a,t)=>{let l=(t+1)*e.height/12;o.fillStyle=g(t,a,.5),o.fillRect(e.width-e.speed,e.height-l,e.width,e.height/12)}),o.translate(-e.speed,0),o.drawImage(i,0,0,e.width,e.height),o.setTransform(1,0,0,1,0,0)}function g(a=0,t=1,l=1){let r=Math.pow(t+e.offset,e.pow);return`hsla(${a*30}, ${r*100}%, ${r*60}%, ${l})`}function x(){o.fillStyle="#333",o.fillRect(0,0,e.width,e.height)}return(a,t)=>{const l=N,r=M,E=H("drag");return f(),p("div",L,[s("div",P,[e.initiated?w("",!0):(f(),U(l,{key:0,class:"absolute",onClick:t[0]||(t[0]=n=>b())},{default:j(()=>t[5]||(t[5]=[A("Start")])),_:1})),s("button",{class:"absolute bottom-4 left-4 text-xl text-white",onClick:t[1]||(t[1]=n=>{e.direction?e.direction=0:e.direction=1,x()})},[e.direction==1?(f(),p("div",Y)):w("",!0),e.direction==0?(f(),p("div",q)):w("",!0)]),s("button",{class:"absolute top-4 right-4 text-xl select-none cursor-pointer",onMousedown:t[2]||(t[2]=n=>x())},t[6]||(t[6]=[s("div",{class:"i-la-trash-alt"},null,-1)]),32),s("div",K,"x"+G(e.speed),1),J(s("canvas",{class:"w-full cursor-pointer",id:"spectrogram",width:v(d),height:v(c)},null,8,Q),[[E,V]])]),s("div",X,[s("div",Z,[C(r,{modelValue:e.pow,"onUpdate:modelValue":t[3]||(t[3]=n=>e.pow=n),min:1,max:10,step:1,fixed:0,param:"POW"},null,8,["modelValue"]),C(r,{modelValue:e.offset,"onUpdate:modelValue":t[4]||(t[4]=n=>e.offset=n),min:-.25,max:.25,step:1e-4,param:"OFFSET",fixed:2},null,8,["modelValue"])])])])}}};export{ae as default};
