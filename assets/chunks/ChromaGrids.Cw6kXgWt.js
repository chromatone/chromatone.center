import{q as z,b as G,c as M,w as q,W as U,B as D,v as h,x as g,z as o,G as _,I as A,E as V,J as H,K,d as O,F as b,A as $,D as t,C as P,X as y,N,M as E,L as T,u as F,y as B,ag as W}from"./framework.C3BURm3f.js";import{H as J,g as C,a as S,F as X,j as Y,aZ as Z,n as Q,aF as I,a_ as R}from"./theme.C6pbtRQB.js";const L=e=>(H("data-v-81a66231"),e=e(),K(),e),tt={class:"knob","drag-options":{preventWindowScrollY:!0}},et={class:"flex items-center"},ot=L(()=>o("div",{class:"i-la-minus"},null,-1)),lt=[ot],st={class:"text-lg font-bold"},nt=L(()=>o("div",{class:"i-la-plus"},null,-1)),at=[nt],it={__name:"ControlChange",props:{max:{type:Number,default:100},min:{type:Number,default:0},modelValue:{type:Number,default:50},step:{type:Number,default:1},param:{type:String,default:"param"},unit:{type:String,default:""},fixed:{type:Number,default:0},ratio:{type:Number,default:1}},emits:["update:modelValue"],setup(e,{emit:w}){const s=e,l=w,a=G({active:!1,internal:0,initial:0,external:M(()=>m(a.internal))});function i(d){const{delta:[r,c],dragging:f,shiftKey:x}=d;a.active=f;let k=s.ratio;a.internal-=c/k,a.internal+=r/k,a.internal>100&&(a.internal=100),a.internal<0&&(a.internal=0),l("update:modelValue",a.external)}function v(d=1){let r=s.step/(s.max-s.min);a.internal+=100*r*d,a.internal>100&&(a.internal=100),a.internal<0&&(a.internal=0),l("update:modelValue",a.external)}q(()=>{a.internal=u(s.modelValue)});function n(){a.internal=a.initial,l("update:modelValue",a.external)}function u(d){return p(d,s.min,s.max,0,100,s.step)}function m(d){return p(d,0,100,s.min,s.max,s.step)}function p(d,r=0,c=100,f=0,x=100,k=1){x=parseFloat(x),f=parseFloat(f),c=parseFloat(c),r=parseFloat(r);let j=(d-r)*(x-f)/(c-r)+f;return Math.round(j/k)*k}return(d,r)=>{const c=U("drag");return D((h(),g("div",tt,[o("div",{class:"level",style:_({width:a.internal+"%"})},null,4),o("div",et,[o("div",{class:"pl-1 absolute",onMousedown:r[0]||(r[0]=f=>v(-1))},lt,32),o("div",{class:"px-1 flex-1 text-center",onDblclick:r[1]||(r[1]=f=>n())},[A(d.$slots,"default",{},()=>[o("div",st,V(e.modelValue.toFixed(e.fixed))+V(e.unit),1)],!0)],32),o("div",{class:"pr-1 absolute right-0",onMousedown:r[2]||(r[2]=f=>v(1))},at,32)])])),[[c,i]])}}},rt=z(it,[["__scopeId","data-v-81a66231"]]),dt=["transform"],ut=["transform"],ct=["x","width","height","fill","onMousedown"],ht=["x1","x2","stroke-width","stroke"],mt=["transform"],ft=["width","height"],vt=["transform"],gt=["data-pos","height","width"],pt=["x","font-size"],xt={__name:"ChromaGridsColumn",props:{step:{type:Array,default:()=>{}},pos:{type:Number,default:0},width:{type:Number,default:100},height:{type:Number,default:500},footer:{type:Number,default:60},color:{type:String,default:"gray"},active:{type:Boolean,default:!1}},emits:["subdivide"],setup(e,{emit:w}){const s=e,l=w,a=J(0,20,160),i=M(()=>Math.floor(a.value/20));O(i,(m,p)=>{if(m==p)return;let d=[...s.step];if(m<d.length)d.length=m;else for(let r=d.length;r<m;r++)d.push({});l("subdivide",d.map(r=>({...r,sub:m})))});function v(m){a.value+=m.delta[0]-m.delta[1]}const n=M(()=>(C.set.chroma+C.set.chroma+1).split(""));function u(m){let p=Object.entries(m).map(d=>{if(d[0]!="sub"&&d[1])return X(Number(d[0])+C.tonic+69,"midi").toNote()}).filter(d=>d!=null);return Y.detect(p)[0]||p[0]}return(m,p)=>{const d=U("drag");return h(),g("g",{class:"col",transform:`translate(${e.pos*e.width} 0)`},[(h(),g(b,null,$(25,(r,c)=>o("g",{class:"cell",key:c,transform:`translate(0 ${e.height-r*e.height/25})`},[(h(!0),g(b,null,$(e.step,(f,x)=>(h(),g("g",{class:"sub",key:f},[o("rect",{class:"transition-all duration-200 ease-out","stroke-width":"0",x:x*e.width/e.step.length+1,width:e.width/e.step.length-2,height:e.height/25-2,rx:"4",fill:t(S)(r+t(C).tonic-1,3,n.value[c]==1?1:.1,f[c]?1:.1),onMousedown:k=>f[c]=!f[c]},null,40,ct),o("line",{class:"line pointer-events-none transition-all duration-200 ease-out",x1:x*e.width/e.step.length,x2:(x+1)*e.width/e.step.length,y1:10,y2:10,"stroke-width":f[c]?4:6,"stroke-opacity":"0.1",stroke:f[c]?"black":t(S)(r+t(C).tonic-1,3,n.value[c]==1?1:.1,f[c]?1:.5)},null,8,ht)]))),128))],8,ut)),64)),D(o("g",{class:"subs",transform:`translate(0 ${e.height})`},[D(o("rect",{width:e.width,height:e.footer,fill:"transparent"},null,8,ft),[[d,v]]),(h(!0),g(b,null,$(e.step,(r,c)=>(h(),g("g",{class:"pointer-events-none",key:r,transform:`translate(${c*e.width/e.step.length} 0)`},[o("rect",{"data-pos":e.pos,height:e.footer,stroke:"currentColor",fill:"#5552",width:e.width/e.step.length},null,8,gt),o("text",{class:"font-bold",x:e.width/e.step.length/2,y:40,"font-size":20*(1-.15*(e.step.length-1)),fill:"currentColor","text-anchor":"middle","dominant-baseline":"cental"},V(u(r)),9,pt)],8,vt))),128))],8,mt),[[P,e.active]])],8,dt)}}},wt=z(xt,[["__scopeId","data-v-90802846"]]),yt={class:"is-group flex p-1 mx-1 items-center"},bt=o("div",{class:"p-2 text-xl"},"/",-1),$t={class:"is-group flex p-1 m-1"},kt=o("div",{class:"i-la-angle-left"},null,-1),_t=[kt],Vt=o("div",{class:"i-la-angle-right"},null,-1),Ct=[Vt],Nt={class:"is-group p-1 flex mx-1"},St=o("div",{class:"i-la-dice text-xl"},null,-1),Mt=o("div",{class:"i-mdi-pan-horizontal"},null,-1),Dt=o("div",{class:"i-la-volume-up"},null,-1),Ft=o("div",{class:"flex-1"},null,-1),Bt=o("div",{class:"i-la-trash-alt"},null,-1),It=[Bt],zt=o("div",{class:"i-la-times"},null,-1),Gt=[zt],Ut=["viewBox","opacity"],Et={id:"grid-mask"},Lt=["width","height"],jt={class:"all","clip-path":"url(#grid-mask)"},qt={class:"grid"},At=["stroke","width","height"],Ht=["y2","stroke-width","stroke","transform"],Kt=["transform","stroke"],Ot=["transform"],Pt=["y2","stroke"],Tt={__name:"ChromaGridsGrid",props:{order:{type:Number,default:0},color:{type:String,default:"currentColor"},active:{type:Boolean,default:!0}},emits:["del"],setup(e){const w=e,s=G({width:1e3,height:720,footer:60}),l=Z(w.order);return(a,i)=>{const v=rt;return h(),g("div",{class:"flex flex-col shadow-xl rounded-3xl overflow-hidden border-4",style:_({zIndex:e.active?100:1,opacity:e.active?1:.25,borderColor:e.color})},[o("div",{class:"flex flex-wrap p-2",style:_({opacity:e.active?1:0,backgroundColor:e.color,pointerEvents:e.active?"auto":"none"})},[o("div",yt,[y(v,{class:"w-5em",modelValue:t(l).metre.over,"onUpdate:modelValue":i[0]||(i[0]=n=>t(l).metre.over=n),step:1,min:1,max:48,param:""},null,8,["modelValue"]),bt,y(v,{class:"w-5em",modelValue:t(l).metre.under,"onUpdate:modelValue":i[1]||(i[1]=n=>t(l).metre.under=n),step:1,min:1,max:16,param:""},null,8,["modelValue"])]),o("div",$t,[o("button",{class:"text-button",onClick:i[2]||(i[2]=n=>t(l).rotate(-1))},_t),o("button",{class:"text-button",onClick:i[3]||(i[3]=n=>t(l).rotate())},Ct)]),o("div",{class:"is-group p-1 flex mx-1 transition-all duration-300 ease",style:_({borderColor:t(S)(t(l).pitch,t(l).octave)})},[y(v,{class:"w-5em",modelValue:t(l).octave,"onUpdate:modelValue":i[4]||(i[4]=n=>t(l).octave=n),step:1,min:0,max:7,ratio:4},{default:N(()=>[o("div",{class:"font-bold transition-all duration-300 ease",style:_({color:t(S)(t(l).pitch,t(l).octave)})},V(t(Q)[t(l).pitch])+V(t(l).octave),5)]),_:1},8,["modelValue"])],4),o("div",Nt,[y(v,{class:"w-5em",modelValue:t(l).probability,"onUpdate:modelValue":i[5]||(i[5]=n=>t(l).probability=n),step:.01,min:0,max:1,fixed:2},{default:N(()=>[St]),_:1},8,["modelValue"]),y(v,{class:"w-4em",modelValue:t(l).pan,"onUpdate:modelValue":i[6]||(i[6]=n=>t(l).pan=n),step:.01,min:-1,max:1,fixed:1,ratio:2},{default:N(()=>[Mt]),_:1},8,["modelValue"]),y(v,{class:"w-4em",modelValue:t(l).volume,"onUpdate:modelValue":i[7]||(i[7]=n=>t(l).volume=n),step:.01,min:0,max:1,fixed:1,ratio:2,onDblclick:i[8]||(i[8]=n=>t(l).volume>0?t(l).volume=0:t(l).volume=.75)},{default:N(()=>[Dt]),_:1},8,["modelValue"])]),Ft,o("button",{class:"text-button",onMousedown:i[9]||(i[9]=n=>t(l).clear())},It,32),o("button",{class:"text-button",onMousedown:i[10]||(i[10]=n=>a.$emit("del"))},Gt,32)],4),(h(),g("svg",{class:"w-full cursor-pointer",ref:"svg",version:"1.1",baseProfile:"full",viewBox:`0 0 ${s.width} ${s.height+s.footer}`,xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"},opacity:t(l).volume},[o("clipPath",Et,[o("rect",{x:0,y:-10,width:s.width,height:s.height+s.footer+10,rx:10},null,8,Lt)]),o("g",jt,[o("g",qt,[o("rect",{ref:"area",stroke:e.color,"stroke-width":10,fill:"transparent",rx:"10",width:s.width,height:s.height},null,8,At),(h(!0),g(b,null,$(t(l).metre.over,n=>(h(),g("line",{key:n,y2:s.height,"stroke-width":n%t(l).metre.under==0?8:n%4==0?4:e.active?1:0,stroke:e.color,transform:`translate(${n*s.width/t(l).metre.over} 0)`},null,8,Ht))),128)),o("line",{x2:"1000",transform:`translate(0 ${s.height/2})`,"stroke-width":"4",stroke:t(S)(t(l).pitch)},null,8,Kt)]),(h(!0),g(b,null,$(t(l).steps,(n,u)=>(h(),E(wt,{key:u,step:n,pos:u,color:e.color,width:s.width/t(l).steps.length,height:s.height,footer:s.footer,active:e.active,onSubdivide:m=>t(l).steps[u]=m},null,8,["step","pos","color","width","height","footer","active","onSubdivide"]))),128)),o("g",{class:"progress",transform:`translate(${s.width*t(l).progress} 0)`},[o("line",{y1:"0",y2:s.height,"stroke-width":"4",stroke:e.color},null,8,Pt)],8,Ot)])],8,Ut))],4)}}},Wt={class:"flex flex-col items-center rounded-3xl fullscreen-container p-2",id:"screen"},Jt={class:"flex flex-wrap mt-4 w-full justify-start px-6"},Xt=["onMousedown"],Yt={class:"px-4 py-2"},Zt=o("div",{class:"i-la-plus"},null,-1),Qt=[Zt],Rt=o("div",{class:"flex-1"},null,-1),te=o("div",{class:"i-la-file-download"},null,-1),ee=[te],oe={class:"flex flex-col mb-4 mx-4 w-full relative"},ne={__name:"ChromaGrids",setup(e){const{isDark:w}=T(),s=F("pitch-bars",[1]);function l(){s.value.push(Math.ceil(Math.random()*100)),a.value=s.value.length-1}const a=F("pitch-bars-active",0);return(i,v)=>(h(),g("div",Wt,[o("div",Jt,[(h(!0),g(b,null,$(t(s),(n,u)=>(h(),g("button",{class:B(["px-2 rounded-t-xl mx-2px transition-all duration-300 ease flex items-center",{active:t(a)==u}]),key:n,style:_({backgroundColor:t(I)(u,t(s).length,t(a)==u?1:.3)}),onMousedown:m=>a.value=u},[o("div",Yt,V(u),1)],46,Xt))),128)),o("button",{class:"text-button",onClick:v[0]||(v[0]=n=>l())},Qt),Rt,o("button",{class:"text-button flex items-center",onClick:v[1]||(v[1]=n=>t(R)())},ee)]),o("div",oe,[y(W,{name:"fade"},{default:N(()=>[(h(!0),g(b,null,$(t(s),(n,u)=>(h(),E(Tt,{class:B(["w-full",{absolute:u>0}]),key:n,order:u,active:t(a)==u,color:t(I)(u,t(s).length,t(w)?.3:1),onDel:m=>{t(s).splice(u,1),a.value=t(s).length-1}},null,8,["class","order","active","color","onDel"]))),128))]),_:1})])]))}};export{ne as default};
