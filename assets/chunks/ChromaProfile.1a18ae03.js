import{_ as Q}from"./ChromaRow.fe7ac111.js";import{_ as X}from"./ChromaCode.580978e6.js";import{_ as Y}from"./ChromaCircle.70557fe3.js";import{_ as Z}from"./ChromaKeys.e1b1bcd4.js";import{_ as ee}from"./AbcRender.e4565a6a.js";import{_ as L,u as te,i as y,z as oe,j as i,o as v,c as $,g as l,l as ae,a as c,t as b,F as se,r as ne,p as R,d as q,k as le,f as x,b as F,e as re,x as ie}from"./framework.f277db28.js";import{r as ce}from"./calculations.2bac3e9a.js";import{u as U,e as me,c as ue}from"./index.8dc0b613.js";import{g as h,c as O,b as V,d as S,n as de}from"./colors.a5d5ae39.js";import"./synth.8a2ee66e.js";import{u as fe}from"./index.911cb71e.js";import{u as pe}from"./index.64a8684b.js";import{p as he}from"./index.b30cd6d2.js";import"./index.86652af6.js";import{i as W}from"./index.ab22ef51.js";import{a as A,b as E,n as ve}from"./theory.61e5aadb.js";const _e=e=>(R("data-v-993ce395"),e=e(),q(),e),ge=["viewBox"],ye=["transform"],$e=["fill"],we={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},xe=_e(()=>c("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),be=["stroke","points"],ke=["stroke","points"],P=4e3,T=300,z=2e3,Ce={__name:"ChromaProfileWaveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(e){const k=e,{isDark:m}=te(),w=[];for(let o=0;o<13;o++)w[o]=Math.pow(2,o/12);const _=P/z,r=y(!1),C=y(0),s=y(0),a=y(2e3),u=y(),d=y(1e3),g=fe(U("waveform-speed",1e3),0,a);pe(o=>{const t=o.delta[0]-o.delta[1];g.value+=t},{domTarget:u});const B=me(s,{duration:d,transition:[.87,-.04,.69,1.13],onFinished:()=>{s.value==0&&I()}}),{resume:M,pause:I}=ue(()=>{C.value+=B.value},{immediate:!1});oe(()=>{r.value?(M(),s.value>0&&(d.value=10),s.value=g.value):(s.value=0,d.value=1e3)});const f=i(()=>{let o=[],t=ce(k.chroma.split(""),-h.tonic);for(let n=0;n<12;n++)t[n]==1?o[n]=!0:delete o[n];return o}),G=U("chord-zoom",400);function D(o,t){return Math.sin((t+C.value)*(Math.PI*2*w[o])/G.value)}const H=i(()=>{let o={};for(let t in f.value){o[t]=[];for(let n=0;n<z;n++)o[t].push(`${n*_},${D(Number(t),n)*100+T/2}`)}return o}),J=i(()=>{let o=[];for(let t=0;t<z;t++){o[t]=0;for(let n in f.value){let p=Number(n);o[t]+=D(p,t)}}return o}),K=i(()=>J.value.map((o,t)=>`${t*_},${o*30+T/2}`).join(" ")),j=i(()=>O(k.chroma,h.tonic));return(o,t)=>{var n;return v(),$("div",{class:"waveform",ref_key:"waveContainer",ref:u},[(v(),$("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${P} ${T}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:t[0]||(t[0]=p=>{l(V)(e.chroma),r.value=!0}),onTouchstart:t[1]||(t[1]=ae(p=>{l(V)(e.chroma),r.value=!0},["prevent","stop"])),onTouchend:t[2]||(t[2]=p=>{l(S)(e.chroma),r.value=!1}),onTouchcancel:t[3]||(t[3]=p=>{l(S)(e.chroma),r.value=!1}),onMouseup:t[4]||(t[4]=p=>{l(S)(e.chroma),r.value=!1}),onMouseleave:t[5]||(t[5]=p=>{l(S)(e.chroma),r.value=!1})},[c("g",{transform:`translate(${l(g)/a.value*P} 10)`},[c("circle",{r:"40",fill:j.value.hsl},null,8,$e),c("text",we,b(l(g)*60)+" px/sec",1)],8,ye),xe,(v(!0),$(se,null,ne(f.value,(p,N)=>(v(),$("g",{key:N},[c("polyline",{stroke:l(de)(N,l(m)?8:2),points:H.value[N],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,be)]))),128)),c("polyline",{stroke:(n=j.value)==null?void 0:n.hsl,points:K.value,"stroke-width":"24",fill:"none"},null,8,ke)],40,ge))],512)}}},Se=L(Ce,[["__scopeId","data-v-993ce395"]]);const Be=e=>(R("data-v-1347a5d8"),e=e(),q(),e),Me={class:"flex w-full relative px-4"},Ie=["href"],Ne=Be(()=>c("div",{class:"i-la-wikipedia-w"},null,-1)),Pe=[Ne],Te={class:"text-2xl font-bold capitalize mb-2"},ze={class:"flex items-center mx-2 w-full gap-2"},De={class:"p-4"},je={__name:"ChromaProfile",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(e,{emit:k}){const m=e;le({chord:i(()=>A.get(m.chroma)),scale:i(()=>E.get(m.chroma))});const w=i(()=>A.get(m.chroma)),_=i(()=>E.get(m.chroma)),r=i(()=>he.intervals(m.chroma));i(()=>{let s=[];if(!r.value)return[];for(let a=1;a<r.value.length;a++)s[a-1]=W.semitones(r.value[a])-W.semitones(r.value[a-1]);return s});function C(s){console.log(s,m.chroma,h.tonic);let a=m.chroma;const u=(12-h.tonic+s)%12;if(console.log(u),u==0)return;let d=a.split("");d[u]=d[u]=="0"?"1":"0",k("update:chroma",d.join(""))}return(s,a)=>{const u=Se,d=ee,g=Z,B=Y,M=X,I=Q;return v(),$("div",{class:"profile",style:ie({borderColor:l(O)(e.chroma,l(h).tonic).hsl})},[x(u,{chroma:e.chroma},null,8,["chroma"]),c("div",Me,[e.link?(v(),$("a",{key:0,class:"p-2 absolute top-8px right-2em",href:e.link,target:"_blank"},Pe,8,Ie)):F("",!0),c("div",Te,b(l(ve)[l(h).tonic])+" "+b(w.value.name||w.value.aliases[0]||_.value.name||e.title)+" "+b(_.value.aliases[0]?`(${_.value.aliases[0]})`:""),1)]),e.abc?(v(),re(d,{key:0,abc:e.abc},null,8,["abc"])):F("",!0),c("div",ze,[x(g,{style:{flex:"1 1 400px"},chroma:e.chroma,"onUpdate:chroma":a[0]||(a[0]=f=>s.$emit("update:chroma",f)),pitch:l(h).tonic,title:!1,"onUpdate:pitch":C,playAll:!0},null,8,["chroma","pitch"]),x(B,{style:{flex:"1 1 250px"},chroma:e.chroma},null,8,["chroma"]),x(M,{chroma:e.chroma,"onUpdate:chroma":a[1]||(a[1]=f=>s.$emit("update:chroma",f))},null,8,["chroma"])]),x(I,{class:"mx-2 mb-2",chroma:e.chroma,"onUpdate:chroma":a[2]||(a[2]=f=>s.$emit("update:chroma",f)),editable:e.editable},null,8,["chroma","editable"]),c("div",De,b(e.description),1)],4)}}},Ye=L(je,[["__scopeId","data-v-1347a5d8"]]);export{Ye as _};
