import{_ as Q}from"./ChromaRow.0eddfe86.js";import{_ as X}from"./ChromaCode.086531f3.js";import{_ as Y}from"./ChromaCircle.4f37cce7.js";import{_ as Z}from"./ChromaKeys.5486e07e.js";import{_ as ee}from"./AbcRender.80ad7d06.js";import{_ as q,k as te,x as y,L as U,S as oe,O as ae,P as ne,b as i,o as v,c as w,u as l,E as se,a as c,t as S,F as le,d as re,p as A,q as O,r as ie,f as b,l as j,g as ce,C as ue}from"./framework.c1cedef0.js";import{r as me}from"./calculations.65ee336d.js";import{g as h,c as R,b as E,e as C,n as fe}from"./colors.de92a8a1.js";import"./synth.22724927.js";import{u as de}from"./index.15d43a61.js";import{u as pe}from"./index.75873fe1.js";import{p as he}from"./index.b30cd6d2.js";import"./index.86652af6.js";import{i as L}from"./index.ab22ef51.js";import{a as V,b as W,n as ve}from"./theory.61e5aadb.js";const _e=t=>(A("data-v-993ce395"),t=t(),O(),t),ge=["viewBox"],ye=["transform"],we=["fill"],$e={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},be=_e(()=>c("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),xe=["stroke","points"],ke=["stroke","points"],N=4e3,T=300,z=2e3,Ce={__name:"ChromaProfileWaveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(t){const x=t,{isDark:u}=te(),$=[];for(let o=0;o<13;o++)$[o]=Math.pow(2,o/12);const _=N/z,r=y(!1),k=y(0),n=y(0),a=y(2e3),m=y(),f=y(1e3),g=de(U("waveform-speed",1e3),0,a);pe(o=>{const e=o.delta[0]-o.delta[1];g.value+=e},{domTarget:m});const B=oe(n,{duration:f,transition:[.87,-.04,.69,1.13],onFinished:()=>{n.value==0&&P()}}),{resume:M,pause:P}=ae(()=>{k.value+=B.value},{immediate:!1});ne(()=>{r.value?(M(),n.value>0&&(f.value=10),n.value=g.value):(n.value=0,f.value=1e3)});const d=i(()=>{let o=[],e=me(x.chroma.split(""),-h.tonic);for(let s=0;s<12;s++)e[s]==1?o[s]=!0:delete o[s];return o}),G=U("chord-zoom",400);function D(o,e){return Math.sin((e+k.value)*(Math.PI*2*$[o])/G.value)}const H=i(()=>{let o={};for(let e in d.value){o[e]=[];for(let s=0;s<z;s++)o[e].push(`${s*_},${D(Number(e),s)*100+T/2}`)}return o}),J=i(()=>{let o=[];for(let e=0;e<z;e++){o[e]=0;for(let s in d.value){let p=Number(s);o[e]+=D(p,e)}}return o}),K=i(()=>J.value.map((o,e)=>`${e*_},${o*30+T/2}`).join(" ")),F=i(()=>R(x.chroma,h.tonic));return(o,e)=>{var s;return v(),w("div",{class:"waveform",ref_key:"waveContainer",ref:m},[(v(),w("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${N} ${T}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:e[0]||(e[0]=p=>{l(E)(t.chroma),r.value=!0}),onTouchstart:e[1]||(e[1]=se(p=>{l(E)(t.chroma),r.value=!0},["prevent","stop"])),onTouchend:e[2]||(e[2]=p=>{l(C)(t.chroma),r.value=!1}),onTouchcancel:e[3]||(e[3]=p=>{l(C)(t.chroma),r.value=!1}),onMouseup:e[4]||(e[4]=p=>{l(C)(t.chroma),r.value=!1}),onMouseleave:e[5]||(e[5]=p=>{l(C)(t.chroma),r.value=!1})},[c("g",{transform:`translate(${l(g)/a.value*N} 10)`},[c("circle",{r:"40",fill:F.value.hsl},null,8,we),c("text",$e,S(l(g)*60)+" px/sec",1)],8,ye),be,(v(!0),w(le,null,re(d.value,(p,I)=>(v(),w("g",{key:I},[c("polyline",{stroke:l(fe)(I,l(u)?8:2),points:H.value[I],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,xe)]))),128)),c("polyline",{stroke:(s=F.value)==null?void 0:s.hsl,points:K.value,"stroke-width":"24",fill:"none"},null,8,ke)],40,ge))],512)}}},Se=q(Ce,[["__scopeId","data-v-993ce395"]]);const Be=t=>(A("data-v-b3433d9e"),t=t(),O(),t),Me={class:"flex w-full relative px-4"},Pe=["href"],Ie=Be(()=>c("div",{class:"i-la-wikipedia-w"},null,-1)),Ne=[Ie],Te={class:"text-2xl font-bold capitalize mb-2"},ze={class:"flex items-center mx-2 w-full gap-2"},De={__name:"ChromaProfile",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(t,{emit:x}){const u=t;ie({chord:i(()=>V.get(u.chroma)),scale:i(()=>W.get(u.chroma))});const $=i(()=>V.get(u.chroma)),_=i(()=>W.get(u.chroma)),r=i(()=>he.intervals(u.chroma));i(()=>{let n=[];if(!r.value)return[];for(let a=1;a<r.value.length;a++)n[a-1]=L.semitones(r.value[a])-L.semitones(r.value[a-1]);return n});function k(n){console.log(n,u.chroma,h.tonic);let a=u.chroma;const m=(12-h.tonic+n)%12;if(console.log(m),m==0)return;let f=a.split("");f[m]=f[m]=="0"?"1":"0",x("update:chroma",f.join(""))}return(n,a)=>{const m=Se,f=ee,g=Z,B=Y,M=X,P=Q;return v(),w("div",{class:"profile",style:ue({borderColor:l(R)(t.chroma,l(h).tonic).hsl})},[b(m,{chroma:t.chroma},null,8,["chroma"]),c("div",Me,[t.link?(v(),w("a",{key:0,class:"p-2 absolute top-8px right-2em",href:t.link,target:"_blank"},Ne,8,Pe)):j("",!0),c("div",Te,S(l(ve)[l(h).tonic])+" "+S($.value.name||$.value.aliases[0]||_.value.name||"?")+" "+S(_.value.aliases[0]?`(${_.value.aliases[0]})`:""),1)]),t.abc?(v(),ce(f,{key:0,abc:t.abc},null,8,["abc"])):j("",!0),c("div",ze,[b(g,{style:{flex:"1 1 400px"},chroma:t.chroma,"onUpdate:chroma":a[0]||(a[0]=d=>n.$emit("update:chroma",d)),pitch:l(h).tonic,title:!1,"onUpdate:pitch":k,playAll:!0},null,8,["chroma","pitch"]),b(B,{style:{flex:"1 1 250px"},chroma:t.chroma},null,8,["chroma"]),b(M,{chroma:t.chroma,"onUpdate:chroma":a[1]||(a[1]=d=>n.$emit("update:chroma",d))},null,8,["chroma"])]),b(P,{class:"mx-2 mb-2",chroma:t.chroma,"onUpdate:chroma":a[2]||(a[2]=d=>n.$emit("update:chroma",d)),editable:t.editable},null,8,["chroma","editable"])],4)}}},Qe=q(De,[["__scopeId","data-v-b3433d9e"]]);export{Qe as _};
