import{_ as te}from"./ChromaRow.ae16dca4.js";import{g as b,n as q,c as H,b as V,e as M}from"./colors.31585d6f.js";import{n as O,i as oe,a as E,b as R}from"./theory.61e5aadb.js";import{i as u,m as ae,o as p,c as h,F as z,r as j,n as se,h as n,v as Q,I as ne,t as k,_ as G,u as le,k as w,H as W,Q as re,M as ie,N as ce,y as ue,a as f,p as J,e as K,C as me,g as S,d as A,f as de}from"./framework.916f0e04.js";import{_ as pe}from"./ChromaCircle.04b16efc.js";import{_ as he}from"./ChromaKeys.df80c1dd.js";import{_ as fe}from"./AbcRender.58824274.js";import{r as ve}from"./calculations.65ee336d.js";import"./synth.13bc9407.js";import{u as _e}from"./index.318a9c78.js";import{u as ge}from"./index.1827ab5a.js";import{p as ye}from"./index.b30cd6d2.js";import"./index.86652af6.js";import{i as L}from"./index.ab22ef51.js";const $e={class:"flex flex-col-reverse gap-1 bg-dark-200 bg-opacity-30 dark-bg-light-900 dark-bg-opacity-40 p-1 rounded-lg"},xe=["onClick"],be="101101011010",we={__name:"ChromaCode",props:{chroma:{type:String,default:"101101011010"},pitch:{type:Number,default:null},cols:{type:Number,default:4}},emits:["update:chroma"],setup(e,{emit:C}){const i=e,_=u(()=>i.pitch!=null?i.pitch:b.tonic),$=u(()=>i.chroma.match(new RegExp(`.{1,${i.cols}}`,"g")).map(m=>m.split("").map(Number))),c=(m,a)=>m.slice(0,a)+(m[a]==="1"?"0":"1")+m.slice(a+1);return(m,a)=>{const s=ae("tooltip");return p(),h("div",$e,[(p(!0),h(z,null,j($.value,(d,l)=>(p(),h("div",{class:"flex gap-1",key:d},[(p(!0),h(z,null,j(d,(g,v)=>se((p(),h("div",{class:"w-6 h-6 flex flex-col items-center justify-center rounded text-xs font-bold select-none cursor-pointer",onClick:N=>m.$emit("update:chroma",c(e.chroma,(l*e.cols+v)%12)),key:v,style:Q({backgroundColor:g?n(q)(_.value+l*e.cols+v):be.split("")[(_.value+l*e.cols+v)%12]=="1"?"hsla(0,0%,100%,0.5)":"hsla(0,0%,10%,0.5)",opacity:`${g==1?1:.4}`})},[ne(k(n(oe)[(l*4+v)%12]),1)],12,xe)),[[s,`${n(O)[(_.value+l*4+v)%12]}`]])),128))]))),128))])}}};const ke=e=>(J("data-v-993ce395"),e=e(),K(),e),Ce=["viewBox"],Se=["transform"],Ne=["fill"],Me={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},Be=ke(()=>f("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),Ie=["stroke","points"],Te=["stroke","points"],T=4e3,D=300,P=2e3,De={__name:"ChromaProfileWaveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(e){const C=e,{isDark:i}=le(),_=[];for(let o=0;o<13;o++)_[o]=Math.pow(2,o/12);const $=T/P,c=w(!1),m=w(0),a=w(0),s=w(2e3),d=w(),l=w(1e3),g=_e(W("waveform-speed",1e3),0,s);ge(o=>{const t=o.delta[0]-o.delta[1];g.value+=t},{domTarget:d});const v=re(a,{duration:l,transition:[.87,-.04,.69,1.13],onFinished:()=>{a.value==0&&B()}}),{resume:N,pause:B}=ie(()=>{m.value+=v.value},{immediate:!1});ce(()=>{c.value?(N(),a.value>0&&(l.value=10),a.value=g.value):(a.value=0,l.value=1e3)});const y=u(()=>{let o=[],t=ve(C.chroma.split(""),-b.tonic);for(let r=0;r<12;r++)t[r]==1?o[r]=!0:delete o[r];return o}),X=W("chord-zoom",400);function F(o,t){return Math.sin((t+m.value)*(Math.PI*2*_[o])/X.value)}const Y=u(()=>{let o={};for(let t in y.value){o[t]=[];for(let r=0;r<P;r++)o[t].push(`${r*$},${F(Number(t),r)*100+D/2}`)}return o}),Z=u(()=>{let o=[];for(let t=0;t<P;t++){o[t]=0;for(let r in y.value){let x=Number(r);o[t]+=F(x,t)}}return o}),ee=u(()=>Z.value.map((o,t)=>`${t*$},${o*30+D/2}`).join(" ")),U=u(()=>H(C.chroma,b.tonic));return(o,t)=>{var r;return p(),h("div",{class:"waveform",ref_key:"waveContainer",ref:d},[(p(),h("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${T} ${D}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:t[0]||(t[0]=x=>{n(V)(e.chroma),c.value=!0}),onTouchstart:t[1]||(t[1]=ue(x=>{n(V)(e.chroma),c.value=!0},["prevent","stop"])),onTouchend:t[2]||(t[2]=x=>{n(M)(e.chroma),c.value=!1}),onTouchcancel:t[3]||(t[3]=x=>{n(M)(e.chroma),c.value=!1}),onMouseup:t[4]||(t[4]=x=>{n(M)(e.chroma),c.value=!1}),onMouseleave:t[5]||(t[5]=x=>{n(M)(e.chroma),c.value=!1})},[f("g",{transform:`translate(${n(g)/s.value*T} 10)`},[f("circle",{r:"40",fill:U.value.hsl},null,8,Ne),f("text",Me,k(n(g)*60)+" px/sec",1)],8,Se),Be,(p(!0),h(z,null,j(y.value,(x,I)=>(p(),h("g",{key:I},[f("polyline",{stroke:n(q)(I,n(i)?8:2),points:Y.value[I],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,Ie)]))),128)),f("polyline",{stroke:(r=U.value)==null?void 0:r.hsl,points:ee.value,"stroke-width":"24",fill:"none"},null,8,Te)],40,Ce))],512)}}},Pe=G(De,[["__scopeId","data-v-993ce395"]]);const ze=e=>(J("data-v-1347a5d8"),e=e(),K(),e),je={class:"flex w-full relative px-4"},Fe=["href"],Ue=ze(()=>f("div",{class:"i-la-wikipedia-w"},null,-1)),Ve=[Ue],Ee={class:"text-2xl font-bold capitalize mb-2"},Re={class:"flex items-center mx-2 w-full gap-2"},We={class:"p-4"},Ae={__name:"ChromaProfile",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(e,{emit:C}){const i=e;me({chord:u(()=>E.get(i.chroma)),scale:u(()=>R.get(i.chroma))});const _=u(()=>E.get(i.chroma)),$=u(()=>R.get(i.chroma)),c=u(()=>ye.intervals(i.chroma));u(()=>{let a=[];if(!c.value)return[];for(let s=1;s<c.value.length;s++)a[s-1]=L.semitones(c.value[s])-L.semitones(c.value[s-1]);return a});function m(a){console.log(a,i.chroma,b.tonic);let s=i.chroma;const d=(12-b.tonic+a)%12;if(console.log(d),d==0)return;let l=s.split("");l[d]=l[d]=="0"?"1":"0",C("update:chroma",l.join(""))}return(a,s)=>{const d=Pe,l=fe,g=he,v=pe,N=we,B=te;return p(),h("div",{class:"profile",style:Q({borderColor:n(H)(e.chroma,n(b).tonic).hsl})},[S(d,{chroma:e.chroma},null,8,["chroma"]),f("div",je,[e.link?(p(),h("a",{key:0,class:"p-2 absolute top-8px right-2em",href:e.link,target:"_blank"},Ve,8,Fe)):A("",!0),f("div",Ee,k(n(O)[n(b).tonic])+" "+k(_.value.name||_.value.aliases[0]||$.value.name||e.title)+" "+k($.value.aliases[0]?`(${$.value.aliases[0]})`:""),1)]),e.abc?(p(),de(l,{key:0,abc:e.abc},null,8,["abc"])):A("",!0),f("div",Re,[S(g,{style:{flex:"1 1 400px"},chroma:e.chroma,"onUpdate:chroma":s[0]||(s[0]=y=>a.$emit("update:chroma",y)),pitch:n(b).tonic,title:!1,"onUpdate:pitch":m,playAll:!0},null,8,["chroma","pitch"]),S(v,{style:{flex:"1 1 250px"},chroma:e.chroma},null,8,["chroma"]),S(N,{chroma:e.chroma,"onUpdate:chroma":s[1]||(s[1]=y=>a.$emit("update:chroma",y))},null,8,["chroma"])]),S(B,{class:"mx-2 mb-2",chroma:e.chroma,"onUpdate:chroma":s[2]||(s[2]=y=>a.$emit("update:chroma",y)),editable:e.editable},null,8,["chroma","editable"]),f("div",We,k(e.description),1)],4)}}},at=G(Ae,[["__scopeId","data-v-1347a5d8"]]);export{at as _};
