import{_ as G}from"./ChromaRow.Bne6WU8G.js";import{_ as Q}from"./ChromaCode.DToZCMbv.js";import{_ as X}from"./ChromaCircle.BIx6oDJF.js";import{H as Y,I as ee,r as te,g as _,d as R,p as U,s as C,c as oe,a as V,b as A,J as ae,K as q,n as se,_ as ne}from"./theme.t-3cbqQx.js";import{_ as le}from"./AbcRender.CNgA35HA.js";import{_ as W,e as re,r as $,u as E,av as ie,M as ce,w as ue,c as i,f as g,g as w,l as n,Z as me,h as c,m as k,F as de,j as he,z as H,A as J,b as fe,V as b,q as L,B as pe,p as ve}from"./framework.B7TlvOs3.js";const _e=e=>(H("data-v-2d3d565a"),e=e(),J(),e),ge=["viewBox"],$e=["transform"],we=["fill"],ye={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},xe=_e(()=>c("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),be=["stroke","points"],ke=["stroke","points"],D=4e3,P=300,T=2e3,Se={__name:"ChromaProfileWaveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(e){const{isDark:B}=re(),u=[];for(let o=0;o<13;o++)u[o]=Math.pow(2,o/12);const S=e,y=D/T,r=$(!1),f=$(0),p=$(0),l=$(2e3),a=$(),m=$(1e3),d=Y(E("waveform-speed",1e3),0,l);ee(o=>{const t=o.delta[0]-o.delta[1];d.value+=t},{domTarget:a});const M=ie(p,{duration:m,transition:[.87,-.04,.69,1.13],onFinished:()=>{p.value==0&&N()}}),{resume:I,pause:N}=ce(()=>{f.value+=M.value},{immediate:!1});ue(()=>{r.value?(I(),p.value>0&&(m.value=10),p.value=d.value):(p.value=0,m.value=1e3)});const x=i(()=>{let o=[],t=te(S.chroma.split(""),-_.tonic);for(let s=0;s<12;s++)t[s]==1?o[s]=!0:delete o[s];return o}),v=E("chord-zoom",400);function j(o,t){return Math.sin((t+f.value)*(Math.PI*2*u[o])/v.value)}const K=i(()=>{let o={};for(let t in x.value){o[t]=[];for(let s=0;s<T;s++)o[t].push(`${s*y},${j(Number(t),s)*100+P/2}`)}return o}),O=i(()=>{let o=[];for(let t=0;t<T;t++){o[t]=0;for(let s in x.value){let h=Number(s);o[t]+=j(h,t)}}return o}),Z=i(()=>O.value.map((o,t)=>`${t*y},${o*30+P/2}`).join(" ")),F=i(()=>R(S.chroma,_.tonic));return(o,t)=>{var s;return g(),w("div",{class:"waveform",ref_key:"waveContainer",ref:a},[(g(),w("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${D} ${P}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:t[0]||(t[0]=h=>{n(U)(e.chroma),r.value=!0}),onTouchstart:t[1]||(t[1]=me(h=>{n(U)(e.chroma),r.value=!0},["prevent","stop"])),onTouchend:t[2]||(t[2]=h=>{n(C)(e.chroma),r.value=!1}),onTouchcancel:t[3]||(t[3]=h=>{n(C)(e.chroma),r.value=!1}),onMouseup:t[4]||(t[4]=h=>{n(C)(e.chroma),r.value=!1}),onMouseleave:t[5]||(t[5]=h=>{n(C)(e.chroma),r.value=!1})},[c("g",{transform:`translate(${n(d)/l.value*D} 10)`},[c("circle",{r:"40",fill:F.value.hsl},null,8,we),c("text",ye,k(n(d)*60)+" px/sec",1)],8,$e),xe,(g(!0),w(de,null,he(x.value,(h,z)=>(g(),w("g",{key:z},[c("polyline",{stroke:n(oe)(z,n(B)?8:2),points:K.value[z],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,be)]))),128)),c("polyline",{stroke:(s=F.value)==null?void 0:s.hsl,points:Z.value,"stroke-width":"24",fill:"none"},null,8,ke)],40,ge))],512)}}},Ce=W(Se,[["__scopeId","data-v-2d3d565a"]]),Be=e=>(H("data-v-2041c4a4"),e=e(),J(),e),Me={class:"flex w-full relative px-4"},Ie=["href"],Ne=Be(()=>c("div",{class:"i-la-wikipedia-w"},null,-1)),ze=[Ne],De={class:"text-2xl font-bold capitalize mb-2"},Pe={class:"flex items-center mx-2 w-full gap-2"},Te={class:"p-4"},je={__name:"ChromaProfile",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(e,{emit:B}){const u=e,S=B;fe({chord:i(()=>V(u.chroma)),scale:i(()=>A(u.chroma))});const y=i(()=>V(u.chroma)),r=i(()=>A(u.chroma)),f=i(()=>ae(u.chroma));i(()=>{let l=[];if(!f.value)return[];for(let a=1;a<f.value.length;a++)l[a-1]=q(f.value[a])-q(f.value[a-1]);return l});function p(l){console.log(l,u.chroma,_.tonic);let a=u.chroma;const m=(12-_.tonic+l)%12;if(console.log(m),m==0)return;let d=a.split("");d[m]=d[m]=="0"?"1":"0",S("update:chroma",d.join(""))}return(l,a)=>{const m=Ce,d=le,M=ne,I=X,N=Q,x=G;return g(),w("div",{class:"profile",style:ve({borderColor:n(R)(e.chroma,n(_).tonic).hsl})},[b(m,{chroma:e.chroma},null,8,["chroma"]),c("div",Me,[e.link?(g(),w("a",{key:0,class:"p-2 absolute top-8px right-2em",href:e.link,target:"_blank"},ze,8,Ie)):L("",!0),c("div",De,k(n(se)[n(_).tonic])+" "+k(y.value.aliases[0]||y.value.name||r.value.name||e.title)+" "+k(r.value.aliases[0]?`(${r.value.aliases[0]})`:""),1)]),e.abc?(g(),pe(d,{key:0,abc:e.abc},null,8,["abc"])):L("",!0),c("div",Pe,[b(M,{style:{flex:"1 1 400px"},chroma:e.chroma,"onUpdate:chroma":a[0]||(a[0]=v=>l.$emit("update:chroma",v)),pitch:n(_).tonic,title:!1,"onUpdate:pitch":p,playAll:!0},null,8,["chroma","pitch"]),b(I,{style:{flex:"1 1 250px"},chroma:e.chroma},null,8,["chroma"]),b(N,{chroma:e.chroma,"onUpdate:chroma":a[1]||(a[1]=v=>l.$emit("update:chroma",v))},null,8,["chroma"])]),b(x,{class:"mx-2 mb-2",chroma:e.chroma,"onUpdate:chroma":a[2]||(a[2]=v=>l.$emit("update:chroma",v)),editable:e.editable},null,8,["chroma","editable"]),c("div",Te,k(e.description),1)],4)}}},Le=W(je,[["__scopeId","data-v-2041c4a4"]]);export{Le as _};
