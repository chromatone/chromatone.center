import{_ as H}from"./ChromaRow.BWTpFs7t.js";import{_ as X}from"./ChromaCode.BhHPp_lZ.js";import{_ as Y}from"./ChromaCircle.C3S4RVl6.js";import{_ as Z}from"./ChromaKeys.BWQz6jaq.js";import{_ as ee}from"./AbcRender.Cert0BI7.js";import{D as A,ak as te,r as y,u as V,at as oe,k as ae,w as se,c,E as g,F as w,C as n,Q as ne,G as i,I as x,V as le,W as re,J as O,K as Q,b as ce,O as k,T as W,a2 as ie,L as ue}from"./framework.BtWLkna7.js";import{Q as me,W as de,r as fe,g as _,q as R,t as j,v as C,n as he,l as E,o as L,ac as pe,ae as q,e as ve}from"./theme.BLFxsYN6.js";const _e=e=>(O("data-v-993ce395"),e=e(),Q(),e),ge=["viewBox"],ye=["transform"],we=["fill"],$e={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},be=_e(()=>i("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),ke=["stroke","points"],xe=["stroke","points"],D=4e3,z=300,P=2e3,Se={__name:"ChromaProfileWaveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(e){const{isDark:B}=te(),u=[];for(let o=0;o<13;o++)u[o]=Math.pow(2,o/12);const S=e,$=D/P,r=y(!1),h=y(0),p=y(0),l=y(2e3),a=y(),m=y(1e3),d=me(V("waveform-speed",1e3),0,l);de(o=>{const t=o.delta[0]-o.delta[1];d.value+=t},{domTarget:a});const I=oe(p,{duration:m,transition:[.87,-.04,.69,1.13],onFinished:()=>{p.value==0&&T()}}),{resume:M,pause:T}=ae(()=>{h.value+=I.value},{immediate:!1});se(()=>{r.value?(M(),p.value>0&&(m.value=10),p.value=d.value):(p.value=0,m.value=1e3)});const b=c(()=>{let o=[],t=fe(S.chroma.split(""),-_.tonic);for(let s=0;s<12;s++)t[s]==1?o[s]=!0:delete o[s];return o}),v=V("chord-zoom",400);function F(o,t){return Math.sin((t+h.value)*(Math.PI*2*u[o])/v.value)}const G=c(()=>{let o={};for(let t in b.value){o[t]=[];for(let s=0;s<P;s++)o[t].push(`${s*$},${F(Number(t),s)*100+z/2}`)}return o}),J=c(()=>{let o=[];for(let t=0;t<P;t++){o[t]=0;for(let s in b.value){let f=Number(s);o[t]+=F(f,t)}}return o}),K=c(()=>J.value.map((o,t)=>`${t*$},${o*30+z/2}`).join(" ")),U=c(()=>R(S.chroma,_.tonic));return(o,t)=>{var s;return g(),w("div",{class:"waveform",ref_key:"waveContainer",ref:a},[(g(),w("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${D} ${z}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:t[0]||(t[0]=f=>{n(j)(e.chroma),r.value=!0}),onTouchstart:t[1]||(t[1]=ne(f=>{n(j)(e.chroma),r.value=!0},["prevent","stop"])),onTouchend:t[2]||(t[2]=f=>{n(C)(e.chroma),r.value=!1}),onTouchcancel:t[3]||(t[3]=f=>{n(C)(e.chroma),r.value=!1}),onMouseup:t[4]||(t[4]=f=>{n(C)(e.chroma),r.value=!1}),onMouseleave:t[5]||(t[5]=f=>{n(C)(e.chroma),r.value=!1})},[i("g",{transform:`translate(${n(d)/l.value*D} 10)`},[i("circle",{r:"40",fill:U.value.hsl},null,8,we),i("text",$e,x(n(d)*60)+" px/sec",1)],8,ye),be,(g(!0),w(le,null,re(b.value,(f,N)=>(g(),w("g",{key:N},[i("polyline",{stroke:n(he)(N,n(B)?8:2),points:G.value[N],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,ke)]))),128)),i("polyline",{stroke:(s=U.value)==null?void 0:s.hsl,points:K.value,"stroke-width":"24",fill:"none"},null,8,xe)],40,ge))],512)}}},Ce=A(Se,[["__scopeId","data-v-993ce395"]]),Be=e=>(O("data-v-c4e30b5a"),e=e(),Q(),e),Ie={class:"flex w-full relative px-4"},Me=["href"],Te=Be(()=>i("div",{class:"i-la-wikipedia-w"},null,-1)),Ne=[Te],De={class:"text-2xl font-bold capitalize mb-2"},ze={class:"flex items-center mx-2 w-full gap-2"},Pe={class:"p-4"},Fe={__name:"ChromaProfile",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(e,{emit:B}){const u=e,S=B;ce({chord:c(()=>E.get(u.chroma)),scale:c(()=>L.get(u.chroma))});const $=c(()=>E.get(u.chroma)),r=c(()=>L.get(u.chroma)),h=c(()=>pe.intervals(u.chroma));c(()=>{let l=[];if(!h.value)return[];for(let a=1;a<h.value.length;a++)l[a-1]=q.semitones(h.value[a])-q.semitones(h.value[a-1]);return l});function p(l){console.log(l,u.chroma,_.tonic);let a=u.chroma;const m=(12-_.tonic+l)%12;if(console.log(m),m==0)return;let d=a.split("");d[m]=d[m]=="0"?"1":"0",S("update:chroma",d.join(""))}return(l,a)=>{const m=Ce,d=ee,I=Z,M=Y,T=X,b=H;return g(),w("div",{class:"profile",style:ue({borderColor:n(R)(e.chroma,n(_).tonic).hsl})},[k(m,{chroma:e.chroma},null,8,["chroma"]),i("div",Ie,[e.link?(g(),w("a",{key:0,class:"p-2 absolute top-8px right-2em",href:e.link,target:"_blank"},Ne,8,Me)):W("",!0),i("div",De,x(n(ve)[n(_).tonic])+" "+x($.value.name||$.value.aliases[0]||r.value.name||e.title)+" "+x(r.value.aliases[0]?`(${r.value.aliases[0]})`:""),1)]),e.abc?(g(),ie(d,{key:0,abc:e.abc},null,8,["abc"])):W("",!0),i("div",ze,[k(I,{style:{flex:"1 1 400px"},chroma:e.chroma,"onUpdate:chroma":a[0]||(a[0]=v=>l.$emit("update:chroma",v)),pitch:n(_).tonic,title:!1,"onUpdate:pitch":p,playAll:!0},null,8,["chroma","pitch"]),k(M,{style:{flex:"1 1 250px"},chroma:e.chroma},null,8,["chroma"]),k(T,{chroma:e.chroma,"onUpdate:chroma":a[1]||(a[1]=v=>l.$emit("update:chroma",v))},null,8,["chroma"])]),k(b,{class:"mx-2 mb-2",chroma:e.chroma,"onUpdate:chroma":a[2]||(a[2]=v=>l.$emit("update:chroma",v)),editable:e.editable},null,8,["chroma","editable"]),i("div",Pe,x(e.description),1)],4)}}},Ae=A(Fe,[["__scopeId","data-v-c4e30b5a"]]);export{Ae as _};
