import{_ as Q}from"./ChromaRow.PbkslapZ.js";import{_ as X}from"./ChromaCode.qHickaR6.js";import{_ as Y}from"./ChromaCircle.aG_MVYtA.js";import{_ as Z}from"./ChromaKeys.b0i_1a4Q.js";import{_ as ee}from"./AbcRender.DQ7xTZIp.js";import{_ as W,u as te,i as y,v as U,P as oe,M as ae,D as se,j as i,o as g,c as $,g as n,l as ne,a as c,t as k,F as le,r as re,p as q,d as O,k as ie,f as x,b as A,e as ce,A as me}from"./framework.IUYQRuva.js";import{r as ue}from"./calculations.uITx2GSi.js";import{g as _,c as G,b as V,d as C,n as de}from"./colors.urjlGKwl.js";import"./synth.CnmFLY9j.js";import{u as fe,p as pe}from"./index.dCqutn0Q.js";import{u as he}from"./index.uSR4lzEy.js";import"./index.M7xXh-bS.js";import{i as E}from"./index.he4oviLp.js";import{a as L,b as R,n as ve}from"./theory.KAWplcFe.js";const _e=e=>(q("data-v-993ce395"),e=e(),O(),e),ge=["viewBox"],ye=["transform"],$e=["fill"],we={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},be=_e(()=>c("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),xe=["stroke","points"],ke=["stroke","points"],D=4e3,P=300,z=2e3,Se={__name:"ChromaProfileWaveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(e){const{isDark:M}=te(),m=[];for(let o=0;o<13;o++)m[o]=Math.pow(2,o/12);const S=e,w=D/z,r=y(!1),p=y(0),h=y(0),l=y(2e3),a=y(),u=y(1e3),d=fe(U("waveform-speed",1e3),0,l);he(o=>{const t=o.delta[0]-o.delta[1];d.value+=t},{domTarget:a});const B=oe(h,{duration:u,transition:[.87,-.04,.69,1.13],onFinished:()=>{h.value==0&&N()}}),{resume:I,pause:N}=ae(()=>{p.value+=B.value},{immediate:!1});se(()=>{r.value?(I(),h.value>0&&(u.value=10),h.value=d.value):(h.value=0,u.value=1e3)});const b=i(()=>{let o=[],t=ue(S.chroma.split(""),-_.tonic);for(let s=0;s<12;s++)t[s]==1?o[s]=!0:delete o[s];return o}),v=U("chord-zoom",400);function j(o,t){return Math.sin((t+p.value)*(Math.PI*2*m[o])/v.value)}const H=i(()=>{let o={};for(let t in b.value){o[t]=[];for(let s=0;s<z;s++)o[t].push(`${s*w},${j(Number(t),s)*100+P/2}`)}return o}),J=i(()=>{let o=[];for(let t=0;t<z;t++){o[t]=0;for(let s in b.value){let f=Number(s);o[t]+=j(f,t)}}return o}),K=i(()=>J.value.map((o,t)=>`${t*w},${o*30+P/2}`).join(" ")),F=i(()=>G(S.chroma,_.tonic));return(o,t)=>{var s;return g(),$("div",{class:"waveform",ref_key:"waveContainer",ref:a},[(g(),$("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${D} ${P}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:t[0]||(t[0]=f=>{n(V)(e.chroma),r.value=!0}),onTouchstart:t[1]||(t[1]=ne(f=>{n(V)(e.chroma),r.value=!0},["prevent","stop"])),onTouchend:t[2]||(t[2]=f=>{n(C)(e.chroma),r.value=!1}),onTouchcancel:t[3]||(t[3]=f=>{n(C)(e.chroma),r.value=!1}),onMouseup:t[4]||(t[4]=f=>{n(C)(e.chroma),r.value=!1}),onMouseleave:t[5]||(t[5]=f=>{n(C)(e.chroma),r.value=!1})},[c("g",{transform:`translate(${n(d)/l.value*D} 10)`},[c("circle",{r:"40",fill:F.value.hsl},null,8,$e),c("text",we,k(n(d)*60)+" px/sec",1)],8,ye),be,(g(!0),$(le,null,re(b.value,(f,T)=>(g(),$("g",{key:T},[c("polyline",{stroke:n(de)(T,n(M)?8:2),points:H.value[T],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,xe)]))),128)),c("polyline",{stroke:(s=F.value)==null?void 0:s.hsl,points:K.value,"stroke-width":"24",fill:"none"},null,8,ke)],40,ge))],512)}}},Ce=W(Se,[["__scopeId","data-v-993ce395"]]),Me=e=>(q("data-v-1b596b96"),e=e(),O(),e),Be={class:"flex w-full relative px-4"},Ie=["href"],Ne=Me(()=>c("div",{class:"i-la-wikipedia-w"},null,-1)),Te=[Ne],De={class:"text-2xl font-bold capitalize mb-2"},Pe={class:"flex items-center mx-2 w-full gap-2"},ze={class:"p-4"},je={__name:"ChromaProfile",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(e,{emit:M}){const m=e,S=M;ie({chord:i(()=>L.get(m.chroma)),scale:i(()=>R.get(m.chroma))});const w=i(()=>L.get(m.chroma)),r=i(()=>R.get(m.chroma)),p=i(()=>pe.intervals(m.chroma));i(()=>{let l=[];if(!p.value)return[];for(let a=1;a<p.value.length;a++)l[a-1]=E.semitones(p.value[a])-E.semitones(p.value[a-1]);return l});function h(l){console.log(l,m.chroma,_.tonic);let a=m.chroma;const u=(12-_.tonic+l)%12;if(console.log(u),u==0)return;let d=a.split("");d[u]=d[u]=="0"?"1":"0",S("update:chroma",d.join(""))}return(l,a)=>{const u=Ce,d=ee,B=Z,I=Y,N=X,b=Q;return g(),$("div",{class:"profile",style:me({borderColor:n(G)(e.chroma,n(_).tonic).hsl})},[x(u,{chroma:e.chroma},null,8,["chroma"]),c("div",Be,[e.link?(g(),$("a",{key:0,class:"p-2 absolute top-8px right-2em",href:e.link,target:"_blank"},Te,8,Ie)):A("",!0),c("div",De,k(n(ve)[n(_).tonic])+" "+k(w.value.name||w.value.aliases[0]||r.value.name||e.title)+" "+k(r.value.aliases[0]?`(${r.value.aliases[0]})`:""),1)]),e.abc?(g(),ce(d,{key:0,abc:e.abc},null,8,["abc"])):A("",!0),c("div",Pe,[x(B,{style:{flex:"1 1 400px"},chroma:e.chroma,"onUpdate:chroma":a[0]||(a[0]=v=>l.$emit("update:chroma",v)),pitch:n(_).tonic,title:!1,"onUpdate:pitch":h,playAll:!0},null,8,["chroma","pitch"]),x(I,{style:{flex:"1 1 250px"},chroma:e.chroma},null,8,["chroma"]),x(N,{chroma:e.chroma,"onUpdate:chroma":a[1]||(a[1]=v=>l.$emit("update:chroma",v))},null,8,["chroma"])]),x(b,{class:"mx-2 mb-2",chroma:e.chroma,"onUpdate:chroma":a[2]||(a[2]=v=>l.$emit("update:chroma",v)),editable:e.editable},null,8,["chroma","editable"]),c("div",ze,k(e.description),1)],4)}}},Qe=W(je,[["__scopeId","data-v-1b596b96"]]);export{Qe as _};
