import{_ as K}from"./ChromaRow.3bc63875.js";import{_ as Q}from"./ChromaCode.90a1f396.js";import{_ as X}from"./ChromaCircle.0273aa2c.js";import{_ as Y}from"./ChromaKeys.5e11627e.js";import{_ as Z}from"./AbcRender.d162e618.js";import{_ as q,x as y,L as U,S as ee,O as oe,P as te,b as i,o as g,c as b,u as s,E as ae,a as f,t as S,F as ne,d as se,p as A,q as O,r as le,f as x,l as j,g as re,C as ie}from"./framework.c7ad3ca2.js";import{r as ce}from"./calculations.65ee336d.js";import{g as _,c as R,b as E,e as C,n as me}from"./colors.394b294c.js";import"./synth.97f998a0.js";import{u as ue}from"./index.098dc14b.js";import{u as fe}from"./index.4016c1de.js";import{i as pe}from"./state.94f7e80e.js";import{p as de}from"./index.b30cd6d2.js";import"./index.86652af6.js";import{i as L}from"./index.ab22ef51.js";import{a as V,b as W,n as he}from"./theory.61e5aadb.js";const ve=o=>(A("data-v-eb60c9fe"),o=o(),O(),o),_e=["viewBox"],ge=["transform"],ye=["fill"],be={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},we=ve(()=>f("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),$e=["stroke","points"],xe=["stroke","points"],N=4e3,T=300,z=2e3,ke={__name:"ChromaProfileWaveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(o){const k=o,c=[];for(let t=0;t<13;t++)c[t]=Math.pow(2,t/12);const w=N/z,r=y(!1),d=y(0),h=y(0),l=y(2e3),a=y(),m=y(1e3),u=ue(U("waveform-speed",1e3),0,l);fe(t=>{const e=t.delta[0]-t.delta[1];u.value+=e},{domTarget:a});const B=ee(h,{duration:m,transition:[.87,-.04,.69,1.13],onFinished:()=>{h.value==0&&P()}}),{resume:M,pause:P}=oe(()=>{d.value+=B.value},{immediate:!1});te(()=>{r.value?(M(),h.value>0&&(m.value=10),h.value=u.value):(h.value=0,m.value=1e3)});const $=i(()=>{let t=[],e=ce(k.chroma.split(""),-_.tonic);for(let n=0;n<12;n++)e[n]==1?t[n]=!0:delete t[n];return t}),v=U("chord-zoom",400);function D(t,e){return Math.sin((e+d.value)*(Math.PI*2*c[t])/v.value)}const G=i(()=>{let t={};for(let e in $.value){t[e]=[];for(let n=0;n<z;n++)t[e].push(`${n*w},${D(Number(e),n)*100+T/2}`)}return t}),H=i(()=>{let t=[];for(let e=0;e<z;e++){t[e]=0;for(let n in $.value){let p=Number(n);t[e]+=D(p,e)}}return t}),J=i(()=>H.value.map((t,e)=>`${e*w},${t*30+T/2}`).join(" ")),F=i(()=>R(k.chroma,_.tonic));return(t,e)=>{var n;return g(),b("div",{class:"waveform",ref_key:"waveContainer",ref:a},[(g(),b("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${N} ${T}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:e[0]||(e[0]=p=>{s(E)(o.chroma),r.value=!0}),onTouchstart:e[1]||(e[1]=ae(p=>{s(E)(o.chroma),r.value=!0},["prevent","stop"])),onTouchend:e[2]||(e[2]=p=>{s(C)(o.chroma),r.value=!1}),onTouchcancel:e[3]||(e[3]=p=>{s(C)(o.chroma),r.value=!1}),onMouseup:e[4]||(e[4]=p=>{s(C)(o.chroma),r.value=!1}),onMouseleave:e[5]||(e[5]=p=>{s(C)(o.chroma),r.value=!1})},[f("g",{transform:`translate(${s(u)/l.value*N} 10)`},[f("circle",{r:"40",fill:F.value.hsl},null,8,ye),f("text",be,S(s(u)*60)+" px/sec",1)],8,ge),we,(g(!0),b(ne,null,se($.value,(p,I)=>(g(),b("g",{key:I},[f("polyline",{stroke:s(me)(I,s(pe)?8:2),points:G.value[I],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,$e)]))),128)),f("polyline",{stroke:(n=F.value)==null?void 0:n.hsl,points:J.value,"stroke-width":"24",fill:"none"},null,8,xe)],40,_e))],512)}}},Ce=q(ke,[["__scopeId","data-v-eb60c9fe"]]);const Se=o=>(A("data-v-b3433d9e"),o=o(),O(),o),Be={class:"flex w-full relative px-4"},Me=["href"],Pe=Se(()=>f("div",{class:"i-la-wikipedia-w"},null,-1)),Ie=[Pe],Ne={class:"text-2xl font-bold capitalize mb-2"},Te={class:"flex items-center mx-2 w-full gap-2"},ze={__name:"ChromaProfile",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(o,{emit:k}){const c=o;le({chord:i(()=>V.get(c.chroma)),scale:i(()=>W.get(c.chroma))});const w=i(()=>V.get(c.chroma)),r=i(()=>W.get(c.chroma)),d=i(()=>de.intervals(c.chroma));i(()=>{let l=[];if(!d.value)return[];for(let a=1;a<d.value.length;a++)l[a-1]=L.semitones(d.value[a])-L.semitones(d.value[a-1]);return l});function h(l){console.log(l,c.chroma,_.tonic);let a=c.chroma;const m=(12-_.tonic+l)%12;if(console.log(m),m==0)return;let u=a.split("");u[m]=u[m]=="0"?"1":"0",k("update:chroma",u.join(""))}return(l,a)=>{const m=Ce,u=Z,B=Y,M=X,P=Q,$=K;return g(),b("div",{class:"profile",style:ie({borderColor:s(R)(o.chroma,s(_).tonic).hsl})},[x(m,{chroma:o.chroma},null,8,["chroma"]),f("div",Be,[o.link?(g(),b("a",{key:0,class:"p-2 absolute top-8px right-2em",href:o.link,target:"_blank"},Ie,8,Me)):j("",!0),f("div",Ne,S(s(he)[s(_).tonic])+" "+S(w.value.name||w.value.aliases[0]||r.value.name||"?")+" "+S(r.value.aliases[0]?`(${r.value.aliases[0]})`:""),1)]),o.abc?(g(),re(u,{key:0,abc:o.abc},null,8,["abc"])):j("",!0),f("div",Te,[x(B,{style:{flex:"1 1 400px"},chroma:o.chroma,"onUpdate:chroma":a[0]||(a[0]=v=>l.$emit("update:chroma",v)),pitch:s(_).tonic,title:!1,"onUpdate:pitch":h,playAll:!0},null,8,["chroma","pitch"]),x(M,{style:{flex:"1 1 250px"},chroma:o.chroma},null,8,["chroma"]),x(P,{chroma:o.chroma,"onUpdate:chroma":a[1]||(a[1]=v=>l.$emit("update:chroma",v))},null,8,["chroma"])]),x($,{class:"mx-2 mb-2",chroma:o.chroma,"onUpdate:chroma":a[2]||(a[2]=v=>l.$emit("update:chroma",v)),editable:o.editable},null,8,["chroma","editable"])],4)}}},Qe=q(ze,[["__scopeId","data-v-b3433d9e"]]);export{Qe as _};
