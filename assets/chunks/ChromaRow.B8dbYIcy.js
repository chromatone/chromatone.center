import{_ as V,H as A,G as p,q as d,f,s,v as x,u as t,z as c,F as w,Q as C,y as z,t as H,a7 as D,k as J}from"./framework.D01lOa8K.js";import{G as I,F as K,H as Q,b as U,a as W,n as O,r as T,g as r,I as X,l as Y,d as k,s as $,J as Z,w as _,e as q,K as ee,p as te}from"./theme.7_GhOmt2.js";const se={class:"flex w-full rounded-xl overflow-hidden"},oe={class:"flex flex-wrap items-center justify-stretch w-full text-sm px-2 bg-dark-800 bg-opacity-10"},le={class:"p-2px"},ae={class:"flex font-bold",title:"Intervals"},ne={class:"flex",title:"Steps"},re={class:"p-1",title:"Pcset number"},ie={class:"mr-1"},ce={class:"flex-1"},me={class:"font-bold -mt-2px"},ue={class:"flex justify-stretch mx-auto w-full p-2"},de=["onMouseenter","onTouchstart","onClick"],fe={__name:"ChromaRow",props:{chroma:{type:String,default:""},twoRow:{type:Boolean,default:!0},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(i,{emit:E}){const G=E,v=i,a=A({minor:"101101011010",chord:p(()=>W(v.chroma)),scale:p(()=>U(v.chroma)),num:p(()=>Q(v.chroma)),intervals:p(()=>K(v.chroma)),semitones:p(()=>{let o=[];if(!a.intervals)return[];for(let e=1;e<a.intervals.length;e++)o[e-1]=I(a.intervals[e])-I(a.intervals[e-1]);return o})});function N(o,e){var m;e==1&&q(o+((m=r)==null?void 0:m.tonic)+57)}function L(o){if(!v.editable||o==0)return;let e=[...v.chroma.split("")];e[o]=="1"?e[o]="0":e[o]="1",G("update:chroma",e.join(""))}const R=[...O].map((o,e)=>({name:o,pitch:e})),S=p(()=>{var u,h;let o=T(v.chroma.split(""),-((u=r)==null?void 0:u.tonic)),m=T(R,-((h=r)==null?void 0:h.tonic)).map((y,g)=>{var b;return X(y.pitch+((b=r)==null?void 0:b.tonic)+57,"midi").toNote()}).filter((y,g)=>{if(o[g]=="1")return!0});return Y(m)});function B(o=!1){var m;let e=[...S.value];if(o){e.push(((m=r)==null?void 0:m.tonic)+57+12);let u=[...S.value].reverse();e=[...e,...u]}e.forEach((u,h)=>{setTimeout(()=>{q(u)},h*1e3/(2*ee.bpm/60))})}return(o,e)=>{var m,u,h,y,g,b,P,j;return f(),d("div",se,[s("div",{class:"w-3 flex flex-col items-center text-white text-opacity-90",style:x({backgroundColor:t(k)(i.chroma,(m=t(r))==null?void 0:m.tonic).hsl})},null,4),s("div",{class:"flex flex-col items-start w-full relative shadow-lg",style:x({backgroundColor:t(_)(t(k)(i.chroma,(u=t(r))==null?void 0:u.tonic).hsl).alpha(.1).toHex()})},[s("div",oe,[s("div",le,c(i.chroma),1),e[6]||(e[6]=s("div",{class:"flex-1"},null,-1)),s("div",ae,[(f(!0),d(w,null,C(a.intervals,l=>(f(),d("div",{class:"p-2px",key:l},c(l),1))),128))]),e[7]||(e[7]=s("div",{class:"flex-1"},null,-1)),s("div",ne,[(f(!0),d(w,null,C(a.semitones,(l,n)=>(f(),d("span",{key:n},c(n!=0?"-":"")+c(l),1))),128))]),e[8]||(e[8]=s("div",{class:"flex-1"},null,-1)),s("div",re,"# "+c(a.num),1)]),s("div",{class:z(["flex flex-wrap items-center justify-between p-2 gap-2",{"w-full":!0}])},[s("button",{class:"text-button text-white font-bold text-md flex gap-1",style:x({backgroundColor:t(k)(i.chroma,(h=t(r))==null?void 0:h.tonic).hsl}),onPointerdown:e[0]||(e[0]=D(l=>t(te)(i.chroma),["prevent","stop"])),onPointerout:e[1]||(e[1]=l=>t($)(i.chroma)),onPointerup:e[2]||(e[2]=l=>t($)(i.chroma)),onPointerleave:e[3]||(e[3]=l=>t($)(i.chroma))},[s("span",ie,c((y=t(r))==null?void 0:y.note.name)+c(a.chord.aliases[0]||" "+a.scale.name),1)],36),s("div",ce,[J(o.$slots,"default",{},void 0,!0)]),a.chord.name||a.chord.aliases[0]?(f(),d("button",{key:0,class:"text-sm flex items-center gap-1 border-2 p-2 rounded-xl",style:x({borderColor:t(k)(i.chroma,(g=t(r))==null?void 0:g.tonic).hsl}),onClick:e[4]||(e[4]=l=>B())},[e[9]||(e[9]=s("div",{class:"i-la-play"},null,-1)),s("div",me,c((b=t(r))==null?void 0:b.note.name)+" "+c(a.chord.name||a.chord.aliases[0]),1)],4)):H("",!0),a.scale.name?(f(),d("button",{key:1,class:"text-button text-sm flex items-center",style:x({borderColor:t(k)(i.chroma,(P=t(r))==null?void 0:P.tonic).hsl}),onClick:e[5]||(e[5]=l=>B(!0))},[e[10]||(e[10]=s("div",{class:"i-la-play -mt-1 mr-1"},null,-1)),s("span",null,c((j=t(r))==null?void 0:j.note.name)+" "+c(a.scale.name)+" scale",1)],4)):H("",!0)]),s("div",ue,[(f(!0),d(w,null,C(i.chroma,(l,n)=>{var F;return f(),d("div",{class:z(["chroma-key text-xs",{active:l==1}]),onMouseenter:M=>N(n,l),onTouchstart:M=>N(n,l),key:n,onClick:M=>L(n),style:x({backgroundColor:t(Z)(n,l),marginLeft:n==1||n==3||n==5||n==7||n==8||n==10?"12px":"2px"})},c(l==1?t(O)[(n+((F=t(r))==null?void 0:F.tonic))%12]:""),47,de)}),128))])],4)])}}},pe=V(fe,[["__scopeId","data-v-f971559e"]]);export{pe as _};
