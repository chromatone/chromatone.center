import{_ as Q,r as J,d as x,v as d,x as f,z as s,E as p,u as t,D as u,F as C,A as $,y as z,T as K,H as U,G as E}from"./framework.BMHKg3V0.js";import{a as W,b as X,Q as Y,O as Z,P as R,n as q,r as A,g as i,F as N,o as _,d as w,p as D,s as k,R as ee,w as te,e as H}from"./theme.C1cSeBFq.js";const oe={class:"flex w-full rounded-xl overflow-hidden"},se={class:"flex flex-wrap items-center justify-stretch w-full text-sm px-2 bg-dark-800 bg-opacity-10"},le={class:"p-2px"},ae={class:"flex font-bold",title:"Intervals"},ne={class:"flex",title:"Steps"},re={class:"p-1",title:"Pcset number"},ie={class:"mr-1"},ce={class:"flex-1"},ue={class:"font-bold -mt-2px"},me={class:"flex justify-stretch mx-auto w-full p-2"},de=["onMouseenter","onTouchstart","onClick"],fe={__name:"ChromaRow",props:{chroma:{type:String,default:""},twoRow:{type:Boolean,default:!0},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(r,{emit:I}){const L=I,v=r,a=J({minor:"101101011010",chord:x(()=>W(v.chroma)),scale:x(()=>X(v.chroma)),num:x(()=>Y(v.chroma)),intervals:x(()=>Z(v.chroma)),semitones:x(()=>{let o=[];if(!a.intervals)return[];for(let e=1;e<a.intervals.length;e++)o[e-1]=R(a.intervals[e])-R(a.intervals[e-1]);return o})});function M(o,e){var c;e==1&&G(o+((c=i)==null?void 0:c.tonic))}function P(o){if(!v.editable||o==0)return;let e=[...v.chroma.split("")];e[o]=="1"?e[o]="0":e[o]="1",L("update:chroma",e.join(""))}const V=[...q].map((o,e)=>({name:o,pitch:e})),S=x(()=>{var m,h;let o=A(v.chroma.split(""),-((m=i)==null?void 0:m.tonic)),c=A(V,-((h=i)==null?void 0:h.tonic)).map((y,g)=>{var b;return N(y.pitch+((b=i)==null?void 0:b.tonic)+57,"midi").toNote()}).filter((y,g)=>{if(o[g]=="1")return!0});return _(c)});function B(o=!1){var c;let e=[...S.value];if(o){e.push(N(((c=i)==null?void 0:c.tonic)+57+12,"midi").toNote());let m=[...S.value].reverse();e=[...e,...m]}e.forEach((m,h)=>{H(m)})}function G(o=0,e=0){let c=N(o+57,"midi");H(c.toNote())}return(o,e)=>{var c,m,h,y,g,b,T,j;return d(),f("div",oe,[s("div",{class:"w-3 flex flex-col items-center text-white text-opacity-90",style:p({backgroundColor:t(w)(r.chroma,(c=t(i))==null?void 0:c.tonic).hsl})},null,4),s("div",{class:"flex flex-col items-start w-full relative shadow-lg",style:p({backgroundColor:t(te)(t(w)(r.chroma,(m=t(i))==null?void 0:m.tonic).hsl).alpha(.1).toHex()})},[s("div",se,[s("div",le,u(r.chroma),1),e[8]||(e[8]=s("div",{class:"flex-1"},null,-1)),s("div",ae,[(d(!0),f(C,null,$(a.intervals,l=>(d(),f("div",{class:"p-2px",key:l},u(l),1))),128))]),e[9]||(e[9]=s("div",{class:"flex-1"},null,-1)),s("div",ne,[(d(!0),f(C,null,$(a.semitones,(l,n)=>(d(),f("span",{key:n},u(n!=0?"-":"")+u(l),1))),128))]),e[10]||(e[10]=s("div",{class:"flex-1"},null,-1)),s("div",re,"# "+u(a.num),1)]),s("div",{class:z(["flex flex-wrap items-center justify-between p-2 gap-2",{"w-full":!0}])},[s("button",{class:"text-button text-white font-bold text-md flex gap-1",style:p({backgroundColor:t(w)(r.chroma,(h=t(i))==null?void 0:h.tonic).hsl}),onMousedown:e[0]||(e[0]=l=>t(D)(r.chroma)),onTouchstart:e[1]||(e[1]=K(l=>t(D)(r.chroma),["prevent","stop"])),onTouchend:e[2]||(e[2]=l=>t(k)(r.chroma)),onTouchcancel:e[3]||(e[3]=l=>t(k)(r.chroma)),onMouseup:e[4]||(e[4]=l=>t(k)(r.chroma)),onMouseleave:e[5]||(e[5]=l=>t(k)(r.chroma))},[s("span",ie,u((y=t(i))==null?void 0:y.note.name)+u(a.chord.aliases[0]||" "+a.scale.name),1)],36),s("div",ce,[U(o.$slots,"default",{},void 0,!0)]),a.chord.name||a.chord.aliases[0]?(d(),f("button",{key:0,class:"text-sm flex items-center gap-1 border-2 p-2 rounded-xl",style:p({borderColor:t(w)(r.chroma,(g=t(i))==null?void 0:g.tonic).hsl}),onClick:e[6]||(e[6]=l=>B())},[e[11]||(e[11]=s("div",{class:"i-la-play"},null,-1)),s("div",ue,u((b=t(i))==null?void 0:b.note.name)+" "+u(a.chord.name||a.chord.aliases[0]),1)],4)):E("",!0),a.scale.name?(d(),f("button",{key:1,class:"text-button text-sm flex items-center",style:p({borderColor:t(w)(r.chroma,(T=t(i))==null?void 0:T.tonic).hsl}),onClick:e[7]||(e[7]=l=>B(!0))},[e[12]||(e[12]=s("div",{class:"i-la-play -mt-1 mr-1"},null,-1)),s("span",null,u((j=t(i))==null?void 0:j.note.name)+" "+u(a.scale.name)+" scale",1)],4)):E("",!0)]),s("div",me,[(d(!0),f(C,null,$(r.chroma,(l,n)=>{var F;return d(),f("div",{class:z(["chroma-key text-xs",{active:l==1}]),onMouseenter:O=>M(n,l),onTouchstart:O=>M(n,l),key:n,onClick:O=>P(n),style:p({backgroundColor:t(ee)(n,l),marginLeft:n==1||n==3||n==5||n==7||n==8||n==10?"12px":"2px"})},u(l==1?t(q)[(n+((F=t(i))==null?void 0:F.tonic))%12]:""),47,de)}),128))])],4)])}}},xe=Q(fe,[["__scopeId","data-v-0ffcdc15"]]);export{xe as _};
