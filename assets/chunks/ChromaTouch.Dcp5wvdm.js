import{r as S,g as v,c as P,aE as I,v as V,y as D,n as E,a_ as F}from"./theme.Dgmu0i8S.js";import{y as u,z as f,O as B,T as G,H as A,u as s,G as _,I as H,v as L,x as R,a as M,r as W,d as j,w as q,n as J,B as d,F as T,C as p}from"./framework.BhJJX2Rg.js";import{_ as K}from"./SvgRing.hfMpaXbr.js";const Q={class:"sector"},U={__name:"ChromaTouchSector",props:{pressed:{type:Boolean,default:!1},octave:{type:Number,default:0},octaves:{type:Number,default:4},startOctave:{type:Number,default:1},size:{type:Number,default:50},n:{type:Number,default:0},note:{type:String,default:""}},setup(e){return(N,y)=>{const x=K;return u(),f("g",Q,[B(x,{cx:0,cy:0,radius:e.size-e.octave*(e.size/e.octaves),thickness:e.size/e.octaves,from:e.n*30-15,to:(e.n+1)*30-15,fill:s(P)(e.n,e.octave+e.startOctave,s(S)(s(v).chroma,-s(v).tonic)[e.n]==1?1:.1,s(I)[e.n+(e.octave+e.startOctave+2)*12+9]?1:.6)},{default:G(()=>[e.octave==0?(u(),f("text",{key:0,class:"fill-black text-4px",style:A({fontWeight:s(S)(s(v).chroma,-s(v).tonic)[e.n]==1?"bold":"normal",fontSize:s(v).tonic==e.n?"8px":"4px"}),y:"1"},_(e.note),5)):H("",!0)]),_:1},8,["radius","thickness","from","to","fill"])])}}},X=["viewBox"],Y={class:"octaves"},Z={class:"touches"},ee=["stroke","x2","y2"],te=["transform"],oe=["fill"],ae={class:"fill-black text-6px"},ne={__name:"ChromaTouch",setup(e){const{isDark:N}=R(),y=M(4),x=M(1),i={pad:2,r:50},b=M(),r=W({}),O=j(()=>{const t={};for(let o in r){const{angle:c,distance:a}=r[o],n=Math.ceil((c-15)/30)%12,m=Math.floor((1-a)*y.value+x.value-2),l=(m+4)*12+n-3;t[o]={pitch:n,octave:m,num:l}}return t});function w({clientX:t,clientY:o}){const c=b.value.createSVGPoint();c.x=t,c.y=o;let{x:a,y:n}=c.matrixTransform(b.value.getScreenCTM().inverse());return{x:a,y:n,angle:180*(Math.PI-Math.atan2(a,n))/Math.PI,distance:Math.hypot(a,n)/i.r}}function h(t){t.type=="mousedown"?r.mouse=w(t):["mouseup","mouseleave","mouseout"].includes(t.type)?delete r.mouse:r.mouse&&t.type=="mousemove"&&(r.mouse=w(t))}function g(t){for(let o of t.changedTouches)["touchend","touchcancel"].includes(t.type)?delete r[o.identifier]:r[o.identifier]=w(o)}return q(O,(t,o)=>{var c,a,n,m;for(let l in t)((c=t[l])==null?void 0:c.num)!=((a=o[l])==null?void 0:a.num)&&V(((n=t[l])==null?void 0:n.pitch)+57+((m=t[l])==null?void 0:m.octave)*12);J(()=>{var l,C,$,z;for(let k in o)((l=o[k])==null?void 0:l.num)!=((C=t[k])==null?void 0:C.num)&&D((($=o[k])==null?void 0:$.pitch)+57+((z=o[k])==null?void 0:z.octave)*12)})}),(t,o)=>{var c;return u(),f("svg",{class:"select-none touch-action-none max-h-full",ref_key:"svg",ref:b,version:"1.1",baseProfile:"full",viewBox:`${-i.r-i.pad} ${-i.r-i.pad} ${i.r*2+2*i.pad} ${i.r*2+2*i.pad}`,xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none","-webkit-user-select":"none !important","-webkit-touch-callout":"none"},"font-family":"Commissioner, sans-serif","text-anchor":"middle","dominant-baseline":"middle",onTouchstart:g,onTouchmove:g,onTouchend:g,onTouchcancel:g,onMouseenter:h,onMousemove:h,onMousedown:h,onMouseup:h,onMouseleave:h},[d("g",Y,[(u(!0),f(T,null,p(y.value,(a,n)=>(u(),f("g",{class:"octave op-90",key:n},[(u(!0),f(T,null,p(s(E),(m,l)=>(u(),f("g",{key:m},[B(U,{n:l,note:m,octave:n,octaves:y.value,"start-octave":x.value,size:i.r},null,8,["n","note","octave","octaves","start-octave","size"])]))),128))]))),128)),d("g",Z,[(u(!0),f(T,null,p(r,(a,n)=>(u(),f("g",{class:"touch",key:n},[d("line",{"stroke-linecap":"round",stroke:`hsl(${a.angle}deg, 50%,50%)`,x2:a.x,y2:a.y},null,8,ee),d("g",{transform:`translate(${a.x} ${a.y})`},[d("circle",{r:"2",fill:s(N)?"#fff3":"#3333"},null,8,oe)],8,te)]))),128))])]),d("text",ae,_((c=s(F))==null?void 0:c[0]),1)],40,X)}}},ie=L(ne,[["__scopeId","data-v-df0b979c"]]);export{ie as default};
