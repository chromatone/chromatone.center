import{ag as l,H as L,w as y,a as O,g as r,_ as V}from"./theme.BxOLoZmJ.js";import{q as $,L as G,ax as K,aT as X,r as S,c as s,f as Q,d as U,v as u,x as c,z as t,G as o,E as p,D as d,y as W,F as h,A as m,X as Y,J as Z,K as tt}from"./framework.C3BURm3f.js";const T=f=>(Z("data-v-49e053a4"),f=f(),tt(),f),et={class:"bg-light-900 dark-bg-dark-800",id:"screen"},at=T(()=>t("div",{class:"text-4xl text-center"},"RANDOM JAM ",-1)),st={class:"flex items-center justify-between gap-2"},ot=T(()=>t("div",{class:"i-system-uicons-reset -scale-y-100"},null,-1)),lt=[ot],nt={class:"overflow-clip rounded-lg flex items-center border-1 relative border-dark-200 border-op-30 dark-border-light-200 dark-border-op-40 py-6"},rt={class:"absolute left-2 z-10"},it={class:"absolute right-2 z-10"},ut={class:"flex flex-wrap gap-4 text-center relative items-center justify-stretch mb-8"},ct={class:"flex flex-col gap-2 w-full max-h-30vh"},dt={class:"flex flex-col gap-2 w-full"},vt={class:"flex gap-2 w-full"},pt={class:"flex gap-2 w-full"},ht={class:"flex gap-2 w-full"},mt={class:"flex gap-2 w-full"},ft={class:"flex gap-2 w-full"},xt=T(()=>t("div",{class:"flex-0"},null,-1)),_t={__name:"JamRandom",setup(f){const{isDark:z}=G();var j=102,A=20;function F(e,b){let D=1-Math.random(),g=1-Math.random();var M=Math.sqrt(-2*Math.log(D))*Math.cos(2*Math.PI*g);return e+b*M}const H=K(()=>l.bpm,{duration:1e3,transition:X.easeInOutCubic}),x=S(!1),_=S(Date.now()),k=L(256,64,1024);function B(){x.value||(l.stopped=!0,x.value=!0,l.bpm=Math.round(F(j,A)),r.chroma=Math.random()>.7?"101011010101":"101101011010",r.tonic=Math.round(Math.random()*12),setTimeout(()=>{x.value=!1,l.playing=!0,_.value=Date.now()},1e3))}const i=s(()=>{var e;return(e=l.position)==null?void 0:e.split(":").map(Number)}),N=s(()=>{var e;return((e=i.value)==null?void 0:e[0])/k.value}),n=s(()=>y(l.color).lighten(z.value?0:.3).desaturate(.2).toHex()),I=s(()=>y(O(r.tonic)).lighten(z.value?0:.3).desaturate(.2).toHex()),w=s(()=>y(n.value).mix(I.value).toHex()),J=e=>[Math.floor(e),Math.round((e-Math.floor(e))*60)],P=e=>Math.round(e*60*1e3);s(()=>J(k.value*4/l.bpm));const R=s(()=>P(k.value*4/l.bpm)),C=s(()=>_.value+R.value),v=Q(),q=s(()=>[Math.floor((v.value-_.value)/(1e3*60)),Math.round((v.value-_.value)%(1e3*60)/1e3)]),E=s(()=>[Math.floor((C.value-v.value)/(1e3*60)),Math.round((C.value-v.value)%(1e3*60)/1e3)]);return U(v,e=>{e>C.value&&B()}),S(!1),(e,b)=>{var g,M;const D=V;return u(),c("div",et,[t("div",{class:"flex flex-col gap-4 p-4 justify-between relative items-stretch min-h-100vh transition duration-1000",style:o({backgroundColor:d(y)(w.value).alpha(.3).toHex()})},[at,t("div",st,[t("div",{class:"text-center text-2xl sm-text-4xl tabular-nums rounded-full px-4 py-2 shadow",style:o([{flex:"1 1 140px"},{backgroundColor:n.value}])},p(d(H).toFixed())+" BPM",5),t("button",{class:"transition duration-1000 text-4xl bg-dark-400 p-4 rounded-full shadow-xl",onClick:b[0]||(b[0]=a=>B()),style:o({backgroundColor:w.value})},[t("div",{class:W(["p-0",{"animate-spin":x.value}])},lt,2)],4),t("div",{class:"text-2xl sm-text-4xl text-center rounded-full px-4 py-2 shadow",style:o([{flex:"1 1 140px"},{backgroundColor:I.value}])},p(d(r).note.name)+" "+p((M=(g=d(r))==null?void 0:g.set)==null?void 0:M.name),5)]),t("div",nt,[t("div",rt,p(q.value.filter(Boolean).join(" m "))+" s",1),t("div",it,"-"+p(E.value.filter(Boolean).join(" m "))+" s",1),t("div",{class:"bg-dark-400 transition duration-300 top-0 bottom-0 left-0 absolute flex items-center",style:o({backgroundColor:w.value,width:`${N.value*100}%`})},null,4)]),t("div",ut,[t("div",ct,[t("div",dt,[t("div",vt,[(u(),c(h,null,m(4,a=>t("div",{class:"p-1 bit",style:o({backgroundColor:a-1==i.value[1]?n.value:"transparent"})},null,4)),64))]),t("div",pt,[(u(),c(h,null,m(4,a=>t("div",{class:"p-2 bit",style:o({backgroundColor:a-1==i.value[0]%4?n.value:"transparent"})},null,4)),64))]),t("div",ht,[(u(),c(h,null,m(4,a=>t("div",{class:"p-3 bit",style:o({backgroundColor:a-1==Math.floor(i.value[0]/4)%4?n.value:"transparent"})},null,4)),64))]),t("div",mt,[(u(),c(h,null,m(4,a=>t("div",{class:"p-4 bit",style:o({backgroundColor:a-1==Math.floor(i.value[0]/4/4)%4?n.value:"transparent"})},null,4)),64))]),t("div",ft,[(u(),c(h,null,m(4,a=>t("div",{class:"p-5 bit",style:o({backgroundColor:a-1==Math.floor(i.value[0]/4/4/4)%4?n.value:"transparent"})},null,4)),64))])])])]),Y(D,{class:"max-h-35vh",title:!1,chroma:d(r).chroma,pitch:d(r).tonic},null,8,["chroma","pitch"]),xt],4)])}}},Mt=$(_t,[["__scopeId","data-v-49e053a4"]]);export{Mt as default};
