import{O as n,H as P,w as M,c as q,g as i,_ as E}from"./theme.ChOOrrTG.js";import{q as V,v as $,av as G,aQ as L,r as D,c as s,f as Q,d as K,x as c,y as d,A as t,H as o,G as m,E as v,z as U,F as f,B as h,R as W}from"./framework.DZXgQweA.js";const X={class:"bg-light-900 dark-bg-dark-800",id:"screen"},Y={class:"flex items-center justify-between gap-2"},Z={class:"overflow-clip rounded-lg flex items-center border-1 relative border-dark-200 border-op-30 dark-border-light-200 dark-border-op-40 py-6"},tt={class:"absolute left-2 z-10"},et={class:"absolute right-2 z-10"},at={class:"flex flex-wrap gap-4 text-center relative items-center justify-stretch mb-8"},lt={class:"flex flex-col gap-2 w-full max-h-30vh"},st={class:"flex flex-col gap-2 w-full"},ot={class:"flex gap-2 w-full"},nt={class:"flex gap-2 w-full"},rt={class:"flex gap-2 w-full"},it={class:"flex gap-2 w-full"},ut={class:"flex gap-2 w-full"},ct={__name:"JamRandom",setup(dt){const{isDark:B}=$();var T=102,j=20;function A(e,a){let C=1-Math.random(),g=1-Math.random();var _=Math.sqrt(-2*Math.log(C))*Math.cos(2*Math.PI*g);return e+a*_}const F=G(()=>n.bpm,{duration:1e3,transition:L.easeInOutCubic}),x=D(!1),b=D(Date.now()),y=P(256,64,1024);function z(){x.value||(n.stopped=!0,x.value=!0,n.bpm=Math.round(A(T,j)),i.chroma=Math.random()>.7?"101011010101":"101101011010",i.tonic=Math.round(Math.random()*12),setTimeout(()=>{x.value=!1,n.playing=!0,b.value=Date.now()},1e3))}const u=s(()=>{var e;return(e=n.position)==null?void 0:e.split(":").map(Number)}),N=s(()=>{var e;return((e=u.value)==null?void 0:e[0])/y.value}),r=s(()=>M(n.color).lighten(B.value?0:.3).desaturate(.2).toHex()),H=s(()=>M(q(i.tonic)).lighten(B.value?0:.3).desaturate(.2).toHex()),k=s(()=>M(r.value).mix(H.value).toHex()),S=e=>[Math.floor(e),Math.round((e-Math.floor(e))*60)],R=e=>Math.round(e*60*1e3);s(()=>S(y.value*4/n.bpm));const I=s(()=>R(y.value*4/n.bpm)),w=s(()=>b.value+I.value),p=Q(),J=s(()=>[Math.floor((p.value-b.value)/(1e3*60)),Math.round((p.value-b.value)%(1e3*60)/1e3)]),O=s(()=>[Math.floor((w.value-p.value)/(1e3*60)),Math.round((w.value-p.value)%(1e3*60)/1e3)]);return K(p,e=>{e>w.value&&z()}),D(!1),(e,a)=>{var g,_;const C=E;return c(),d("div",X,[t("div",{class:"flex flex-col gap-4 p-4 justify-between relative items-stretch min-h-100vh transition duration-1000",style:o({backgroundColor:v(M)(k.value).alpha(.3).toHex()})},[a[2]||(a[2]=t("div",{class:"text-4xl text-center"},"RANDOM JAM ",-1)),t("div",Y,[t("div",{class:"text-center text-2xl sm-text-4xl tabular-nums rounded-full px-4 py-2 shadow",style:o([{flex:"1 1 140px"},{backgroundColor:r.value}])},m(v(F).toFixed())+" BPM",5),t("button",{class:"transition duration-1000 text-4xl bg-dark-400 p-4 rounded-full shadow-xl",onClick:a[0]||(a[0]=l=>z()),style:o({backgroundColor:k.value})},[t("div",{class:U(["p-0",{"animate-spin":x.value}])},a[1]||(a[1]=[t("div",{class:"i-system-uicons-reset -scale-y-100"},null,-1)]),2)],4),t("div",{class:"text-2xl sm-text-4xl text-center rounded-full px-4 py-2 shadow",style:o([{flex:"1 1 140px"},{backgroundColor:H.value}])},m(v(i).note.name)+" "+m((_=(g=v(i))==null?void 0:g.set)==null?void 0:_.name),5)]),t("div",Z,[t("div",tt,m(J.value.filter(Boolean).join(" m "))+" s",1),t("div",et,"-"+m(O.value.filter(Boolean).join(" m "))+" s",1),t("div",{class:"bg-dark-400 transition duration-300 top-0 bottom-0 left-0 absolute flex items-center",style:o({backgroundColor:k.value,width:`${N.value*100}%`})},null,4)]),t("div",at,[t("div",lt,[t("div",st,[t("div",ot,[(c(),d(f,null,h(4,l=>t("div",{class:"p-1 bit",style:o({backgroundColor:l-1==u.value[1]?r.value:"transparent"})},null,4)),64))]),t("div",nt,[(c(),d(f,null,h(4,l=>t("div",{class:"p-2 bit",style:o({backgroundColor:l-1==u.value[0]%4?r.value:"transparent"})},null,4)),64))]),t("div",rt,[(c(),d(f,null,h(4,l=>t("div",{class:"p-3 bit",style:o({backgroundColor:l-1==Math.floor(u.value[0]/4)%4?r.value:"transparent"})},null,4)),64))]),t("div",it,[(c(),d(f,null,h(4,l=>t("div",{class:"p-4 bit",style:o({backgroundColor:l-1==Math.floor(u.value[0]/4/4)%4?r.value:"transparent"})},null,4)),64))]),t("div",ut,[(c(),d(f,null,h(4,l=>t("div",{class:"p-5 bit",style:o({backgroundColor:l-1==Math.floor(u.value[0]/4/4/4)%4?r.value:"transparent"})},null,4)),64))])])])]),W(C,{class:"max-h-35vh",title:!1,chroma:v(i).chroma,pitch:v(i).tonic},null,8,["chroma","pitch"]),a[3]||(a[3]=t("div",{class:"flex-0"},null,-1))],4)])}}},mt=V(ct,[["__scopeId","data-v-49e053a4"]]);export{mt as default};
