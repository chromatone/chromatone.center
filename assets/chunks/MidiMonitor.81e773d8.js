import{_ as b,m as C,n as I,o as l,c as u,a as d,t as x,v as w,k as S,y as j,h as _,i as B,F as g,r as $,f as k,p as T,e as O}from"./framework.916f0e04.js";import{n as D}from"./colors.31585d6f.js";import{c as U}from"./index.2afda254.js";import"./index.86652af6.js";import{u as z,i as N,s as A}from"./midi.051dff15.js";import"./index.b30cd6d2.js";const F={class:"cc"},P={class:"p-1 text-center flex-1"},E={__name:"MidiMonitorCc",props:{cc:{type:Object,default:()=>{}}},emits:["update"],setup(t,{emit:o}){const v=t;let s=0;function f({movement:[r],dragging:p}){let i=r/2-s;s=r/2,p||(s=0);let e=Math.round(v.cc.raw+i);e>127&&(e=127),e<0&&(e=0),o("update",e)}return(r,p)=>{var e,c;const i=C("drag");return I((l(),u("div",F,[d("div",P,x((e=t.cc)==null?void 0:e.number),1),d("div",{class:"absolute h-full z-10 bg-gray-500 top-0 bg-opacity-40 self-start",style:w({width:((c=t.cc)==null?void 0:c.value)*100+"%"})},null,4)])),[[i,f]])}}},L=b(E,[["__scopeId","data-v-5d5f8574"]]);const R={class:"font-bold"},V={class:"text-sm"},q={__name:"MidiMonitorNote",props:{note:{type:Object,default:()=>{}},active:Boolean},emits:["play","stop","update:active"],setup(t,{emit:o}){const v=t,s=S(!1);function f(){s.value=!0,o("update:active",!0),o("play")}function r(i=!1){s.value&&(s.value=!1,i||o("update:active",!1),o("stop"))}function p(){v.active&&!s.value&&(s.value=!0,o("update:active",!0),o("play"))}return(i,e)=>{var c,m,a;return l(),u("div",{class:"note",onMousedown:e[0]||(e[0]=n=>f()),onMouseup:e[1]||(e[1]=n=>r()),onMouseleave:e[2]||(e[2]=n=>r(!0)),onTouchstart:e[3]||(e[3]=j(n=>f(),["prevent"])),onTouchend:e[4]||(e[4]=n=>r()),onMousemove:e[5]||(e[5]=n=>p()),onTouchmove:e[6]||(e[6]=n=>p()),style:w({backgroundColor:_(D)(t.note.pitch,t.note.octA-1,t.note.velocity)})},[d("div",R,x((c=t.note)==null?void 0:c._name)+x((m=t.note)==null?void 0:m._accidental),1),d("div",V,x((a=t.note)==null?void 0:a.number),1)],36)}}},G=b(q,[["__scopeId","data-v-4edb83ef"]]);const H=t=>(T("data-v-51180af5"),t=t(),O(),t),J={class:"flex flex-col gap-4 items-start"},K={class:"flex w-full h-full mt-4"},Q={class:"header absolute w-full text-center"},W=H(()=>d("div",{class:"p-6"},null,-1)),X={class:"flex w-full"},Y={__name:"MidiMonitor",setup(t){const o=S(!1),{midi:v,midiAttack:s,midiRelease:f,setCC:r}=z(),p=B(()=>{const i={};for(let e in v.channels){const c=Object.keys(v.channels[e].activeNotes).map(m=>N.midiToNoteName(m,{sharps:!0}));i[e]=c.length>2?U.detect(c):[]}return i});return(i,e)=>{const c=G,m=L;return l(),u("div",J,[d("div",{class:"fullscreen-container",id:"screen",onMouseleave:e[1]||(e[1]=a=>o.value=!1)},[d("div",K,[(l(!0),u(g,null,$(_(v).channels,(a,n)=>{var M;return l(),u("div",{class:"flex flex-col flex-1 text-center relative",key:a.num},[d("div",Q,x(((M=p.value[n])==null?void 0:M[0])||Object.keys(a.activeNotes).map(y=>_(N).midiToNoteName(y,{sharps:!0})).join(" ")||a.num),1),W,(l(!0),u(g,null,$(_(A)(a.notes),y=>(l(),k(c,{key:y.number,active:o.value,"onUpdate:active":e[0]||(e[0]=h=>o.value=h),note:y,onPlay:h=>_(s)(y),onStop:h=>_(f)(y)},null,8,["active","note","onPlay","onStop"]))),128))])}),128))]),d("div",X,[(l(!0),u(g,null,$(_(v).channels,a=>(l(),u("div",{class:"flex flex-col flex-1 text-center",key:a.num},[(l(!0),u(g,null,$(a.cc,n=>(l(),k(m,{key:n,cc:n,onUpdate:M=>_(r)(n,M)},null,8,["cc","onUpdate"]))),128))]))),128))])],32)])}}},ae=b(Y,[["__scopeId","data-v-51180af5"]]);export{ae as _};
