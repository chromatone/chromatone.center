import{bm as R,H as X,aA as j,F as O,aF as H,aq as rt}from"./theme.C7-omd-H.js";import{r as lt,c as q,b as S,av as ft,aQ as ut,P as dt,x as M,y as D,E as m,A as c,G as B,C as Y,F as Z,B as J,L as ht}from"./framework.DzzWumix.js";typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const l=BigInt(0),u=BigInt(1),T=BigInt(2),U=BigInt(5),I=BigInt(10),ct=2e3,s={s:u,n:l,d:u};function E(t,n){try{t=BigInt(t)}catch{throw z()}return t*n}function x(t,n){if(n===l)throw G();const e=Object.create(A.prototype);e.s=t<l?-u:u,t=t<l?-t:t;const i=p(t,n);return e.n=t/i,e.d=n/i,e}function K(t){const n={};let e=t,i=T,f=U-u;for(;f<=e;){for(;e%i===l;)e/=i,n[i]=(n[i]||l)+u;f+=u+T*i++}return e!==t?e>1&&(n[e]=(n[e]||l)+u):n[t]=(n[t]||l)+u,n}const b=function(t,n){let e=l,i=u,f=u;if(t!=null)if(n!==void 0){if(typeof t=="bigint")e=t;else{if(isNaN(t))throw z();if(t%1!==0)throw tt();e=BigInt(t)}if(typeof n=="bigint")i=n;else{if(isNaN(n))throw z();if(n%1!==0)throw tt();i=BigInt(n)}f=e*i}else if(typeof t=="object"){if("d"in t&&"n"in t)e=BigInt(t.n),i=BigInt(t.d),"s"in t&&(e*=BigInt(t.s));else if(0 in t)e=BigInt(t[0]),1 in t&&(i=BigInt(t[1]));else if(typeof t=="bigint")e=t;else throw z();f=e*i}else if(typeof t=="number"){if(isNaN(t))throw z();if(t<0&&(f=-u,t=-t),t%1===0)e=BigInt(t);else if(t>0){let r=1,h=0,a=1,P=1,y=1,N=1e7;for(t>=1&&(r=10**Math.floor(1+Math.log10(t)),t/=r);a<=N&&y<=N;){let d=(h+P)/(a+y);if(t===d){a+y<=N?(e=h+P,i=a+y):y>a?(e=P,i=y):(e=h,i=a);break}else t>d?(h+=P,a+=y):(P+=h,y+=a),a>N?(e=P,i=y):(e=h,i=a)}e=BigInt(e)*BigInt(r),i=BigInt(i)}}else if(typeof t=="string"){let r=0,h=l,a=l,P=l,y=u,N=u,d=t.replace(/_/g,"").match(/\d+|./g);if(d===null)throw z();if(d[r]==="-"?(f=-u,r++):d[r]==="+"&&r++,d.length===r+1?a=E(d[r++],f):d[r+1]==="."||d[r]==="."?(d[r]!=="."&&(h=E(d[r++],f)),r++,(r+1===d.length||d[r+1]==="("&&d[r+3]===")"||d[r+1]==="'"&&d[r+3]==="'")&&(a=E(d[r],f),y=I**BigInt(d[r].length),r++),(d[r]==="("&&d[r+2]===")"||d[r]==="'"&&d[r+2]==="'")&&(P=E(d[r+1],f),N=I**BigInt(d[r+1].length)-u,r+=3)):d[r+1]==="/"||d[r+1]===":"?(a=E(d[r],f),y=E(d[r+2],u),r+=3):d[r+3]==="/"&&d[r+1]===" "&&(h=E(d[r],f),a=E(d[r+2],f),y=E(d[r+4],u),r+=5),d.length<=r)i=y*N,f=e=P+i*h+N*a;else throw z()}else if(typeof t=="bigint")e=t,f=t,i=u;else throw z();if(i===l)throw G();s.s=f<l?-u:u,s.n=e<l?-e:e,s.d=i<l?-i:i};function at(t,n,e){let i=u;for(;n>l;t=t*t%e,n>>=u)n&u&&(i=i*t%e);return i}function gt(t,n){for(;n%T===l;n/=T);for(;n%U===l;n/=U);if(n===u)return l;let e=I%n,i=1;for(;e!==u;i++)if(e=e*I%n,i>ct)return l;return BigInt(i)}function xt(t,n,e){let i=u,f=at(I,e,n);for(let r=0;r<300;r++){if(i===f)return BigInt(r);i=i*I%n,f=f*I%n}return 0}function p(t,n){if(!t)return n;if(!n)return t;for(;;){if(t%=n,!t)return n;if(n%=t,!n)return t}}function A(t,n){if(b(t,n),this instanceof A)t=p(s.d,s.n),this.s=s.s,this.n=s.n/t,this.d=s.d/t;else return x(s.s*s.n,s.d)}var G=function(){return new Error("Division by Zero")},z=function(){return new Error("Invalid argument")},tt=function(){return new Error("Parameters must be integer")};A.prototype={s:u,n:l,d:u,abs:function(){return x(this.n,this.d)},neg:function(){return x(-this.s*this.n,this.d)},add:function(t,n){return b(t,n),x(this.s*this.n*s.d+s.s*this.d*s.n,this.d*s.d)},sub:function(t,n){return b(t,n),x(this.s*this.n*s.d-s.s*this.d*s.n,this.d*s.d)},mul:function(t,n){return b(t,n),x(this.s*s.s*this.n*s.n,this.d*s.d)},div:function(t,n){return b(t,n),x(this.s*s.s*this.n*s.d,this.d*s.n)},clone:function(){return x(this.s*this.n,this.d)},mod:function(t,n){if(t===void 0)return x(this.s*this.n%this.d,u);if(b(t,n),l===s.n*this.d)throw G();return x(this.s*(s.d*this.n)%(s.n*this.d),s.d*this.d)},gcd:function(t,n){return b(t,n),x(p(s.n,this.n)*p(s.d,this.d),s.d*this.d)},lcm:function(t,n){return b(t,n),s.n===l&&this.n===l?x(l,u):x(s.n*this.n,p(s.n,this.n)*p(s.d,this.d))},inverse:function(){return x(this.s*this.d,this.n)},pow:function(t,n){if(b(t,n),s.d===u)return s.s<l?x((this.s*this.d)**s.n,this.n**s.n):x((this.s*this.n)**s.n,this.d**s.n);if(this.s<l)return null;let e=K(this.n),i=K(this.d),f=u,r=u;for(let h in e)if(h!=="1"){if(h==="0"){f=l;break}if(e[h]*=s.n,e[h]%s.d===l)e[h]/=s.d;else return null;f*=BigInt(h)**e[h]}for(let h in i)if(h!=="1"){if(i[h]*=s.n,i[h]%s.d===l)i[h]/=s.d;else return null;r*=BigInt(h)**i[h]}return s.s<l?x(r,f):x(f,r)},equals:function(t,n){return b(t,n),this.s*this.n*s.d===s.s*s.n*this.d},compare:function(t,n){b(t,n);let e=this.s*this.n*s.d-s.s*s.n*this.d;return(l<e)-(e<l)},ceil:function(t){return t=I**BigInt(t||0),x(this.s*t*this.n/this.d+(t*this.n%this.d>l&&this.s>=l?u:l),t)},floor:function(t){return t=I**BigInt(t||0),x(this.s*t*this.n/this.d-(t*this.n%this.d>l&&this.s<l?u:l),t)},round:function(t){return t=I**BigInt(t||0),x(this.s*t*this.n/this.d+this.s*((this.s>=l?u:l)+T*(t*this.n%this.d)>this.d?u:l),t)},roundTo:function(t,n){b(t,n);const e=this.n*s.d,i=this.d*s.n,f=e%i;let r=e/i;return f+f>=i&&r++,x(this.s*r*s.n,s.d)},divisible:function(t,n){return b(t,n),!(!(s.n*this.d)||this.n*s.d%(s.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let n=this.n,e=this.d;function i(a){return typeof a=="bigint"?a:Math.floor(a)}t=t||15;let f=gt(n,e),r=xt(n,e,f),h=this.s<l?"-":"";if(h+=i(n/e),n%=e,n*=I,n&&(h+="."),f){for(let a=r;a--;)h+=i(n/e),n%=e,n*=I;h+="(";for(let a=f;a--;)h+=i(n/e),n%=e,n*=I;h+=")"}else for(let a=t;n&&a--;)h+=i(n/e),n%=e,n*=I;return h},toFraction:function(t){let n=this.n,e=this.d,i=this.s<l?"-":"";if(e===u)i+=n;else{let f=n/e;t&&f>l&&(i+=f,i+=" ",n%=e),i+=n,i+="/",i+=e}return i},toLatex:function(t){let n=this.n,e=this.d,i=this.s<l?"-":"";if(e===u)i+=n;else{let f=n/e;t&&f>l&&(i+=f,n%=e),i+="\\frac{",i+=n,i+="}{",i+=e,i+="}"}return i},toContinued:function(){let t=this.n,n=this.d,e=[];do{e.push(t/n);let i=t%n;t=n,n=i}while(t!==u);return e},simplify:function(t){t=t||.001;const n=this.abs(),e=n.toContinued();for(let i=1;i<e.length;i++){let f=x(e[i-1],u);for(let r=i-2;r>=0;r--)f=f.inverse().add(e[r]);if(Math.abs(f.sub(n).valueOf())<t)return f.mul(this.s)}return this}};const vt={key:1,class:"flex flex-col gap-6 p-2"},mt={class:"flex flex-col fullscreen-container",id:"screen"},yt={class:"py-8 select-none",version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 35",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white"},wt={id:"ruler","stroke-width":"0.2",stroke:"currentColor"},qt=["x1","x2"],Bt={id:"freqs",stroke:"none",fill:"currentColor"},It={id:"left","text-anchor":"end"},kt=["x"],bt=["x"],Pt={id:"right","text-anchor":"start"},Ct=["x"],Ft=["x"],$t={class:"cursor-pointer",id:"ratio","font-size":"4px",fill:"currentColor"},Nt=["x"],_t=["x"],Mt=["stroke"],Et={x:"50","font-weight":"bold"},Dt={class:"cursor-pointer",id:"divided",transform:"translate(0,15)","font-weight":"bold"},zt=["stroke","x2"],Lt=["x"],Ot=["stroke","x1"],pt=["x"],Tt=["cx"],At={class:"flex flex-wrap justify-center m-4"},St=["onClick"],Vt={class:"flex flex-wrap p-2 gap-4"},Ht={__name:"MonoChord",setup(t){const{note:n,init:e,controls:i,params:f}=R("center"),{note:r,init:h}=R("left"),{note:a,init:P}=R("right"),y=lt(!1),N=[n,r,a],d=q(()=>[w.freq,C.freq,F.freq]),nt=$=>69+12*Math.log2($/440);function v($=0,o=.5){Object.assign(N[$],{number:nt(d.value[$]).toFixed(4),velocity:o})}const _=S({ratio:X(.8,.05,.95),fraction:q(()=>new A(1-_.ratio).simplify(.001).toFraction(!0)),invFraction:q(()=>new A(_.ratio).simplify(.001).toFraction(!0))}),w=S({freq:X(220,50,2e3),pitch:q(()=>j(w.freq).toFixed()),note:q(()=>O(w.freq).toNote()),cents:q(()=>V(O(w.note).toFrequency(),w.freq))}),C=S({freq:q(()=>w.freq/(1-_.ratio)),pitch:q(()=>(j(C.freq)+120)%12),note:q(()=>O(C.freq).toNote()),cents:q(()=>V(O(C.note).toFrequency(),C.freq))}),F=S({freq:q(()=>w.freq/_.ratio),pitch:q(()=>(j(F.freq)+120)%12),note:q(()=>O(F.freq).toNote()),cents:q(()=>V(O(F.note).toFrequency(),F.freq))}),et={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},k=ft(q(()=>_.ratio),{duration:200,transition:ut.easeOutCubic});function it($){w.freq+=$.delta[0]/4}function ot($){_.ratio-=$.delta[0]/1200}function V($,o){return-(1200/Math.log10(2))*Math.log10($/o)%1200}return($,o)=>{const st=rt,Q=dt("drag");return M(),D(Z,null,[y.value?(M(),D("div",vt)):(M(),D("button",{key:0,class:"p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700 absolute min-h-30 top-0 z-100 right-0 left-0",onClick:o[0]||(o[0]=g=>{m(e)(),m(h)(),m(P)(),y.value=!0})},"START ")),c("div",mt,[(M(),D("svg",yt,[c("g",wt,[o[22]||(o[22]=c("line",{y1:"30",y2:"30",x2:"100"},null,-1)),o[23]||(o[23]=c("line",{y1:"0",y2:"30"},null,-1)),o[24]||(o[24]=c("line",{x1:"100",x2:"100",y1:"0",y2:"30"},null,-1)),c("line",{x1:100*(1-m(k)),x2:100*(1-m(k)),y1:"0",y2:"30"},null,8,qt),c("g",Bt,[c("g",It,[c("text",{x:100*(1-m(k))-2,y:"28"},B(C.freq.toFixed(1))+" Hz",9,kt),c("text",{x:100*(1-m(k))-2,y:"24"},B(C.note)+" ("+B(C.cents.toFixed())+" cents) ",9,bt)]),c("g",Pt,[c("text",{x:100*(1-m(k))+2,y:"28"},B(F.freq.toFixed(1))+" Hz",9,Ct),c("text",{x:100*(1-m(k))+2,y:"24"},B(F.note)+" ("+B(F.cents.toFixed())+" cents) ",9,Ft)])]),c("g",$t,[c("g",{onMousedown:o[1]||(o[1]=g=>{v(w.freq),v(C.freq,1)})},[c("text",{x:100*(1-m(k))-2,y:"8","text-anchor":"end"},B(_.fraction),9,Nt)],32),c("g",{onMousedown:o[2]||(o[2]=g=>{v(w.freq),v(F.freq,2)})},[c("text",{x:100*(1-m(k))+2,y:"8","text-anchor":"start"},B(_.invFraction),9,_t)],32)])]),Y((M(),D("g",{class:"cursor-pointer",id:"fundamental",onDblclick:o[3]||(o[3]=g=>w.freq=220),onPointerdown:o[4]||(o[4]=g=>v(0,1)),onPointerenter:o[5]||(o[5]=g=>v(0,1)),onPointerover:o[6]||(o[6]=g=>v(0,1)),onPointercancel:o[7]||(o[7]=g=>v(0,0)),onPointerleave:o[8]||(o[8]=g=>v(0,0)),onPointerout:o[9]||(o[9]=g=>v(0,0))},[c("line",{x2:"100","stroke-width":"4",stroke:m(H)(w.freq)},null,8,Mt),o[25]||(o[25]=c("circle",{r:"1"},null,-1)),o[26]||(o[26]=c("circle",{cx:"100",r:"1"},null,-1)),c("text",Et,B(w.note)+" "+B(w.freq.toFixed(2))+" Hz ("+B(w.cents.toFixed())+" cents)",1)],32)),[[Q,it]]),Y((M(),D("g",Dt,[c("g",{id:"part1",onPointerdown:o[10]||(o[10]=g=>v(1,1)),onPointerenter:o[11]||(o[11]=g=>v(1,1)),onPointerover:o[12]||(o[12]=g=>v(1,1)),onPointercancel:o[13]||(o[13]=g=>v(1,0)),onPointerleave:o[14]||(o[14]=g=>v(1,0)),onPointerout:o[15]||(o[15]=g=>v(1,0))},[c("line",{stroke:m(H)(C.freq),"stroke-width":"4",x2:100*(1-m(k))},null,8,zt),c("text",{y:"0.3",x:100*(1-m(k))/2},B(C.note),9,Lt)],32),c("g",{id:"part2",onPointerdown:o[16]||(o[16]=g=>v(2,1)),onPointerenter:o[17]||(o[17]=g=>v(2,1)),onPointerover:o[18]||(o[18]=g=>v(2,1)),onPointercancel:o[19]||(o[19]=g=>v(2,0)),onPointerleave:o[20]||(o[20]=g=>v(2,0)),onPointerout:o[21]||(o[21]=g=>v(2,0))},[c("line",{stroke:m(H)(F.freq),"stroke-width":"4",x1:100*(1-m(k)),x2:"100"},null,8,Ot),c("text",{y:"0.3",x:100-100*m(k)/2},B(F.note),9,pt),c("circle",{cx:100*(1-m(k)),r:"1"},null,8,Tt)],32),o[27]||(o[27]=c("circle",{r:"1"},null,-1)),o[28]||(o[28]=c("circle",{r:"1",cx:"100"},null,-1))])),[[Q,ot]])])),c("div",At,[(M(),D(Z,null,J(et,(g,L)=>c("button",{class:"p-2 border-1 shadow m-2",key:L,onClick:W=>_.ratio=g},B(L),9,St)),64))]),c("div",Vt,[(M(!0),D(Z,null,J(m(f),(g,L)=>(M(),ht(st,{param:L.split(":")[1],modelValue:m(i)[L],"onUpdate:modelValue":W=>m(i)[L]=W,min:g.min,max:g.max,fixed:g.fixed,step:g.step},null,8,["param","modelValue","onUpdate:modelValue","min","max","fixed","step"]))),256))])])],64)}}};export{Ht as default};
