import{D as H,F as G,bj as X,aC as I}from"./theme.FO-BRpn0.js";import{u as Y}from"./index.Dw9P-zBO.js";import{r as J,b as q,c as N,d as K,M as Z,x as $,y as C,A as f,H as L,E as x,G as w,C as R,F as Q,B as U,z as tt}from"./framework.BjEhsXnI.js";typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const d=BigInt(0),h=BigInt(1),M=BigInt(2),j=BigInt(5),b=BigInt(10),nt=2e3,u={s:h,n:d,d:h};function P(t,n){try{t=BigInt(t)}catch{throw _()}return t*n}function m(t,n){if(n===d)throw A();const e=Object.create(O.prototype);e.s=t<d?-h:h,t=t<d?-t:t;const i=z(t,n);return e.n=t/i,e.d=n/i,e}function V(t){const n={};let e=t,i=M,l=j-h;for(;l<=e;){for(;e%i===d;)e/=i,n[i]=(n[i]||d)+h;l+=h+M*i++}return e!==t?e>1&&(n[e]=(n[e]||d)+h):n[t]=(n[t]||d)+h,n}const p=function(t,n){let e=d,i=h,l=h;if(t!=null)if(n!==void 0){if(typeof t=="bigint")e=t;else{if(isNaN(t))throw _();if(t%1!==0)throw W();e=BigInt(t)}if(typeof n=="bigint")i=n;else{if(isNaN(n))throw _();if(n%1!==0)throw W();i=BigInt(n)}l=e*i}else if(typeof t=="object"){if("d"in t&&"n"in t)e=BigInt(t.n),i=BigInt(t.d),"s"in t&&(e*=BigInt(t.s));else if(0 in t)e=BigInt(t[0]),1 in t&&(i=BigInt(t[1]));else if(typeof t=="bigint")e=t;else throw _();l=e*i}else if(typeof t=="number"){if(isNaN(t))throw _();if(t<0&&(l=-h,t=-t),t%1===0)e=BigInt(t);else if(t>0){let s=1,c=0,a=1,B=1,y=1,k=1e7;for(t>=1&&(s=10**Math.floor(1+Math.log10(t)),t/=s);a<=k&&y<=k;){let r=(c+B)/(a+y);if(t===r){a+y<=k?(e=c+B,i=a+y):y>a?(e=B,i=y):(e=c,i=a);break}else t>r?(c+=B,a+=y):(B+=c,y+=a),a>k?(e=B,i=y):(e=c,i=a)}e=BigInt(e)*BigInt(s),i=BigInt(i)}}else if(typeof t=="string"){let s=0,c=d,a=d,B=d,y=h,k=h,r=t.replace(/_/g,"").match(/\d+|./g);if(r===null)throw _();if(r[s]==="-"?(l=-h,s++):r[s]==="+"&&s++,r.length===s+1?a=P(r[s++],l):r[s+1]==="."||r[s]==="."?(r[s]!=="."&&(c=P(r[s++],l)),s++,(s+1===r.length||r[s+1]==="("&&r[s+3]===")"||r[s+1]==="'"&&r[s+3]==="'")&&(a=P(r[s],l),y=b**BigInt(r[s].length),s++),(r[s]==="("&&r[s+2]===")"||r[s]==="'"&&r[s+2]==="'")&&(B=P(r[s+1],l),k=b**BigInt(r[s+1].length)-h,s+=3)):r[s+1]==="/"||r[s+1]===":"?(a=P(r[s],l),y=P(r[s+2],h),s+=3):r[s+3]==="/"&&r[s+1]===" "&&(c=P(r[s],l),a=P(r[s+2],l),y=P(r[s+4],h),s+=5),r.length<=s)i=y*k,l=e=B+i*c+k*a;else throw _()}else if(typeof t=="bigint")e=t,l=t,i=h;else throw _();if(i===d)throw A();u.s=l<d?-h:h,u.n=e<d?-e:e,u.d=i<d?-i:i};function et(t,n,e){let i=h;for(;n>d;t=t*t%e,n>>=h)n&h&&(i=i*t%e);return i}function it(t,n){for(;n%M===d;n/=M);for(;n%j===d;n/=j);if(n===h)return d;let e=b%n,i=1;for(;e!==h;i++)if(e=e*b%n,i>nt)return d;return BigInt(i)}function st(t,n,e){let i=h,l=et(b,e,n);for(let s=0;s<300;s++){if(i===l)return BigInt(s);i=i*b%n,l=l*b%n}return 0}function z(t,n){if(!t)return n;if(!n)return t;for(;;){if(t%=n,!t)return n;if(n%=t,!n)return t}}function O(t,n){if(p(t,n),this instanceof O)t=z(u.d,u.n),this.s=u.s,this.n=u.n/t,this.d=u.d/t;else return m(u.s*u.n,u.d)}var A=function(){return new Error("Division by Zero")},_=function(){return new Error("Invalid argument")},W=function(){return new Error("Parameters must be integer")};O.prototype={s:h,n:d,d:h,abs:function(){return m(this.n,this.d)},neg:function(){return m(-this.s*this.n,this.d)},add:function(t,n){return p(t,n),m(this.s*this.n*u.d+u.s*this.d*u.n,this.d*u.d)},sub:function(t,n){return p(t,n),m(this.s*this.n*u.d-u.s*this.d*u.n,this.d*u.d)},mul:function(t,n){return p(t,n),m(this.s*u.s*this.n*u.n,this.d*u.d)},div:function(t,n){return p(t,n),m(this.s*u.s*this.n*u.d,this.d*u.n)},clone:function(){return m(this.s*this.n,this.d)},mod:function(t,n){if(t===void 0)return m(this.s*this.n%this.d,h);if(p(t,n),d===u.n*this.d)throw A();return m(this.s*(u.d*this.n)%(u.n*this.d),u.d*this.d)},gcd:function(t,n){return p(t,n),m(z(u.n,this.n)*z(u.d,this.d),u.d*this.d)},lcm:function(t,n){return p(t,n),u.n===d&&this.n===d?m(d,h):m(u.n*this.n,z(u.n,this.n)*z(u.d,this.d))},inverse:function(){return m(this.s*this.d,this.n)},pow:function(t,n){if(p(t,n),u.d===h)return u.s<d?m((this.s*this.d)**u.n,this.n**u.n):m((this.s*this.n)**u.n,this.d**u.n);if(this.s<d)return null;let e=V(this.n),i=V(this.d),l=h,s=h;for(let c in e)if(c!=="1"){if(c==="0"){l=d;break}if(e[c]*=u.n,e[c]%u.d===d)e[c]/=u.d;else return null;l*=BigInt(c)**e[c]}for(let c in i)if(c!=="1"){if(i[c]*=u.n,i[c]%u.d===d)i[c]/=u.d;else return null;s*=BigInt(c)**i[c]}return u.s<d?m(s,l):m(l,s)},equals:function(t,n){return p(t,n),this.s*this.n*u.d===u.s*u.n*this.d},compare:function(t,n){p(t,n);let e=this.s*this.n*u.d-u.s*u.n*this.d;return(d<e)-(e<d)},ceil:function(t){return t=b**BigInt(t||0),m(this.s*t*this.n/this.d+(t*this.n%this.d>d&&this.s>=d?h:d),t)},floor:function(t){return t=b**BigInt(t||0),m(this.s*t*this.n/this.d-(t*this.n%this.d>d&&this.s<d?h:d),t)},round:function(t){return t=b**BigInt(t||0),m(this.s*t*this.n/this.d+this.s*((this.s>=d?h:d)+M*(t*this.n%this.d)>this.d?h:d),t)},roundTo:function(t,n){p(t,n);const e=this.n*u.d,i=this.d*u.n,l=e%i;let s=e/i;return l+l>=i&&s++,m(this.s*s*u.n,u.d)},divisible:function(t,n){return p(t,n),!(!(u.n*this.d)||this.n*u.d%(u.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let n=this.n,e=this.d;function i(a){return typeof a=="bigint"?a:Math.floor(a)}t=t||15;let l=it(n,e),s=st(n,e,l),c=this.s<d?"-":"";if(c+=i(n/e),n%=e,n*=b,n&&(c+="."),l){for(let a=s;a--;)c+=i(n/e),n%=e,n*=b;c+="(";for(let a=l;a--;)c+=i(n/e),n%=e,n*=b;c+=")"}else for(let a=t;n&&a--;)c+=i(n/e),n%=e,n*=b;return c},toFraction:function(t){let n=this.n,e=this.d,i=this.s<d?"-":"";if(e===h)i+=n;else{let l=n/e;t&&l>d&&(i+=l,i+=" ",n%=e),i+=n,i+="/",i+=e}return i},toLatex:function(t){let n=this.n,e=this.d,i=this.s<d?"-":"";if(e===h)i+=n;else{let l=n/e;t&&l>d&&(i+=l,n%=e),i+="\\frac{",i+=n,i+="}{",i+=e,i+="}"}return i},toContinued:function(){let t=this.n,n=this.d,e=[];do{e.push(t/n);let i=t%n;t=n,n=i}while(t!==h);return e},simplify:function(t){t=t||.001;const n=this.abs(),e=n.toContinued();for(let i=1;i<e.length;i++){let l=m(e[i-1],h);for(let s=i-2;s>=0;s--)l=l.inverse().add(e[s]);if(Math.abs(l.sub(n).valueOf())<t)return l.mul(this.s)}return this}};const ot={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},rt={class:"flex flex-col fullscreen-container select-none z-100",id:"screen"},lt={key:1,class:"my-12 select-none touch-action-none select-none",style:{"-webkit-overflow-scrolling":"touch"},version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 31",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white"},ut={class:"cursor-pointer",id:"ratio",transform:"translate(0 10)","font-size":"4px","stroke-width":"0",fill:"currentColor"},ft={id:"intL"},dt=["width"],at=["x"],ht=["fill"],ct=["fill"],xt={id:"intR"},vt=["width","x"],gt=["x"],mt=["fill"],wt=["fill"],yt=["stroke"],bt={class:"pointer-events-none",x:"50",y:".5","font-weight":"bold","text-anchor":"end"},pt={class:"text-6px"},Bt={class:"pointer-events-none",x:"50.5",y:"-1.5","text-anchor":"start"},It={class:"text-2px"},kt={class:"text-2px",x:"50.75",y:"1.5"},Pt={class:"cursor-pointer touch-manipulation",id:"divided",transform:"translate(0,20)"},_t=["stroke","x1"],$t=["transform"],Ct={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Ft={class:"text-2px",y:"-1.5","text-anchor":"start"},Nt={class:"text-2px",y:"1.5","text-anchor":"start"},zt=["stroke","x2"],Et=["cx"],Mt=["transform"],Dt={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Lt={class:"text-2px",y:"-1.5","text-anchor":"start"},Ot={class:"text-2px",y:"1.5","text-anchor":"start"},St={class:"touch-manipulation",id:"ruler","stroke-width":"0.2",stroke:"currentColor"},qt=["x1","x2"],Rt=["x"],jt={class:"flex flex-wrap justify-center p-2"},At=["onClick"],Vt={__name:"MonoChord",setup(t){const n=J(!1),e=q({ratio:H(.66,.05,.95),fraction:N(()=>i(e.ratio)),invFraction:N(()=>i(1-e.ratio))}),i=g=>new O(g).simplify(.001).toFraction(!0),l=Y({ratio:e.ratio});K(()=>e.ratio,g=>l.ratio=g);const s=q([H(220,27.5,3520),N(()=>s[0].value/l.ratio),N(()=>s[0].value/(1-l.ratio))]),a=q(["fundamental","left","right"].map((g,o)=>{const F=N(()=>G(s[o].value).toNote()),E=N(()=>B(G(F.value).toFrequency(),s[o].value));return{...X(g),name:F,cents:E}})),B=(g,o)=>-(1200/Math.log10(2))*Math.log10(g/o)%1200;function y(){n.value||(a.forEach(g=>g.init()),n.value=!0)}const k=g=>69+12*Math.log2(g/440);function r(g=0,o=.5){n.value&&Object.assign(a[g].note,{number:k(s[g].value).toFixed(4),velocity:o})}function T(g){s[0].value+=g.wheeling?-g.delta[0]/32:g.delta[0]/4}function D(g){e.ratio+=g.wheeling?-g.delta[0]/4800:g.delta[0]/1200}return(g,o)=>{const F=Z("drag"),E=Z("wheel");return $(),C("div",rt,[n.value?($(),C("svg",lt,[f("g",ut,[f("g",{class:"touch-manipulation",id:"intervalL",onPointerdown:o[1]||(o[1]=v=>{r(0),r(1)}),onPointercancel:o[2]||(o[2]=v=>{r(0,0),r(1,0)}),onPointerup:o[3]||(o[3]=v=>{r(0,0),r(1,0)}),onPointerout:o[4]||(o[4]=v=>{r(0,0),r(1,0)})},[f("defs",null,[f("linearGradient",ft,[f("stop",{offset:"0%",style:L({stopColor:x(I)(s[1].value,void 0,a[1].meter)})},null,4),f("stop",{offset:"100%",style:L({stopColor:x(I)(s[0].value,void 0,a[0].meter)})},null,4)])]),f("rect",{width:100*x(l).ratio-4,height:"8",y:"-4",x:"1",rx:"2",fill:"url(#intL)"},null,8,dt),f("text",{class:"pointer-events-none",x:100*x(l).ratio/2-2,"text-anchor":"middle",y:".5"},[f("tspan",{class:"font-bold",fill:x(I)(s[1].value)},w(e.fraction.split("/")[0]),9,ht),o[24]||(o[24]=f("tspan",null,"/",-1)),f("tspan",{class:"font-bold",fill:x(I)(s[0].value)},w(e.fraction.split("/")[1]),9,ct)],8,at)],32),f("g",{class:"touch-manipulation",id:"intervalR",onPointerdown:o[5]||(o[5]=v=>{r(0),r(2)}),onPointercancel:o[6]||(o[6]=v=>{r(0,0),r(2,0)}),onPointerup:o[7]||(o[7]=v=>{r(0,0),r(2,0)}),onPointerout:o[8]||(o[8]=v=>{r(0,0),r(2,0)})},[f("defs",null,[f("linearGradient",xt,[f("stop",{offset:"0%",style:L({stopColor:x(I)(s[0].value,void 0,a[0].meter)})},null,4),f("stop",{offset:"100%",style:L({stopColor:x(I)(s[2].value,void 0,a[2].meter)})},null,4)])]),f("rect",{width:100*(1-x(l).ratio)-4,height:"8",y:"-4",x:100-100*(1-x(l).ratio)+3,rx:"2",fill:"url(#intR)"},null,8,vt),f("text",{class:"pointer-events-none",x:100*x(l).ratio+100*(1-x(l).ratio)/2+2,"text-anchor":"middle",y:".5"},[f("tspan",{class:"font-bold",fill:x(I)(s[2].value)},w(e.invFraction.split("/")[0]),9,mt),o[25]||(o[25]=f("tspan",null,"/",-1)),f("tspan",{class:"font-bold",fill:x(I)(s[0].value)},w(e.invFraction.split("/")[1]),9,wt)],8,gt)],32)]),R(($(),C("g",{class:"cursor-pointer touch-manipulation",id:"fundamental",onPointerdown:o[9]||(o[9]=v=>r(0)),onPointercancel:o[10]||(o[10]=v=>r(0,0)),onPointerleave:o[11]||(o[11]=v=>r(0,0)),onPointerout:o[12]||(o[12]=v=>r(0,0)),onPointerup:o[13]||(o[13]=v=>r(0,0))},[f("line",{x2:"100","stroke-width":"10",stroke:x(I)(s[0].value,.3+.7*a[0].meter)},null,8,yt),o[26]||(o[26]=f("circle",{r:"2"},null,-1)),o[27]||(o[27]=f("circle",{cx:"100",r:"2"},null,-1)),f("text",bt,[f("tspan",pt,w(a[0].name),1)]),f("text",Bt,[f("tspan",It,w(a[0].cents>0?"+":"")+w(a[0].cents.toFixed())+"% ",1),f("tspan",kt,w(s[0].value.toFixed(2))+" Hz ",1)])],32)),[[F,T],[E,T]]),R(($(),C("g",Pt,[f("g",{id:"right",onPointerdown:o[14]||(o[14]=v=>r(2)),onPointercancel:o[15]||(o[15]=v=>r(2,0)),onPointerleave:o[16]||(o[16]=v=>r(2,0)),onPointerout:o[17]||(o[17]=v=>r(2,0)),onPointerup:o[18]||(o[18]=v=>r(2,0))},[f("line",{stroke:x(I)(s[2].value,.3+.7*a[2].meter),"stroke-width":"10",x1:100*x(l).ratio,x2:"100"},null,8,_t),o[28]||(o[28]=f("circle",{r:"2",cx:"100"},null,-1)),f("g",{transform:`translate(${100*x(l).ratio+5+100*(1-x(l).ratio)/2} 0.5)`},[f("text",Ct,w(a[2].name),1),f("text",Ft,w(a[2].cents>0?"+":"")+w(a[2].cents.toFixed())+"% ",1),f("text",Nt,w(s[2].value.toFixed(2))+" Hz ",1)],8,$t)],32),f("g",{id:"left",onPointerdown:o[19]||(o[19]=v=>r(1)),onPointercancel:o[20]||(o[20]=v=>r(1,0)),onPointerleave:o[21]||(o[21]=v=>r(1,0)),onPointerout:o[22]||(o[22]=v=>r(1,0)),onPointerup:o[23]||(o[23]=v=>r(1,0))},[f("line",{stroke:x(I)(s[1].value,.3+.7*a[1].meter),"stroke-width":"10",x2:100*x(l).ratio},null,8,zt),o[29]||(o[29]=f("circle",{r:"2"},null,-1)),f("circle",{cx:100*x(l).ratio,r:"2"},null,8,Et),f("g",{transform:`translate(${100*x(l).ratio/2} 0.5)`},[f("text",Dt,w(a[1].name),1),f("text",Lt,w(a[1].cents>0?"+":"")+w(a[1].cents.toFixed())+"% ",1),f("text",Ot,w(s[1].value.toFixed(2))+" Hz ",1)],8,Mt)],32)])),[[F,D],[E,D]]),f("g",St,[o[30]||(o[30]=f("line",{y1:"0",y2:"20"},null,-1)),o[31]||(o[31]=f("line",{x1:"100",x2:"100",y1:"0",y2:"20"},null,-1)),f("line",{x1:100*x(l).ratio,x2:100*x(l).ratio,y1:"5",y2:"20"},null,8,qt),R(f("rect",{class:"cursor-grab",width:"8",height:"8",opacity:"0.3",rx:"2",x:100*x(l).ratio-4,y:"6"},null,8,Rt),[[E,D],[F,D]])])])):($(),C("button",{key:0,class:"min-h-80vh p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700 absolute min-h-30 top-0 z-100 right-0 left-0 w-full bg-op-30 dark-bg-op-30 backdrop-blur",onPointerdown:o[0]||(o[0]=v=>y())},"START ",32)),f("div",jt,[($(!0),C(Q,null,U(x(ot),(v,S)=>($(),C("button",{class:tt(["text-button flex-1",{active:S==e.fraction}]),key:S,onClick:Tt=>e.ratio=v},w(S),11,At))),128))])])}}};export{Vt as default};
