import{bm as V,H as K,aA as G,F as O,aF as p}from"./theme.CASTdkoz.js";import{r as st,c as B,b as S,av as rt,aQ as lt,P as ft,x as D,y as L,E as w,A as h,G as m,C as Q,F as ut,B as dt,z as ht}from"./framework.DzzWumix.js";typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const l=BigInt(0),u=BigInt(1),A=BigInt(2),W=BigInt(5),b=BigInt(10),at=2e3,s={s:u,n:l,d:u};function M(t,n){try{t=BigInt(t)}catch{throw z()}return t*n}function x(t,n){if(n===l)throw X();const e=Object.create(R.prototype);e.s=t<l?-u:u,t=t<l?-t:t;const o=T(t,n);return e.n=t/o,e.d=n/o,e}function U(t){const n={};let e=t,o=A,f=W-u;for(;f<=e;){for(;e%o===l;)e/=o,n[o]=(n[o]||l)+u;f+=u+A*o++}return e!==t?e>1&&(n[e]=(n[e]||l)+u):n[t]=(n[t]||l)+u,n}const I=function(t,n){let e=l,o=u,f=u;if(t!=null)if(n!==void 0){if(typeof t=="bigint")e=t;else{if(isNaN(t))throw z();if(t%1!==0)throw _();e=BigInt(t)}if(typeof n=="bigint")o=n;else{if(isNaN(n))throw z();if(n%1!==0)throw _();o=BigInt(n)}f=e*o}else if(typeof t=="object"){if("d"in t&&"n"in t)e=BigInt(t.n),o=BigInt(t.d),"s"in t&&(e*=BigInt(t.s));else if(0 in t)e=BigInt(t[0]),1 in t&&(o=BigInt(t[1]));else if(typeof t=="bigint")e=t;else throw z();f=e*o}else if(typeof t=="number"){if(isNaN(t))throw z();if(t<0&&(f=-u,t=-t),t%1===0)e=BigInt(t);else if(t>0){let r=1,g=0,v=1,k=1,y=1,N=1e7;for(t>=1&&(r=10**Math.floor(1+Math.log10(t)),t/=r);v<=N&&y<=N;){let a=(g+k)/(v+y);if(t===a){v+y<=N?(e=g+k,o=v+y):y>v?(e=k,o=y):(e=g,o=v);break}else t>a?(g+=k,v+=y):(k+=g,y+=v),v>N?(e=k,o=y):(e=g,o=v)}e=BigInt(e)*BigInt(r),o=BigInt(o)}}else if(typeof t=="string"){let r=0,g=l,v=l,k=l,y=u,N=u,a=t.replace(/_/g,"").match(/\d+|./g);if(a===null)throw z();if(a[r]==="-"?(f=-u,r++):a[r]==="+"&&r++,a.length===r+1?v=M(a[r++],f):a[r+1]==="."||a[r]==="."?(a[r]!=="."&&(g=M(a[r++],f)),r++,(r+1===a.length||a[r+1]==="("&&a[r+3]===")"||a[r+1]==="'"&&a[r+3]==="'")&&(v=M(a[r],f),y=b**BigInt(a[r].length),r++),(a[r]==="("&&a[r+2]===")"||a[r]==="'"&&a[r+2]==="'")&&(k=M(a[r+1],f),N=b**BigInt(a[r+1].length)-u,r+=3)):a[r+1]==="/"||a[r+1]===":"?(v=M(a[r],f),y=M(a[r+2],u),r+=3):a[r+3]==="/"&&a[r+1]===" "&&(g=M(a[r],f),v=M(a[r+2],f),y=M(a[r+4],u),r+=5),a.length<=r)o=y*N,f=e=k+o*g+N*v;else throw z()}else if(typeof t=="bigint")e=t,f=t,o=u;else throw z();if(o===l)throw X();s.s=f<l?-u:u,s.n=e<l?-e:e,s.d=o<l?-o:o};function gt(t,n,e){let o=u;for(;n>l;t=t*t%e,n>>=u)n&u&&(o=o*t%e);return o}function ct(t,n){for(;n%A===l;n/=A);for(;n%W===l;n/=W);if(n===u)return l;let e=b%n,o=1;for(;e!==u;o++)if(e=e*b%n,o>at)return l;return BigInt(o)}function vt(t,n,e){let o=u,f=gt(b,e,n);for(let r=0;r<300;r++){if(o===f)return BigInt(r);o=o*b%n,f=f*b%n}return 0}function T(t,n){if(!t)return n;if(!n)return t;for(;;){if(t%=n,!t)return n;if(n%=t,!n)return t}}function R(t,n){if(I(t,n),this instanceof R)t=T(s.d,s.n),this.s=s.s,this.n=s.n/t,this.d=s.d/t;else return x(s.s*s.n,s.d)}var X=function(){return new Error("Division by Zero")},z=function(){return new Error("Invalid argument")},_=function(){return new Error("Parameters must be integer")};R.prototype={s:u,n:l,d:u,abs:function(){return x(this.n,this.d)},neg:function(){return x(-this.s*this.n,this.d)},add:function(t,n){return I(t,n),x(this.s*this.n*s.d+s.s*this.d*s.n,this.d*s.d)},sub:function(t,n){return I(t,n),x(this.s*this.n*s.d-s.s*this.d*s.n,this.d*s.d)},mul:function(t,n){return I(t,n),x(this.s*s.s*this.n*s.n,this.d*s.d)},div:function(t,n){return I(t,n),x(this.s*s.s*this.n*s.d,this.d*s.n)},clone:function(){return x(this.s*this.n,this.d)},mod:function(t,n){if(t===void 0)return x(this.s*this.n%this.d,u);if(I(t,n),l===s.n*this.d)throw X();return x(this.s*(s.d*this.n)%(s.n*this.d),s.d*this.d)},gcd:function(t,n){return I(t,n),x(T(s.n,this.n)*T(s.d,this.d),s.d*this.d)},lcm:function(t,n){return I(t,n),s.n===l&&this.n===l?x(l,u):x(s.n*this.n,T(s.n,this.n)*T(s.d,this.d))},inverse:function(){return x(this.s*this.d,this.n)},pow:function(t,n){if(I(t,n),s.d===u)return s.s<l?x((this.s*this.d)**s.n,this.n**s.n):x((this.s*this.n)**s.n,this.d**s.n);if(this.s<l)return null;let e=U(this.n),o=U(this.d),f=u,r=u;for(let g in e)if(g!=="1"){if(g==="0"){f=l;break}if(e[g]*=s.n,e[g]%s.d===l)e[g]/=s.d;else return null;f*=BigInt(g)**e[g]}for(let g in o)if(g!=="1"){if(o[g]*=s.n,o[g]%s.d===l)o[g]/=s.d;else return null;r*=BigInt(g)**o[g]}return s.s<l?x(r,f):x(f,r)},equals:function(t,n){return I(t,n),this.s*this.n*s.d===s.s*s.n*this.d},compare:function(t,n){I(t,n);let e=this.s*this.n*s.d-s.s*s.n*this.d;return(l<e)-(e<l)},ceil:function(t){return t=b**BigInt(t||0),x(this.s*t*this.n/this.d+(t*this.n%this.d>l&&this.s>=l?u:l),t)},floor:function(t){return t=b**BigInt(t||0),x(this.s*t*this.n/this.d-(t*this.n%this.d>l&&this.s<l?u:l),t)},round:function(t){return t=b**BigInt(t||0),x(this.s*t*this.n/this.d+this.s*((this.s>=l?u:l)+A*(t*this.n%this.d)>this.d?u:l),t)},roundTo:function(t,n){I(t,n);const e=this.n*s.d,o=this.d*s.n,f=e%o;let r=e/o;return f+f>=o&&r++,x(this.s*r*s.n,s.d)},divisible:function(t,n){return I(t,n),!(!(s.n*this.d)||this.n*s.d%(s.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let n=this.n,e=this.d;function o(v){return typeof v=="bigint"?v:Math.floor(v)}t=t||15;let f=ct(n,e),r=vt(n,e,f),g=this.s<l?"-":"";if(g+=o(n/e),n%=e,n*=b,n&&(g+="."),f){for(let v=r;v--;)g+=o(n/e),n%=e,n*=b;g+="(";for(let v=f;v--;)g+=o(n/e),n%=e,n*=b;g+=")"}else for(let v=t;n&&v--;)g+=o(n/e),n%=e,n*=b;return g},toFraction:function(t){let n=this.n,e=this.d,o=this.s<l?"-":"";if(e===u)o+=n;else{let f=n/e;t&&f>l&&(o+=f,o+=" ",n%=e),o+=n,o+="/",o+=e}return o},toLatex:function(t){let n=this.n,e=this.d,o=this.s<l?"-":"";if(e===u)o+=n;else{let f=n/e;t&&f>l&&(o+=f,n%=e),o+="\\frac{",o+=n,o+="}{",o+=e,o+="}"}return o},toContinued:function(){let t=this.n,n=this.d,e=[];do{e.push(t/n);let o=t%n;t=n,n=o}while(t!==u);return e},simplify:function(t){t=t||.001;const n=this.abs(),e=n.toContinued();for(let o=1;o<e.length;o++){let f=x(e[o-1],u);for(let r=o-2;r>=0;r--)f=f.inverse().add(e[r]);if(Math.abs(f.sub(n).valueOf())<t)return f.mul(this.s)}return this}};const xt={key:1,class:"flex flex-col fullscreen-container",id:"screen"},wt={class:"py-8 select-none tocuh-action-none",version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 35",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white"},yt={id:"ruler","stroke-width":"0.2",stroke:"currentColor"},mt=["x1","x2"],qt={id:"freqs",transform:"translate(0 26)",stroke:"none",fill:"currentColor"},Bt={id:"left","text-anchor":"start"},bt={x:2},It={x:2,y:"-4"},Pt={id:"right","text-anchor":"end"},kt={x:98},$t={x:98,y:"-4"},Ct={class:"cursor-pointer",id:"ratio",transform:"translate(0 18)","font-size":"4px","stroke-width":"0",fill:"currentColor"},Ft=["x"],Nt={x:2,"text-anchor":"start"},Mt=["fill"],Et=["fill"],zt={x:98,"text-anchor":"end"},pt=["fill"],Dt=["fill"],Lt=["stroke"],Ot={x:"50","font-weight":"bold"},Tt={class:"cursor-pointer",id:"divided",transform:"translate(0,10)","font-weight":"bold"},At=["stroke","x2"],Rt=["x"],St=["stroke","x1"],jt=["x"],Ht=["cx"],Zt={class:"flex flex-wrap justify-center p-2"},Vt=["onClick"],Xt={__name:"MonoChord",setup(t){const{note:n,init:e,controls:o,params:f,meter:r}=V("center"),{note:g,init:v,meter:k}=V("left"),{note:y,init:N,meter:a}=V("right"),Y=st(!1),tt=[n,g,y],nt=B(()=>[q.freq,$.freq,C.freq]),et=F=>69+12*Math.log2(F/440);function d(F=0,i=.5){Object.assign(tt[F],{number:et(nt.value[F]).toFixed(4),velocity:i})}const P=S({ratio:K(.8,.05,.95),fraction:B(()=>new R(1-P.ratio).simplify(.001).toFraction(!0)),invFraction:B(()=>new R(P.ratio).simplify(.001).toFraction(!0))}),q=S({freq:K(220,50,2e3),pitch:B(()=>G(q.freq).toFixed()),note:B(()=>O(q.freq).toNote()),cents:B(()=>j(O(q.note).toFrequency(),q.freq))}),$=S({freq:B(()=>q.freq/(1-P.ratio)),pitch:B(()=>(G($.freq)+120)%12),note:B(()=>O($.freq).toNote()),cents:B(()=>j(O($.note).toFrequency(),$.freq))}),C=S({freq:B(()=>q.freq/P.ratio),pitch:B(()=>(G(C.freq)+120)%12),note:B(()=>O(C.freq).toNote()),cents:B(()=>j(O(C.note).toFrequency(),C.freq))}),it={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},E=rt(B(()=>P.ratio),{duration:200,transition:lt.easeOutCubic});function ot(F){q.freq+=F.delta[0]/4}function J(F){P.ratio-=F.delta[0]/1200}function j(F,i){return-(1200/Math.log10(2))*Math.log10(F/i)%1200}return(F,i)=>{const H=ft("drag");return Y.value?(D(),L("div",xt,[(D(),L("svg",wt,[h("g",yt,[i[32]||(i[32]=h("line",{y1:"30",y2:"30",x2:"100"},null,-1)),i[33]||(i[33]=h("line",{y1:"0",y2:"30"},null,-1)),i[34]||(i[34]=h("line",{x1:"100",x2:"100",y1:"0",y2:"30"},null,-1)),h("line",{x1:100*(1-w(E)),x2:100*(1-w(E)),y1:"0",y2:"30"},null,8,mt),h("g",qt,[h("g",Bt,[h("text",bt,m($.freq.toFixed(1))+" Hz",1),h("text",It,m($.note)+" ("+m($.cents.toFixed())+" cents) ",1)]),h("g",Pt,[h("text",kt,m(C.freq.toFixed(1))+" Hz",1),h("text",$t,m(C.note)+" ("+m(C.cents.toFixed())+" cents) ",1)])]),Q((D(),L("g",Ct,[h("rect",{class:"cursor-grab",width:"8",height:"10",opacity:"0.3",rx:"2",x:100*(1-w(E))-4},null,8,Ft),h("g",{onMousedown:i[1]||(i[1]=c=>{d(0),d(1)}),onPointerdown:i[2]||(i[2]=c=>{d(0),d(1)}),onPointercancel:i[3]||(i[3]=c=>{d(0,0),d(1,0)}),onPointerup:i[4]||(i[4]=c=>{d(0,0),d(1,0)}),onPointerout:i[5]||(i[5]=c=>{d(0,0),d(1,0)})},[h("text",Nt,[h("tspan",{class:"font-bold",fill:w(p)($.freq)},m(P.fraction.split("/")[0]),9,Mt),i[30]||(i[30]=h("tspan",null,"/",-1)),h("tspan",{class:"font-bold",fill:w(p)(q.freq)},m(P.fraction.split("/")[1]),9,Et)])],32),h("g",{onMousedown:i[6]||(i[6]=c=>{d(0),d(2)}),onPointerdown:i[7]||(i[7]=c=>{d(0),d(2)}),onPointercancel:i[8]||(i[8]=c=>{d(0,0),d(2,0)}),onPointerup:i[9]||(i[9]=c=>{d(0,0),d(2,0)}),onPointerout:i[10]||(i[10]=c=>{d(0,0),d(2,0)})},[h("text",zt,[h("tspan",{class:"font-bold",fill:w(p)(C.freq)},m(P.invFraction.split("/")[0]),9,pt),i[31]||(i[31]=h("tspan",null,"/",-1)),h("tspan",{class:"font-bold",fill:w(p)(q.freq)},m(P.invFraction.split("/")[1]),9,Dt)])],32)])),[[H,J]])]),Q((D(),L("g",{class:"cursor-pointer",id:"fundamental",onDblclick:i[11]||(i[11]=c=>q.freq=220),onPointerdown:i[12]||(i[12]=c=>d(0)),onPointerenter:i[13]||(i[13]=c=>d(0)),onPointerover:i[14]||(i[14]=c=>d(0)),onPointercancel:i[15]||(i[15]=c=>d(0,0)),onPointerleave:i[16]||(i[16]=c=>d(0,0)),onPointerout:i[17]||(i[17]=c=>d(0,0))},[h("line",{x2:"100","stroke-width":"8",stroke:w(p)(q.freq,.3+.7*w(r))},null,8,Lt),i[35]||(i[35]=h("circle",{r:"2"},null,-1)),i[36]||(i[36]=h("circle",{cx:"100",r:"2"},null,-1)),h("text",Ot,m(q.note)+" "+m(q.freq.toFixed(2))+" Hz ("+m(q.cents.toFixed())+" cents)",1)],32)),[[H,ot]]),Q((D(),L("g",Tt,[h("g",{id:"part1",onPointerdown:i[18]||(i[18]=c=>d(1,1)),onPointerenter:i[19]||(i[19]=c=>d(1,1)),onPointerover:i[20]||(i[20]=c=>d(1,1)),onPointercancel:i[21]||(i[21]=c=>d(1,0)),onPointerleave:i[22]||(i[22]=c=>d(1,0)),onPointerout:i[23]||(i[23]=c=>d(1,0))},[h("line",{stroke:w(p)($.freq,.3+.7*w(k)),"stroke-width":"8",x2:100*(1-w(E))},null,8,At),h("text",{y:"0.3",x:100*(1-w(E))/2},m($.note),9,Rt)],32),h("g",{id:"part2",onPointerdown:i[24]||(i[24]=c=>d(2,1)),onPointerenter:i[25]||(i[25]=c=>d(2,1)),onPointerover:i[26]||(i[26]=c=>d(2,1)),onPointercancel:i[27]||(i[27]=c=>d(2,0)),onPointerleave:i[28]||(i[28]=c=>d(2,0)),onPointerout:i[29]||(i[29]=c=>d(2,0))},[h("line",{stroke:w(p)(C.freq,.3+.7*w(a)),"stroke-width":"8",x1:100*(1-w(E)),x2:"100"},null,8,St),h("text",{y:"0.3",x:100-100*w(E)/2},m(C.note),9,jt),h("circle",{cx:100*(1-w(E)),r:"2"},null,8,Ht)],32),i[37]||(i[37]=h("circle",{r:"2"},null,-1)),i[38]||(i[38]=h("circle",{r:"2",cx:"100"},null,-1))])),[[H,J]])])),h("div",Zt,[(D(),L(ut,null,dt(it,(c,Z)=>h("button",{class:ht(["text-button flex-1",{active:Z==P.invFraction}]),key:Z,onClick:Gt=>P.ratio=c},m(Z),11,Vt)),64))])])):(D(),L("button",{key:0,class:"p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700 absolute min-h-30 top-0 z-100 right-0 left-0",onClick:i[0]||(i[0]=c=>{w(e)(),w(v)(),w(N)(),Y.value=!0})},"START "))}}};export{Xt as default};
