import{bm as W,H as U,aA as X,F as O,aF as N}from"./theme.Bg9LHQhv.js";import{r as ft,c as B,b as G,u as tt,av as ut,aQ as dt,P as nt,x as L,y as M,I as ht,A as l,C as A,H as V,E as c,G as q,F as at,B as ct,z as xt}from"./framework.DzzWumix.js";typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const f=BigInt(0),d=BigInt(1),H=BigInt(2),Y=BigInt(5),I=BigInt(10),gt=2e3,s={s:d,n:f,d};function z(t,n){try{t=BigInt(t)}catch{throw D()}return t*n}function w(t,n){if(n===f)throw J();const e=Object.create(j.prototype);e.s=t<f?-d:d,t=t<f?-t:t;const i=R(t,n);return e.n=t/i,e.d=n/i,e}function et(t){const n={};let e=t,i=H,u=Y-d;for(;u<=e;){for(;e%i===f;)e/=i,n[i]=(n[i]||f)+d;u+=d+H*i++}return e!==t?e>1&&(n[e]=(n[e]||f)+d):n[t]=(n[t]||f)+d,n}const k=function(t,n){let e=f,i=d,u=d;if(t!=null)if(n!==void 0){if(typeof t=="bigint")e=t;else{if(isNaN(t))throw D();if(t%1!==0)throw it();e=BigInt(t)}if(typeof n=="bigint")i=n;else{if(isNaN(n))throw D();if(n%1!==0)throw it();i=BigInt(n)}u=e*i}else if(typeof t=="object"){if("d"in t&&"n"in t)e=BigInt(t.n),i=BigInt(t.d),"s"in t&&(e*=BigInt(t.s));else if(0 in t)e=BigInt(t[0]),1 in t&&(i=BigInt(t[1]));else if(typeof t=="bigint")e=t;else throw D();u=e*i}else if(typeof t=="number"){if(isNaN(t))throw D();if(t<0&&(u=-d,t=-t),t%1===0)e=BigInt(t);else if(t>0){let r=1,h=0,g=1,F=1,y=1,P=1e7;for(t>=1&&(r=10**Math.floor(1+Math.log10(t)),t/=r);g<=P&&y<=P;){let a=(h+F)/(g+y);if(t===a){g+y<=P?(e=h+F,i=g+y):y>g?(e=F,i=y):(e=h,i=g);break}else t>a?(h+=F,g+=y):(F+=h,y+=g),g>P?(e=F,i=y):(e=h,i=g)}e=BigInt(e)*BigInt(r),i=BigInt(i)}}else if(typeof t=="string"){let r=0,h=f,g=f,F=f,y=d,P=d,a=t.replace(/_/g,"").match(/\d+|./g);if(a===null)throw D();if(a[r]==="-"?(u=-d,r++):a[r]==="+"&&r++,a.length===r+1?g=z(a[r++],u):a[r+1]==="."||a[r]==="."?(a[r]!=="."&&(h=z(a[r++],u)),r++,(r+1===a.length||a[r+1]==="("&&a[r+3]===")"||a[r+1]==="'"&&a[r+3]==="'")&&(g=z(a[r],u),y=I**BigInt(a[r].length),r++),(a[r]==="("&&a[r+2]===")"||a[r]==="'"&&a[r+2]==="'")&&(F=z(a[r+1],u),P=I**BigInt(a[r+1].length)-d,r+=3)):a[r+1]==="/"||a[r+1]===":"?(g=z(a[r],u),y=z(a[r+2],d),r+=3):a[r+3]==="/"&&a[r+1]===" "&&(h=z(a[r],u),g=z(a[r+2],u),y=z(a[r+4],d),r+=5),a.length<=r)i=y*P,u=e=F+i*h+P*g;else throw D()}else if(typeof t=="bigint")e=t,u=t,i=d;else throw D();if(i===f)throw J();s.s=u<f?-d:d,s.n=e<f?-e:e,s.d=i<f?-i:i};function vt(t,n,e){let i=d;for(;n>f;t=t*t%e,n>>=d)n&d&&(i=i*t%e);return i}function wt(t,n){for(;n%H===f;n/=H);for(;n%Y===f;n/=Y);if(n===d)return f;let e=I%n,i=1;for(;e!==d;i++)if(e=e*I%n,i>gt)return f;return BigInt(i)}function yt(t,n,e){let i=d,u=vt(I,e,n);for(let r=0;r<300;r++){if(i===u)return BigInt(r);i=i*I%n,u=u*I%n}return 0}function R(t,n){if(!t)return n;if(!n)return t;for(;;){if(t%=n,!t)return n;if(n%=t,!n)return t}}function j(t,n){if(k(t,n),this instanceof j)t=R(s.d,s.n),this.s=s.s,this.n=s.n/t,this.d=s.d/t;else return w(s.s*s.n,s.d)}var J=function(){return new Error("Division by Zero")},D=function(){return new Error("Invalid argument")},it=function(){return new Error("Parameters must be integer")};j.prototype={s:d,n:f,d,abs:function(){return w(this.n,this.d)},neg:function(){return w(-this.s*this.n,this.d)},add:function(t,n){return k(t,n),w(this.s*this.n*s.d+s.s*this.d*s.n,this.d*s.d)},sub:function(t,n){return k(t,n),w(this.s*this.n*s.d-s.s*this.d*s.n,this.d*s.d)},mul:function(t,n){return k(t,n),w(this.s*s.s*this.n*s.n,this.d*s.d)},div:function(t,n){return k(t,n),w(this.s*s.s*this.n*s.d,this.d*s.n)},clone:function(){return w(this.s*this.n,this.d)},mod:function(t,n){if(t===void 0)return w(this.s*this.n%this.d,d);if(k(t,n),f===s.n*this.d)throw J();return w(this.s*(s.d*this.n)%(s.n*this.d),s.d*this.d)},gcd:function(t,n){return k(t,n),w(R(s.n,this.n)*R(s.d,this.d),s.d*this.d)},lcm:function(t,n){return k(t,n),s.n===f&&this.n===f?w(f,d):w(s.n*this.n,R(s.n,this.n)*R(s.d,this.d))},inverse:function(){return w(this.s*this.d,this.n)},pow:function(t,n){if(k(t,n),s.d===d)return s.s<f?w((this.s*this.d)**s.n,this.n**s.n):w((this.s*this.n)**s.n,this.d**s.n);if(this.s<f)return null;let e=et(this.n),i=et(this.d),u=d,r=d;for(let h in e)if(h!=="1"){if(h==="0"){u=f;break}if(e[h]*=s.n,e[h]%s.d===f)e[h]/=s.d;else return null;u*=BigInt(h)**e[h]}for(let h in i)if(h!=="1"){if(i[h]*=s.n,i[h]%s.d===f)i[h]/=s.d;else return null;r*=BigInt(h)**i[h]}return s.s<f?w(r,u):w(u,r)},equals:function(t,n){return k(t,n),this.s*this.n*s.d===s.s*s.n*this.d},compare:function(t,n){k(t,n);let e=this.s*this.n*s.d-s.s*s.n*this.d;return(f<e)-(e<f)},ceil:function(t){return t=I**BigInt(t||0),w(this.s*t*this.n/this.d+(t*this.n%this.d>f&&this.s>=f?d:f),t)},floor:function(t){return t=I**BigInt(t||0),w(this.s*t*this.n/this.d-(t*this.n%this.d>f&&this.s<f?d:f),t)},round:function(t){return t=I**BigInt(t||0),w(this.s*t*this.n/this.d+this.s*((this.s>=f?d:f)+H*(t*this.n%this.d)>this.d?d:f),t)},roundTo:function(t,n){k(t,n);const e=this.n*s.d,i=this.d*s.n,u=e%i;let r=e/i;return u+u>=i&&r++,w(this.s*r*s.n,s.d)},divisible:function(t,n){return k(t,n),!(!(s.n*this.d)||this.n*s.d%(s.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let n=this.n,e=this.d;function i(g){return typeof g=="bigint"?g:Math.floor(g)}t=t||15;let u=wt(n,e),r=yt(n,e,u),h=this.s<f?"-":"";if(h+=i(n/e),n%=e,n*=I,n&&(h+="."),u){for(let g=r;g--;)h+=i(n/e),n%=e,n*=I;h+="(";for(let g=u;g--;)h+=i(n/e),n%=e,n*=I;h+=")"}else for(let g=t;n&&g--;)h+=i(n/e),n%=e,n*=I;return h},toFraction:function(t){let n=this.n,e=this.d,i=this.s<f?"-":"";if(e===d)i+=n;else{let u=n/e;t&&u>f&&(i+=u,i+=" ",n%=e),i+=n,i+="/",i+=e}return i},toLatex:function(t){let n=this.n,e=this.d,i=this.s<f?"-":"";if(e===d)i+=n;else{let u=n/e;t&&u>f&&(i+=u,n%=e),i+="\\frac{",i+=n,i+="}{",i+=e,i+="}"}return i},toContinued:function(){let t=this.n,n=this.d,e=[];do{e.push(t/n);let i=t%n;t=n,n=i}while(t!==d);return e},simplify:function(t){t=t||.001;const n=this.abs(),e=n.toContinued();for(let i=1;i<e.length;i++){let u=w(e[i-1],d);for(let r=i-2;r>=0;r--)u=u.inverse().add(e[r]);if(Math.abs(u.sub(n).valueOf())<t)return u.mul(this.s)}return this}};const mt={class:"flex flex-col fullscreen-container",id:"screen"},qt={class:"py-8 select-none touch-action-none select-none",style:{"-webkit-overflow-scrolling":"touch"},version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 31",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white"},bt={class:"cursor-pointer",id:"ratio",transform:"translate(0 10)","font-size":"4px","stroke-width":"0",fill:"currentColor"},pt={id:"intL"},Bt=["width"],It=["x"],Pt=["fill"],kt=["fill"],Ct={id:"intR"},_t=["width","x"],$t=["x"],Ft=["fill"],Nt=["fill"],zt=["stroke"],Et={x:"50",y:".5","font-weight":"bold","text-anchor":"end"},Lt={class:"text-6px"},Mt={x:"50.5",y:"-1.5","text-anchor":"start"},Dt={class:"text-2px"},Ot={class:"text-2px",x:"50.75",y:"1.5"},Rt={class:"cursor-pointer touch-manipulation",id:"divided",transform:"translate(0,20)"},St=["stroke","x1"],Tt=["transform"],At={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Ht={class:"text-2px",y:"-1.5","text-anchor":"start"},jt={class:"text-2px",y:"1.5","text-anchor":"start"},Gt=["stroke","x2"],Vt=["cx"],Zt=["transform"],Qt={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Wt={class:"text-2px",y:"-1.5","text-anchor":"start"},Xt={class:"text-2px",y:"1.5","text-anchor":"start"},Yt={class:"touch-manipulation",id:"ruler","stroke-width":"0.2",stroke:"currentColor"},Jt=["x1","x2"],Kt=["x"],Ut={class:"flex flex-wrap justify-center p-2"},tn=["onClick"],sn={__name:"MonoChord",setup(t){const{note:n,init:e,meter:i}=W("center"),{note:u,init:r,meter:h}=W("left"),{note:g,init:F,meter:y}=W("right"),P=ft(!1);function a(){P.value||(e(),r(),F(),P.value=!0)}const ot=[n,u,g],st=B(()=>[m.freq,_.freq,$.freq]),rt=p=>69+12*Math.log2(p/440);function x(p=0,o=.5){P.value&&Object.assign(ot[p],{number:rt(st.value[p]).toFixed(4),velocity:o})}const C=G({ratio:U(tt("monochord-ratio",.66),.05,.95),fraction:B(()=>new j(C.ratio).simplify(.001).toFraction(!0)),invFraction:B(()=>new j(1-C.ratio).simplify(.001).toFraction(!0))}),m=G({freq:U(tt("monochord-freq",220),27.5,3520),pitch:B(()=>X(m.freq).toFixed()),note:B(()=>O(m.freq).toNote()),cents:B(()=>Z(O(m.note).toFrequency(),m.freq))}),_=G({freq:B(()=>m.freq/C.ratio),pitch:B(()=>(X(_.freq)+120)%12),note:B(()=>O(_.freq).toNote()),cents:B(()=>Z(O(_.note).toFrequency(),_.freq))}),$=G({freq:B(()=>m.freq/(1-C.ratio)),pitch:B(()=>(X($.freq)+120)%12),note:B(()=>O($.freq).toNote()),cents:B(()=>Z(O($.note).toFrequency(),$.freq))}),lt={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},b=ut(B(()=>C.ratio),{duration:200,transition:dt.easeOutCubic});function K(p){const o=p.wheeling?-p.delta[0]/32:p.delta[0]/4;m.freq+=o}function E(p){const o=p.wheeling?-p.delta[0]/4800:p.delta[0]/1200;C.ratio+=o}function Z(p,o){return-(1200/Math.log10(2))*Math.log10(p/o)%1200}return(p,o)=>{const S=nt("wheel"),T=nt("drag");return L(),M("div",mt,[P.value?ht("",!0):(L(),M("button",{key:0,class:"p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700 absolute min-h-30 top-0 z-100 right-0 left-0 w-full bg-op-30 dark-bg-op-30 backdrop-blur",onPointerdown:o[0]||(o[0]=v=>a())},"START ",32)),(L(),M("svg",qt,[l("g",bt,[A((L(),M("g",{class:"touch-manipulation",id:"intervalL",onPointerdown:o[1]||(o[1]=v=>{x(0),x(1)}),onPointercancel:o[2]||(o[2]=v=>{x(0,0),x(1,0)}),onPointerup:o[3]||(o[3]=v=>{x(0,0),x(1,0)}),onPointerout:o[4]||(o[4]=v=>{x(0,0),x(1,0)})},[l("defs",null,[l("linearGradient",pt,[l("stop",{offset:"0%",style:V({stopColor:c(N)(_.freq,void 0,c(h))})},null,4),l("stop",{offset:"100%",style:V({stopColor:c(N)(m.freq,void 0,c(i))})},null,4)])]),l("rect",{width:100*c(b)-4,height:"8",y:"-4",x:"1",rx:"2",fill:"url(#intL)"},null,8,Bt),l("text",{x:100*c(b)/2-2,"text-anchor":"middle",y:".5"},[l("tspan",{class:"font-bold",fill:c(N)(_.freq)},q(C.fraction.split("/")[0]),9,Pt),o[24]||(o[24]=l("tspan",null,"/",-1)),l("tspan",{class:"font-bold",fill:c(N)(m.freq)},q(C.fraction.split("/")[1]),9,kt)],8,It)],32)),[[S,E],[T,E]]),A((L(),M("g",{class:"touch-manipulation",id:"intervalR",onPointerdown:o[5]||(o[5]=v=>{x(0),x(2)}),onPointercancel:o[6]||(o[6]=v=>{x(0,0),x(2,0)}),onPointerup:o[7]||(o[7]=v=>{x(0,0),x(2,0)}),onPointerout:o[8]||(o[8]=v=>{x(0,0),x(2,0)})},[l("defs",null,[l("linearGradient",Ct,[l("stop",{offset:"0%",style:V({stopColor:c(N)(m.freq,void 0,c(i))})},null,4),l("stop",{offset:"100%",style:V({stopColor:c(N)($.freq,void 0,c(y))})},null,4)])]),l("rect",{width:100*(1-c(b))-4,height:"8",y:"-4",x:100-100*(1-c(b))+3,rx:"2",fill:"url(#intR)"},null,8,_t),l("text",{x:100*c(b)+100*(1-c(b))/2+2,"text-anchor":"middle",y:".5"},[l("tspan",{class:"font-bold",fill:c(N)($.freq)},q(C.invFraction.split("/")[0]),9,Ft),o[25]||(o[25]=l("tspan",null,"/",-1)),l("tspan",{class:"font-bold",fill:c(N)(m.freq)},q(C.invFraction.split("/")[1]),9,Nt)],8,$t)],32)),[[S,E],[T,E]])]),A((L(),M("g",{class:"cursor-pointer touch-manipulation",id:"fundamental",onPointerdown:o[9]||(o[9]=v=>x(0)),onPointercancel:o[10]||(o[10]=v=>x(0,0)),onPointerleave:o[11]||(o[11]=v=>x(0,0)),onPointerout:o[12]||(o[12]=v=>x(0,0)),onPointerup:o[13]||(o[13]=v=>x(0,0))},[l("line",{x2:"100","stroke-width":"10",stroke:c(N)(m.freq,.3+.7*c(i))},null,8,zt),o[26]||(o[26]=l("circle",{r:"2"},null,-1)),o[27]||(o[27]=l("circle",{cx:"100",r:"2"},null,-1)),l("text",Et,[l("tspan",Lt,q(m.note),1)]),l("text",Mt,[l("tspan",Dt,q(m.cents>0?"+":"")+q(m.cents.toFixed())+"% ",1),l("tspan",Ot,q(m.freq.toFixed(2))+" Hz ",1)])],32)),[[T,K],[S,K]]),A((L(),M("g",Rt,[l("g",{id:"part2",onPointerdown:o[14]||(o[14]=v=>x(2,1)),onPointercancel:o[15]||(o[15]=v=>x(2,0)),onPointerleave:o[16]||(o[16]=v=>x(2,0)),onPointerout:o[17]||(o[17]=v=>x(2,0)),onPointerup:o[18]||(o[18]=v=>x(2,0))},[l("line",{stroke:c(N)($.freq,.3+.7*c(y)),"stroke-width":"10",x1:100*c(b),x2:"100"},null,8,St),o[28]||(o[28]=l("circle",{r:"2",cx:"100"},null,-1)),l("g",{transform:`translate(${100*c(b)+5+100*(1-c(b))/2} 0.5)`},[l("text",At,q($.note),1),l("text",Ht,q($.cents>0?"+":"")+q($.cents.toFixed())+"% ",1),l("text",jt,q($.freq.toFixed(2))+" Hz ",1)],8,Tt)],32),l("g",{id:"part1",onPointerdown:o[19]||(o[19]=v=>x(1,1)),onPointercancel:o[20]||(o[20]=v=>x(1,0)),onPointerleave:o[21]||(o[21]=v=>x(1,0)),onPointerout:o[22]||(o[22]=v=>x(1,0)),onPointerup:o[23]||(o[23]=v=>x(1,0))},[l("line",{stroke:c(N)(_.freq,.3+.7*c(h)),"stroke-width":"10",x2:100*c(b)},null,8,Gt),o[29]||(o[29]=l("circle",{r:"2"},null,-1)),l("circle",{cx:100*c(b),r:"2"},null,8,Vt),l("g",{transform:`translate(${100*c(b)/2} 0.5)`},[l("text",Qt,q(_.note),1),l("text",Wt,q(_.cents>0?"+":"")+q(_.cents.toFixed())+"% ",1),l("text",Xt,q(_.freq.toFixed(2))+" Hz ",1)],8,Zt)],32)])),[[T,E],[S,E]]),l("g",Yt,[o[30]||(o[30]=l("line",{y1:"0",y2:"20"},null,-1)),o[31]||(o[31]=l("line",{x1:"100",x2:"100",y1:"0",y2:"20"},null,-1)),l("line",{x1:100*c(b),x2:100*c(b),y1:"5",y2:"20"},null,8,Jt),A(l("rect",{class:"cursor-grab",width:"8",height:"8",opacity:"0.3",rx:"2",x:100*c(b)-4,y:"6"},null,8,Kt),[[S,E],[T,E]])])])),l("div",Ut,[(L(),M(at,null,ct(lt,(v,Q)=>l("button",{class:xt(["text-button flex-1",{active:Q==C.fraction}]),key:Q,onClick:nn=>C.ratio=v},q(Q),11,tn)),64))])])}}};export{sn as default};
