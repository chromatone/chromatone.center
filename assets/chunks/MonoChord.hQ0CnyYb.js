import{D as G,F as Z,bb as Y,aA as I}from"./theme.DymgPwgJ.js";import{u as J}from"./index.CD2wFBtQ.js";import{r as K,b as A,c as z,d as Q,M as V,x as C,y as F,A as f,H as O,E as x,G as w,C as R,F as U,B as tt,z as nt}from"./framework.Bh6q1hI4.js";typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const d=BigInt(0),a=BigInt(1),D=BigInt(2),T=BigInt(5),p=BigInt(10),et=2e3,o={s:a,n:d,d:a};function _(t,n){try{t=BigInt(t)}catch{throw $()}return t*n}function k(t){return typeof t=="bigint"?t:Math.floor(t)}function m(t,n){if(n===d)throw j();const e=Object.create(S.prototype);e.s=t<d?-a:a,t=t<d?-t:t;const s=E(t,n);return e.n=t/s,e.d=n/s,e}function W(t){const n={};let e=t,s=D,u=T-a;for(;u<=e;){for(;e%s===d;)e/=s,n[s]=(n[s]||d)+a;u+=a+D*s++}return e!==t?e>1&&(n[e]=(n[e]||d)+a):n[t]=(n[t]||d)+a,n}const y=function(t,n){let e=d,s=a,u=a;if(t!=null)if(n!==void 0){if(typeof t=="bigint")e=t;else{if(isNaN(t))throw $();if(t%1!==0)throw X();e=BigInt(t)}if(typeof n=="bigint")s=n;else{if(isNaN(n))throw $();if(n%1!==0)throw X();s=BigInt(n)}u=e*s}else if(typeof t=="object"){if("d"in t&&"n"in t)e=BigInt(t.n),s=BigInt(t.d),"s"in t&&(e*=BigInt(t.s));else if(0 in t)e=BigInt(t[0]),1 in t&&(s=BigInt(t[1]));else if(typeof t=="bigint")e=t;else throw $();u=e*s}else if(typeof t=="number"){if(isNaN(t))throw $();if(t<0&&(u=-a,t=-t),t%1===0)e=BigInt(t);else if(t>0){let i=1,c=0,h=1,B=1,b=1,P=1e7;for(t>=1&&(i=10**Math.floor(1+Math.log10(t)),t/=i);h<=P&&b<=P;){let l=(c+B)/(h+b);if(t===l){h+b<=P?(e=c+B,s=h+b):b>h?(e=B,s=b):(e=c,s=h);break}else t>l?(c+=B,h+=b):(B+=c,b+=h),h>P?(e=B,s=b):(e=c,s=h)}e=BigInt(e)*BigInt(i),s=BigInt(s)}}else if(typeof t=="string"){let i=0,c=d,h=d,B=d,b=a,P=a,l=t.replace(/_/g,"").match(/\d+|./g);if(l===null)throw $();if(l[i]==="-"?(u=-a,i++):l[i]==="+"&&i++,l.length===i+1?h=_(l[i++],u):l[i+1]==="."||l[i]==="."?(l[i]!=="."&&(c=_(l[i++],u)),i++,(i+1===l.length||l[i+1]==="("&&l[i+3]===")"||l[i+1]==="'"&&l[i+3]==="'")&&(h=_(l[i],u),b=p**BigInt(l[i].length),i++),(l[i]==="("&&l[i+2]===")"||l[i]==="'"&&l[i+2]==="'")&&(B=_(l[i+1],u),P=p**BigInt(l[i+1].length)-a,i+=3)):l[i+1]==="/"||l[i+1]===":"?(h=_(l[i],u),b=_(l[i+2],a),i+=3):l[i+3]==="/"&&l[i+1]===" "&&(c=_(l[i],u),h=_(l[i+2],u),b=_(l[i+4],a),i+=5),l.length<=i)s=b*P,u=e=B+s*c+P*h;else throw $()}else if(typeof t=="bigint")e=t,u=t,s=a;else throw $();if(s===d)throw j();o.s=u<d?-a:a,o.n=e<d?-e:e,o.d=s<d?-s:s};function it(t,n,e){let s=a;for(;n>d;t=t*t%e,n>>=a)n&a&&(s=s*t%e);return s}function st(t,n){for(;n%D===d;n/=D);for(;n%T===d;n/=T);if(n===a)return d;let e=p%n,s=1;for(;e!==a;s++)if(e=e*p%n,s>et)return d;return BigInt(s)}function ot(t,n,e){let s=a,u=it(p,e,n);for(let i=0;i<300;i++){if(s===u)return BigInt(i);s=s*p%n,u=u*p%n}return 0}function E(t,n){if(!t)return n;if(!n)return t;for(;;){if(t%=n,!t)return n;if(n%=t,!n)return t}}function S(t,n){if(y(t,n),this instanceof S)t=E(o.d,o.n),this.s=o.s,this.n=o.n/t,this.d=o.d/t;else return m(o.s*o.n,o.d)}var j=function(){return new Error("Division by Zero")},$=function(){return new Error("Invalid argument")},X=function(){return new Error("Parameters must be integer")};S.prototype={s:a,n:d,d:a,abs:function(){return m(this.n,this.d)},neg:function(){return m(-this.s*this.n,this.d)},add:function(t,n){return y(t,n),m(this.s*this.n*o.d+o.s*this.d*o.n,this.d*o.d)},sub:function(t,n){return y(t,n),m(this.s*this.n*o.d-o.s*this.d*o.n,this.d*o.d)},mul:function(t,n){return y(t,n),m(this.s*o.s*this.n*o.n,this.d*o.d)},div:function(t,n){return y(t,n),m(this.s*o.s*this.n*o.d,this.d*o.n)},clone:function(){return m(this.s*this.n,this.d)},mod:function(t,n){if(t===void 0)return m(this.s*this.n%this.d,a);if(y(t,n),d===o.n*this.d)throw j();return m(this.s*(o.d*this.n)%(o.n*this.d),o.d*this.d)},gcd:function(t,n){return y(t,n),m(E(o.n,this.n)*E(o.d,this.d),o.d*this.d)},lcm:function(t,n){return y(t,n),o.n===d&&this.n===d?m(d,a):m(o.n*this.n,E(o.n,this.n)*E(o.d,this.d))},inverse:function(){return m(this.s*this.d,this.n)},pow:function(t,n){if(y(t,n),o.d===a)return o.s<d?m((this.s*this.d)**o.n,this.n**o.n):m((this.s*this.n)**o.n,this.d**o.n);if(this.s<d)return null;let e=W(this.n),s=W(this.d),u=a,i=a;for(let c in e)if(c!=="1"){if(c==="0"){u=d;break}if(e[c]*=o.n,e[c]%o.d===d)e[c]/=o.d;else return null;u*=BigInt(c)**e[c]}for(let c in s)if(c!=="1"){if(s[c]*=o.n,s[c]%o.d===d)s[c]/=o.d;else return null;i*=BigInt(c)**s[c]}return o.s<d?m(i,u):m(u,i)},equals:function(t,n){return y(t,n),this.s*this.n*o.d===o.s*o.n*this.d},lt:function(t,n){return y(t,n),this.s*this.n*o.d<o.s*o.n*this.d},lte:function(t,n){return y(t,n),this.s*this.n*o.d<=o.s*o.n*this.d},gt:function(t,n){return y(t,n),this.s*this.n*o.d>o.s*o.n*this.d},gte:function(t,n){return y(t,n),this.s*this.n*o.d>=o.s*o.n*this.d},compare:function(t,n){y(t,n);let e=this.s*this.n*o.d-o.s*o.n*this.d;return(d<e)-(e<d)},ceil:function(t){return t=p**BigInt(t||0),m(k(this.s*t*this.n/this.d)+(t*this.n%this.d>d&&this.s>=d?a:d),t)},floor:function(t){return t=p**BigInt(t||0),m(k(this.s*t*this.n/this.d)-(t*this.n%this.d>d&&this.s<d?a:d),t)},round:function(t){return t=p**BigInt(t||0),m(k(this.s*t*this.n/this.d)+this.s*((this.s>=d?a:d)+D*(t*this.n%this.d)>this.d?a:d),t)},roundTo:function(t,n){y(t,n);const e=this.n*o.d,s=this.d*o.n,u=e%s;let i=k(e/s);return u+u>=s&&i++,m(this.s*i*o.n,o.d)},divisible:function(t,n){return y(t,n),!(!(o.n*this.d)||this.n*o.d%(o.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let n=this.n,e=this.d;t=t||15;let s=st(n,e),u=ot(n,e,s),i=this.s<d?"-":"";if(i+=k(n/e),n%=e,n*=p,n&&(i+="."),s){for(let c=u;c--;)i+=k(n/e),n%=e,n*=p;i+="(";for(let c=s;c--;)i+=k(n/e),n%=e,n*=p;i+=")"}else for(let c=t;n&&c--;)i+=k(n/e),n%=e,n*=p;return i},toFraction:function(t){let n=this.n,e=this.d,s=this.s<d?"-":"";if(e===a)s+=n;else{let u=k(n/e);t&&u>d&&(s+=u,s+=" ",n%=e),s+=n,s+="/",s+=e}return s},toLatex:function(t){let n=this.n,e=this.d,s=this.s<d?"-":"";if(e===a)s+=n;else{let u=k(n/e);t&&u>d&&(s+=u,n%=e),s+="\\frac{",s+=n,s+="}{",s+=e,s+="}"}return s},toContinued:function(){let t=this.n,n=this.d,e=[];do{e.push(k(t/n));let s=t%n;t=n,n=s}while(t!==a);return e},simplify:function(t){t=t||.001;const n=this.abs(),e=n.toContinued();for(let s=1;s<e.length;s++){let u=m(e[s-1],a);for(let i=s-2;i>=0;i--)u=u.inverse().add(e[i]);if(Math.abs(u.sub(n).valueOf())<t)return u.mul(this.s)}return this}};const rt={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},lt={class:"flex flex-col fullscreen-container select-none z-100",id:"screen"},ut={key:1,class:"my-12 select-none touch-action-none select-none",style:{"-webkit-overflow-scrolling":"touch"},version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 31",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white"},ft={class:"cursor-pointer",id:"ratio",transform:"translate(0 10)","font-size":"4px","stroke-width":"0",fill:"currentColor"},dt={id:"intL"},at=["width"],ht=["x"],ct=["fill"],xt=["fill"],gt={id:"intR"},vt=["width","x"],mt=["x"],wt=["fill"],yt=["fill"],bt=["stroke"],pt={class:"pointer-events-none",x:"50",y:".5","font-weight":"bold","text-anchor":"end"},Bt={class:"text-6px"},It={class:"pointer-events-none",x:"50.5",y:"-1.5","text-anchor":"start"},kt={class:"text-2px"},Pt={class:"text-2px",x:"50.75",y:"1.5"},_t={class:"cursor-pointer touch-manipulation",id:"divided",transform:"translate(0,20)"},$t=["stroke","x1"],Ct=["transform"],Ft={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Nt={class:"text-2px",y:"-1.5","text-anchor":"start"},zt={class:"text-2px",y:"1.5","text-anchor":"start"},Et=["stroke","x2"],Mt=["cx"],Dt=["transform"],Lt={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Ot={class:"text-2px",y:"-1.5","text-anchor":"start"},St={class:"text-2px",y:"1.5","text-anchor":"start"},qt={class:"touch-manipulation",id:"ruler","stroke-width":"0.2",stroke:"currentColor"},At=["x1","x2"],Rt=["x"],Tt={class:"flex flex-wrap justify-center p-2"},jt=["onClick"],Wt={__name:"MonoChord",setup(t){const n=K(!1),e=A({ratio:G(.66,.05,.95),fraction:z(()=>s(e.ratio)),invFraction:z(()=>s(1-e.ratio))}),s=v=>new S(v).simplify(.001).toFraction(!0),u=J({ratio:e.ratio});Q(()=>e.ratio,v=>u.ratio=v);const i=A([G(220,27.5,3520),z(()=>i[0].value/u.ratio),z(()=>i[0].value/(1-u.ratio))]),h=A(["fundamental","left","right"].map((v,r)=>{const N=z(()=>Z(i[r].value).toNote()),M=z(()=>B(Z(N.value).toFrequency(),i[r].value));return{...Y(v),name:N,cents:M}})),B=(v,r)=>-(1200/Math.log10(2))*Math.log10(v/r)%1200;function b(){n.value||(h.forEach(v=>v.init()),n.value=!0)}const P=v=>69+12*Math.log2(v/440);function l(v=0,r=.5){n.value&&Object.assign(h[v].note,{number:P(i[v].value).toFixed(4),velocity:r})}function H(v){i[0].value+=v.wheeling?-v.delta[0]/32:v.delta[0]/4}function L(v){e.ratio+=v.wheeling?-v.delta[0]/4800:v.delta[0]/1200}return(v,r)=>{const N=V("drag"),M=V("wheel");return C(),F("div",lt,[n.value?(C(),F("svg",ut,[f("g",ft,[f("g",{class:"touch-manipulation",id:"intervalL",onPointerdown:r[1]||(r[1]=g=>{l(0),l(1)}),onPointercancel:r[2]||(r[2]=g=>{l(0,0),l(1,0)}),onPointerup:r[3]||(r[3]=g=>{l(0,0),l(1,0)}),onPointerout:r[4]||(r[4]=g=>{l(0,0),l(1,0)})},[f("defs",null,[f("linearGradient",dt,[f("stop",{offset:"0%",style:O({stopColor:x(I)(i[1].value,void 0,h[1].meter)})},null,4),f("stop",{offset:"100%",style:O({stopColor:x(I)(i[0].value,void 0,h[0].meter)})},null,4)])]),f("rect",{width:100*x(u).ratio-4,height:"8",y:"-4",x:"1",rx:"2",fill:"url(#intL)"},null,8,at),f("text",{class:"pointer-events-none",x:100*x(u).ratio/2-2,"text-anchor":"middle",y:".5"},[f("tspan",{class:"font-bold",fill:x(I)(i[1].value)},w(e.fraction.split("/")[0]),9,ct),r[24]||(r[24]=f("tspan",null,"/",-1)),f("tspan",{class:"font-bold",fill:x(I)(i[0].value)},w(e.fraction.split("/")[1]),9,xt)],8,ht)],32),f("g",{class:"touch-manipulation",id:"intervalR",onPointerdown:r[5]||(r[5]=g=>{l(0),l(2)}),onPointercancel:r[6]||(r[6]=g=>{l(0,0),l(2,0)}),onPointerup:r[7]||(r[7]=g=>{l(0,0),l(2,0)}),onPointerout:r[8]||(r[8]=g=>{l(0,0),l(2,0)})},[f("defs",null,[f("linearGradient",gt,[f("stop",{offset:"0%",style:O({stopColor:x(I)(i[0].value,void 0,h[0].meter)})},null,4),f("stop",{offset:"100%",style:O({stopColor:x(I)(i[2].value,void 0,h[2].meter)})},null,4)])]),f("rect",{width:100*(1-x(u).ratio)-4,height:"8",y:"-4",x:100-100*(1-x(u).ratio)+3,rx:"2",fill:"url(#intR)"},null,8,vt),f("text",{class:"pointer-events-none",x:100*x(u).ratio+100*(1-x(u).ratio)/2+2,"text-anchor":"middle",y:".5"},[f("tspan",{class:"font-bold",fill:x(I)(i[2].value)},w(e.invFraction.split("/")[0]),9,wt),r[25]||(r[25]=f("tspan",null,"/",-1)),f("tspan",{class:"font-bold",fill:x(I)(i[0].value)},w(e.invFraction.split("/")[1]),9,yt)],8,mt)],32)]),R((C(),F("g",{class:"cursor-pointer touch-manipulation",id:"fundamental",onPointerdown:r[9]||(r[9]=g=>l(0)),onPointercancel:r[10]||(r[10]=g=>l(0,0)),onPointerleave:r[11]||(r[11]=g=>l(0,0)),onPointerout:r[12]||(r[12]=g=>l(0,0)),onPointerup:r[13]||(r[13]=g=>l(0,0))},[f("line",{x2:"100","stroke-width":"10",stroke:x(I)(i[0].value,.3+.7*h[0].meter)},null,8,bt),r[26]||(r[26]=f("circle",{r:"2"},null,-1)),r[27]||(r[27]=f("circle",{cx:"100",r:"2"},null,-1)),f("text",pt,[f("tspan",Bt,w(h[0].name),1)]),f("text",It,[f("tspan",kt,w(h[0].cents>0?"+":"")+w(h[0].cents.toFixed())+"% ",1),f("tspan",Pt,w(i[0].value.toFixed(2))+" Hz ",1)])],32)),[[N,H],[M,H]]),R((C(),F("g",_t,[f("g",{id:"right",onPointerdown:r[14]||(r[14]=g=>l(2)),onPointercancel:r[15]||(r[15]=g=>l(2,0)),onPointerleave:r[16]||(r[16]=g=>l(2,0)),onPointerout:r[17]||(r[17]=g=>l(2,0)),onPointerup:r[18]||(r[18]=g=>l(2,0))},[f("line",{stroke:x(I)(i[2].value,.3+.7*h[2].meter),"stroke-width":"10",x1:100*x(u).ratio,x2:"100"},null,8,$t),r[28]||(r[28]=f("circle",{r:"2",cx:"100"},null,-1)),f("g",{transform:`translate(${100*x(u).ratio+5+100*(1-x(u).ratio)/2} 0.5)`},[f("text",Ft,w(h[2].name),1),f("text",Nt,w(h[2].cents>0?"+":"")+w(h[2].cents.toFixed())+"% ",1),f("text",zt,w(i[2].value.toFixed(2))+" Hz ",1)],8,Ct)],32),f("g",{id:"left",onPointerdown:r[19]||(r[19]=g=>l(1)),onPointercancel:r[20]||(r[20]=g=>l(1,0)),onPointerleave:r[21]||(r[21]=g=>l(1,0)),onPointerout:r[22]||(r[22]=g=>l(1,0)),onPointerup:r[23]||(r[23]=g=>l(1,0))},[f("line",{stroke:x(I)(i[1].value,.3+.7*h[1].meter),"stroke-width":"10",x2:100*x(u).ratio},null,8,Et),r[29]||(r[29]=f("circle",{r:"2"},null,-1)),f("circle",{cx:100*x(u).ratio,r:"2"},null,8,Mt),f("g",{transform:`translate(${100*x(u).ratio/2} 0.5)`},[f("text",Lt,w(h[1].name),1),f("text",Ot,w(h[1].cents>0?"+":"")+w(h[1].cents.toFixed())+"% ",1),f("text",St,w(i[1].value.toFixed(2))+" Hz ",1)],8,Dt)],32)])),[[N,L],[M,L]]),f("g",qt,[r[30]||(r[30]=f("line",{y1:"0",y2:"20"},null,-1)),r[31]||(r[31]=f("line",{x1:"100",x2:"100",y1:"0",y2:"20"},null,-1)),f("line",{x1:100*x(u).ratio,x2:100*x(u).ratio,y1:"5",y2:"20"},null,8,At),R(f("rect",{class:"cursor-grab",width:"8",height:"8",opacity:"0.3",rx:"2",x:100*x(u).ratio-4,y:"6"},null,8,Rt),[[M,L],[N,L]])])])):(C(),F("button",{key:0,class:"min-h-80vh p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700 absolute min-h-30 top-0 z-100 right-0 left-0 w-full bg-op-30 dark-bg-op-30 backdrop-blur",onPointerdown:r[0]||(r[0]=g=>b())},"START ",32)),f("div",Tt,[(C(!0),F(U,null,tt(x(rt),(g,q)=>(C(),F("button",{class:nt(["text-button flex-1",{active:q==e.fraction}]),key:q,onClick:Ht=>e.ratio=g},w(q),11,jt))),128))])])}}};export{Wt as default};
