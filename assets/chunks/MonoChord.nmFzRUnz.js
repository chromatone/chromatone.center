import{D as _,I as F,b6 as D,aA as x}from"./theme.7_GhOmt2.js";import{u as L}from"./index.H6CleFuy.js";import{F as M}from"./fraction.TqTz4TU4.js";import{r as S,H as $,G as c,J as B,a0 as C,q as f,f as v,s as e,R as b,v as w,u as n,z as d,F as H,Q as G,y as I}from"./framework.D01lOa8K.js";const j={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},A={class:"flex flex-col fullscreen-container select-none z-100",id:"screen"},E={key:1,class:"my-12 select-none touch-action-none select-none",style:{"-webkit-overflow-scrolling":"touch"},version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 31",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white"},N={class:"cursor-pointer",id:"ratio",transform:"translate(0 10)","font-size":"4px","stroke-width":"0",fill:"currentColor"},T={id:"intL"},J=["width"],O=["x"],Q=["fill"],V=["fill"],K={id:"intR"},U=["width","x"],W=["x"],X=["fill"],Y=["fill"],Z=["stroke"],tt={class:"pointer-events-none",x:"50",y:".5","font-weight":"bold","text-anchor":"end"},et={class:"text-6px"},ot={class:"pointer-events-none",x:"50.5",y:"-1.5","text-anchor":"start"},nt={class:"text-2px"},st={class:"text-2px",x:"50.75",y:"1.5"},it={class:"cursor-pointer touch-manipulation",id:"divided",transform:"translate(0,20)"},lt=["stroke","x1"],rt=["transform"],at={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},dt={class:"text-2px",y:"-1.5","text-anchor":"start"},ut={class:"text-2px",y:"1.5","text-anchor":"start"},xt=["stroke","x2"],ft=["cx"],vt=["transform"],pt={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},ct={class:"text-2px",y:"-1.5","text-anchor":"start"},mt={class:"text-2px",y:"1.5","text-anchor":"start"},gt={class:"touch-manipulation",id:"ruler","stroke-width":"0.2",stroke:"currentColor"},yt=["x1","x2"],wt=["x"],ht={class:"flex flex-wrap justify-center p-2"},$t=["onClick"],qt={__name:"MonoChord",setup(bt){const g=S(!1),u=$({ratio:_(.66,.05,.95),fraction:c(()=>k(u.ratio)),invFraction:c(()=>k(1-u.ratio))}),k=i=>new M(i).simplify(.001).toFraction(!0),r=L({ratio:u.ratio});B(()=>u.ratio,i=>r.ratio=i);const l=$([_(220,27.5,3520),c(()=>l[0].value/r.ratio),c(()=>l[0].value/(1-r.ratio))]),a=$(["fundamental","left","right"].map((i,t)=>{const p=c(()=>F(l[t].value).toNote()),m=c(()=>z(F(p.value).toFrequency(),l[t].value));return{...D(i),name:p,cents:m}})),z=(i,t)=>-(1200/Math.log10(2))*Math.log10(i/t)%1200;function q(){g.value||(a.forEach(i=>i.init()),g.value=!0)}const R=i=>69+12*Math.log2(i/440);function o(i=0,t=.5){g.value&&Object.assign(a[i].note,{number:R(l[i].value).toFixed(4),velocity:t})}function P(i){l[0].value+=i.wheeling?-i.delta[0]/32:i.delta[0]/4}function y(i){u.ratio+=i.wheeling?-i.delta[0]/4800:i.delta[0]/1200}return(i,t)=>{const p=C("drag"),m=C("wheel");return v(),f("div",A,[g.value?(v(),f("svg",E,[e("g",N,[e("g",{class:"touch-manipulation",id:"intervalL",onPointerdown:t[1]||(t[1]=s=>{o(0),o(1)}),onPointercancel:t[2]||(t[2]=s=>{o(0,0),o(1,0)}),onPointerup:t[3]||(t[3]=s=>{o(0,0),o(1,0)}),onPointerout:t[4]||(t[4]=s=>{o(0,0),o(1,0)})},[e("defs",null,[e("linearGradient",T,[e("stop",{offset:"0%",style:w({stopColor:n(x)(l[1].value,void 0,a[1].meter)})},null,4),e("stop",{offset:"100%",style:w({stopColor:n(x)(l[0].value,void 0,a[0].meter)})},null,4)])]),e("rect",{width:100*n(r).ratio-4,height:"8",y:"-4",x:"1",rx:"2",fill:"url(#intL)"},null,8,J),e("text",{class:"pointer-events-none",x:100*n(r).ratio/2-2,"text-anchor":"middle",y:".5"},[e("tspan",{class:"font-bold",fill:n(x)(l[1].value)},d(u.fraction.split("/")[0]),9,Q),t[24]||(t[24]=e("tspan",null,"/",-1)),e("tspan",{class:"font-bold",fill:n(x)(l[0].value)},d(u.fraction.split("/")[1]),9,V)],8,O)],32),e("g",{class:"touch-manipulation",id:"intervalR",onPointerdown:t[5]||(t[5]=s=>{o(0),o(2)}),onPointercancel:t[6]||(t[6]=s=>{o(0,0),o(2,0)}),onPointerup:t[7]||(t[7]=s=>{o(0,0),o(2,0)}),onPointerout:t[8]||(t[8]=s=>{o(0,0),o(2,0)})},[e("defs",null,[e("linearGradient",K,[e("stop",{offset:"0%",style:w({stopColor:n(x)(l[0].value,void 0,a[0].meter)})},null,4),e("stop",{offset:"100%",style:w({stopColor:n(x)(l[2].value,void 0,a[2].meter)})},null,4)])]),e("rect",{width:100*(1-n(r).ratio)-4,height:"8",y:"-4",x:100-100*(1-n(r).ratio)+3,rx:"2",fill:"url(#intR)"},null,8,U),e("text",{class:"pointer-events-none",x:100*n(r).ratio+100*(1-n(r).ratio)/2+2,"text-anchor":"middle",y:".5"},[e("tspan",{class:"font-bold",fill:n(x)(l[2].value)},d(u.invFraction.split("/")[0]),9,X),t[25]||(t[25]=e("tspan",null,"/",-1)),e("tspan",{class:"font-bold",fill:n(x)(l[0].value)},d(u.invFraction.split("/")[1]),9,Y)],8,W)],32)]),b((v(),f("g",{class:"cursor-pointer touch-manipulation",id:"fundamental",onPointerdown:t[9]||(t[9]=s=>o(0)),onPointercancel:t[10]||(t[10]=s=>o(0,0)),onPointerleave:t[11]||(t[11]=s=>o(0,0)),onPointerout:t[12]||(t[12]=s=>o(0,0)),onPointerup:t[13]||(t[13]=s=>o(0,0))},[e("line",{x2:"100","stroke-width":"10",stroke:n(x)(l[0].value,.3+.7*a[0].meter)},null,8,Z),t[26]||(t[26]=e("circle",{r:"2"},null,-1)),t[27]||(t[27]=e("circle",{cx:"100",r:"2"},null,-1)),e("text",tt,[e("tspan",et,d(a[0].name),1)]),e("text",ot,[e("tspan",nt,d(a[0].cents>0?"+":"")+d(a[0].cents.toFixed())+"% ",1),e("tspan",st,d(l[0].value.toFixed(2))+" Hz ",1)])],32)),[[p,P],[m,P]]),b((v(),f("g",it,[e("g",{id:"right",onPointerdown:t[14]||(t[14]=s=>o(2)),onPointercancel:t[15]||(t[15]=s=>o(2,0)),onPointerleave:t[16]||(t[16]=s=>o(2,0)),onPointerout:t[17]||(t[17]=s=>o(2,0)),onPointerup:t[18]||(t[18]=s=>o(2,0))},[e("line",{stroke:n(x)(l[2].value,.3+.7*a[2].meter),"stroke-width":"10",x1:100*n(r).ratio,x2:"100"},null,8,lt),t[28]||(t[28]=e("circle",{r:"2",cx:"100"},null,-1)),e("g",{transform:`translate(${100*n(r).ratio+5+100*(1-n(r).ratio)/2} 0.5)`},[e("text",at,d(a[2].name),1),e("text",dt,d(a[2].cents>0?"+":"")+d(a[2].cents.toFixed())+"% ",1),e("text",ut,d(l[2].value.toFixed(2))+" Hz ",1)],8,rt)],32),e("g",{id:"left",onPointerdown:t[19]||(t[19]=s=>o(1)),onPointercancel:t[20]||(t[20]=s=>o(1,0)),onPointerleave:t[21]||(t[21]=s=>o(1,0)),onPointerout:t[22]||(t[22]=s=>o(1,0)),onPointerup:t[23]||(t[23]=s=>o(1,0))},[e("line",{stroke:n(x)(l[1].value,.3+.7*a[1].meter),"stroke-width":"10",x2:100*n(r).ratio},null,8,xt),t[29]||(t[29]=e("circle",{r:"2"},null,-1)),e("circle",{cx:100*n(r).ratio,r:"2"},null,8,ft),e("g",{transform:`translate(${100*n(r).ratio/2} 0.5)`},[e("text",pt,d(a[1].name),1),e("text",ct,d(a[1].cents>0?"+":"")+d(a[1].cents.toFixed())+"% ",1),e("text",mt,d(l[1].value.toFixed(2))+" Hz ",1)],8,vt)],32)])),[[p,y],[m,y]]),e("g",gt,[t[30]||(t[30]=e("line",{y1:"0",y2:"20"},null,-1)),t[31]||(t[31]=e("line",{x1:"100",x2:"100",y1:"0",y2:"20"},null,-1)),e("line",{x1:100*n(r).ratio,x2:100*n(r).ratio,y1:"5",y2:"20"},null,8,yt),b(e("rect",{class:"cursor-grab",width:"8",height:"8",opacity:"0.3",rx:"2",x:100*n(r).ratio-4,y:"6"},null,8,wt),[[m,y],[p,y]])])])):(v(),f("button",{key:0,class:"min-h-80vh p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700 absolute min-h-30 top-0 z-100 right-0 left-0 w-full bg-op-30 dark-bg-op-30 backdrop-blur",onPointerdown:t[0]||(t[0]=s=>q())},"START ",32)),e("div",ht,[(v(!0),f(H,null,G(n(j),(s,h)=>(v(),f("button",{class:I(["text-button flex-1",{active:h==u.fraction}]),key:h,onClick:Pt=>u.ratio=s},d(h),11,$t))),128))])])}}};export{qt as default};
