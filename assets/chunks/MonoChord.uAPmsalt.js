import{bm as W,H as U,aA as X,F as O,aF as N}from"./theme.DzeXIrDl.js";import{r as lt,c as B,b as G,av as ft,aQ as ut,P as tt,x as L,y as M,A as l,C as A,H as Z,E as c,G as b,F as dt,B as ht,z as at}from"./framework.DZXgQweA.js";typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const f=BigInt(0),d=BigInt(1),H=BigInt(2),Y=BigInt(5),I=BigInt(10),ct=2e3,o={s:d,n:f,d};function z(t,n){try{t=BigInt(t)}catch{throw D()}return t*n}function w(t,n){if(n===f)throw J();const e=Object.create(j.prototype);e.s=t<f?-d:d,t=t<f?-t:t;const i=R(t,n);return e.n=t/i,e.d=n/i,e}function nt(t){const n={};let e=t,i=H,u=Y-d;for(;u<=e;){for(;e%i===f;)e/=i,n[i]=(n[i]||f)+d;u+=d+H*i++}return e!==t?e>1&&(n[e]=(n[e]||f)+d):n[t]=(n[t]||f)+d,n}const k=function(t,n){let e=f,i=d,u=d;if(t!=null)if(n!==void 0){if(typeof t=="bigint")e=t;else{if(isNaN(t))throw D();if(t%1!==0)throw et();e=BigInt(t)}if(typeof n=="bigint")i=n;else{if(isNaN(n))throw D();if(n%1!==0)throw et();i=BigInt(n)}u=e*i}else if(typeof t=="object"){if("d"in t&&"n"in t)e=BigInt(t.n),i=BigInt(t.d),"s"in t&&(e*=BigInt(t.s));else if(0 in t)e=BigInt(t[0]),1 in t&&(i=BigInt(t[1]));else if(typeof t=="bigint")e=t;else throw D();u=e*i}else if(typeof t=="number"){if(isNaN(t))throw D();if(t<0&&(u=-d,t=-t),t%1===0)e=BigInt(t);else if(t>0){let r=1,h=0,g=1,F=1,y=1,P=1e7;for(t>=1&&(r=10**Math.floor(1+Math.log10(t)),t/=r);g<=P&&y<=P;){let a=(h+F)/(g+y);if(t===a){g+y<=P?(e=h+F,i=g+y):y>g?(e=F,i=y):(e=h,i=g);break}else t>a?(h+=F,g+=y):(F+=h,y+=g),g>P?(e=F,i=y):(e=h,i=g)}e=BigInt(e)*BigInt(r),i=BigInt(i)}}else if(typeof t=="string"){let r=0,h=f,g=f,F=f,y=d,P=d,a=t.replace(/_/g,"").match(/\d+|./g);if(a===null)throw D();if(a[r]==="-"?(u=-d,r++):a[r]==="+"&&r++,a.length===r+1?g=z(a[r++],u):a[r+1]==="."||a[r]==="."?(a[r]!=="."&&(h=z(a[r++],u)),r++,(r+1===a.length||a[r+1]==="("&&a[r+3]===")"||a[r+1]==="'"&&a[r+3]==="'")&&(g=z(a[r],u),y=I**BigInt(a[r].length),r++),(a[r]==="("&&a[r+2]===")"||a[r]==="'"&&a[r+2]==="'")&&(F=z(a[r+1],u),P=I**BigInt(a[r+1].length)-d,r+=3)):a[r+1]==="/"||a[r+1]===":"?(g=z(a[r],u),y=z(a[r+2],d),r+=3):a[r+3]==="/"&&a[r+1]===" "&&(h=z(a[r],u),g=z(a[r+2],u),y=z(a[r+4],d),r+=5),a.length<=r)i=y*P,u=e=F+i*h+P*g;else throw D()}else if(typeof t=="bigint")e=t,u=t,i=d;else throw D();if(i===f)throw J();o.s=u<f?-d:d,o.n=e<f?-e:e,o.d=i<f?-i:i};function xt(t,n,e){let i=d;for(;n>f;t=t*t%e,n>>=d)n&d&&(i=i*t%e);return i}function gt(t,n){for(;n%H===f;n/=H);for(;n%Y===f;n/=Y);if(n===d)return f;let e=I%n,i=1;for(;e!==d;i++)if(e=e*I%n,i>ct)return f;return BigInt(i)}function vt(t,n,e){let i=d,u=xt(I,e,n);for(let r=0;r<300;r++){if(i===u)return BigInt(r);i=i*I%n,u=u*I%n}return 0}function R(t,n){if(!t)return n;if(!n)return t;for(;;){if(t%=n,!t)return n;if(n%=t,!n)return t}}function j(t,n){if(k(t,n),this instanceof j)t=R(o.d,o.n),this.s=o.s,this.n=o.n/t,this.d=o.d/t;else return w(o.s*o.n,o.d)}var J=function(){return new Error("Division by Zero")},D=function(){return new Error("Invalid argument")},et=function(){return new Error("Parameters must be integer")};j.prototype={s:d,n:f,d,abs:function(){return w(this.n,this.d)},neg:function(){return w(-this.s*this.n,this.d)},add:function(t,n){return k(t,n),w(this.s*this.n*o.d+o.s*this.d*o.n,this.d*o.d)},sub:function(t,n){return k(t,n),w(this.s*this.n*o.d-o.s*this.d*o.n,this.d*o.d)},mul:function(t,n){return k(t,n),w(this.s*o.s*this.n*o.n,this.d*o.d)},div:function(t,n){return k(t,n),w(this.s*o.s*this.n*o.d,this.d*o.n)},clone:function(){return w(this.s*this.n,this.d)},mod:function(t,n){if(t===void 0)return w(this.s*this.n%this.d,d);if(k(t,n),f===o.n*this.d)throw J();return w(this.s*(o.d*this.n)%(o.n*this.d),o.d*this.d)},gcd:function(t,n){return k(t,n),w(R(o.n,this.n)*R(o.d,this.d),o.d*this.d)},lcm:function(t,n){return k(t,n),o.n===f&&this.n===f?w(f,d):w(o.n*this.n,R(o.n,this.n)*R(o.d,this.d))},inverse:function(){return w(this.s*this.d,this.n)},pow:function(t,n){if(k(t,n),o.d===d)return o.s<f?w((this.s*this.d)**o.n,this.n**o.n):w((this.s*this.n)**o.n,this.d**o.n);if(this.s<f)return null;let e=nt(this.n),i=nt(this.d),u=d,r=d;for(let h in e)if(h!=="1"){if(h==="0"){u=f;break}if(e[h]*=o.n,e[h]%o.d===f)e[h]/=o.d;else return null;u*=BigInt(h)**e[h]}for(let h in i)if(h!=="1"){if(i[h]*=o.n,i[h]%o.d===f)i[h]/=o.d;else return null;r*=BigInt(h)**i[h]}return o.s<f?w(r,u):w(u,r)},equals:function(t,n){return k(t,n),this.s*this.n*o.d===o.s*o.n*this.d},compare:function(t,n){k(t,n);let e=this.s*this.n*o.d-o.s*o.n*this.d;return(f<e)-(e<f)},ceil:function(t){return t=I**BigInt(t||0),w(this.s*t*this.n/this.d+(t*this.n%this.d>f&&this.s>=f?d:f),t)},floor:function(t){return t=I**BigInt(t||0),w(this.s*t*this.n/this.d-(t*this.n%this.d>f&&this.s<f?d:f),t)},round:function(t){return t=I**BigInt(t||0),w(this.s*t*this.n/this.d+this.s*((this.s>=f?d:f)+H*(t*this.n%this.d)>this.d?d:f),t)},roundTo:function(t,n){k(t,n);const e=this.n*o.d,i=this.d*o.n,u=e%i;let r=e/i;return u+u>=i&&r++,w(this.s*r*o.n,o.d)},divisible:function(t,n){return k(t,n),!(!(o.n*this.d)||this.n*o.d%(o.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let n=this.n,e=this.d;function i(g){return typeof g=="bigint"?g:Math.floor(g)}t=t||15;let u=gt(n,e),r=vt(n,e,u),h=this.s<f?"-":"";if(h+=i(n/e),n%=e,n*=I,n&&(h+="."),u){for(let g=r;g--;)h+=i(n/e),n%=e,n*=I;h+="(";for(let g=u;g--;)h+=i(n/e),n%=e,n*=I;h+=")"}else for(let g=t;n&&g--;)h+=i(n/e),n%=e,n*=I;return h},toFraction:function(t){let n=this.n,e=this.d,i=this.s<f?"-":"";if(e===d)i+=n;else{let u=n/e;t&&u>f&&(i+=u,i+=" ",n%=e),i+=n,i+="/",i+=e}return i},toLatex:function(t){let n=this.n,e=this.d,i=this.s<f?"-":"";if(e===d)i+=n;else{let u=n/e;t&&u>f&&(i+=u,n%=e),i+="\\frac{",i+=n,i+="}{",i+=e,i+="}"}return i},toContinued:function(){let t=this.n,n=this.d,e=[];do{e.push(t/n);let i=t%n;t=n,n=i}while(t!==d);return e},simplify:function(t){t=t||.001;const n=this.abs(),e=n.toContinued();for(let i=1;i<e.length;i++){let u=w(e[i-1],d);for(let r=i-2;r>=0;r--)u=u.inverse().add(e[r]);if(Math.abs(u.sub(n).valueOf())<t)return u.mul(this.s)}return this}};const wt={class:"flex flex-col fullscreen-container",id:"screen"},yt={key:1,class:"py-8 select-none touch-action-none select-none",style:{"-webkit-overflow-scrolling":"touch"},version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 31",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white"},mt={class:"cursor-pointer",id:"ratio",transform:"translate(0 10)","font-size":"4px","stroke-width":"0",fill:"currentColor"},bt={id:"intL"},pt=["width"],qt=["x"],Bt=["fill"],It=["fill"],Pt={id:"intR"},kt=["width","x"],Ct=["x"],_t=["fill"],$t=["fill"],Ft=["stroke"],Nt={x:"50",y:".5","font-weight":"bold","text-anchor":"end"},zt={class:"text-6px"},Et={x:"50.5",y:"-1.5","text-anchor":"start"},Lt={class:"text-2px"},Mt={class:"text-2px",x:"50.75",y:"1.5"},Dt={class:"cursor-pointer touch-manipulation",id:"divided",transform:"translate(0,20)"},Ot=["stroke","x1"],Rt=["transform"],St={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Tt={class:"text-2px",y:"-1.5","text-anchor":"start"},At={class:"text-2px",y:"1.5","text-anchor":"start"},Ht=["stroke","x2"],jt=["cx"],Gt=["transform"],Zt={class:"text-6px",y:"0.3",x:"-1","font-weight":"bold","text-anchor":"end"},Vt={class:"text-2px",y:"-1.5","text-anchor":"start"},Qt={class:"text-2px",y:"1.5","text-anchor":"start"},Wt={class:"touch-manipulation",id:"ruler","stroke-width":"0.2",stroke:"currentColor"},Xt=["x1","x2"],Yt=["x"],Jt={class:"flex flex-wrap justify-center p-2"},Kt=["onClick"],en={__name:"MonoChord",setup(t){const{note:n,init:e,meter:i}=W("center"),{note:u,init:r,meter:h}=W("left"),{note:g,init:F,meter:y}=W("right"),P=lt(!1);function a(){P.value||(e(),r(),F(),P.value=!0)}const it=[n,u,g],st=B(()=>[m.freq,_.freq,$.freq]),ot=q=>69+12*Math.log2(q/440);function x(q=0,s=.5){P.value&&Object.assign(it[q],{number:ot(st.value[q]).toFixed(4),velocity:s})}const C=G({ratio:U(.66,.05,.95),fraction:B(()=>new j(C.ratio).simplify(.001).toFraction(!0)),invFraction:B(()=>new j(1-C.ratio).simplify(.001).toFraction(!0))}),m=G({freq:U(220,27.5,3520),pitch:B(()=>X(m.freq).toFixed()),note:B(()=>O(m.freq).toNote()),cents:B(()=>V(O(m.note).toFrequency(),m.freq))}),_=G({freq:B(()=>m.freq/C.ratio),pitch:B(()=>(X(_.freq)+120)%12),note:B(()=>O(_.freq).toNote()),cents:B(()=>V(O(_.note).toFrequency(),_.freq))}),$=G({freq:B(()=>m.freq/(1-C.ratio)),pitch:B(()=>(X($.freq)+120)%12),note:B(()=>O($.freq).toNote()),cents:B(()=>V(O($.note).toFrequency(),$.freq))}),rt={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},p=ft(B(()=>C.ratio),{duration:200,transition:ut.easeOutCubic});function K(q){const s=q.wheeling?-q.delta[0]/32:q.delta[0]/4;m.freq+=s}function E(q){const s=q.wheeling?-q.delta[0]/4800:q.delta[0]/1200;C.ratio+=s}function V(q,s){return-(1200/Math.log10(2))*Math.log10(q/s)%1200}return(q,s)=>{const S=tt("wheel"),T=tt("drag");return L(),M("div",wt,[P.value?(L(),M("svg",yt,[l("g",mt,[A((L(),M("g",{class:"touch-manipulation",id:"intervalL",onPointerdown:s[1]||(s[1]=v=>{x(0),x(1)}),onPointercancel:s[2]||(s[2]=v=>{x(0,0),x(1,0)}),onPointerup:s[3]||(s[3]=v=>{x(0,0),x(1,0)}),onPointerout:s[4]||(s[4]=v=>{x(0,0),x(1,0)})},[l("defs",null,[l("linearGradient",bt,[l("stop",{offset:"0%",style:Z({stopColor:c(N)(_.freq,void 0,c(h))})},null,4),l("stop",{offset:"100%",style:Z({stopColor:c(N)(m.freq,void 0,c(i))})},null,4)])]),l("rect",{width:100*c(p)-4,height:"8",y:"-4",x:"1",rx:"2",fill:"url(#intL)"},null,8,pt),l("text",{x:100*c(p)/2-2,"text-anchor":"middle",y:".5"},[l("tspan",{class:"font-bold",fill:c(N)(_.freq)},b(C.fraction.split("/")[0]),9,Bt),s[24]||(s[24]=l("tspan",null,"/",-1)),l("tspan",{class:"font-bold",fill:c(N)(m.freq)},b(C.fraction.split("/")[1]),9,It)],8,qt)],32)),[[S,E],[T,E]]),A((L(),M("g",{class:"touch-manipulation",id:"intervalR",onPointerdown:s[5]||(s[5]=v=>{x(0),x(2)}),onPointercancel:s[6]||(s[6]=v=>{x(0,0),x(2,0)}),onPointerup:s[7]||(s[7]=v=>{x(0,0),x(2,0)}),onPointerout:s[8]||(s[8]=v=>{x(0,0),x(2,0)})},[l("defs",null,[l("linearGradient",Pt,[l("stop",{offset:"0%",style:Z({stopColor:c(N)(m.freq,void 0,c(i))})},null,4),l("stop",{offset:"100%",style:Z({stopColor:c(N)($.freq,void 0,c(y))})},null,4)])]),l("rect",{width:100*(1-c(p))-4,height:"8",y:"-4",x:100-100*(1-c(p))+3,rx:"2",fill:"url(#intR)"},null,8,kt),l("text",{x:100*c(p)+100*(1-c(p))/2+2,"text-anchor":"middle",y:".5"},[l("tspan",{class:"font-bold",fill:c(N)($.freq)},b(C.invFraction.split("/")[0]),9,_t),s[25]||(s[25]=l("tspan",null,"/",-1)),l("tspan",{class:"font-bold",fill:c(N)(m.freq)},b(C.invFraction.split("/")[1]),9,$t)],8,Ct)],32)),[[S,E],[T,E]])]),A((L(),M("g",{class:"cursor-pointer touch-manipulation",id:"fundamental",onPointerdown:s[9]||(s[9]=v=>x(0)),onPointercancel:s[10]||(s[10]=v=>x(0,0)),onPointerleave:s[11]||(s[11]=v=>x(0,0)),onPointerout:s[12]||(s[12]=v=>x(0,0)),onPointerup:s[13]||(s[13]=v=>x(0,0))},[l("line",{x2:"100","stroke-width":"10",stroke:c(N)(m.freq,.3+.7*c(i))},null,8,Ft),s[26]||(s[26]=l("circle",{r:"2"},null,-1)),s[27]||(s[27]=l("circle",{cx:"100",r:"2"},null,-1)),l("text",Nt,[l("tspan",zt,b(m.note),1)]),l("text",Et,[l("tspan",Lt,b(m.cents>0?"+":"")+b(m.cents.toFixed())+"% ",1),l("tspan",Mt,b(m.freq.toFixed(2))+" Hz ",1)])],32)),[[T,K],[S,K]]),A((L(),M("g",Dt,[l("g",{id:"part2",onPointerdown:s[14]||(s[14]=v=>x(2,1)),onPointercancel:s[15]||(s[15]=v=>x(2,0)),onPointerleave:s[16]||(s[16]=v=>x(2,0)),onPointerout:s[17]||(s[17]=v=>x(2,0)),onPointerup:s[18]||(s[18]=v=>x(2,0))},[l("line",{stroke:c(N)($.freq,.3+.7*c(y)),"stroke-width":"10",x1:100*c(p),x2:"100"},null,8,Ot),s[28]||(s[28]=l("circle",{r:"2",cx:"100"},null,-1)),l("g",{transform:`translate(${100*c(p)+5+100*(1-c(p))/2} 0.5)`},[l("text",St,b($.note),1),l("text",Tt,b($.cents>0?"+":"")+b($.cents.toFixed())+"% ",1),l("text",At,b($.freq.toFixed(2))+" Hz ",1)],8,Rt)],32),l("g",{id:"part1",onPointerdown:s[19]||(s[19]=v=>x(1,1)),onPointercancel:s[20]||(s[20]=v=>x(1,0)),onPointerleave:s[21]||(s[21]=v=>x(1,0)),onPointerout:s[22]||(s[22]=v=>x(1,0)),onPointerup:s[23]||(s[23]=v=>x(1,0))},[l("line",{stroke:c(N)(_.freq,.3+.7*c(h)),"stroke-width":"10",x2:100*c(p)},null,8,Ht),s[29]||(s[29]=l("circle",{r:"2"},null,-1)),l("circle",{cx:100*c(p),r:"2"},null,8,jt),l("g",{transform:`translate(${100*c(p)/2} 0.5)`},[l("text",Zt,b(_.note),1),l("text",Vt,b(_.cents>0?"+":"")+b(_.cents.toFixed())+"% ",1),l("text",Qt,b(_.freq.toFixed(2))+" Hz ",1)],8,Gt)],32)])),[[T,E],[S,E]]),l("g",Wt,[s[30]||(s[30]=l("line",{y1:"0",y2:"20"},null,-1)),s[31]||(s[31]=l("line",{x1:"100",x2:"100",y1:"0",y2:"20"},null,-1)),l("line",{x1:100*c(p),x2:100*c(p),y1:"5",y2:"20"},null,8,Xt),A(l("rect",{class:"cursor-grab",width:"8",height:"8",opacity:"0.3",rx:"2",x:100*c(p)-4,y:"6"},null,8,Yt),[[S,E],[T,E]])])])):(L(),M("button",{key:0,class:"p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700 absolute min-h-30 top-0 z-100 right-0 left-0 w-full bg-op-30 dark-bg-op-30 backdrop-blur",onPointerdown:s[0]||(s[0]=v=>a())},"START ",32)),l("div",Jt,[(L(),M(dt,null,ht(rt,(v,Q)=>l("button",{class:at(["text-button flex-1",{active:Q==C.fraction}]),key:Q,onClick:Ut=>C.ratio=v},b(Q),11,Kt)),64))])])}}};export{en as default};
