import{a3 as R,b2 as V,bc as E,G as O,b3 as H,c as L,n as B,bd as G,be as K,g as U,l as W}from"./theme.dQYKTFz5.js";import{b as S,u as f,c as h,q as w,x as r,y as d,E as s,I as v,K as A,L as q,A as i,H as x,G as m,R as Q,d as g,W as X,C as y,D as C,X as u,z as F,P as Y,r as j,F as $,B as T,M as P,N as J,al as Z,af as ee}from"./framework.Bi_5INRF.js";const e=S({show:{letters:f("table-letters",!0),bpm:f("table-bpm",!0),hz:f("table-hz",!0),len:f("table-len",!0)},stopped:!0,middleA:f("table-middleA",440),tuning:"equal",octave:{range:{bottom:f("table-bottom",1),top:f("table-top",4)},limit:{bottom:-6,top:8},list:h(()=>{let o=[];for(let a=e.octave.range.top;a>=e.octave.range.bottom;a--)o.push(a);return o}),inc:se,dec:te}});function te(o){let a=o?"top":"bottom",t=o?"bottom":"top";o&&e.octave.range[a]<=e.octave.range[t]||!o&&e.octave.range[a]<=e.octave.limit[a]||e.octave.range[a]--}function se(o){let a=o?"top":"bottom",t=o?"bottom":"top";o&&e.octave.range[a]>=e.octave.limit[a]||!o&&e.octave.range[a]>=e.octave.range[t]||e.octave.range[a]++}const N=o=>(A("data-v-d639d554"),o=o(),q(),o),oe={class:"flex text-2xl text-center cursor-pointer w-full"},ae=N(()=>i("div",{class:"i-la-minus"},null,-1)),le=[ae],ne=N(()=>i("div",{class:"i-la-plus"},null,-1)),ce=[ne],re={__name:"PitchTableShift",props:{top:Boolean},setup(o){return(a,t)=>(r(),d("div",oe,[s(e).octave.range.bottom!=s(e).octave.limit.bottom?(r(),d("div",{key:0,class:"btn bg-gray-300 dark-bg-gray-900",onClick:t[0]||(t[0]=p=>s(e).octave.dec(o.top))},le)):v("",!0),s(e).octave.range.top!=s(e).octave.limit.top?(r(),d("div",{key:1,class:"btn bg-gray-50 dark-bg-gray-500",onClick:t[1]||(t[1]=p=>s(e).octave.inc(o.top))},ce)):v("",!0)]))}},I=w(re,[["__scopeId","data-v-d639d554"]]),ie={class:"button"},de={class:"uppercase mr-1"},pe={__name:"PitchTableSwitch",props:{label:{type:String,default:""},state:{type:Boolean,default:!1}},setup(o){return(a,t)=>(r(),d("div",ie,[i("div",{class:"indicator mr-2",style:x({color:o.state?"#fff":"#333"})},"●",4),i("div",de,m(o.label),1)]))}},b=w(pe,[["__scopeId","data-v-59035f98"]]);function ue(o,a){const{channel:t}=R("table"),p=new V(0,-1/0).connect(t),l=new E({oscillator:{type:"sawtooth"},envelope:{attack:.5},filterEnvelope:{attack:.05}}).connect(p),n=S({vol:0,pan:50,started:!1,active:h(()=>n.vol>0),freq:h(()=>{let c=O(o,a,e.middleA);return l.oscillator.frequency.value=c,c})});return Q(()=>{l.triggerRelease(),l.dispose()}),g(()=>n.vol,c=>{p.volume.targetRampTo(H(c*.4/100),"16n")}),g(()=>n.pan,c=>{let _=(c-50)/100*2;p.pan.targetRampTo(_,"16n")}),g(()=>e.stopped,c=>{c&&(n.vol=0,n.pan=50)}),g(()=>n.active,c=>{c?(e.stopped&&(e.stopped=!1),l.triggerAttack(n.freq)):l.triggerRelease()}),n}const ve={key:0,class:"flex flex-col text-xs p-1"},fe={key:0,class:"text-xl font-bold"},he={key:1,class:"flex"},me={key:2,class:"flex"},be={key:3,class:"flex"},_e={__name:"PitchTableCellInfo",props:{name:{type:String,default:"A"},hz:{type:Number,default:440},octave:{default:3,type:Number}},setup(o){const a=o,t=h(()=>a.hz*60),p=h(()=>340/a.hz);function l(n){let c;return n>1e6?c=(n/1e6).toFixed(2)+" M":n>1e3?c=(n/1e3).toFixed(2)+" k":c=n.toFixed(2)+" ",c}return(n,c)=>s(e).show.len||s(e).show.hz||s(e).show.bpm||s(e).show.letters?(r(),d("div",ve,[s(e).show.letters?(r(),d("div",fe,m(o.name)+m(o.octave),1)):v("",!0),s(e).show.hz?(r(),d("div",he,m(l(o.hz))+"hz",1)):v("",!0),s(e).show.len?(r(),d("div",me,m(p.value.toFixed(2))+" m",1)):v("",!0),s(e).show.bpm?(r(),d("div",be,m(l(t.value))+"BPM",1)):v("",!0)])):v("",!0)}},ge=["drag-options"],xe={class:"absolute w-full h-full top-0 left-0 bottom-0"},ye={class:"absolute h-full top-0 left-0 right-0 text-center"},we={__name:"PitchTableCell",props:{pitch:{type:Number,default:0},octave:{default:3,type:Number}},setup(o){const a=o,t=ue(a.pitch,a.octave),p=S({filterTaps:!0,preventWindowScrollY:!0,delay:0,eventOptions:{passive:!1}}),l=_=>{G.state=="suspended"&&K();let{movement:[z,k],tap:D}=_;D?t.active?(t.vol=0,t.pan=50):t.vol=50:(t.vol+=-k/20,t.vol>100&&(t.vol=100),t.vol<0&&(t.vol=0),t.pan+=z/20,t.pan>100&&(t.pan=100),t.pan<0&&(t.pan=0))},n=h(()=>L(a.pitch,a.octave)),c=h(()=>Math.abs(a.octave+2)*8>40?"hsla(0,0%,0%,"+(t.active?"1":"0.8")+")":"hsla(0,0%,100%,"+(t.active?"1":"0.8")+")");return(_,z)=>{const k=X("drag");return y((r(),d("div",{class:F(["cell",{active:s(t).active}]),"drag-options":p,style:x({backgroundColor:n.value,color:c.value})},[y(i("div",xe,[i("div",{class:"volume",style:x({height:s(t).vol+"%"})},null,4)],512),[[C,s(t).vol>0]]),y(i("div",ye,[i("div",{class:"pan absolute bg-gray-100 h-full m-auto",style:x({left:s(t).pan+"%"})},null,4)],512),[[C,s(t).pan!=50]]),u(_e,{name:s(B)[o.pitch],hz:s(t).freq,octave:o.octave},null,8,["name","hz","octave"])],14,ge)),[[k,l]])}}},ke=w(we,[["__scopeId","data-v-f9872ed5"]]),M=o=>(A("data-v-224898d5"),o=o(),q(),o),$e={class:"fullscreen-container",id:"screen"},Se={class:"flex flex-wrap"},ze={class:"flex flex-col p-2",style:{flex:"10 1 6rem"}},Ce={class:"flex-auto flex flex-wrap rounded-xl dark-bg-dark-700 shadow items-center p-2 gap-2 relative"},Te={class:"flex px-2 rounded-lg items-center bg-light-300 dark-bg-dark-800"},Pe=M(()=>i("div",{class:"p-1 pr-2 font-bold"},"A",-1)),Ie=M(()=>i("div",{class:"p-1"},"Hz",-1)),Be={__name:"PitchTable",setup(o){return Y("Enter",a=>{a.preventDefault(),e.stopped=!e.stopped}),j(),(a,t)=>{const p=W;return r(),d($,null,[i("div",$e,[u(I,{top:!0}),(r(!0),d($,null,T(s(e).octave.list,l=>(r(),d("div",{class:"flex w-full",key:l},[(r(!0),d($,null,T(s(B),(n,c)=>(r(),P(ke,{key:n,class:F({dim:!s(U).isIn(n)}),pitch:c,octave:l},null,8,["class","pitch","octave"]))),128))]))),128)),u(I)]),i("div",Se,[u(p,{class:"mb-4 flex-auto",style:{flex:"1 1 2rem"}}),i("div",ze,[i("div",Ce,[u(b,{label:"letters",state:s(e).show.letters,onClick:t[0]||(t[0]=l=>s(e).show.letters=!s(e).show.letters)},null,8,["state"]),u(b,{label:"FREQ",state:s(e).show.hz,onClick:t[1]||(t[1]=l=>s(e).show.hz=!s(e).show.hz)},null,8,["state"]),u(b,{label:"Length",state:s(e).show.len,onClick:t[2]||(t[2]=l=>s(e).show.len=!s(e).show.len)},null,8,["state"]),u(b,{label:"BPM",state:s(e).show.bpm,onClick:t[3]||(t[3]=l=>s(e).show.bpm=!s(e).show.bpm)},null,8,["state"])]),u(Z,{name:"fade"},{default:J(()=>[s(e).stopped?v("",!0):(r(),P(b,{key:0,class:"my-4",label:"STOP",state:s(e).stopped,onClick:t[4]||(t[4]=l=>s(e).stopped=!s(e).stopped)},null,8,["state"]))]),_:1}),i("div",Te,[Pe,y(i("input",{class:"mx-1 p-2 max-w-26 dark-bg-dark-800","onUpdate:modelValue":t[5]||(t[5]=l=>s(e).middleA=l),type:"number"},null,512),[[ee,s(e).middleA]]),Ie])])])],64)}}},Fe=w(Be,[["__scopeId","data-v-224898d5"]]);export{Fe as default};
