import{q as R,r as f,T,d as S,x as _,y as x,A as l,C as D,O as A,af as W,E as g,am as j,G as M,F as q,B as G,H as $,z as J,I as K,K as X,L as Y}from"./framework.CYx1s6BW.js";import{J as Q,n as Z,ap as ee}from"./theme.BJ9F72QS.js";const p=v=>(X("data-v-a6bfb0b2"),v=v(),Y(),v),te={class:"container mx-auto p-4"},se={class:"mb-4"},ae=p(()=>l("label",{class:"cursor-pointer bg-blue-500 hover-bg-blue-600 text-white font-bold py-2 px-4 rounded",for:"fileInput"},"Load Image",-1)),ne={class:"mb-4"},oe=p(()=>l("label",{class:"mr-2"},"Scan direction:",-1)),le=p(()=>l("option",{value:"horizontal"},"Horizontal",-1)),ce=p(()=>l("option",{value:"vertical"},"Vertical",-1)),ie=[le,ce],re={class:"mb-4"},ue=p(()=>l("label",{class:"mr-2"},"Color count:",-1)),de={class:"ml-2"},he={key:0,class:"relative max-w-screen max-h-full"},me={class:"text-xs font-bold text-white text-shadow"},w=20,fe={__name:"PixelSort",setup(v){const d=f(null),r=f("horizontal"),h=f(null),{elementX:b,elementY:I,isOutside:H}=T(h),m=Q(f(5),5,7),k=f([]);function L(s){const e=s.target.files[0];e&&(d.value=URL.createObjectURL(e))}function B(s,e,t,o){return(o==="horizontal"?s.getImageData(0,t-w/2,s.canvas.width,w):s.getImageData(e-w/2,0,w,s.canvas.height)).data}function E(s){const e=new Map;for(let a=0;a<s.length;a+=4){const n=s[a],c=s[a+1],u=s[a+2],[i,F,O]=N(n,c,u),z=U(i);if(z!==-1){const y=z;e.has(y)||e.set(y,{count:0,s:0,l:0});const C=e.get(y);C.count++,C.s+=F,C.l+=O}}const t=Array.from(e.entries()).sort((a,n)=>n[1].count-a[1].count).slice(0,m.value).map(([a,{count:n,s:c,l:u}])=>({hueIndex:a,s:c/n,l:u/n,percent:n/(s.length/4)*100})),o=t.reduce((a,n)=>a+n.percent,0);return t.map(a=>({...a,percent:a.percent/o*100}))}function U(s){const e=s*360;for(let t=0;t<12;t++){const o=t*30,a=(o-15+360)%360,n=(o+15)%360;if(a>n){if(e>=a||e<n)return t}else if(e>=a&&e<n)return t}return-1}function N(s,e,t){s/=255,e/=255,t/=255;const o=Math.max(s,e,t),a=Math.min(s,e,t);let n,c,u=(o+a)/2;if(o===a)n=c=0;else{const i=o-a;switch(c=u>.5?i/(2-o-a):i/(o+a),o){case s:n=(e-t)/i+(e<t?6:0);break;case e:n=(t-s)/i+2;break;case t:n=(s-e)/i+4;break}n/=6}return[n,c,u]}function P(s,e,t){return`hsl(${s*30%360}, ${e*100}%, ${t*100}%)`}function V(s,e){const t=Z[s],o=Math.floor(e*3)-1+ee.offset;return`${t}${o}`}return S([b,I],()=>{if(H.value||!h.value)return;const s=h.value.getContext("2d"),e=B(s,b.value,I.value,r.value);k.value=E(e)}),S(d,async()=>{if(d.value){const s=new Image;s.src=d.value,await s.decode();const e=h.value,t=e.getContext("2d"),o=s.width/s.height,a=600,n=600;o>a/n?(e.width=a,e.height=a/o):(e.height=n,e.width=n*o),t.drawImage(s,0,0,e.width,e.height)}}),(s,e)=>(_(),x("div",te,[l("div",se,[ae,l("input",{class:"hidden",id:"fileInput",type:"file",accept:"image/*",onChange:L},null,32)]),l("div",ne,[oe,D(l("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t)},ie,512),[[A,r.value]])]),l("div",re,[ue,D(l("input",{type:"range","onUpdate:modelValue":e[1]||(e[1]=t=>j(m)?m.value=t:null),min:"5",max:"7",step:"1"},null,512),[[W,g(m)]]),l("span",de,M(g(m)),1)]),d.value?(_(),x("div",he,[l("canvas",{class:"w-full w-100",ref_key:"canvasElement",ref:h},null,512),l("div",{class:J(["absolute flex",{"w-full h-5":r.value==="horizontal","h-full w-5 flex-col":r.value==="vertical"}]),style:$(r.value==="horizontal"?`top: ${g(I)-10}px`:`left: ${g(b)-10}px`)},[(_(!0),x(q,null,G(k.value,t=>(_(),x("div",{class:"relative flex items-center justify-center",key:t.hueIndex,style:$({flex:`1 1 ${t.percent}%`,backgroundColor:P(t.hueIndex,t.s,t.l)})},[l("span",me,M(V(t.hueIndex,t.l)),1)],4))),128))],6)])):K("",!0)]))}},_e=R(fe,[["__scopeId","data-v-a6bfb0b2"]]);export{_e as default};
