import{a4 as M,M as w,r as B,q as i,f as l,s as v,z as x,u as e,F as P,Y as $,a3 as _,v as N,t as A,y as E,_ as F,e as L}from"./framework.CxSiiyCs.js";import{K as j,g as s,al as m,n as C,y as S,v as u,aC as I,aD as z,d as V,aE as q,aF as K,U as O,r as U,A as Y,i as G,c as H}from"./theme.DLCqlVTm.js";const J={class:"text-sm absolute top-2 left-2 w-full z-100 pointer-events-none text-white font-bold"},Q=["onPointerdown","onPointerup","onPointerleave","onPointerout","onPointercancel","onPointerenter"],R={key:0,class:"text-10px absolute z-100 top-0 left-1 text-white pointer-events-none"},T={__name:"ScaleChordsCard",props:{chord:{type:Object,default:()=>({})},degree:{type:Number,default:0}},setup(r){const y=r,{isDark:k}=M(),p=w(()=>y.chord.intervals.map(d=>j(d)+y.degree+s.tonic+69-12+m.offset*12));function c(d,b,n,a=0){return Array.from({length:d.intervals.length},(o,t)=>t+1+n).map(q(d.aliases[0],C[(b+s.tonic)%12]+(4+m.offset-a))).map(K)}const f=B(!1);return(d,b)=>(l(),i("div",{class:E(["flex flex-col border-1 p-1 border-op-10 dark-border-light-900 dark-border-op-10 border-dark-200 rounded overflow-hidden select-none relative",{active:p.value.filter(n=>e(z)[n]).length==p.value.length}]),style:N({backgroundColor:e(V)(r.chord.chroma,(r.degree+e(s).tonic)%12,.2,e(k)?4:14).lch})},[v("div",J,x(e(C)[(r.degree+e(s).tonic)%12])+x(r.chord.aliases[0]),1),(l(),i(P,null,$([0,1],n=>v("div",{class:"flex flex-1 w-full",key:n},[(l(!0),i(P,null,$(p.value,(a,o)=>(l(),i("button",{class:"relative py-3 px-1 flex-1",key:a,style:N({backgroundColor:e(I)(a-n*12,e(z)[a-n*12]?1:.3)}),onPointerdown:_(t=>{f.value=!0,e(S)(c(r.chord,r.degree,o,n))},["prevent"]),onPointerup:t=>{f.value=!1,e(u)(c(r.chord,r.degree,o,n))},onPointerleave:t=>e(u)(c(r.chord,r.degree,o,n)),onPointerout:t=>e(u)(c(r.chord,r.degree,o,n)),onPointercancel:t=>{f.value=!1,e(u)(c(r.chord,r.degree,o,n))},onPointerenter:t=>f.value&&e(S)(c(r.chord,r.degree,o,n))},[n==1?(l(),i("span",R,x(e(C)[(a-9)%12]),1)):A("",!0)],44,Q))),128))])),64))],6))}},W={class:"gap-2 p-4 items-center select-none",style:{display:"grid","grid-template-columns":"repeat(auto-fill, minmax(100px, 1fr))"}},X={class:"flex items-center gap-2 px-2"},Z={class:"text-sm w-4"},ee=["onPointerdown","onPointerup","onPointercancel","onPointerout"],te={__name:"ScaleChords",emits:["chord"],setup(r,{emit:y}){const k=y,p=w(()=>O().map(n=>{const a=[0,...n.chroma.split("").map((t,g)=>t==1?g:!1).filter(Boolean)];let o={};return a.forEach(t=>o[t]=f(U(n.chroma.split(""),t).join(""))),{...n,degrees:a,degreeChords:o}}));function c(n="101010010100",a="100010010000"){let o=n.split(""),t=a.split("");if(t.reduce((h,D)=>Number(D)+Number(h))<3)return!1;for(let h=0;h<12;h++)if(t[h]==1&&o[h]!=1)return!1;return!0}function f(n="101010010100"){return Y().filter(a=>c(n,a.chroma))}const d=w(()=>p.value.find(n=>n.chroma==s.chroma)),b=B();return(n,a)=>(l(),i("div",W,[(l(!0),i(P,null,$(d.value?.degrees,o=>(l(),i(P,{key:o},[v("div",X,[v("div",Z,x(e(G)[o]),1),a[0]||(a[0]=v("div",{class:"flex-1"},null,-1)),v("div",{class:"font-bold w-8 h-8 rounded-full flex items-center flex-col cursor-pointer select-none text-white",onPointerdown:t=>e(S)(o+e(s).tonic+57+e(m).offset*12),onPointerup:_(t=>e(u)(o+e(s).tonic+57+e(m).offset*12),["stop","prevent"]),onPointercancel:t=>e(u)(o+e(s).tonic+57+e(m).offset*12),onPointerout:t=>e(u)(o+e(s).tonic+57+e(m).offset*12),style:N({backgroundColor:e(H)((o+e(s).tonic)%12,2)})},x(e(C)[(o+e(s).tonic)%12]),45,ee)]),(l(!0),i(P,null,$(d.value.degreeChords[o].toSorted((t,g)=>t.intervals.length>g.intervals.length?1:-1),t=>(l(),L(T,{onPointerdown:g=>{k("chord",t),b.value=t},key:t,chord:t,degree:o},null,8,["onPointerdown","chord","degree"]))),128))],64))),128))]))}},re=F(te,[["__scopeId","data-v-ff17a197"]]);export{re as _};
