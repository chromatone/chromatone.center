import{_ as $}from"./trash.DwfvUeYy.js";import{q as X,r as S,b as C,c as u,x as l,y as i,E as m,A as o,F as y,B as h,G as f,S as k,P as A,I as v,z as H}from"./framework.Bh6q1hI4.js";import{ba as L,az as w,at as z,n as M,Y as q,aJ as B,aF as P}from"./theme.Dszuvfml.js";const Y={class:"fullscreen-container p-4 mb-8",id:"screen"},D=["opacity"],E={class:"y"},I=["transform"],R={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"10px","text-anchor":"left",x:"-25",y:"595"},V=["transform"],j=["x2"],T={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"left",x:"6",y:"-12"},G={class:"x"},J=["x1","x2"],O=["x"],U=["x1","x2","y2","opacity"],K=["x"],Q=["transform"],W=["y1","stroke"],Z=["fill"],tt={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"start",x:"10",y:"590"},ot=["color"],et=["transform"],st=["fill"],rt={"font-weight":"bold",fill:"white","font-family":"Commissioner, sans-serif","font-size":"18px","text-anchor":"middle",x:"0",y:"5"},nt=["points"],lt=["transform"],it=["y2","stroke"],at=["cy","fill","onClick"],ct=["y"],ft=["y"],xt=["y"],mt={__name:"SoundLoudness",setup(ut){const p=S(!1);function b(){P(),p.value=!0}const{svg:N,area:F,mouse:n}=L(),s=C({min:10,max:2e4,marks:[10,20,30,40,50,60,70,80,90,100,200,300,400,500,600,700,800,900,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3,1e4,2e4],nums:[10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4],As:[22.5,55,110,220,440,880,1760,3520,7040,14080],Cs:[16,32,65,130.813,261,523,1046,2093,4186,8372,16744],hz:u(()=>s.toHz(n.normX)),color:u(()=>w(s.hz)),pitch:u(()=>(z(s.hz)+120)%12),note:u(()=>{let r=Math.round(s.pitch);return r>11.5&&(r=0),M[r]}),cents:u(()=>((s.pitch-s.pitch.toFixed(0))*100).toFixed(0)),toNormX(r){return(Math.log(r)-Math.log(s.min))/(Math.log(s.max)-Math.log(s.min))},toHz(r){return Math.pow(10,r*(Math.log10(s.max)-Math.log10(s.min))+Math.log10(s.min))}}),x=C({min:-80,max:10,marks:[-80,-70,-60,-50,-40,-30,-20,-10,0,10],db:u(()=>x.toDb(n.normY)),toDb(r){return(x.max-x.min)*r+x.min},toNormY(r){return(r-x.min)/(x.max-x.min)}});let _;const a=C({list:[],add(){var d,g;_||(_=q("loudness").channel);let r=s.toHz(n.normX),e=new B({oscillator:{type:"sine"},volume:x.db}).connect(_);e.triggerAttack(r,n.normY);let c=(z(r)+120)%12;c>11.5&&(c=0);let t=((c-c.toFixed(0))*100).toFixed(0);a.list.push({synth:e,x:n.x,y:n.y,hz:r,pitch:c,cents:t,note:(g=(d=M)==null?void 0:d[Math.round(c)])==null?void 0:g.name,color:w(r)})},line:u(()=>{let r=[],e=[...a.list];return e.sort((c,t)=>c.x<t.x?-1:1),e.forEach(c=>{r.push([c.x,c.y].join(","))}),r.join(" ")}),clear(){a.list.forEach(r=>{r.synth.triggerRelease()}),a.list.splice(0,a.list.length)},remove(r){var e;(e=a.list)==null||e[r].synth.triggerRelease(),a.list.splice(r,1)}});return(r,e)=>{const c=$;return l(),i("div",Y,[(l(),i("svg",{class:"min-h-80svh max-h-100svh w-full select-none",ref_key:"svg",ref:N,version:"1.1",baseProfile:"full",viewBox:"-50 -50 1000 720",xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none"},onMousemove:e[2]||(e[2]=(...t)=>m(n).getCursorPosition&&m(n).getCursorPosition(...t)),onClick:e[3]||(e[3]=t=>a.add())},[o("g",{opacity:p.value?1:.1,class:H({"pointer-events-none":!p.value})},[o("g",E,[e[5]||(e[5]=o("line",{x1:"0",x2:"0",y1:"0",y2:"600","stroke-width":"2",stroke:"currentColor"},null,-1)),e[6]||(e[6]=o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"25px","text-anchor":"middle",x:"-30",y:"240","transform-origin":"-30 240",transform:"rotate(-90)"},"Sound pressure",-1)),(l(!0),i(y,null,h(x.marks,t=>(l(),i("g",{key:t,transform:`translate(0, ${-x.toNormY(t)*600})`},[e[4]||(e[4]=o("line",{opacity:"0.2",stroke:"currentColor","stroke-width":"1",y1:"600",y2:"600",x1:"-10",x2:"900"},null,-1)),o("text",R,f(t),1)],8,I))),128)),o("g",{transform:`translate(0, ${m(n).y})`},[o("line",{x1:"-5",x2:m(n).x,y1:"0",y2:"0",stroke:"currentColor","stroke-width":"1px",opacity:"0.8"},null,8,j),o("text",T,f(x.db.toFixed(0))+" db",1)],8,V)]),o("g",G,[e[7]||(e[7]=o("line",{x1:"0",x2:"900",y1:"600",y2:"600","stroke-width":"2",stroke:"currentColor"},null,-1)),e[8]||(e[8]=o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"25px","text-anchor":"middle",x:"450",y:"650"},"Frequency",-1)),(l(!0),i(y,null,h(s.Cs,(t,d)=>(l(),i("g",{key:t},[o("line",{x1:900*s.toNormX(t),x2:900*s.toNormX(t),y1:"0",y2:600,stroke:"hsla(90,50%,50%,1)","stroke-width":"2",opacity:"0.4"},null,8,J),o("text",{fill:"hsla(90,50%,50%,1)",x:900*s.toNormX(t)+5,y:"20"},"C"+f(d),9,O)]))),128)),(l(!0),i(y,null,h(s.marks,t=>(l(),i("g",{key:t},[o("line",{x1:900*s.toNormX(t),x2:900*s.toNormX(t),y1:"0",y2:s.nums.includes(t)?620:600,stroke:"currentColor","stroke-width":"1",opacity:s.nums.includes(t)?.3:.1},null,8,U)]))),128)),(l(!0),i(y,null,h(s.nums,t=>(l(),i("text",{key:t,fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"12px","text-anchor":"middle",x:900*s.toNormX(t),y:"625"},f(t)+" Hz",9,K))),128)),o("g",{transform:`translate(${m(n).x}, 0)`},[o("line",{class:"transition-all duration-100",x1:"0",x2:"0",y1:m(n).y,y2:"600",stroke:s.color,"stroke-width":"2px"},null,8,W),o("circle",{class:"transition-all duration-100",cx:"0",cy:"600",r:"6",fill:s.color},null,8,Z),o("text",tt,f(s.hz.toFixed(1))+" Hz",1),o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"end",x:"-10",y:"590",color:s.color},f(s.note.name)+" "+f(s.cents),9,ot)],8,Q)]),e[10]||(e[10]=o("path",{stroke:"currentColor","stroke-width":"1",fill:"none",transform:"scale(1.46) translate(-82,20)",d:"M82.6,19.38l10.11,16,22,38.26,20.7,35.62c.09.16.18.31.28.46l19.74,29.17a5.39,5.39,0,0,0,.4.54l19.74,24.36,21.84,24.37,13.08,13.58.38.36,16.34,14.85,18.13,15.25.38.3,14.75,10.94c.13.1.28.2.42.29l14.68,9.46,18.19,11,18.43,10.1,18.18,9.47,14.79,6.83c.16.08.32.14.49.21L367.09,299l16.75,5.7.6.18L398,308.35l10.49,2.59.5.11,12.13,2.18.49.07,11.11,1.29a7.83,7.83,0,0,0,1.28,0l9.1-.43a8,8,0,0,0,1.94-.33l13.56-4.18a5.52,5.52,0,0,0,.53-.18l16.53-6.4a9.37,9.37,0,0,1,1-.31l10.53-2.49a8.3,8.3,0,0,1,1.4-.21l8-.42a8,8,0,0,1,1.77.11l5.71,1a7.77,7.77,0,0,1,2.57.93l8.44,4.85a7.5,7.5,0,0,1,.88.59l11.07,8.51,11,7.88c.19.14.38.26.58.38l5.94,3.52a7.35,7.35,0,0,0,1.2.58l2.9,1.11a7.31,7.31,0,0,0,1.59.42l1.06.17a7.91,7.91,0,0,0,4.19-.49l2.49-1a7.85,7.85,0,0,0,2.88-2l6.58-7.32c.11-.12.21-.24.31-.37l10.33-13c.17-.22.33-.44.48-.67l10.38-16.32L599,272c.12-.2.25-.39.39-.58l6-8.19a8,8,0,0,1,2-1.9l4.94-3.26a7.82,7.82,0,0,1,2.92-1.18l4.58-.84a8,8,0,0,1,2.84,0l2.29.42a7.89,7.89,0,0,1,4.23,2.27l5.54,5.72a7.3,7.3,0,0,1,1,1.19l8.2,12.64a7.52,7.52,0,0,0,1.11,1.35l1.92,1.87a7.87,7.87,0,0,0,5.68,2.24h0a7.93,7.93,0,0,0,3.93-1.16l3-1.82a7.87,7.87,0,0,0,2.35-2.21l6-8.59a7.84,7.84,0,0,0,1-2l5.5-16.27a7.38,7.38,0,0,0,.31-1.23l1.55-9.33a8.18,8.18,0,0,1,.33-1.27l6.35-18.44"},null,-1)),o("rect",{ref_key:"area",ref:F,style:{cursor:"none"},x:"0",y:"0",width:"900",height:"600",fill:"hsla(0,0%,100%,0.1)"},null,512),o("g",{transform:`translate(${m(n).x}, ${m(n).y})`},[o("circle",{class:"pointer",cx:0,cy:0,r:"16",fill:s.color},null,8,st),o("text",rt,f(s.note),1)],8,et),o("polyline",{points:a.line,stroke:"currentColor","stroke-width":"4",fill:"none",opacity:"0.7"},null,8,nt),(l(!0),i(y,null,h(a.list,(t,d)=>(l(),i("g",{key:t.hz,transform:`translate(${t.x}, 0)`},[o("line",{x1:"0",x2:"0",y1:"600",y2:t.y,stroke:t.color,"stroke-width":"2"},null,8,it),o("circle",{class:"cursor-pointer",cx:"0",cy:t.y,r:"20",fill:t.color,onClick:k(g=>a.remove(d),["stop","prevent"])},null,8,at),o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"16px","text-anchor":"end",x:"-5",y:t.y+36},f(t.cents<0?"":"+")+f(t.cents),9,ct),o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"16px","text-anchor":"start",x:"5",y:t.y+36},f(t.hz.toFixed(1))+" Hz",9,ft),o("text",{"font-weight":"bold",fill:"white","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"middle",x:"0",y:t.y+8},f(t.note),9,xt)],8,lt))),128)),a.list.length>0?(l(),i("g",{key:0,class:"cursor-pointer",transform:"translate(860,560)",onClick:e[0]||(e[0]=k(t=>a.clear(),["stop","prevent"]))},[e[9]||(e[9]=o("circle",{cx:"14",cy:"14",r:"22",fill:"gray"},null,-1)),A(c,{class:"text-2xl"})])):v("",!0)],10,D),p.value?v("",!0):(l(),i("g",{key:0,class:"cursor-pointer",onClick:e[1]||(e[1]=k(t=>b(),["stop","prevent"]))},e[11]||(e[11]=[o("rect",{x:"250",y:"200",width:"400",height:"100",rx:"20",fill:"gray",stroke:"white"},null,-1),o("text",{"font-weight":"bold",fill:"white","font-family":"Commissioner, sans-serif","font-size":"42px","text-anchor":"middle",x:"450",y:"265"},"START AUDIO",-1)])))],544))])}}},pt=X(mt,[["__scopeId","data-v-61b65253"]]);export{pt as default};
