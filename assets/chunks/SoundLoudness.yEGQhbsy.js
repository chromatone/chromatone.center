import{_ as X}from"./trash.DtYYwpMG.js";import{q as H,r as A,b as v,c as d,v as l,x as i,D as m,z as o,F as y,A as _,E as f,$ as w,X as L,H as z,y as Y,J as q,K as D}from"./framework.C3BURm3f.js";import{b3 as I,aN as M,aG as b,n as N,Y as B,aW as E,aY as P}from"./theme.BxOLoZmJ.js";const x=p=>(q("data-v-ecc88e19"),p=p(),D(),p),R={class:"fullscreen-container p-4 mb-8",id:"screen"},V=["opacity"],j={class:"y"},T=x(()=>o("line",{x1:"0",x2:"0",y1:"0",y2:"600","stroke-width":"2",stroke:"currentColor"},null,-1)),G=x(()=>o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"25px","text-anchor":"middle",x:"-30",y:"240","transform-origin":"-30 240",transform:"rotate(-90)"},"Sound pressure",-1)),J=["transform"],K=x(()=>o("line",{opacity:"0.2",stroke:"currentColor","stroke-width":"1",y1:"600",y2:"600",x1:"-10",x2:"900"},null,-1)),O={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"10px","text-anchor":"left",x:"-25",y:"595"},U=["transform"],W=["x2"],Q={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"left",x:"6",y:"-12"},Z={class:"x"},tt=x(()=>o("line",{x1:"0",x2:"900",y1:"600",y2:"600","stroke-width":"2",stroke:"currentColor"},null,-1)),ot=x(()=>o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"25px","text-anchor":"middle",x:"450",y:"650"},"Frequency",-1)),et=["x1","x2"],st=["x"],nt=["x1","x2","y2","opacity"],rt=["x"],lt=["transform"],it=["y1","stroke"],at=["fill"],ct={fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"start",x:"10",y:"590"},ft=["color"],ht=x(()=>o("path",{stroke:"currentColor","stroke-width":"1",fill:"none",transform:"scale(1.46) translate(-82,20)",d:"M82.6,19.38l10.11,16,22,38.26,20.7,35.62c.09.16.18.31.28.46l19.74,29.17a5.39,5.39,0,0,0,.4.54l19.74,24.36,21.84,24.37,13.08,13.58.38.36,16.34,14.85,18.13,15.25.38.3,14.75,10.94c.13.1.28.2.42.29l14.68,9.46,18.19,11,18.43,10.1,18.18,9.47,14.79,6.83c.16.08.32.14.49.21L367.09,299l16.75,5.7.6.18L398,308.35l10.49,2.59.5.11,12.13,2.18.49.07,11.11,1.29a7.83,7.83,0,0,0,1.28,0l9.1-.43a8,8,0,0,0,1.94-.33l13.56-4.18a5.52,5.52,0,0,0,.53-.18l16.53-6.4a9.37,9.37,0,0,1,1-.31l10.53-2.49a8.3,8.3,0,0,1,1.4-.21l8-.42a8,8,0,0,1,1.77.11l5.71,1a7.77,7.77,0,0,1,2.57.93l8.44,4.85a7.5,7.5,0,0,1,.88.59l11.07,8.51,11,7.88c.19.14.38.26.58.38l5.94,3.52a7.35,7.35,0,0,0,1.2.58l2.9,1.11a7.31,7.31,0,0,0,1.59.42l1.06.17a7.91,7.91,0,0,0,4.19-.49l2.49-1a7.85,7.85,0,0,0,2.88-2l6.58-7.32c.11-.12.21-.24.31-.37l10.33-13c.17-.22.33-.44.48-.67l10.38-16.32L599,272c.12-.2.25-.39.39-.58l6-8.19a8,8,0,0,1,2-1.9l4.94-3.26a7.82,7.82,0,0,1,2.92-1.18l4.58-.84a8,8,0,0,1,2.84,0l2.29.42a7.89,7.89,0,0,1,4.23,2.27l5.54,5.72a7.3,7.3,0,0,1,1,1.19l8.2,12.64a7.52,7.52,0,0,0,1.11,1.35l1.92,1.87a7.87,7.87,0,0,0,5.68,2.24h0a7.93,7.93,0,0,0,3.93-1.16l3-1.82a7.87,7.87,0,0,0,2.35-2.21l6-8.59a7.84,7.84,0,0,0,1-2l5.5-16.27a7.38,7.38,0,0,0,.31-1.23l1.55-9.33a8.18,8.18,0,0,1,.33-1.27l6.35-18.44"},null,-1)),xt=["transform"],mt=["fill"],dt={"font-weight":"bold",fill:"white","font-family":"Commissioner, sans-serif","font-size":"18px","text-anchor":"middle",x:"0",y:"5"},ut=["points"],yt=["transform"],_t=["y2","stroke"],pt=["cy","fill","onClick"],gt=["y"],Ct=["y"],kt=["y"],vt=x(()=>o("circle",{cx:"14",cy:"14",r:"22",fill:"gray"},null,-1)),wt=x(()=>o("rect",{x:"250",y:"200",width:"400",height:"100",rx:"20",fill:"gray",stroke:"white"},null,-1)),zt=x(()=>o("text",{"font-weight":"bold",fill:"white","font-family":"Commissioner, sans-serif","font-size":"42px","text-anchor":"middle",x:"450",y:"265"},"START AUDIO",-1)),Mt=[wt,zt],bt={__name:"SoundLoudness",setup(p){const g=A(!1);function $(){P(),g.value=!0}const{svg:F,area:S,mouse:r}=I(),e=v({min:10,max:2e4,marks:[10,20,30,40,50,60,70,80,90,100,200,300,400,500,600,700,800,900,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3,1e4,2e4],nums:[10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4],As:[22.5,55,110,220,440,880,1760,3520,7040,14080],Cs:[16,32,65,130.813,261,523,1046,2093,4186,8372,16744],hz:d(()=>e.toHz(r.normX)),color:d(()=>M(e.hz)),pitch:d(()=>(b(e.hz)+120)%12),note:d(()=>{let s=Math.round(e.pitch);return s>11.5&&(s=0),N[s]}),cents:d(()=>((e.pitch-e.pitch.toFixed(0))*100).toFixed(0)),toNormX(s){return(Math.log(s)-Math.log(e.min))/(Math.log(e.max)-Math.log(e.min))},toHz(s){return Math.pow(10,s*(Math.log10(e.max)-Math.log10(e.min))+Math.log10(e.min))}}),h=v({min:-80,max:10,marks:[-80,-70,-60,-50,-40,-30,-20,-10,0,10],db:d(()=>h.toDb(r.normY)),toDb(s){return(h.max-h.min)*s+h.min},toNormY(s){return(s-h.min)/(h.max-h.min)}});let C;const a=v({list:[],add(){var u,k;C||(C=B("loudness").channel);let s=e.toHz(r.normX),n=new E({oscillator:{type:"sine"},volume:h.db}).connect(C);n.triggerAttack(s,r.normY);let c=(b(s)+120)%12;c>11.5&&(c=0);let t=((c-c.toFixed(0))*100).toFixed(0);a.list.push({synth:n,x:r.x,y:r.y,hz:s,pitch:c,cents:t,note:(k=(u=N)==null?void 0:u[Math.round(c)])==null?void 0:k.name,color:M(s)})},line:d(()=>{let s=[],n=[...a.list];return n.sort((c,t)=>c.x<t.x?-1:1),n.forEach(c=>{s.push([c.x,c.y].join(","))}),s.join(" ")}),clear(){a.list.forEach(s=>{s.synth.triggerRelease()}),a.list.splice(0,a.list.length)},remove(s){var n;(n=a.list)==null||n[s].synth.triggerRelease(),a.list.splice(s,1)}});return(s,n)=>{const c=X;return l(),i("div",R,[(l(),i("svg",{class:"min-h-80svh max-h-100svh w-full select-none",ref_key:"svg",ref:F,version:"1.1",baseProfile:"full",viewBox:"-50 -50 1000 720",xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none"},onMousemove:n[2]||(n[2]=(...t)=>m(r).getCursorPosition&&m(r).getCursorPosition(...t)),onClick:n[3]||(n[3]=t=>a.add())},[o("g",{opacity:g.value?1:.1,class:Y({"pointer-events-none":!g.value})},[o("g",j,[T,G,(l(!0),i(y,null,_(h.marks,t=>(l(),i("g",{key:t,transform:`translate(0, ${-h.toNormY(t)*600})`},[K,o("text",O,f(t),1)],8,J))),128)),o("g",{transform:`translate(0, ${m(r).y})`},[o("line",{x1:"-5",x2:m(r).x,y1:"0",y2:"0",stroke:"currentColor","stroke-width":"1px",opacity:"0.8"},null,8,W),o("text",Q,f(h.db.toFixed(0))+" db",1)],8,U)]),o("g",Z,[tt,ot,(l(!0),i(y,null,_(e.Cs,(t,u)=>(l(),i("g",{key:t},[o("line",{x1:900*e.toNormX(t),x2:900*e.toNormX(t),y1:"0",y2:600,stroke:"hsla(90,50%,50%,1)","stroke-width":"2",opacity:"0.4"},null,8,et),o("text",{fill:"hsla(90,50%,50%,1)",x:900*e.toNormX(t)+5,y:"20"},"C"+f(u),9,st)]))),128)),(l(!0),i(y,null,_(e.marks,t=>(l(),i("g",{key:t},[o("line",{x1:900*e.toNormX(t),x2:900*e.toNormX(t),y1:"0",y2:e.nums.includes(t)?620:600,stroke:"currentColor","stroke-width":"1",opacity:e.nums.includes(t)?.3:.1},null,8,nt)]))),128)),(l(!0),i(y,null,_(e.nums,t=>(l(),i("text",{key:t,fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"12px","text-anchor":"middle",x:900*e.toNormX(t),y:"625"},f(t)+" Hz",9,rt))),128)),o("g",{transform:`translate(${m(r).x}, 0)`},[o("line",{class:"transition-all duration-100",x1:"0",x2:"0",y1:m(r).y,y2:"600",stroke:e.color,"stroke-width":"2px"},null,8,it),o("circle",{class:"transition-all duration-100",cx:"0",cy:"600",r:"6",fill:e.color},null,8,at),o("text",ct,f(e.hz.toFixed(1))+" Hz",1),o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"end",x:"-10",y:"590",color:e.color},f(e.note.name)+" "+f(e.cents),9,ft)],8,lt)]),ht,o("rect",{ref_key:"area",ref:S,style:{cursor:"none"},x:"0",y:"0",width:"900",height:"600",fill:"hsla(0,0%,100%,0.1)"},null,512),o("g",{transform:`translate(${m(r).x}, ${m(r).y})`},[o("circle",{class:"pointer",cx:0,cy:0,r:"16",fill:e.color},null,8,mt),o("text",dt,f(e.note),1)],8,xt),o("polyline",{points:a.line,stroke:"currentColor","stroke-width":"4",fill:"none",opacity:"0.7"},null,8,ut),(l(!0),i(y,null,_(a.list,(t,u)=>(l(),i("g",{key:t.hz,transform:`translate(${t.x}, 0)`},[o("line",{x1:"0",x2:"0",y1:"600",y2:t.y,stroke:t.color,"stroke-width":"2"},null,8,_t),o("circle",{class:"cursor-pointer",cx:"0",cy:t.y,r:"20",fill:t.color,onClick:w(k=>a.remove(u),["stop","prevent"])},null,8,pt),o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"16px","text-anchor":"end",x:"-5",y:t.y+36},f(t.cents<0?"":"+")+f(t.cents),9,gt),o("text",{fill:"currentColor","font-family":"Commissioner, sans-serif","font-size":"16px","text-anchor":"start",x:"5",y:t.y+36},f(t.hz.toFixed(1))+" Hz",9,Ct),o("text",{"font-weight":"bold",fill:"white","font-family":"Commissioner, sans-serif","font-size":"22px","text-anchor":"middle",x:"0",y:t.y+8},f(t.note),9,kt)],8,yt))),128)),a.list.length>0?(l(),i("g",{key:0,class:"cursor-pointer",transform:"translate(860,560)",onClick:n[0]||(n[0]=w(t=>a.clear(),["stop","prevent"]))},[vt,L(c,{class:"text-2xl"})])):z("",!0)],10,V),g.value?z("",!0):(l(),i("g",{key:0,class:"cursor-pointer",onClick:n[1]||(n[1]=w(t=>$(),["stop","prevent"]))},Mt))],544))])}}},St=H(bt,[["__scopeId","data-v-ecc88e19"]]);export{St as default};
