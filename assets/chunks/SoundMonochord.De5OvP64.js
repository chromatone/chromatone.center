import{H as T,aA as z,F as C,aF as O}from"./theme.B0Nso7zl.js";import{b as $,c as y,av as R,aQ as Z,P as V,x as b,y as M,A as a,E as w,G as v,C as H,F as G,B as Q}from"./framework.DzzWumix.js";typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const u=BigInt(1),f=BigInt(0),m=BigInt(10),E=BigInt(2),P=BigInt(5),W=2e3,r={s:u,n:f,d:u};function F(t,n){try{t=BigInt(t)}catch{throw k()}return t*n}function g(t,n){if(n===f)throw L();const i=Object.create(D.prototype);i.s=t<f?-u:u,t=t<f?-t:t;const e=N(t,n);return i.n=t/e,i.d=n/e,i}function j(t){const n={};let i=t,e=E,o=P-u;for(;o<=i;){for(;i%e===f;)i/=e,n[e]=(n[e]||f)+u;o+=u+E*e++}return i!==t?i>1&&(n[i]=(n[i]||f)+u):n[t]=(n[t]||f)+u,n}const q=function(t,n){let i=f,e=u,o=u;if(t!=null)if(n!==void 0){if(!(typeof t=="bigint"&&typeof t=="bigint"))if(!isNaN(n)&&!isNaN(t)){if(t%1!==0||n%1!==0)throw K();i=BigInt(t),e=BigInt(n),o=i*e}else throw k()}else if(typeof t=="object"){if("d"in t&&"n"in t)i=BigInt(t.n),e=BigInt(t.d),"s"in t&&(i*=BigInt(t.s));else if(0 in t)i=BigInt(t[0]),1 in t&&(e=BigInt(t[1]));else if(t instanceof BigInt)i=BigInt(t);else throw k();o=i*e}else if(typeof t=="bigint")i=t,o=t,e=u;else if(typeof t=="number"){if(isNaN(t))throw k();if(t<0&&(o=-u,t=-t),t%1===0)i=BigInt(t);else if(t>0){let s=1,h=0,d=1,_=1,x=1,B=1e7;for(t>=1&&(s=10**Math.floor(1+Math.log10(t)),t/=s);d<=B&&x<=B;){let l=(h+_)/(d+x);if(t===l){d+x<=B?(i=h+_,e=d+x):x>d?(i=_,e=x):(i=h,e=d);break}else t>l?(h+=_,d+=x):(_+=h,x+=d),d>B?(i=_,e=x):(i=h,e=d)}i=BigInt(i)*BigInt(s),e=BigInt(e)}}else if(typeof t=="string"){let s=0,h=f,d=f,_=f,x=u,B=u,l=t.match(/\d+|./g);if(l===null)throw k();if(l[s]==="-"?(o=-u,s++):l[s]==="+"&&s++,l.length===s+1?d=F(l[s++],o):l[s+1]==="."||l[s]==="."?(l[s]!=="."&&(h=F(l[s++],o)),s++,(s+1===l.length||l[s+1]==="("&&l[s+3]===")"||l[s+1]==="'"&&l[s+3]==="'")&&(d=F(l[s],o),x=m**BigInt(l[s].length),s++),(l[s]==="("&&l[s+2]===")"||l[s]==="'"&&l[s+2]==="'")&&(_=F(l[s+1],o),B=m**BigInt(l[s+1].length)-u,s+=3)):l[s+1]==="/"||l[s+1]===":"?(d=F(l[s],o),x=F(l[s+2],u),s+=3):l[s+3]==="/"&&l[s+1]===" "&&(h=F(l[s],o),d=F(l[s+2],o),x=F(l[s+4],u),s+=5),l.length<=s)e=x*B,o=i=_+e*h+B*d;else throw k()}else throw k();if(e===f)throw L();r.s=o<f?-u:u,r.n=i<f?-i:i,r.d=e<f?-e:e};function X(t,n,i){let e=u;for(;n>f;t=t*t%i,n>>=u)n&u&&(e=e*t%i);return e}function Y(t,n){for(;n%E===f;n/=E);for(;n%P===f;n/=P);if(n===u)return f;let i=m%n,e=1;for(;i!==u;e++)if(i=i*m%n,e>W)return f;return BigInt(e)}function J(t,n,i){let e=u,o=X(m,i,n);for(let s=0;s<300;s++){if(e===o)return BigInt(s);e=e*m%n,o=o*m%n}return 0}function N(t,n){if(!t)return n;if(!n)return t;for(;;){if(t%=n,!t)return n;if(n%=t,!n)return t}}function D(t,n){if(q(t,n),this instanceof D)t=N(r.d,r.n),this.s=r.s,this.n=r.n/t,this.d=r.d/t;else return g(r.s*r.n,r.d)}var L=function(){return new Error("Division by Zero")},k=function(){return new Error("Invalid argument")},K=function(){return new Error("Parameters must be integer")};D.prototype={s:u,n:f,d:u,abs:function(){return g(this.n,this.d)},neg:function(){return g(-this.s*this.n,this.d)},add:function(t,n){return q(t,n),g(this.s*this.n*r.d+r.s*this.d*r.n,this.d*r.d)},sub:function(t,n){return q(t,n),g(this.s*this.n*r.d-r.s*this.d*r.n,this.d*r.d)},mul:function(t,n){return q(t,n),g(this.s*r.s*this.n*r.n,this.d*r.d)},div:function(t,n){return q(t,n),g(this.s*r.s*this.n*r.d,this.d*r.n)},clone:function(){return g(this.s*this.n,this.d)},mod:function(t,n){if(t===void 0)return g(this.s*this.n%this.d,u);if(q(t,n),r.n===0&&this.d===0)throw L();return g(this.s*(r.d*this.n)%(r.n*this.d),r.d*this.d)},gcd:function(t,n){return q(t,n),g(N(r.n,this.n)*N(r.d,this.d),r.d*this.d)},lcm:function(t,n){return q(t,n),r.n===f&&this.n===f?g(f,u):g(r.n*this.n,N(r.n,this.n)*N(r.d,this.d))},inverse:function(){return g(this.s*this.d,this.n)},pow:function(t,n){if(q(t,n),r.d===u)return r.s<f?g((this.s*this.d)**r.n,this.n**r.n):g((this.s*this.n)**r.n,this.d**r.n);if(this.s<f)return null;let i=j(this.n),e=j(this.d),o=u,s=u;for(let h in i)if(h!=="1"){if(h==="0"){o=f;break}if(i[h]*=r.n,i[h]%r.d===f)i[h]/=r.d;else return null;o*=BigInt(h)**i[h]}for(let h in e)if(h!=="1"){if(e[h]*=r.n,e[h]%r.d===f)e[h]/=r.d;else return null;s*=BigInt(h)**e[h]}return r.s<f?g(s,o):g(o,s)},equals:function(t,n){return q(t,n),this.s*this.n*r.d===r.s*r.n*this.d},compare:function(t,n){q(t,n);let i=this.s*this.n*r.d-r.s*r.n*this.d;return(f<i)-(i<f)},ceil:function(t){return t=m**BigInt(t||0),g(this.s*t*this.n/this.d+(t*this.n%this.d>f&&this.s>=f?u:f),t)},floor:function(t){return t=m**BigInt(t||0),g(this.s*t*this.n/this.d-(t*this.n%this.d>f&&this.s<f?u:f),t)},round:function(t){return t=m**BigInt(t||0),g(this.s*t*this.n/this.d+this.s*((this.s>=f?u:f)+E*(t*this.n%this.d)>this.d?u:f),t)},roundTo:function(t,n){q(t,n);const i=this.n*r.d,e=this.d*r.n;let o=i/e;return i%e*2n>=e&&o++,g(this.s*o*r.n,r.d)},divisible:function(t,n){return q(t,n),!(!(r.n*this.d)||this.n*r.d%(r.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let n=this.n,i=this.d;function e(d){return typeof d=="bigint"?d:Math.floor(d)}t=t||15;let o=Y(n,i),s=J(n,i,o),h=this.s<f?"-":"";if(h+=e(n/i),n%=i,n*=m,n&&(h+="."),o){for(let d=s;d--;)h+=e(n/i),n%=i,n*=m;h+="(";for(let d=o;d--;)h+=e(n/i),n%=i,n*=m;h+=")"}else for(let d=t;n&&d--;)h+=e(n/i),n%=i,n*=m;return h},toFraction:function(t){let n=this.n,i=this.d,e=this.s<f?"-":"";if(i===u)e+=n;else{let o=n/i;t&&o>f&&(e+=o,e+=" ",n%=i),e+=n,e+="/",e+=i}return e},toLatex:function(t){let n=this.n,i=this.d,e=this.s<f?"-":"";if(i===u)e+=n;else{let o=n/i;t&&o>f&&(e+=o,n%=i),e+="\\frac{",e+=n,e+="}{",e+=i,e+="}"}return e},toContinued:function(){let t=this.n,n=this.d,i=[];do{i.push(t/n);let e=t%n;t=n,n=e}while(t!==u);return i},simplify:function(t){t=t||.001;const n=this.abs(),i=n.toContinued();for(let e=1;e<i.length;e++){let o=g(i[e-1],u);for(let s=e-2;s>=0;s--)o=o.inverse().add(i[s]);if(Math.abs(o.sub(n).valueOf())<t)return o.mul(this.s)}return this}};const U={class:"flex flex-col fullscreen-container",id:"screen"},p={class:"py-8 select-none",version:"1.1",baseProfile:"full",viewBox:"-10 -5 120 35",xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"3px","text-anchor":"middle","dominant-baseline":"middle","stroke-linecap":"round",fill:"white",style:{"touch-action":"none"}},tt={id:"ruler","stroke-width":"0.2",stroke:"currentColor"},nt=["x1","x2"],et={id:"freqs",stroke:"none",fill:"currentColor"},it={id:"left","text-anchor":"end"},st=["x"],rt=["x"],ot={id:"right","text-anchor":"start"},ft=["x"],lt=["x"],ut={class:"cursor-pointer",id:"ratio","font-size":"4px",fill:"currentColor"},dt=["x"],ht=["x"],ct=["stroke"],at={x:"50","font-weight":"bold"},gt={class:"cursor-pointer",id:"divided",transform:"translate(0,15)","font-weight":"bold"},xt=["stroke","x2"],wt=["x"],yt=["stroke","x1"],vt=["x"],mt=["cx"],qt={class:"flex flex-wrap justify-center m-4"},Bt=["onClick"],kt={__name:"SoundMonochord",setup(t){function n(l){console.log(l)}const i=$({ratio:T(.8,.05,.95),fraction:y(()=>new D(1-i.ratio).simplify(.001).toFraction(!0)),invFraction:y(()=>new D(i.ratio).simplify(.001).toFraction(!0))}),e=$({freq:T(220,50,2e3),pitch:y(()=>z(e.freq).toFixed()),note:y(()=>C(e.freq).toNote()),cents:y(()=>B(C(e.note).toFrequency(),e.freq))}),o=$({freq:y(()=>e.freq/(1-i.ratio)),pitch:y(()=>(z(o.freq)+120)%12),note:y(()=>C(o.freq).toNote()),cents:y(()=>B(C(o.note).toFrequency(),o.freq))}),s=$({freq:y(()=>e.freq/i.ratio),pitch:y(()=>(z(s.freq)+120)%12),note:y(()=>C(s.freq).toNote()),cents:y(()=>B(C(s.note).toFrequency(),s.freq))}),h={"1/2":1/2,"2/3":2/3,"3/4":3/4,"3/5":3/5,"4/5":4/5,"5/6":5/6,"4/7":4/7,"5/7":5/7,"6/7":6/7,"5/8":5/8,"7/8":7/8,"5/9":5/9,"7/9":7/9,"8/9":8/9,"9/10":9/10,"10/11":10/11,"11/12":11/12,"8/15":8/15,"15/16":15/16,"32/45":32/45},d=R(y(()=>i.ratio),{duration:200,transition:Z.easeOutCubic});function _(l){e.freq+=l.delta[0]/4}function x(l){i.ratio-=l.delta[0]/1200}function B(l,c){return-(1200/Math.log10(2))*Math.log10(l/c)%1200}return(l,c)=>{const A=V("drag");return b(),M("div",U,[(b(),M("svg",p,[a("g",tt,[c[8]||(c[8]=a("line",{y1:"30",y2:"30",x2:"100"},null,-1)),c[9]||(c[9]=a("line",{y1:"0",y2:"30"},null,-1)),c[10]||(c[10]=a("line",{x1:"100",x2:"100",y1:"0",y2:"30"},null,-1)),a("line",{x1:100*(1-w(d)),x2:100*(1-w(d)),y1:"0",y2:"30"},null,8,nt),a("g",et,[a("g",it,[a("text",{x:100*(1-w(d))-2,y:"28"},v(o.freq.toFixed(1))+" Hz",9,st),a("text",{x:100*(1-w(d))-2,y:"24"},v(o.note)+" ("+v(o.cents.toFixed())+" cents) ",9,rt)]),a("g",ot,[a("text",{x:100*(1-w(d))+2,y:"28"},v(s.freq.toFixed(1))+" Hz",9,ft),a("text",{x:100*(1-w(d))+2,y:"24"},v(s.note)+" ("+v(s.cents.toFixed())+" cents) ",9,lt)])]),a("g",ut,[a("g",{onMousedown:c[0]||(c[0]=I=>{n(e.freq),n(o.freq)})},[a("text",{x:100*(1-w(d))-2,y:"8","text-anchor":"end"},v(i.fraction),9,dt)],32),a("g",{onMousedown:c[1]||(c[1]=I=>{n(e.freq),n(s.freq)})},[a("text",{x:100*(1-w(d))+2,y:"8","text-anchor":"start"},v(i.invFraction),9,ht)],32)])]),H((b(),M("g",{class:"cursor-pointer",id:"fundamental",onMouseover:c[2]||(c[2]=I=>n(e.freq)),onMousedown:c[3]||(c[3]=I=>n(e.freq))},[a("line",{x2:"100","stroke-width":"4",stroke:w(O)(e.freq)},null,8,ct),c[11]||(c[11]=a("circle",{r:"1"},null,-1)),c[12]||(c[12]=a("circle",{cx:"100",r:"1"},null,-1)),a("text",at,v(e.note)+" "+v(e.freq.toFixed())+" Hz ("+v(e.cents.toFixed())+" cents)",1)],32)),[[A,_]]),H((b(),M("g",gt,[a("g",{id:"part1",onMouseover:c[4]||(c[4]=I=>n(o.freq)),onMousedown:c[5]||(c[5]=I=>n(o.freq))},[a("line",{stroke:w(O)(o.freq),"stroke-width":"4",x2:100*(1-w(d))},null,8,xt),a("text",{y:"0.3",x:100*(1-w(d))/2},v(o.note),9,wt)],32),a("g",{id:"part2",onMouseover:c[6]||(c[6]=I=>n(s.freq)),onMousedown:c[7]||(c[7]=I=>n(s.freq))},[a("line",{stroke:w(O)(s.freq),"stroke-width":"4",x1:100*(1-w(d)),x2:"100"},null,8,yt),a("text",{y:"0.3",x:100-100*w(d)/2},v(s.note),9,vt),a("circle",{cx:100*(1-w(d)),r:"1"},null,8,mt)],32),c[13]||(c[13]=a("circle",{r:"1"},null,-1)),c[14]||(c[14]=a("circle",{r:"1",cx:"100"},null,-1))])),[[A,x]])])),a("div",qt,[(b(),M(G,null,Q(h,(I,S)=>a("button",{class:"p-2 border-1 shadow m-2",key:S,onClick:_t=>i.ratio=I},v(S),9,Bt)),64))])])}}};export{kt as default};
