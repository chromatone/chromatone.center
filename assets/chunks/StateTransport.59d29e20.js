import{_ as w}from"./ControlKnob.6f9345f0.js";import{ac as P,i as k,o as s,c as l,a as i,v,_ as T,m as x,n as a,h as t,g as h,q as f,t as c,y as $,p as z,e as M}from"./framework.e4746382.js";import{u as B,a as g}from"./tempo.4b0ad442.js";import{u as D}from"./tuner.04cde6a3.js";const I=["viewBox","stroke-width"],E=["r","stroke"],N=P({__name:"BeatMove",props:{color:String,progress:Number,size:{type:Number,default:10},stroke:{type:Number,default:2}},setup(r){const o=r,m=k(()=>o.size/2-1),n=k(()=>m.value*Math.PI*2);return(b,_)=>(s(),l("svg",{version:"1.1",baseProfile:"full",viewBox:`${-r.size/2} ${-r.size/2} ${r.size} ${r.size}`,xmlns:"http://www.w3.org/2000/svg","stroke-width":r.stroke},[i("circle",{r:m.value,fill:"none",stroke:r.color,transform:"rotate(-90)",style:v({strokeDasharray:`${n.value/2}, ${n.value/2}`,strokeDashoffset:1.5*n.value-r.progress*n.value})},null,12,E)],8,I))}});const p=r=>(z("data-v-687b8869"),r=r(),M(),r),U={class:"flex flex-col w-full mx-auto justify-center gap-2"},V={class:"tempo-grid text-xl"},L=["transform"],A={key:0,class:"i-la-play"},F={key:1,class:"i-la-pause"},G=p(()=>i("div",{class:"i-la-stop"},null,-1)),O=[G],H=p(()=>i("div",{class:"i-la-minus"},null,-1)),j=[H],q=p(()=>i("div",{class:"i-la-plus"},null,-1)),K=[q],Y=p(()=>i("div",{class:"i-la-slash"},null,-1)),J=[Y],Q=p(()=>i("div",{class:"i-la-times"},null,-1)),R=[Q],W={class:"font-bold font-mono flex-1 -mt-4 flex justify-center items-end",style:{"font-variant-numeric":"tabular-nums"}},X={class:"text-4xl"},Z={class:"m-0"},tt=p(()=>i("div",{class:"text-sm mt-1px ml-1 absolute bottom-3"},"BPM",-1)),ot={class:"text-4xl font-bold"},et={class:"flex-1 -mt-2 font-bold font-mono"},st=p(()=>i("div",{class:"text-sm mt-1px absolute bottom-3"},"Hz",-1)),lt=p(()=>i("div",{class:"i-fluent-tap-double-20-regular mt-1"},null,-1)),it=[lt],nt={key:0,class:"font-bold"},at={key:1,class:"opacity-40"},rt={key:0,class:"i-tabler-ear"},dt={key:1,class:"i-tabler-ear-off"},ut={key:0,class:"font-bold"},ct={key:1,class:"opacity-40"},pt={class:"flex font-mono text-sm gap-4"},mt={class:"flex-1"},vt={class:"flex-1"},_t={__name:"StateTransport",props:{secondary:Boolean},setup(r){const o=B(),{init:m,tuner:n}=D();function b(_){o.bpm+=(_.delta[0]-_.delta[1])/16}return(_,e)=>{const C=N,S=w,d=x("tooltip"),y=x("drag");return s(),l("div",U,[i("div",V,[a((s(),l("button",{class:"relative overflow-hidden",style:v([{"grid-area":"CLICK"},{color:t(o).blink?t(o).color:"currentColor"}]),onClick:e[0]||(e[0]=u=>t(o).mute=!t(o).mute),"aria-label":"Toggle metronome"},[i("div",{class:"i-mdi-metronome z-4",style:v([{transition:"all 300ms ease-out"},{opacity:t(o).mute?.3:1}]),transform:`scale(${!t(o).mute&&t(o).blink?1.1:1})`},null,12,L),h(C,{class:"opacity-30 z-2 absolute top-0 bottom-0 w-full h-full",progress:t(o).progress,color:t(o).color,stroke:10},null,8,["progress","color"])],4)),[[d,"Toggle metronome",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"PLAY"},onClick:e[1]||(e[1]=u=>t(o).playing=!t(o).playing)},[t(o).playing?(s(),l("div",F)):(s(),l("div",A))])),[[d,"Play",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"STOP"},onClick:e[2]||(e[2]=u=>t(o).stopped=Date.now())},O)),[[d,"Stop",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"MINUS"},onClick:e[3]||(e[3]=u=>t(o).set(-1))},j)),[[d,"Subtract 1 BPM",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"PLUS"},onClick:e[4]||(e[4]=u=>t(o).set(1))},K)),[[d,"Add 1 BPM",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"DIVIDE"},onClick:e[5]||(e[5]=u=>t(o).set(-t(o).bpm/2))},J)),[[d,"Half speed",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"MULTIPLY"},onClick:e[6]||(e[6]=u=>t(o).set(t(o).bpm))},R)),[[d,"Double speed",void 0,{top:!0}]]),a((s(),l("button",{class:f(["relative touch-none text-center flex",{active:t(n).blink}]),style:v([{"grid-area":"BPM"},{borderColor:t(o).blink?t(o).color:"currentColor"}])},[i("div",W,[i("div",X,c(t(o).bpm.toFixed(0)),1),i("div",Z,c((t(o).bpm-Math.floor(t(o).bpm)).toFixed(1).substring(1)),1)]),tt],6)),[[y,b]]),a((s(),l("button",{class:"relative flex flex-col gap-2 touch-none",style:v([{"grid-area":"Hz"},{color:t(o).color,borderColor:t(o).color}])},[i("div",ot,c(t(o).note),1),i("div",et,c(t(o).hz),1),st],4)),[[y,b],[d,"Tempo frequency and pitch class",void 0,{top:!0}]]),a(h(S,{class:"font-bold w-full",style:{"grid-area":"NOTE"},modelValue:t(o).volume,"onUpdate:modelValue":e[7]||(e[7]=u=>t(o).volume=u),min:0,max:1,step:.01,param:"VOL",cc:16},null,8,["modelValue"]),[[d,"Metronome volume",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"TAP"},onMousedown:e[8]||(e[8]=$(u=>t(g)(),["stop","prevent"])),onTouchstart:e[9]||(e[9]=$(u=>t(g)(),["stop","prevent"])),class:f({active:t(o).tap.last})},it,34)),[[d,"Tap tempo",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"TAPPED"},onClick:e[10]||(e[10]=u=>t(o).tap.bpm&&t(o).tap.last?t(o).bpm=t(o).tap.bpm:t(g)())},[t(o).tap.bpm&&t(o).tap.last?(s(),l("div",nt,c(t(o).tap.bpm.toFixed(1)),1)):(s(),l("div",at,"TAP"))])),[[d,"Click to set tap tempo",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"GUESS"},onClick:e[11]||(e[11]=u=>t(n).initiated?t(n).listen=!t(n).listen:t(m)())},[t(n).listen?(s(),l("div",dt)):(s(),l("div",rt))])),[[d,"Guess tempo from audio",void 0,{top:!0}]]),a((s(),l("button",{class:f(["duration-100",{active:t(n).blink}]),style:{"grid-area":"GUESSED"},onClick:e[12]||(e[12]=u=>t(n).initiated?t(n).listen&&t(n).bpm?t(o).bpm=t(n).bpm:t(n).listen=!0:t(m)())},[t(n).listen?(s(),l("div",ut,c(t(n).bpm.toFixed(0)),1)):(s(),l("div",ct,"GUESS"))],2)),[[d,"Click to set guessed tempo",void 0,{top:!0}]])]),i("div",pt,[i("div",mt,"POS "+c(t(o).position),1),i("div",vt,"TICK "+c(t(o).ticks),1)])])}}},kt=T(_t,[["__scopeId","data-v-687b8869"]]);export{kt as _};
