import{D as d,ag as G,am as B}from"./theme.CwHwVffe.js";import{J as I,aq as $,aW as z,a2 as A,H as D,o as H,Z as K,G as j,r as Q,E as c,q as E,f as m,s as i,l as x,j as N,e as k,t as _,u as t,ac as R,aj as X,a7 as V,z as O,F as T,Q as Y}from"./framework.D01lOa8K.js";const J={a:{name:"amp",type:"float",min:0,max:5,default:0,notes:"use after a note on is triggered with velocity to adjust amplitude without re-triggering the note"},A:{name:"bp0",type:"string",default:"100,0.5,150,0.25,200,0",notes:"in commas, like 100,0.5,150,0.25,200,0 -- envelope generator with alternating time(ms) and ratio. last pair triggers on note off"},B:{name:"bp1",type:"string",default:"100,0.5,150,0.25,200,0",notes:"set the second breakpoint generator. see breakpoint 0"},b:{name:"feedback",type:"float",min:0,max:1,default:0,notes:"use for the ALGO synthesis type in FM, or partial synthesis (for bandwidth) or for karplus-strong, or to indicate PCM looping (0 off, >0, on)"},C:{name:"bp2",type:"string",default:"100,0.5,150,0.25,200,0",notes:"3rd breakpoint generator"},d:{name:"duty",type:"float",min:.001,max:.999,default:.5,notes:"duty cycle for pulse wave, default 0.5"},D:{name:"debug",type:"uint",min:2,max:4,default:0,notes:"2 shows queue sample, 3 shows oscillator data, 4 shows modified oscillator. will interrupt audio!"},f:{name:"freq",type:"floats",min:0,max:14e3,default:220,notes:"frequency of oscillator"},F:{name:"filter_freq",type:"float",min:0,max:14e3,default:3e3,notes:"center frequency for biquad filter"},g:{name:"mod_target",type:"mask",min:0,max:64,default:0,notes:"Which parameter modulation/LFO controls. 1=amp, 2=duty, 4=freq, 8=filter freq, 16=resonance, 32=feedback. Can handle any combo, add them together"},G:{name:"filter_type",type:"uint",min:0,max:3,default:0,notes:"0 = none (default.) 1 = low pass, 2 = band pass, 3 = hi pass."},I:{name:"ratio",type:"float",min:0,max:1,default:.5,notes:"for ALGO types, where the base note frequency controls the modulators, or for the ALGO base note and PARTIALS base note, where the ratio controls the speed of the playback"},L:{name:"mod_source",type:"uint",min:0,max:1024,default:0,notes:"Which oscillator is used as an modulation/LFO source for this oscillator. Source oscillator will be silent."},l:{name:"vel",type:"floats",min:0,max:5,default:0,notes:"velocity - >0 to trigger note on, 0 to trigger note off. sets amplitude"},N:{name:"latency_ms",type:"uint",min:0,max:1e3,default:0,notes:"sets latency in ms. default 0"},n:{name:"note",type:"uint",min:1,max:127,default:60,notes:"midi note, sets frequency"},o:{name:"algorithm",type:"uint",min:1,max:32,default:1,notes:"DX7 algorith to use for ALGO type"},O:{name:"algo_source",type:"string",default:"0,1,2,3,4,-1",notes:"which oscillators to use for the algorithm. list of six, use -1 for not used, e.g 0,1,2,-1,-1-1"},p:{name:"patch",type:"uint",min:0,max:1024,default:16,notes:"choose a preloaded PCM sample, partial patch or FM patch number for ALGO waveforms."},P:{name:"phase",type:"floats",min:0,max:0,default:0,notes:"where in the oscillator's cycle to start sampling from (also works on the PCM buffer). default 0"},R:{name:"resonance",type:"float",min:0,max:10,default:0,notes:"q factor of biquad filter. in practice, 0-10.0. default 0.7"},S:{name:"reset",type:"uint",min:0,max:1024,default:0,notes:"resets given oscillator. set to > OSCS to reset all oscillators, gain and EQ"},T:{name:"bp0_target",type:"mask",min:0,max:128,default:0,notes:"Which parameter bp0 controls. 1=amp, 2=duty, 4=freq, 8=filter freq, 16=resonance, 32=feedback (can be added together). Can add 64 for linear ramp, otherwise exponential"},t:{name:"timestamp",type:"uint",min:0,max:1e3,default:0,notes:"ms of expected playback since some fixed start point on your host. you should always give this if you can."},v:{name:"osc",type:"uint",min:0,max:1024,default:0,notes:"which oscillator to control"},V:{name:"volume",type:"float",min:0,max:10,default:1,notes:"volume knob for entire synth, default 1.0"},w:{name:"wave",type:"uint",min:0,max:11,default:0,notes:"waveform: [0=SINE, PULSE, SAW_DOWN, SAW_UP, TRIANGLE, NOISE, KS, PCM, ALGO, PARTIAL, PARTIALS, OFF]. default: 0/SINE"},W:{name:"bp1_target",type:"mask",min:0,max:128,default:0,notes:"see bp0_target"},x:{name:"eq_l",type:"float",min:-15,max:15,default:0,notes:"in dB, fc=800Hz amount, -15 to 15. 0 is off. default 0."},X:{name:"bp2_target",type:"mask",min:0,max:128,default:0,notes:"see bp0_target"},y:{name:"eq_m",type:"float",min:-15,max:15,default:0,notes:"in dB, fc=2500Hz amount, -15 to 15. 0 is off. default 0."},z:{name:"eq_h",type:"float",min:-15,max:15,default:0,notes:"in dB, fc=7500Hz amount, -15 to 15. 0 is off. default 0."}};var U=!1,F=null,S=null,L=null,M=null;const Z=Q(!1),ee=J,q=j(()=>{const u=[];for(let o in v)u.push(`${o}${v[o]}`);return u.push("A0,0.2,150,1,250,0T59"),u.join("")}),te=["SINE","PULSE","SAW_DOWN","SAW_UP","TRI","NOISE","KS","PCM","ALGO","PARTIAL","PARTIALS"],g=d(60,10,127),P=D([]),v=D({p:d(c("amy-patch",248),0,1024),w:d(c("amy-waveform",7),0,11),V:d(c("amy-volume",1),0,10),d:d(c("amy-duty",.5),.001,.999),o:d(c("amy-algo",1),1,32),b:d(c("amy-feedback",0),0,1)});function ae(){I(()=>G.note,n=>{y(n.number,n.velocity/127)}),I(q,n=>{S(n),P.unshift(n)}),$("a",()=>{y(g.value,1)}),z("a",()=>{y(g.value,0)}),A("ArrowLeft",()=>{v.patch--}),A("ArrowRight",()=>{v.patch++}),A("ArrowUp",n=>{n.preventDefault(),g.value++}),A("ArrowDown",n=>{n.preventDefault(),g.value--}),H(()=>{K(()=>import("./amyJS.DbXKzB8V.js"),[]).then(n=>{const{Module:l}=n;l.onRuntimeInitialized=function(){F=l.cwrap("web_audio_buffer","number",["number","number"]),S=l.cwrap("amy_play_message",null,["string"]),L=l.cwrap("amy_start_web",null,["number"])};var e=null,s=null,a=new Float32Array;M=function(h){if(e==null||e.length==0){a=new Float32Array(h.length);var C=a.length*a.BYTES_PER_ELEMENT;s=l._malloc(C),e=new Uint8Array(l.HEAPU8.buffer,s,C),e.set(new Uint8Array(a.buffer))}F(e.byteOffset,h.length);var W=new Float32Array(e.buffer,e.byteOffset,a.length);for(let w=0;w<h.length;w++)h[w]=W[w]}})});var u=!1,o=null,b=null,f=null;function r(n){var l=window.AudioContext||window.webkitAudioContext||!1;if(!l){console.error("No Audio");return}f=new l({sampleRate:48e3}),b=f.createBufferSource(),o=f.createScriptProcessor(256,0,1),o.onaudioprocess=function(e){n(e.outputBuffer.getChannelData(0))}}function p(){u||(L==null||L(),r(M),o.connect(f.destination),b.start(),u=!0,U=!0)}function y(n,l=0){U||p();let e=`v${n*20}`;if(l>0){let a=e+q.value;S(a),P.unshift(a)}let s=e+`n${n}l${l.toFixed(2)}`;P.unshift(s),S(s)}return{started:Z,codes:ee,message:q,waveforms:te,history:P,note:g,knobs:v}}const oe={class:"p-2 rounded-xl border-1 m-2 select-none flex flex-wrap gap-2"},ne={class:"p-2 rounded-xl border-1 m-2 select-none flex flex-wrap gap-4"},le={class:"p-4 flex items-center font-mono"},se={class:"top-16 right-4 p-4 w-80 max-h-80vh overflow-hidden flex flex-col opacity-30 pointer-events-none font-mono text-sm fixed"},re={class:"font-bold border-b-2"},de={__name:"SynthAmy",setup(u){const{knobs:o,waveforms:b,reset:f,note:r,play:p,message:y,history:n}=ae();return(l,e)=>{const s=B;return m(),E(T,null,[i("div",oe,[x(R,{name:"fade"},{default:N(()=>[x(s,{key:"Wave",min:0,max:11,param:"Wave",modelValue:t(o).w,"onUpdate:modelValue":e[0]||(e[0]=a=>t(o).w=a),fixed:0,unit:t(b)[t(o).w]},null,8,["modelValue","unit"]),t(o).w>6?(m(),k(s,{key:"Patch",min:1,max:1024,param:"Patch",modelValue:t(o).p,"onUpdate:modelValue":e[1]||(e[1]=a=>t(o).p=a),fixed:0},null,8,["modelValue"])):_("",!0),t(o).w==1?(m(),k(s,{key:"Duty",min:.001,max:.999,param:"Duty",step:.01,modelValue:t(o).d,"onUpdate:modelValue":e[2]||(e[2]=a=>t(o).d=a),fixed:2},null,8,["modelValue"])):_("",!0),t(o).w==8?(m(),k(s,{key:"Algo",min:1,max:32,param:"ALGO",modelValue:t(o).o,"onUpdate:modelValue":e[3]||(e[3]=a=>t(o).o=a),fixed:0},null,8,["modelValue"])):_("",!0),t(o).w>5?(m(),k(s,{key:"Feedback",min:0,max:1,param:"Feedback",modelValue:t(o).b,"onUpdate:modelValue":e[4]||(e[4]=a=>t(o).b=a),fixed:1,step:.01},null,8,["modelValue"])):_("",!0),x(s,{key:"volume",min:0,max:10,param:"Volume",modelValue:t(o).V,"onUpdate:modelValue":e[5]||(e[5]=a=>t(o).V=a),fixed:1,step:.01},null,8,["modelValue"]),e[12]||(e[12]=i("div",{class:"flex-auto",key:"flex"},null,-1)),i("button",{class:"text-button",onClick:e[6]||(e[6]=a=>t(f)()),key:"reset"},"RESET")]),_:1})]),i("div",ne,[x(s,{min:1,max:127,param:"Note",modelValue:t(r),"onUpdate:modelValue":e[7]||(e[7]=a=>X(r)?r.value=a:null),fixed:0,unit:"MIDI"},null,8,["modelValue"]),i("button",{class:"flex items-center gap-4 select-none p-4 rounded-xl bg-green-300 dark-bg-green-900 active-font-bold",onMousedown:e[8]||(e[8]=V(a=>t(p)(t(r),1),["prevent","stop"])),onTouchstart:e[9]||(e[9]=V(a=>t(p)(t(r),1),["prevent","stop"])),onMouseup:e[10]||(e[10]=V(a=>t(p)(t(r),0),["prevent","stop"])),onTouchend:e[11]||(e[11]=V(a=>t(p)(t(r),0),["prevent","stop"]))},e[13]||(e[13]=[i("div",{class:"i-la-play text-4xl"},null,-1)]),32)]),i("div",le,O(t(y)),1),i("div",se,[i("div",re,O(t(y)),1),x(R,{name:"fade"},{default:N(()=>[(m(!0),E(T,null,Y(t(n),a=>(m(),E("div",{class:"p-0",key:a},O(a),1))),128))]),_:1})])],64)}}};export{de as default};
