import{be as W,bf as G,b1 as A,F as i,u as f,al as B,ar as z}from"./theme.BH05JkjQ.js";import{I as O,D as T,o as $,a0 as H,M as K,r as j,q as C,f as r,s as d,Z as Y,l as _,j as q,e as k,t as S,u as o,a6 as F,a5 as X,C as Q,z as I,F as R,Y as Z}from"./framework.DprnlfsI.js";const J={a:{name:"amp",type:"float",min:0,max:5,default:0,notes:"use after a note on is triggered with velocity to adjust amplitude without re-triggering the note"},A:{name:"bp0",type:"string",default:"100,0.5,150,0.25,200,0",notes:"in commas, like 100,0.5,150,0.25,200,0 -- envelope generator with alternating time(ms) and ratio. last pair triggers on note off"},B:{name:"bp1",type:"string",default:"100,0.5,150,0.25,200,0",notes:"set the second breakpoint generator. see breakpoint 0"},b:{name:"feedback",type:"float",min:0,max:1,default:0,notes:"use for the ALGO synthesis type in FM, or partial synthesis (for bandwidth) or for karplus-strong, or to indicate PCM looping (0 off, >0, on)"},C:{name:"bp2",type:"string",default:"100,0.5,150,0.25,200,0",notes:"3rd breakpoint generator"},d:{name:"duty",type:"float",min:.001,max:.999,default:.5,notes:"duty cycle for pulse wave, default 0.5"},D:{name:"debug",type:"uint",min:2,max:4,default:0,notes:"2 shows queue sample, 3 shows oscillator data, 4 shows modified oscillator. will interrupt audio!"},f:{name:"freq",type:"floats",min:0,max:14e3,default:220,notes:"frequency of oscillator"},F:{name:"filter_freq",type:"float",min:0,max:14e3,default:3e3,notes:"center frequency for biquad filter"},g:{name:"mod_target",type:"mask",min:0,max:64,default:0,notes:"Which parameter modulation/LFO controls. 1=amp, 2=duty, 4=freq, 8=filter freq, 16=resonance, 32=feedback. Can handle any combo, add them together"},G:{name:"filter_type",type:"uint",min:0,max:3,default:0,notes:"0 = none (default.) 1 = low pass, 2 = band pass, 3 = hi pass."},I:{name:"ratio",type:"float",min:0,max:1,default:.5,notes:"for ALGO types, where the base note frequency controls the modulators, or for the ALGO base note and PARTIALS base note, where the ratio controls the speed of the playback"},L:{name:"mod_source",type:"uint",min:0,max:1024,default:0,notes:"Which oscillator is used as an modulation/LFO source for this oscillator. Source oscillator will be silent."},l:{name:"vel",type:"floats",min:0,max:5,default:0,notes:"velocity - >0 to trigger note on, 0 to trigger note off. sets amplitude"},N:{name:"latency_ms",type:"uint",min:0,max:1e3,default:0,notes:"sets latency in ms. default 0"},n:{name:"note",type:"uint",min:1,max:127,default:60,notes:"midi note, sets frequency"},o:{name:"algorithm",type:"uint",min:1,max:32,default:1,notes:"DX7 algorith to use for ALGO type"},O:{name:"algo_source",type:"string",default:"0,1,2,3,4,-1",notes:"which oscillators to use for the algorithm. list of six, use -1 for not used, e.g 0,1,2,-1,-1-1"},p:{name:"patch",type:"uint",min:0,max:1024,default:16,notes:"choose a preloaded PCM sample, partial patch or FM patch number for ALGO waveforms."},P:{name:"phase",type:"floats",min:0,max:0,default:0,notes:"where in the oscillator's cycle to start sampling from (also works on the PCM buffer). default 0"},R:{name:"resonance",type:"float",min:0,max:10,default:0,notes:"q factor of biquad filter. in practice, 0-10.0. default 0.7"},S:{name:"reset",type:"uint",min:0,max:1024,default:0,notes:"resets given oscillator. set to > OSCS to reset all oscillators, gain and EQ"},T:{name:"bp0_target",type:"mask",min:0,max:128,default:0,notes:"Which parameter bp0 controls. 1=amp, 2=duty, 4=freq, 8=filter freq, 16=resonance, 32=feedback (can be added together). Can add 64 for linear ramp, otherwise exponential"},t:{name:"timestamp",type:"uint",min:0,max:1e3,default:0,notes:"ms of expected playback since some fixed start point on your host. you should always give this if you can."},v:{name:"osc",type:"uint",min:0,max:1024,default:0,notes:"which oscillator to control"},V:{name:"volume",type:"float",min:0,max:10,default:1,notes:"volume knob for entire synth, default 1.0"},w:{name:"wave",type:"uint",min:0,max:11,default:0,notes:"waveform: [0=SINE, PULSE, SAW_DOWN, SAW_UP, TRIANGLE, NOISE, KS, PCM, ALGO, PARTIAL, PARTIALS, OFF]. default: 0/SINE"},W:{name:"bp1_target",type:"mask",min:0,max:128,default:0,notes:"see bp0_target"},x:{name:"eq_l",type:"float",min:-15,max:15,default:0,notes:"in dB, fc=800Hz amount, -15 to 15. 0 is off. default 0."},X:{name:"bp2_target",type:"mask",min:0,max:128,default:0,notes:"see bp0_target"},y:{name:"eq_m",type:"float",min:-15,max:15,default:0,notes:"in dB, fc=2500Hz amount, -15 to 15. 0 is off. default 0."},z:{name:"eq_h",type:"float",min:-15,max:15,default:0,notes:"in dB, fc=7500Hz amount, -15 to 15. 0 is off. default 0."}};var U=!1,N=null,V=null,L=null,D=null;const ee=j(!1),te=J,c=K(()=>{const l=[];for(let a in x)l.push(`${a}${x[a]}`);return l.push("A0,0,10,0.2,30,1,100,0.7,30,0.3,0,0"),l.join("")}),ae=["SINE","PULSE","SAW_DOWN","SAW_UP","TRI","NOISE","KS","PCM","ALGO","PARTIAL","PARTIALS"],y=i(60,10,127),h=T([]),x=T({p:i(f("amy-patch",248),0,1024),w:i(f("amy-waveform",7),0,11),V:i(f("amy-volume",1),0,10),d:i(f("amy-duty",.5),.001,.999),o:i(f("amy-algo",1),1,32),b:i(f("amy-feedback",0),0,1)});function oe(){O(()=>B.note,e=>{g(e.number,e.velocity/127)}),O(c,e=>{V(e),h.unshift(e)}),W("a",()=>{g(y.value,1)}),G("a",()=>{g(y.value,0)}),A("ArrowLeft",()=>{x.patch--}),A("ArrowRight",()=>{x.patch++}),A("ArrowUp",e=>{e.preventDefault(),y.value++}),A("ArrowDown",e=>{e.preventDefault(),y.value--}),$(()=>{H(()=>import("./amyJS.DbXKzB8V.js"),[]).then(e=>{const{Module:n}=e;n.onRuntimeInitialized=function(){N=n.cwrap("web_audio_buffer","number",["number","number"]),V=n.cwrap("amy_play_message",null,["string"]),L=n.cwrap("amy_start_web",null,["number"])};var t=null,p=null,s=new Float32Array;D=function(w){if(t==null||t.length==0){s=new Float32Array(w.length);var E=s.length*s.BYTES_PER_ELEMENT;p=n._malloc(E),t=new Uint8Array(n.HEAPU8.buffer,p,E),t.set(new Uint8Array(s.buffer))}N(t.byteOffset,w.length);var M=new Float32Array(t.buffer,t.byteOffset,s.length);for(let v=0;v<w.length;v++)w[v]=M[v]}})});var l=!1,a=null,b=null,u=null;function m(e){var n=window.AudioContext||window.webkitAudioContext||!1;if(!n){console.error("No Audio");return}u=new n({sampleRate:48e3}),b=u.createBufferSource(),a=u.createScriptProcessor(256,0,1),a.onaudioprocess=function(t){e(t.outputBuffer.getChannelData(0))}}function P(){l||(L==null||L(),m(D),a.connect(u.destination),b.start(),l=!0,U=!0)}function g(e,n=0){U||P();let t=`v${e}`;if(n>0){let s=t+c.value;h[0]!=c.value&&(V(s),h.unshift(c.value))}let p=t+`n${e}l${n.toFixed(2)}`;h.unshift(p),V(p)}return{started:ee,codes:te,message:c,waveforms:ae,history:h,note:y,knobs:x}}const ne={class:"p-2 rounded-xl border-1 m-2 select-none flex flex-wrap gap-2"},le={class:"top-16 right-4 p-4 w-80 max-h-80vh overflow-hidden flex flex-col opacity-30 pointer-events-none font-mono text-sm fixed"},se={class:"font-bold border-b-2"},me={__name:"SynthAmy",setup(l){const{knobs:a,waveforms:b,reset:u,message:m,history:P}=oe();return(g,e)=>{const n=z;return r(),C(R,null,[d("div",ne,[_(F,{name:"fade"},{default:q(()=>[_(n,{key:"Wave",min:0,max:11,param:"Wave",modelValue:o(a).w,"onUpdate:modelValue":e[0]||(e[0]=t=>o(a).w=t),fixed:0,unit:o(b)[o(a).w]},null,8,["modelValue","unit"]),o(a).w>6?(r(),k(n,{key:"Patch",min:1,max:1024,param:"Patch",modelValue:o(a).p,"onUpdate:modelValue":e[1]||(e[1]=t=>o(a).p=t),fixed:0},null,8,["modelValue"])):S("",!0),o(a).w==1?(r(),k(n,{key:"Duty",min:.001,max:.999,param:"Duty",step:.01,modelValue:o(a).d,"onUpdate:modelValue":e[2]||(e[2]=t=>o(a).d=t),fixed:2},null,8,["modelValue"])):S("",!0),o(a).w==8?(r(),k(n,{key:"Algo",min:1,max:32,param:"ALGO",modelValue:o(a).o,"onUpdate:modelValue":e[3]||(e[3]=t=>o(a).o=t),fixed:0},null,8,["modelValue"])):S("",!0),o(a).w>5?(r(),k(n,{key:"Feedback",min:0,max:1,param:"Feedback",modelValue:o(a).b,"onUpdate:modelValue":e[4]||(e[4]=t=>o(a).b=t),fixed:1,step:.01},null,8,["modelValue"])):S("",!0),_(n,{key:"volume",min:0,max:10,param:"Volume",modelValue:o(a).V,"onUpdate:modelValue":e[5]||(e[5]=t=>o(a).V=t),fixed:1,step:.01},null,8,["modelValue"]),e[8]||(e[8]=d("div",{class:"flex-auto",key:"flex"},null,-1)),d("button",{class:"text-button",onClick:e[6]||(e[6]=t=>o(u)()),key:"reset"},"RESET")]),_:1})]),Y(d("input",{class:"p-4 flex items-center font-mono","onUpdate:modelValue":e[7]||(e[7]=t=>Q(m)?m.value=t:null)},null,512),[[X,o(m)]]),d("div",le,[d("div",se,I(o(m)),1),_(F,{name:"fade"},{default:q(()=>[(r(!0),C(R,null,Z(o(P),t=>(r(),C("div",{class:"p-0",key:t},I(t),1))),128))]),_:1})])],64)}}};export{me as default};
