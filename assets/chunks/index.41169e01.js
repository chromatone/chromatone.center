import{_ as K}from"./row.5fbcfe17.js";import{_ as Q}from"./code.c8655794.js";import{_ as X}from"./circle.14cf81f9.js";import{_ as Y}from"./keys.9b6a8257.js";import{_ as Z}from"./render.94f55f7f.js";import{_ as L,q as y,J as U,ab as ee,M as te,N as oe,b as i,o as g,c as w,u as s,C as ae,a as d,t as C,F as ne,d as se,p as R,k as J,r as le,f as b,j as A,g as re,A as ie}from"./framework.88e9bc5c.js";import{r as ce}from"./calculations.65ee336d.js";import{g as _,c as O,b as P,e as S,n as ue}from"./colors.60a0cd0b.js";import"./synth.3f37295f.js";import{u as me}from"./index.bdd8aab5.js";import{u as de}from"./index.fb8d2492.js";import{i as pe}from"./state.13f6c2e7.js";import{p as fe}from"./index.140cffd8.js";import"./index.be7eb4a8.js";import{i as V}from"./index.2a263da6.js";import{a as q,b as E,n as he}from"./theory.dec16ed9.js";const ve=t=>(R("data-v-e94aa6de"),t=t(),J(),t),_e=["viewBox"],ge=["transform"],ye=["fill"],we={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},xe=ve(()=>d("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),$e=["stroke","points"],be=["stroke","points"],T=4e3,z=300,j=2e3,ke={__name:"waveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(t){const k=t,c=[];for(let o=0;o<13;o++)c[o]=Math.pow(2,o/12);const x=T/j,r=y(!1),f=y(0),h=y(0),l=y(2e3),a=y(),u=y(1e3),m=me(U("waveform-speed",1e3),0,l);de(o=>{const e=o.delta[0]-o.delta[1];m.value+=e},{domTarget:a});const M=ee(h,{duration:u,transition:[.87,-.04,.69,1.13],onFinished:()=>{h.value==0&&N()}}),{resume:B,pause:N}=te(()=>{f.value+=M.value},{immediate:!1});oe(()=>{r.value?(B(),h.value>0&&(u.value=10),h.value=m.value):(h.value=0,u.value=1e3)});const $=i(()=>{let o=[],e=ce(k.chroma.split(""),-_.tonic);for(let n=0;n<12;n++)e[n]==1?o[n]=!0:delete o[n];return o}),v=U("chord-zoom",400);function D(o,e){return Math.sin((e+f.value)*(Math.PI*2*c[o])/v.value)}const W=i(()=>{let o={};for(let e in $.value){o[e]=[];for(let n=0;n<j;n++)o[e].push(`${n*x},${D(Number(e),n)*100+z/2}`)}return o}),G=i(()=>{let o=[];for(let e=0;e<j;e++){o[e]=0;for(let n in $.value){let p=Number(n);o[e]+=D(p,e)}}return o}),H=i(()=>G.value.map((o,e)=>`${e*x},${o*30+z/2}`).join(" ")),F=i(()=>O(k.chroma,_.tonic));return(o,e)=>{var n;return g(),w("div",{class:"waveform",ref_key:"waveContainer",ref:a},[(g(),w("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${T} ${z}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:e[0]||(e[0]=p=>{s(P)(t.chroma),r.value=!0}),onTouchstart:e[1]||(e[1]=ae(p=>{s(P)(t.chroma),r.value=!0},["prevent","stop"])),onTouchend:e[2]||(e[2]=p=>{s(S)(t.chroma),r.value=!1}),onTouchcancel:e[3]||(e[3]=p=>{s(S)(t.chroma),r.value=!1}),onMouseup:e[4]||(e[4]=p=>{s(S)(t.chroma),r.value=!1}),onMouseleave:e[5]||(e[5]=p=>{s(S)(t.chroma),r.value=!1})},[d("g",{transform:`translate(${s(m)/l.value*T} 10)`},[d("circle",{r:"40",fill:F.value.hsl},null,8,ye),d("text",we,C(s(m)*60)+" px/sec",1)],8,ge),xe,(g(!0),w(ne,null,se($.value,(p,I)=>(g(),w("g",{key:I},[d("polyline",{stroke:s(ue)(I,s(pe)?8:2),points:W.value[I],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,$e)]))),128)),d("polyline",{stroke:(n=F.value)==null?void 0:n.hsl,points:H.value,"stroke-width":"24",fill:"none"},null,8,be)],40,_e))],512)}}},Se=L(ke,[["__scopeId","data-v-e94aa6de"]]);const Ce=t=>(R("data-v-d29801a0"),t=t(),J(),t),Me={class:"flex w-full relative px-4"},Be=["href"],Ne=Ce(()=>d("div",{class:"i-la-wikipedia-w"},null,-1)),Ie=[Ne],Te={class:"text-2xl font-bold capitalize mb-2"},ze={class:"flex items-center mx-2 w-full gap-2"},je={__name:"index",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(t,{emit:k}){const c=t;le({chord:i(()=>q.get(c.chroma)),scale:i(()=>E.get(c.chroma))});const x=i(()=>q.get(c.chroma)),r=i(()=>E.get(c.chroma)),f=i(()=>fe.intervals(c.chroma));i(()=>{let l=[];if(!f.value)return[];for(let a=1;a<f.value.length;a++)l[a-1]=V.semitones(f.value[a])-V.semitones(f.value[a-1]);return l});function h(l){console.log(l,c.chroma,_.tonic);let a=c.chroma;const u=(12-_.tonic+l)%12;if(console.log(u),u==0)return;let m=a.split("");m[u]=m[u]=="0"?"1":"0",k("update:chroma",m.join(""))}return(l,a)=>{const u=Se,m=Z,M=Y,B=X,N=Q,$=K;return g(),w("div",{class:"profile",style:ie({borderColor:s(O)(t.chroma,s(_).tonic).hsl})},[b(u,{chroma:t.chroma},null,8,["chroma"]),d("div",Me,[t.link?(g(),w("a",{key:0,class:"p-2 absolute top-8px right-2em",href:t.link,target:"_blank"},Ie,8,Be)):A("",!0),d("div",Te,C(s(he)[s(_).tonic])+" "+C(x.value.name||x.value.aliases[0]||r.value.name||"?")+" "+C(r.value.aliases[0]?`(${r.value.aliases[0]})`:""),1)]),t.abc?(g(),re(m,{key:0,abc:t.abc},null,8,["abc"])):A("",!0),d("div",ze,[b(M,{style:{flex:"1 1 400px"},chroma:t.chroma,"onUpdate:chroma":a[0]||(a[0]=v=>l.$emit("update:chroma",v)),pitch:s(_).tonic,title:!1,"onUpdate:pitch":h,playAll:!0},null,8,["chroma","pitch"]),b(B,{style:{flex:"1 1 250px"},chroma:t.chroma},null,8,["chroma"]),b(N,{chroma:t.chroma,"onUpdate:chroma":a[1]||(a[1]=v=>l.$emit("update:chroma",v))},null,8,["chroma"])]),b($,{class:"mx-2 mb-2",chroma:t.chroma,"onUpdate:chroma":a[2]||(a[2]=v=>l.$emit("update:chroma",v)),editable:t.editable},null,8,["chroma","editable"])],4)}}},Qe=L(je,[["__scopeId","data-v-d29801a0"]]);export{Qe as _};
