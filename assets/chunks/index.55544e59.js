import{_ as K}from"./row.ba775f52.js";import{_ as Q}from"./code.baadcf4f.js";import{_ as V}from"./circle.f77ef0cf.js";import{_ as Y}from"./keys.c3aef01a.js";import{_ as Z}from"./render.39913f67.js";import{_ as L,P as y,k as ee,r as i,v as g,b as w,N as n,w as te,F as d,X as S,a as oe,H as ae,A as O,c as W,i as se,T as b,B as A,C as ne,f as le}from"./framework.7e747cd7.js";import{r as re}from"./calculations.3384a913.js";import{b as U,m as ie,i as ce}from"./index.c0ca431c.js";import{g as _,e as X,b as D,c as C,n as ue}from"./colors.abbc28c6.js";import"./synth.220fb0dd.js";import{u as me}from"./index.0b97d2b2.js";import{u as de}from"./index.2a79020c.js";import{i as fe}from"./state.181c131c.js";import{p as pe}from"./index.b30cd6d2.js";import"./index.86652af6.js";import{i as H}from"./index.ab22ef51.js";import{a as R,b as q,n as ve}from"./theory.61e5aadb.js";const he=t=>(O("data-v-e94aa6de"),t=t(),W(),t),_e=["viewBox"],ge=["transform"],ye=["fill"],we={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},xe=he(()=>d("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),$e=["stroke","points"],be=["stroke","points"],F=4e3,I=300,P=2e3,ke={__name:"waveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(t){const k=t,c=[];for(let o=0;o<13;o++)c[o]=Math.pow(2,o/12);const x=F/P,r=y(!1),p=y(0),v=y(0),l=y(2e3),a=y(),u=y(1e3),m=me(U("waveform-speed",1e3),0,l);de(o=>{const e=o.delta[0]-o.delta[1];m.value+=e},{domTarget:a});const T=ie(v,{duration:u,transition:[.87,-.04,.69,1.13],onFinished:()=>{v.value==0&&B()}}),{resume:M,pause:B}=ce(()=>{p.value+=T.value},{immediate:!1});ee(()=>{r.value?(M(),v.value>0&&(u.value=10),v.value=m.value):(v.value=0,u.value=1e3)});const $=i(()=>{let o=[],e=re(k.chroma.split(""),-_.tonic);for(let s=0;s<12;s++)e[s]==1?o[s]=!0:delete o[s];return o}),h=U("chord-zoom",400);function j(o,e){return Math.sin((e+p.value)*(Math.PI*2*c[o])/h.value)}const E=i(()=>{let o={};for(let e in $.value){o[e]=[];for(let s=0;s<P;s++)o[e].push(`${s*x},${j(Number(e),s)*100+I/2}`)}return o}),G=i(()=>{let o=[];for(let e=0;e<P;e++){o[e]=0;for(let s in $.value){let f=Number(s);o[e]+=j(f,e)}}return o}),J=i(()=>G.value.map((o,e)=>`${e*x},${o*30+I/2}`).join(" ")),z=i(()=>X(k.chroma,_.tonic));return(o,e)=>{var s;return g(),w("div",{class:"waveform",ref_key:"waveContainer",ref:a},[(g(),w("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${F} ${I}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:e[0]||(e[0]=f=>{n(D)(t.chroma),r.value=!0}),onTouchstart:e[1]||(e[1]=te(f=>{n(D)(t.chroma),r.value=!0},["prevent","stop"])),onTouchend:e[2]||(e[2]=f=>{n(C)(t.chroma),r.value=!1}),onTouchcancel:e[3]||(e[3]=f=>{n(C)(t.chroma),r.value=!1}),onMouseup:e[4]||(e[4]=f=>{n(C)(t.chroma),r.value=!1}),onMouseleave:e[5]||(e[5]=f=>{n(C)(t.chroma),r.value=!1})},[d("g",{transform:`translate(${n(m)/l.value*F} 10)`},[d("circle",{r:"40",fill:z.value.hsl},null,8,ye),d("text",we,S(n(m)*60)+" px/sec",1)],8,ge),xe,(g(!0),w(oe,null,ae($.value,(f,N)=>(g(),w("g",{key:N},[d("polyline",{stroke:n(ue)(N,n(fe)?8:2),points:E.value[N],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,$e)]))),128)),d("polyline",{stroke:(s=z.value)==null?void 0:s.hsl,points:J.value,"stroke-width":"24",fill:"none"},null,8,be)],40,_e))],512)}}},Ce=L(ke,[["__scopeId","data-v-e94aa6de"]]);const Se=t=>(O("data-v-d29801a0"),t=t(),W(),t),Te={class:"flex w-full relative px-4"},Me=["href"],Be=Se(()=>d("div",{class:"i-la-wikipedia-w"},null,-1)),Ne=[Be],Fe={class:"text-2xl font-bold capitalize mb-2"},Ie={class:"flex items-center mx-2 w-full gap-2"},Pe={__name:"index",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(t,{emit:k}){const c=t;se({chord:i(()=>R.get(c.chroma)),scale:i(()=>q.get(c.chroma))});const x=i(()=>R.get(c.chroma)),r=i(()=>q.get(c.chroma)),p=i(()=>pe.intervals(c.chroma));i(()=>{let l=[];if(!p.value)return[];for(let a=1;a<p.value.length;a++)l[a-1]=H.semitones(p.value[a])-H.semitones(p.value[a-1]);return l});function v(l){console.log(l,c.chroma,_.tonic);let a=c.chroma;const u=(12-_.tonic+l)%12;if(console.log(u),u==0)return;let m=a.split("");m[u]=m[u]=="0"?"1":"0",k("update:chroma",m.join(""))}return(l,a)=>{const u=Ce,m=Z,T=Y,M=V,B=Q,$=K;return g(),w("div",{class:"profile",style:le({borderColor:n(X)(t.chroma,n(_).tonic).hsl})},[b(u,{chroma:t.chroma},null,8,["chroma"]),d("div",Te,[t.link?(g(),w("a",{key:0,class:"p-2 absolute top-8px right-2em",href:t.link,target:"_blank"},Ne,8,Me)):A("",!0),d("div",Fe,S(n(ve)[n(_).tonic])+" "+S(x.value.name||x.value.aliases[0]||r.value.name||"?")+" "+S(r.value.aliases[0]?`(${r.value.aliases[0]})`:""),1)]),t.abc?(g(),ne(m,{key:0,abc:t.abc},null,8,["abc"])):A("",!0),d("div",Ie,[b(T,{style:{flex:"1 1 400px"},chroma:t.chroma,"onUpdate:chroma":a[0]||(a[0]=h=>l.$emit("update:chroma",h)),pitch:n(_).tonic,title:!1,"onUpdate:pitch":v,playAll:!0},null,8,["chroma","pitch"]),b(M,{style:{flex:"1 1 250px"},chroma:t.chroma},null,8,["chroma"]),b(B,{chroma:t.chroma,"onUpdate:chroma":a[1]||(a[1]=h=>l.$emit("update:chroma",h))},null,8,["chroma"])]),b($,{class:"mx-2 mb-2",chroma:t.chroma,"onUpdate:chroma":a[2]||(a[2]=h=>l.$emit("update:chroma",h)),editable:t.editable},null,8,["chroma","editable"])],4)}}},Ve=L(Pe,[["__scopeId","data-v-d29801a0"]]);export{Ve as _};
