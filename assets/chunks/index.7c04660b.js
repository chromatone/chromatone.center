import{_ as K}from"./row.d8db91e8.js";import{_ as Q}from"./code.753c1e70.js";import{_ as X}from"./circle.dc40812c.js";import{_ as Y}from"./keys.5222c55e.js";import{_ as Z}from"./render.69e5590b.js";import{_ as L,k as y,G as ee,i,o as g,c as w,u as s,q as te,a as d,t as C,F as oe,r as ae,p as R,h as G,A as ne,f as b,g as j,e as se,m as le}from"./framework.aa37bc02.js";import{r as re}from"./calculations.65ee336d.js";import{b as A,m as ie,i as ce}from"./index.9f2d097c.js";import{g as _,c as O,b as P,e as S,n as me}from"./colors.0dc03560.js";import"./synth.99a34600.js";import{u as ue}from"./index.0eeb4803.js";import{u as de}from"./index.1cdf7ac0.js";import{i as pe}from"./state.b2795d34.js";import{p as fe}from"./index.b30cd6d2.js";import"./index.86652af6.js";import{i as V}from"./index.ab22ef51.js";import{a as q,b as E,n as he}from"./theory.61e5aadb.js";const ve=t=>(R("data-v-e94aa6de"),t=t(),G(),t),_e=["viewBox"],ge=["transform"],ye=["fill"],we={class:"select-none",opacity:"0.7","font-size":"80",y:"25",x:"50",fill:"currentColor"},$e=ve(()=>d("line",{x1:"0",x2:"1200",y1:"400",y2:"400",stroke:"gray","stroke-width":"1"},null,-1)),xe=["stroke","points"],be=["stroke","points"],T=4e3,z=300,D=2e3,ke={__name:"waveform",props:{chroma:{type:String,default:"100010001000"},mix:{type:Boolean,default:!1}},setup(t){const k=t,c=[];for(let o=0;o<13;o++)c[o]=Math.pow(2,o/12);const $=T/D,r=y(!1),f=y(0),h=y(0),l=y(2e3),a=y(),m=y(1e3),u=ue(A("waveform-speed",1e3),0,l);de(o=>{const e=o.delta[0]-o.delta[1];u.value+=e},{domTarget:a});const B=ie(h,{duration:m,transition:[.87,-.04,.69,1.13],onFinished:()=>{h.value==0&&I()}}),{resume:M,pause:I}=ce(()=>{f.value+=B.value},{immediate:!1});ee(()=>{r.value?(M(),h.value>0&&(m.value=10),h.value=u.value):(h.value=0,m.value=1e3)});const x=i(()=>{let o=[],e=re(k.chroma.split(""),-_.tonic);for(let n=0;n<12;n++)e[n]==1?o[n]=!0:delete o[n];return o}),v=A("chord-zoom",400);function F(o,e){return Math.sin((e+f.value)*(Math.PI*2*c[o])/v.value)}const W=i(()=>{let o={};for(let e in x.value){o[e]=[];for(let n=0;n<D;n++)o[e].push(`${n*$},${F(Number(e),n)*100+z/2}`)}return o}),H=i(()=>{let o=[];for(let e=0;e<D;e++){o[e]=0;for(let n in x.value){let p=Number(n);o[e]+=F(p,e)}}return o}),J=i(()=>H.value.map((o,e)=>`${e*$},${o*30+z/2}`).join(" ")),U=i(()=>O(k.chroma,_.tonic));return(o,e)=>{var n;return g(),w("div",{class:"waveform",ref_key:"waveContainer",ref:a},[(g(),w("svg",{class:"min-h-4em w-full cursor-pointer",version:"1.1",baseProfile:"full",viewBox:`0 0 ${T} ${z}`,xmlns:"http://www.w3.org/2000/svg",onMousedown:e[0]||(e[0]=p=>{s(P)(t.chroma),r.value=!0}),onTouchstart:e[1]||(e[1]=te(p=>{s(P)(t.chroma),r.value=!0},["prevent","stop"])),onTouchend:e[2]||(e[2]=p=>{s(S)(t.chroma),r.value=!1}),onTouchcancel:e[3]||(e[3]=p=>{s(S)(t.chroma),r.value=!1}),onMouseup:e[4]||(e[4]=p=>{s(S)(t.chroma),r.value=!1}),onMouseleave:e[5]||(e[5]=p=>{s(S)(t.chroma),r.value=!1})},[d("g",{transform:`translate(${s(u)/l.value*T} 10)`},[d("circle",{r:"40",fill:U.value.hsl},null,8,ye),d("text",we,C(s(u)*60)+" px/sec",1)],8,ge),$e,(g(!0),w(oe,null,ae(x.value,(p,N)=>(g(),w("g",{key:N},[d("polyline",{stroke:s(me)(N,s(pe)?8:2),points:W.value[N],"stroke-width":"4",fill:"none",opacity:"0.9"},null,8,xe)]))),128)),d("polyline",{stroke:(n=U.value)==null?void 0:n.hsl,points:J.value,"stroke-width":"24",fill:"none"},null,8,be)],40,_e))],512)}}},Se=L(ke,[["__scopeId","data-v-e94aa6de"]]);const Ce=t=>(R("data-v-d29801a0"),t=t(),G(),t),Be={class:"flex w-full relative px-4"},Me=["href"],Ie=Ce(()=>d("div",{class:"i-la-wikipedia-w"},null,-1)),Ne=[Ie],Te={class:"text-2xl font-bold capitalize mb-2"},ze={class:"flex items-center mx-2 w-full gap-2"},De={__name:"index",props:{title:{type:String,default:null},chroma:{type:String,default:"1001000100000"},abc:{type:String,default:null},link:{type:String,default:null},description:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(t,{emit:k}){const c=t;ne({chord:i(()=>q.get(c.chroma)),scale:i(()=>E.get(c.chroma))});const $=i(()=>q.get(c.chroma)),r=i(()=>E.get(c.chroma)),f=i(()=>fe.intervals(c.chroma));i(()=>{let l=[];if(!f.value)return[];for(let a=1;a<f.value.length;a++)l[a-1]=V.semitones(f.value[a])-V.semitones(f.value[a-1]);return l});function h(l){console.log(l,c.chroma,_.tonic);let a=c.chroma;const m=(12-_.tonic+l)%12;if(console.log(m),m==0)return;let u=a.split("");u[m]=u[m]=="0"?"1":"0",k("update:chroma",u.join(""))}return(l,a)=>{const m=Se,u=Z,B=Y,M=X,I=Q,x=K;return g(),w("div",{class:"profile",style:le({borderColor:s(O)(t.chroma,s(_).tonic).hsl})},[b(m,{chroma:t.chroma},null,8,["chroma"]),d("div",Be,[t.link?(g(),w("a",{key:0,class:"p-2 absolute top-8px right-2em",href:t.link,target:"_blank"},Ne,8,Me)):j("",!0),d("div",Te,C(s(he)[s(_).tonic])+" "+C($.value.name||$.value.aliases[0]||r.value.name||"?")+" "+C(r.value.aliases[0]?`(${r.value.aliases[0]})`:""),1)]),t.abc?(g(),se(u,{key:0,abc:t.abc},null,8,["abc"])):j("",!0),d("div",ze,[b(B,{style:{flex:"1 1 400px"},chroma:t.chroma,"onUpdate:chroma":a[0]||(a[0]=v=>l.$emit("update:chroma",v)),pitch:s(_).tonic,title:!1,"onUpdate:pitch":h,playAll:!0},null,8,["chroma","pitch"]),b(M,{style:{flex:"1 1 250px"},chroma:t.chroma},null,8,["chroma"]),b(I,{chroma:t.chroma,"onUpdate:chroma":a[1]||(a[1]=v=>l.$emit("update:chroma",v))},null,8,["chroma"])]),b(x,{class:"mx-2 mb-2",chroma:t.chroma,"onUpdate:chroma":a[2]||(a[2]=v=>l.$emit("update:chroma",v)),editable:t.editable},null,8,["chroma","editable"])],4)}}},Xe=L(De,[["__scopeId","data-v-d29801a0"]]);export{Xe as _};
