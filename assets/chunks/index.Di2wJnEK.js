import{B as st}from"./theme.BH05JkjQ.js";function ht(s,p){for(var E=0;E<p.length;E++){const v=p[E];if(typeof v!="string"&&!Array.isArray(v)){for(const l in v)if(l!=="default"&&!(l in s)){const g=Object.getOwnPropertyDescriptor(v,l);g&&Object.defineProperty(s,l,g.get?g:{enumerable:!0,get:()=>v[l]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}var _,q;function ut(){if(q)return _;q=1;var s={VERSION:"3.1.1",HEADER_CHUNK_TYPE:[77,84,104,100],HEADER_CHUNK_LENGTH:[0,0,0,6],HEADER_CHUNK_FORMAT0:[0,0],HEADER_CHUNK_FORMAT1:[0,1],HEADER_CHUNK_DIVISION:[0,128],TRACK_CHUNK_TYPE:[77,84,114,107],META_EVENT_ID:255,META_SMTPE_OFFSET:84},p=(e,t)=>Array(Math.abs(t)+1).join(e);function E(e){return e!==null&&typeof e=="object"&&typeof e.name=="string"}function v(e){return e!==null&&typeof e=="object"&&typeof e.step=="number"&&typeof e.alt=="number"}var l=[0,2,4,-1,1,3,5],g=l.map(e=>Math.floor(e*7/12));function G(e){const{step:t,alt:n,oct:i,dir:r=1}=e,c=l[t]+7*n;if(i===void 0)return[r*c];const o=i-g[t]-4*n;return[r*c,r*o]}var A={empty:!0,name:"",pc:"",acc:""},V=new Map,z=e=>"CDEFGAB".charAt(e),Y=e=>e<0?p("b",-e):p("#",e),J=e=>e[0]==="b"?-e.length:e.length;function x(e){const t=JSON.stringify(e),n=V.get(t);if(n)return n;const i=typeof e=="string"?Q(e):v(e)?x(tt(e)):E(e)?x(e.name):A;return V.set(t,i),i}var X=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Z(e){const t=X.exec(e);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}var $=(e,t)=>(e%t+t)%t,k=[0,2,4,5,7,9,11];function Q(e){const t=Z(e);if(t[0]===""||t[3]!=="")return A;const n=t[0],i=t[1],r=t[2],c=(n.charCodeAt(0)+3)%7,o=J(i),h=r.length?+r:void 0,u=G({step:c,alt:o,oct:h}),T=n+i+r,w=n+i,b=(k[c]+o+120)%12,d=h===void 0?$(k[c]+o,12)-12*99:k[c]+o+12*(h+1),D=d>=0&&d<=127?d:null,ct=h===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:i,alt:o,chroma:b,coord:u,freq:ct,height:d,letter:n,midi:D,name:T,oct:h,pc:w,step:c}}function tt(e){const{step:t,alt:n,oct:i}=e,r=z(t);if(!r)return"";const c=r+Y(n);return i||i===0?c+i:c}function et(e){return+e>=0&&+e<=127}function B(e){if(et(e))return+e;const t=x(e);return t.empty?null:t.midi}var a=function(){function e(){}return e.version=function(){return s.VERSION},e.stringToBytes=function(t){return t.split("").map(function(n){return n.charCodeAt(0)})},e.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},e.getPitch=function(t,n){return n===void 0&&(n="C4"),60-B(n)+B(t)},e.numberToVariableLength=function(t){t=Math.round(t);for(var n=t&127;t=t>>7;)n<<=8,n|=t&127|128;for(var i=[];i.push(n&255),n&128;)n>>=8;return i},e.stringByteCount=function(t){return encodeURI(t).split(/%..|./).length-1},e.numberFromBytes=function(t){var n="",i;return t.forEach(function(r){i=r.toString(16),i.length==1&&(i="0"+i),n+=i}),parseInt(n,16)},e.numberToBytes=function(t,n){n=n||1;var i=t.toString(16);i.length&1&&(i="0"+i);var r=i.match(/.{2}/g),c=r.map(function(o){return parseInt(o,16)});if(c.length<n)for(;n-c.length>0;)c.unshift(0);return c},e.toArray=function(t){return Array.isArray(t)?t:[t]},e.convertVelocity=function(t){return t=t>100?100:t,Math.round(t/100*127)},e.getTickDuration=function(t){if(Array.isArray(t))return t.map(function(c){return e.getTickDuration(c)}).reduce(function(c,o){return c+o},0);if(t=t.toString(),t.toLowerCase().charAt(0)==="t"){var n=parseInt(t.substring(1));if(isNaN(n)||n<0)throw new Error(t+" is not a valid duration.");return n}var i=e.numberFromBytes(s.HEADER_CHUNK_DIVISION),r=i*e.getDurationMultiplier(t);return e.getRoundedIfClose(r)},e.getRoundedIfClose=function(t){var n=Math.round(t);return Math.abs(n-t)<1e-6?n:t},e.getPrecisionLoss=function(t){var n=Math.round(t);return n-t},e.getDurationMultiplier=function(t){if(t==="0")return 0;var n=t.match(/^(?<dotted>d+)?(?<base>\d+)(?:t(?<tuplet>\d*))?/);if(n){var i=Number(n.groups.base),r=i===1||(i&i-1)===0;if(r){var c=i/4,o=1/c,h=n.groups,u=h.dotted,T=h.tuplet;if(u){var w=u.length,b=Math.pow(2,w);o=o+o*((b-1)/b)}if(typeof T=="string"){var d=o*2,D=Number(T||"3");o=d/D}return o}}throw new Error(t+" is not a valid duration.")},e}(),M=function(){function e(t){this.channel=t.channel-1||0,this.controllerValue=t.controllerValue,this.controllerNumber=t.controllerNumber,this.delta=t.delta||0,this.name="ControllerChangeEvent",this.status=176,this.data=a.numberToVariableLength(t.delta).concat(this.status|this.channel,this.controllerNumber,this.controllerValue)}return e}(),P=function(){function e(t){this.delta=t.delta||0,this.name="CopyrightEvent",this.text=t.text,this.type=2;var n=a.stringToBytes(this.text);this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type,a.numberToVariableLength(n.length),n)}return e}(),I=function(){function e(t){this.delta=t.delta||0,this.name="CuePointEvent",this.text=t.text,this.type=7;var n=a.stringToBytes(this.text);this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type,a.numberToVariableLength(n.length),n)}return e}(),C=function(){function e(t){this.delta=(t==null?void 0:t.delta)||0,this.name="EndTrackEvent",this.type=[47,0],this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type)}return e}(),L=function(){function e(t){this.delta=t.delta||0,this.name="InstrumentNameEvent",this.text=t.text,this.type=4;var n=a.stringToBytes(this.text);this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type,a.numberToVariableLength(n.length),n)}return e}(),S=function(){function e(t,n){this.name="KeySignatureEvent",this.type=89;var i=n||0;if(t=t||0,typeof n>"u"){var r=[["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"],["ab","eb","bb","f","c","g","d","a","e","b","f#","c#","g#","d#","a#"]],c=t.length,o=t||"C";if(t[0]===t[0].toLowerCase()&&(i=1),c>1)switch(t.charAt(c-1)){case"m":i=1,o=t.charAt(0).toLowerCase(),o=o.concat(t.substring(1,c-1));break;case"-":i=1,o=t.charAt(0).toLowerCase(),o=o.concat(t.substring(1,c-1));break;case"M":i=0,o=t.charAt(0).toUpperCase(),o=o.concat(t.substring(1,c-1));break;case"+":i=0,o=t.charAt(0).toUpperCase(),o=o.concat(t.substring(1,c-1));break}var h=r[i].indexOf(o);t=h===-1?0:h-7}this.data=a.numberToVariableLength(0).concat(s.META_EVENT_ID,this.type,[2],a.numberToBytes(t,1),a.numberToBytes(i,1))}return e}(),O=function(){function e(t){this.delta=t.delta||0,this.name="LyricEvent",this.text=t.text,this.type=5;var n=a.stringToBytes(this.text);this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type,a.numberToVariableLength(n.length),n)}return e}(),R=function(){function e(t){this.delta=t.delta||0,this.name="MarkerEvent",this.text=t.text,this.type=6;var n=a.stringToBytes(this.text);this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type,a.numberToVariableLength(n.length),n)}return e}(),f=function(){function e(t){this.name="NoteOnEvent",this.channel=t.channel||1,this.pitch=t.pitch,this.wait=t.wait||0,this.velocity=t.velocity||50,this.tick=t.tick||null,this.delta=null,this.data=t.data,this.status=144}return e.prototype.buildData=function(t,n,i){return i===void 0&&(i={}),this.data=[],this.tick?(this.tick=a.getRoundedIfClose(this.tick),t.tickPointer==0&&(this.delta=this.tick)):(this.delta=a.getTickDuration(this.wait),this.tick=a.getRoundedIfClose(t.tickPointer+this.delta)),this.deltaWithPrecisionCorrection=a.getRoundedIfClose(this.delta-n),this.data=a.numberToVariableLength(this.deltaWithPrecisionCorrection).concat(this.status|this.channel-1,a.getPitch(this.pitch,i.middleC),a.convertVelocity(this.velocity)),this},e}(),y=function(){function e(t){this.name="NoteOffEvent",this.channel=t.channel||1,this.pitch=t.pitch,this.velocity=t.velocity||50,this.tick=t.tick||null,this.data=t.data,this.delta=t.delta||a.getTickDuration(t.duration),this.status=128}return e.prototype.buildData=function(t,n,i){return i===void 0&&(i={}),this.tick===null&&(this.tick=a.getRoundedIfClose(this.delta+t.tickPointer)),this.deltaWithPrecisionCorrection=a.getRoundedIfClose(this.delta-n),this.data=a.numberToVariableLength(this.deltaWithPrecisionCorrection).concat(this.status|this.channel-1,a.getPitch(this.pitch,i.middleC),a.convertVelocity(this.velocity)),this},e}(),m=function(){function e(t){this.data=[],this.name="NoteEvent",this.pitch=a.toArray(t.pitch),this.channel=t.channel||1,this.duration=t.duration||"4",this.grace=t.grace,this.repeat=t.repeat||1,this.sequential=t.sequential||!1,this.tick=t.startTick||t.tick||null,this.velocity=t.velocity||50,this.wait=t.wait||0,this.tickDuration=a.getTickDuration(this.duration),this.restDuration=a.getTickDuration(this.wait),this.events=[]}return e.prototype.buildData=function(){var t=this;if(this.data=[],this.grace){var n=1;this.grace=a.toArray(this.grace),this.grace.forEach(function(){var r=new e({pitch:t.grace,duration:"T"+n});t.data=t.data.concat(r.data)})}if(this.sequential)for(var i=0;i<this.repeat;i++)this.pitch.forEach(function(c,o){var h=new f({channel:t.channel,wait:o>0?0:t.wait,delta:o>0?0:a.getTickDuration(t.wait),velocity:t.velocity,pitch:c,tick:t.tick}),u=new y({channel:t.channel,duration:t.duration,velocity:t.velocity,pitch:c});t.events.push(h,u)});else for(var i=0;i<this.repeat;i++)this.pitch.forEach(function(r,c){var o;c==0?o=new f({channel:t.channel,wait:t.wait,delta:a.getTickDuration(t.wait),velocity:t.velocity,pitch:r,tick:t.tick}):o=new f({channel:t.channel,wait:0,delta:0,velocity:t.velocity,pitch:r,tick:t.tick}),t.events.push(o)}),this.pitch.forEach(function(r,c){var o;c==0?o=new y({channel:t.channel,duration:t.duration,velocity:t.velocity,pitch:r,tick:t.tick!==null?a.getTickDuration(t.duration)+t.tick:null}):o=new y({channel:t.channel,duration:0,velocity:t.velocity,pitch:r,tick:t.tick!==null?a.getTickDuration(t.duration)+t.tick:null}),t.events.push(o)});return this},e}(),F=function(){function e(t){this.channel=t.channel||0,this.delta=t.delta||0,this.name="PitchBendEvent",this.status=224;var n=this.scale14bits(t.bend),i=n&127,r=n>>7&127;this.data=a.numberToVariableLength(this.delta).concat(this.status|this.channel,i,r)}return e.prototype.scale14bits=function(t){return t<=0?Math.floor(16384*(t+1)/2):Math.floor(16383*(t+1)/2)},e}(),nt=function(){function e(t){this.channel=t.channel||0,this.delta=t.delta||0,this.instrument=t.instrument,this.status=192,this.name="ProgramChangeEvent",this.data=a.numberToVariableLength(this.delta).concat(this.status|this.channel,this.instrument)}return e}(),N=function(){function e(t){this.bpm=t.bpm,this.delta=t.delta||0,this.tick=t.tick,this.name="TempoEvent",this.type=81;var n=Math.round(6e7/this.bpm);this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type,[3],a.numberToBytes(n,3))}return e}(),H=function(){function e(t){this.delta=t.delta||0,this.text=t.text,this.name="TextEvent",this.type=1;var n=a.stringToBytes(this.text);this.data=a.numberToVariableLength(t.delta).concat(s.META_EVENT_ID,this.type,a.numberToVariableLength(n.length),n)}return e}(),U=function(){function e(t,n,i,r){this.name="TimeSignatureEvent",this.type=88,this.data=a.numberToVariableLength(0).concat(s.META_EVENT_ID,this.type,[4],a.numberToBytes(t,1),a.numberToBytes(Math.log2(n),1),a.numberToBytes(i||24,1),a.numberToBytes(r||8,1))}return e}(),K=function(){function e(t){this.delta=t.delta||0,this.name="TrackNameEvent",this.text=t.text,this.type=3;var n=a.stringToBytes(this.text);this.data=a.numberToVariableLength(this.delta).concat(s.META_EVENT_ID,this.type,a.numberToVariableLength(n.length),n)}return e}(),j=function(){function e(){this.type=s.TRACK_CHUNK_TYPE,this.data=[],this.size=[],this.events=[],this.explicitTickEvents=[],this.tickPointer=0}return e.prototype.addEvent=function(t,n){var i=this;return a.toArray(t).forEach(function(r,c){if(r instanceof m){if(typeof n=="function"){var o=n(c,r);typeof o=="object"&&Object.assign(r,o)}r.tick!==null?i.explicitTickEvents.push(r):r.buildData().events.forEach(function(h){return i.events.push(h)})}else i.events.push(r)}),this},e.prototype.buildData=function(t){var n=this;t===void 0&&(t={}),this.data=[],this.size=[],this.tickPointer=0;var i=0;return this.events.forEach(function(r){if(r instanceof f||r instanceof y){var c=r.buildData(n,i,t);i=a.getPrecisionLoss(r.deltaWithPrecisionCorrection||0),n.data=n.data.concat(c.data),n.tickPointer=a.getRoundedIfClose(r.tick)}else r instanceof N&&(n.tickPointer=a.getRoundedIfClose(r.tick)),n.data=n.data.concat(r.data)}),this.mergeExplicitTickEvents(),(!this.events.length||!(this.events[this.events.length-1]instanceof C))&&(this.data=this.data.concat(new C().data)),this.size=a.numberToBytes(this.data.length,4),this},e.prototype.mergeExplicitTickEvents=function(){var t=this;this.explicitTickEvents.length&&(this.explicitTickEvents.sort(function(n,i){return n.tick-i.tick}),this.explicitTickEvents.forEach(function(n){n.buildData().events.forEach(function(i){return i.buildData(t)}),n.events.forEach(function(i){return t.mergeSingleEvent(i)})}),this.explicitTickEvents=[],this.buildData())},e.prototype.mergeTrack=function(t){var n=this;return this.buildData(),t.buildData().events.forEach(function(i){return n.mergeSingleEvent(i)}),this},e.prototype.mergeSingleEvent=function(t){if(!this.events.length){this.addEvent(t);return}for(var n,i=0;i<this.events.length&&!(this.events[i].tick>t.tick);i++)n=i;var r=n+1;t.delta=t.tick-this.events[n].tick,this.events.splice(r,0,t);for(var i=r+1;i<this.events.length;i++)this.events[i].delta=this.events[i].tick-this.events[i-1].tick},e.prototype.removeEventsByName=function(t){var n=this;return this.events.forEach(function(i,r){i.name===t&&n.events.splice(r,1)}),this},e.prototype.setTempo=function(t,n){return n===void 0&&(n=0),this.addEvent(new N({bpm:t,tick:n}))},e.prototype.setTimeSignature=function(t,n,i,r){return this.addEvent(new U(t,n,i,r))},e.prototype.setKeySignature=function(t,n){return this.addEvent(new S(t,n))},e.prototype.addText=function(t){return this.addEvent(new H({text:t}))},e.prototype.addCopyright=function(t){return this.addEvent(new P({text:t}))},e.prototype.addTrackName=function(t){return this.addEvent(new K({text:t}))},e.prototype.addInstrumentName=function(t){return this.addEvent(new L({text:t}))},e.prototype.addMarker=function(t){return this.addEvent(new R({text:t}))},e.prototype.addCuePoint=function(t){return this.addEvent(new I({text:t}))},e.prototype.addLyric=function(t){return this.addEvent(new O({text:t}))},e.prototype.polyModeOn=function(){var t=new f({data:[0,176,126,0]});return this.addEvent(t)},e.prototype.setPitchBend=function(t){return this.addEvent(new F({bend:t}))},e.prototype.controllerChange=function(t,n,i,r){return this.addEvent(new M({controllerNumber:t,controllerValue:n,channel:i,delta:r}))},e}(),it=function(){function e(){}return e.prototype.trackFromVoice=function(t,n){var i=this;n===void 0&&(n={addRenderedAccidentals:!1});var r=new j,c=[];return t.tickables.forEach(function(o){o.noteType==="n"?(r.addEvent(new m({pitch:o.keys.map(function(h,u){return i.convertPitch(h,u,o,n.addRenderedAccidentals)}),duration:i.convertDuration(o),wait:c})),c=[]):o.noteType==="r"&&c.push(i.convertDuration(o))}),c.length>0&&r.addEvent(new m({pitch:"[c4]",duration:"0",wait:c,velocity:"0"})),r},e.prototype.convertPitch=function(t,n,i,r){var c;r===void 0&&(r=!1);var o=t.split("/"),h=o[0].substring(1).replace("n","");return r&&((c=i.getAccidentals())===null||c===void 0||c.forEach(function(u){u.index===n&&(u.type==="n"?h="":h+=u.type)})),o[0][0]+h+o[1]},e.prototype.convertDuration=function(t){return"d".repeat(t.dots)+this.convertBaseDuration(t.duration)+(t.tuplet?"t"+t.tuplet.num_notes:"")},e.prototype.convertBaseDuration=function(t){switch(t){case"w":return"1";case"h":return"2";case"q":return"4";default:return t}},e}(),rt=function(){function e(t){this.type=s.HEADER_CHUNK_TYPE;var n=t>1?s.HEADER_CHUNK_FORMAT1:s.HEADER_CHUNK_FORMAT0;this.data=n.concat(a.numberToBytes(t,2),s.HEADER_CHUNK_DIVISION),this.size=[0,0,0,this.data.length]}return e}(),at=function(){function e(t,n){n===void 0&&(n={}),this.tracks=a.toArray(t),this.options=n}return e.prototype.buildData=function(){var t=this,n=[];return n.push(new rt(this.tracks.length)),this.tracks.forEach(function(i){n.push(i.buildData(t.options))}),n},e.prototype.buildFile=function(){var t=[];return this.buildData().forEach(function(n){return t=t.concat(n.type,n.size,n.data)}),new Uint8Array(t)},e.prototype.base64=function(){if(typeof btoa=="function"){for(var t="",n=this.buildFile(),i=n.byteLength,r=0;r<i;r++)t+=String.fromCharCode(n[r]);return btoa(t)}return Buffer.from(this.buildFile()).toString("base64")},e.prototype.dataUri=function(){return"data:audio/midi;base64,"+this.base64()},e.prototype.setOption=function(t,n){return this.options[t]=n,this},e.prototype.stdout=function(){return process.stdout.write(Buffer.from(this.buildFile()))},e}(),ot={Constants:s,ControllerChangeEvent:M,CopyrightEvent:P,CuePointEvent:I,EndTrackEvent:C,InstrumentNameEvent:L,KeySignatureEvent:S,LyricEvent:O,MarkerEvent:R,NoteOnEvent:f,NoteOffEvent:y,NoteEvent:m,PitchBendEvent:F,ProgramChangeEvent:nt,TempoEvent:N,TextEvent:H,TimeSignatureEvent:U,Track:j,TrackNameEvent:K,Utils:a,VexFlow:it,Writer:at};return _=ot,_}var W=ut();const lt=st(W),dt=ht({__proto__:null,default:lt},[W]);export{dt as i};
