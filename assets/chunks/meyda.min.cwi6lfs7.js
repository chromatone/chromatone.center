import{a0 as Z,$ as tt}from"./theme.BwFCI582.js";function et(C,k){for(var M=0;M<k.length;M++){const S=k[M];if(typeof S!="string"&&!Array.isArray(S)){for(const w in S)if(w!=="default"&&!(w in C)){const A=Object.getOwnPropertyDescriptor(S,w);A&&Object.defineProperty(C,w,A.get?A:{enumerable:!0,get:()=>S[w]})}}}return Object.freeze(Object.defineProperty(C,Symbol.toStringTag,{value:"Module"}))}var U={exports:{}};(function(C,k){(function(M,S){C.exports=S()})(tt,function(){function M(e,t,a){if(a||arguments.length===2)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}var S=Object.freeze({__proto__:null,blackman:function(e){for(var t=new Float32Array(e),a=2*Math.PI/(e-1),r=2*a,n=0;n<e/2;n++)t[n]=.42-.5*Math.cos(n*a)+.08*Math.cos(n*r);for(n=Math.ceil(e/2);n>0;n--)t[e-n]=t[n-1];return t},hamming:function(e){for(var t=new Float32Array(e),a=0;a<e;a++)t[a]=.54-.46*Math.cos(2*Math.PI*(a/e-1));return t},hanning:function(e){for(var t=new Float32Array(e),a=0;a<e;a++)t[a]=.5-.5*Math.cos(2*Math.PI*a/(e-1));return t},sine:function(e){for(var t=Math.PI/(e-1),a=new Float32Array(e),r=0;r<e;r++)a[r]=Math.sin(t*r);return a}}),w={};function A(e){for(;e%2==0&&e>1;)e/=2;return e===1}function I(e,t){if(t!=="rect"){if(t!==""&&t||(t="hanning"),w[t]||(w[t]={}),!w[t][e.length])try{w[t][e.length]=S[t](e.length)}catch{throw new Error("Invalid windowing function")}e=function(a,r){for(var n=[],o=0;o<Math.min(a.length,r.length);o++)n[o]=a[o]*r[o];return n}(e,w[t][e.length])}return e}function R(e,t,a){for(var r=new Float32Array(e),n=0;n<r.length;n++)r[n]=n*t/a,r[n]=13*Math.atan(r[n]/1315.8)+3.5*Math.atan(Math.pow(r[n]/7518,2));return r}function D(e){return Float32Array.from(e)}function P(e){return 1125*Math.log(1+e/700)}function q(e,t,a){for(var r,n=new Float32Array(e+2),o=new Float32Array(e+2),f=t/2,s=P(0),u=(P(f)-s)/(e+1),i=new Array(e+2),l=0;l<n.length;l++)n[l]=l*u,o[l]=(r=n[l],700*(Math.exp(r/1125)-1)),i[l]=Math.floor((a+1)*o[l]/t);for(var h=new Array(e),c=0;c<h.length;c++){for(h[c]=new Array(a/2+1).fill(0),l=i[c];l<i[c+1];l++)h[c][l]=(l-i[c])/(i[c+1]-i[c]);for(l=i[c+1];l<i[c+2];l++)h[c][l]=(i[c+2]-l)/(i[c+2]-i[c+1])}return h}function H(e,t,a,r,n,o,f){r===void 0&&(r=5),n===void 0&&(n=2),o===void 0&&(o=!0),f===void 0&&(f=440);var s=Math.floor(a/2)+1,u=new Array(a).fill(0).map(function(m,p){return e*function(g,b){return Math.log2(16*g/b)}(t*p/a,f)});u[0]=u[1]-1.5*e;var i,l,h,c=u.slice(1).map(function(m,p){return Math.max(m-u[p])},1).concat([1]),y=Math.round(e/2),v=new Array(e).fill(0).map(function(m,p){return u.map(function(g){return(10*e+y+g-p)%e-y})}),d=v.map(function(m,p){return m.map(function(g,b){return Math.exp(-.5*Math.pow(2*v[p][b]/c[b],2))})});if(l=(i=d)[0].map(function(){return 0}),h=i.reduce(function(m,p){return p.forEach(function(g,b){m[b]+=Math.pow(g,2)}),m},l).map(Math.sqrt),d=i.map(function(m,p){return m.map(function(g,b){return g/(h[b]||1)})}),n){var O=u.map(function(m){return Math.exp(-.5*Math.pow((m/e-r)/n,2))});d=d.map(function(m){return m.map(function(p,g){return p*O[g]})})}return o&&(d=M(M([],d.slice(3),!0),d.slice(0,3),!0)),d.map(function(m){return m.slice(0,s)})}function _(e,t){for(var a=0,r=0,n=0;n<t.length;n++)a+=Math.pow(n,e)*Math.abs(t[n]),r+=t[n];return a/r}function T(e){var t=e.ampSpectrum,a=e.barkScale,r=e.numberOfBarkBands,n=r===void 0?24:r;if(typeof t!="object"||typeof a!="object")throw new TypeError;var o=n,f=new Float32Array(o),s=0,u=t,i=new Int32Array(o+1);i[0]=0;for(var l=a[u.length-1]/o,h=1,c=0;c<u.length;c++)for(;a[c]>l;)i[h++]=c,l=h*a[u.length-1]/o;for(i[o]=u.length-1,c=0;c<o;c++){for(var y=0,v=i[c];v<i[c+1];v++)y+=u[v];f[c]=Math.pow(y,.23)}for(c=0;c<f.length;c++)s+=f[c];return{specific:f,total:s}}function N(e){var t=e.ampSpectrum;if(typeof t!="object")throw new TypeError;for(var a=new Float32Array(t.length),r=0;r<a.length;r++)a[r]=Math.pow(t[r],2);return a}function X(e){var t=e.ampSpectrum,a=e.melFilterBank,r=e.bufferSize;if(typeof t!="object")throw new TypeError("Valid ampSpectrum is required to generate melBands");if(typeof a!="object")throw new TypeError("Valid melFilterBank is required to generate melBands");for(var n=N({ampSpectrum:t}),o=a.length,f=Array(o),s=new Float32Array(o),u=0;u<s.length;u++){f[u]=new Float32Array(r/2),s[u]=0;for(var i=0;i<r/2;i++)f[u][i]=a[u][i]*n[i],s[u]+=f[u][i];s[u]=Math.log(s[u]+1)}return Array.prototype.slice.call(s)}function K(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var E=null,J=K(function(e,t){var a=e.length;return t=t||2,E&&E[a]||function(r){(E=E||{})[r]=new Array(r*r);for(var n=Math.PI/r,o=0;o<r;o++)for(var f=0;f<r;f++)E[r][f+o*r]=Math.cos(n*(f+.5)*o)}(a),e.map(function(){return 0}).map(function(r,n){return t*e.reduce(function(o,f,s,u){return o+f*E[a][s+n*a]},0)})}),V=Object.freeze({__proto__:null,amplitudeSpectrum:function(e){return e.ampSpectrum},buffer:function(e){return e.signal},chroma:function(e){var t=e.ampSpectrum,a=e.chromaFilterBank;if(typeof t!="object")throw new TypeError("Valid ampSpectrum is required to generate chroma");if(typeof a!="object")throw new TypeError("Valid chromaFilterBank is required to generate chroma");var r=a.map(function(o,f){return t.reduce(function(s,u,i){return s+u*o[i]},0)}),n=Math.max.apply(Math,r);return n?r.map(function(o){return o/n}):r},complexSpectrum:function(e){return e.complexSpectrum},energy:function(e){var t=e.signal;if(typeof t!="object")throw new TypeError;for(var a=0,r=0;r<t.length;r++)a+=Math.pow(Math.abs(t[r]),2);return a},loudness:T,melBands:X,mfcc:function(e){var t=e.ampSpectrum,a=e.melFilterBank,r=e.numberOfMFCCCoefficients,n=e.bufferSize,o=Math.min(40,Math.max(1,r||13));if(a.length<o)throw new Error("Insufficient filter bank for requested number of coefficients");var f=X({ampSpectrum:t,melFilterBank:a,bufferSize:n});return J(f).slice(0,o)},perceptualSharpness:function(e){for(var t=T({ampSpectrum:e.ampSpectrum,barkScale:e.barkScale}),a=t.specific,r=0,n=0;n<a.length;n++)r+=n<15?(n+1)*a[n+1]:.066*Math.exp(.171*(n+1));return r*=.11/t.total},perceptualSpread:function(e){for(var t=T({ampSpectrum:e.ampSpectrum,barkScale:e.barkScale}),a=0,r=0;r<t.specific.length;r++)t.specific[r]>a&&(a=t.specific[r]);return Math.pow((t.total-a)/t.total,2)},powerSpectrum:N,rms:function(e){var t=e.signal;if(typeof t!="object")throw new TypeError;for(var a=0,r=0;r<t.length;r++)a+=Math.pow(t[r],2);return a/=t.length,a=Math.sqrt(a)},spectralCentroid:function(e){var t=e.ampSpectrum;if(typeof t!="object")throw new TypeError;return _(1,t)},spectralCrest:function(e){var t=e.ampSpectrum;if(typeof t!="object")throw new TypeError;var a=0,r=-1/0;return t.forEach(function(n){a+=Math.pow(n,2),r=n>r?n:r}),a/=t.length,a=Math.sqrt(a),r/a},spectralFlatness:function(e){var t=e.ampSpectrum;if(typeof t!="object")throw new TypeError;for(var a=0,r=0,n=0;n<t.length;n++)a+=Math.log(t[n]),r+=t[n];return Math.exp(a/t.length)*t.length/r},spectralFlux:function(e){var t=e.signal,a=e.previousSignal,r=e.bufferSize;if(typeof t!="object"||typeof a!="object")throw new TypeError;for(var n=0,o=-r/2;o<t.length/2-1;o++)x=Math.abs(t[o])-Math.abs(a[o]),n+=(x+Math.abs(x))/2;return n},spectralKurtosis:function(e){var t=e.ampSpectrum;if(typeof t!="object")throw new TypeError;var a=t,r=_(1,a),n=_(2,a),o=_(3,a),f=_(4,a);return(-3*Math.pow(r,4)+6*r*n-4*r*o+f)/Math.pow(Math.sqrt(n-Math.pow(r,2)),4)},spectralRolloff:function(e){var t=e.ampSpectrum,a=e.sampleRate;if(typeof t!="object")throw new TypeError;for(var r=t,n=a/(2*(r.length-1)),o=0,f=0;f<r.length;f++)o+=r[f];for(var s=.99*o,u=r.length-1;o>s&&u>=0;)o-=r[u],--u;return(u+1)*n},spectralSkewness:function(e){var t=e.ampSpectrum;if(typeof t!="object")throw new TypeError;var a=_(1,t),r=_(2,t),n=_(3,t);return(2*Math.pow(a,3)-3*a*r+n)/Math.pow(Math.sqrt(r-Math.pow(a,2)),3)},spectralSlope:function(e){var t=e.ampSpectrum,a=e.sampleRate,r=e.bufferSize;if(typeof t!="object")throw new TypeError;for(var n=0,o=0,f=new Float32Array(t.length),s=0,u=0,i=0;i<t.length;i++){n+=t[i];var l=i*a/r;f[i]=l,s+=l*l,o+=l,u+=l*t[i]}return(t.length*u-o*n)/(n*(s-Math.pow(o,2)))},spectralSpread:function(e){var t=e.ampSpectrum;if(typeof t!="object")throw new TypeError;return Math.sqrt(_(2,t)-Math.pow(_(1,t),2))},zcr:function(e){var t=e.signal;if(typeof t!="object")throw new TypeError;for(var a=0,r=1;r<t.length;r++)(t[r-1]>=0&&t[r]<0||t[r-1]<0&&t[r]>=0)&&a++;return a}});function L(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}var B={},z={},F={bitReverseArray:function(e){if(B[e]===void 0){for(var t=(e-1).toString(2).length,a="0".repeat(t),r={},n=0;n<e;n++){var o=n.toString(2);o=a.substr(o.length)+o,o=[].concat(L(o)).reverse().join(""),r[n]=parseInt(o,2)}B[e]=r}return B[e]},multiply:function(e,t){return{real:e.real*t.real-e.imag*t.imag,imag:e.real*t.imag+e.imag*t.real}},add:function(e,t){return{real:e.real+t.real,imag:e.imag+t.imag}},subtract:function(e,t){return{real:e.real-t.real,imag:e.imag-t.imag}},euler:function(e,t){var a=-2*Math.PI*e/t;return{real:Math.cos(a),imag:Math.sin(a)}},conj:function(e){return e.imag*=-1,e},constructComplexArray:function(e){var t={};t.real=e.real===void 0?e.slice():e.real.slice();var a=t.real.length;return z[a]===void 0&&(z[a]=Array.apply(null,Array(a)).map(Number.prototype.valueOf,0)),t.imag=z[a].slice(),t}},Q=function(e){var t={};e.real===void 0||e.imag===void 0?t=F.constructComplexArray(e):(t.real=e.real.slice(),t.imag=e.imag.slice());var a=t.real.length,r=Math.log2(a);if(Math.round(r)!=r)throw new Error("Input size must be a power of 2.");if(t.real.length!=t.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var n=F.bitReverseArray(a),o={real:[],imag:[]},f=0;f<a;f++)o.real[n[f]]=t.real[f],o.imag[n[f]]=t.imag[f];for(var s=0;s<a;s++)t.real[s]=o.real[s],t.imag[s]=o.imag[s];for(var u=1;u<=r;u++)for(var i=Math.pow(2,u),l=0;l<i/2;l++)for(var h=F.euler(l,i),c=0;c<a/i;c++){var y=i*c+l,v=i*c+l+i/2,d={real:t.real[y],imag:t.imag[y]},O={real:t.real[v],imag:t.imag[v]},m=F.multiply(h,O),p=F.subtract(d,m);t.real[v]=p.real,t.imag[v]=p.imag;var g=F.add(m,d);t.real[y]=g.real,t.imag[y]=g.imag}return t},W=Q,Y=function(){function e(t,a){var r=this;if(this._m=a,!t.audioContext)throw this._m.errors.noAC;if(t.bufferSize&&!A(t.bufferSize))throw this._m._errors.notPow2;if(!t.source)throw this._m._errors.noSource;this._m.audioContext=t.audioContext,this._m.bufferSize=t.bufferSize||this._m.bufferSize||256,this._m.hopSize=t.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=t.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=t.callback,this._m.windowingFunction=t.windowingFunction||"hanning",this._m.featureExtractors=V,this._m.EXTRACTION_STARTED=t.startImmediately||!1,this._m.channel=typeof t.channel=="number"?t.channel:0,this._m.inputs=t.inputs||1,this._m.outputs=t.outputs||1,this._m.numberOfMFCCCoefficients=t.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.numberOfBarkBands=t.numberOfBarkBands||this._m.numberOfBarkBands||24,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=t.featureExtractors||[],this._m.barkScale=R(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=q(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(t.source),this._m.spn.onaudioprocess=function(n){var o;r._m.inputData!==null&&(r._m.previousInputData=r._m.inputData),r._m.inputData=n.inputBuffer.getChannelData(r._m.channel),r._m.previousInputData?((o=new Float32Array(r._m.previousInputData.length+r._m.inputData.length-r._m.hopSize)).set(r._m.previousInputData.slice(r._m.hopSize)),o.set(r._m.inputData,r._m.previousInputData.length-r._m.hopSize)):o=r._m.inputData;var f=function(s,u,i){if(s.length<u)throw new Error("Buffer is too short for frame length");if(i<1)throw new Error("Hop length cannot be less that 1");if(u<1)throw new Error("Frame length cannot be less that 1");var l=1+Math.floor((s.length-u)/i);return new Array(l).fill(0).map(function(h,c){return s.slice(c*i,c*i+u)})}(o,r._m.bufferSize,r._m.hopSize);f.forEach(function(s){r._m.frame=s;var u=r._m.extract(r._m._featuresToExtract,r._m.frame,r._m.previousFrame);typeof r._m.callback=="function"&&r._m.EXTRACTION_STARTED&&r._m.callback(u),r._m.previousFrame=r._m.frame})}}return e.prototype.start=function(t){this._m._featuresToExtract=t||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0},e.prototype.stop=function(){this._m.EXTRACTION_STARTED=!1},e.prototype.setSource=function(t){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=t,this._m.source.connect(this._m.spn)},e.prototype.setChannel=function(t){t<=this._m.inputs?this._m.channel=t:console.error("Channel ".concat(t," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(t," when instantiating the MeydaAnalyzer"))},e.prototype.get=function(t){return this._m.inputData?this._m.extract(t||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null},e}(),j={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:V,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,numberOfBarkBands:24,_featuresToExtract:[],windowing:I,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(e){return new Y(e,Object.assign({},j))},listAvailableFeatureExtractors:function(){return Object.keys(this.featureExtractors)},extract:function(e,t,a){var r=this;if(!t)throw this._errors.invalidInput;if(typeof t!="object")throw this._errors.invalidInput;if(!e)throw this._errors.featureUndef;if(!A(t.length))throw this._errors.notPow2;this.barkScale!==void 0&&this.barkScale.length==this.bufferSize||(this.barkScale=R(this.bufferSize,this.sampleRate,this.bufferSize)),this.melFilterBank!==void 0&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=q(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),this.chromaFilterBank!==void 0&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=H(this.chromaBands,this.sampleRate,this.bufferSize)),"buffer"in t&&t.buffer===void 0?this.signal=D(t):this.signal=t;var n=$(t,this.windowingFunction,this.bufferSize);if(this.signal=n.windowedSignal,this.complexSpectrum=n.complexSpectrum,this.ampSpectrum=n.ampSpectrum,a){var o=$(a,this.windowingFunction,this.bufferSize);this.previousSignal=o.windowedSignal,this.previousComplexSpectrum=o.complexSpectrum,this.previousAmpSpectrum=o.ampSpectrum}var f=function(s){return r.featureExtractors[s]({ampSpectrum:r.ampSpectrum,chromaFilterBank:r.chromaFilterBank,complexSpectrum:r.complexSpectrum,signal:r.signal,bufferSize:r.bufferSize,sampleRate:r.sampleRate,barkScale:r.barkScale,melFilterBank:r.melFilterBank,previousSignal:r.previousSignal,previousAmpSpectrum:r.previousAmpSpectrum,previousComplexSpectrum:r.previousComplexSpectrum,numberOfMFCCCoefficients:r.numberOfMFCCCoefficients,numberOfBarkBands:r.numberOfBarkBands})};if(typeof e=="object")return e.reduce(function(s,u){var i;return Object.assign({},s,((i={})[u]=f(u),i))},{});if(typeof e=="string")return f(e);throw this._errors.invalidFeatureFmt}},$=function(e,t,a){var r={};e.buffer===void 0?r.signal=D(e):r.signal=e,r.windowedSignal=I(r.signal,t),r.complexSpectrum=W(r.windowedSignal),r.ampSpectrum=new Float32Array(a/2);for(var n=0;n<a/2;n++)r.ampSpectrum[n]=Math.sqrt(Math.pow(r.complexSpectrum.real[n],2)+Math.pow(r.complexSpectrum.imag[n],2));return r};return typeof window<"u"&&(window.Meyda=j),j})})(U);var G=U.exports;const rt=Z(G),nt=et({__proto__:null,default:rt},[G]);export{nt as m};
