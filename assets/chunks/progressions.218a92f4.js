import{r as y,v as l,b as u,F as d,X as _,N as s,B as b,f as T,a as N,H as C,w as V,_ as X,P as Y,i as j,z as D,T as O,O as F,C as I,$ as Z}from"./framework.7e747cd7.js";import{r as A,a as U}from"./calculations.3384a913.js";import{a as z,b as M,n as S,i as J,d as E}from"./theory.61e5aadb.js";import{g,n as $,e as G,b as q,c as k,f as K}from"./colors.abbc28c6.js";import{w as Q,x as ee,y as te,z as oe,A as B,t as se,u as ne,p as re}from"./index.b30cd6d2.js";import{F as ae}from"./index.83aed4fc.js";import{b as le}from"./synth.220fb0dd.js";import{e as ie,g as ce,d as ue}from"./midi.290fabf9.js";import{w as R}from"./index.654bd828.js";import{_ as me}from"./circle.f77ef0cf.js";import"./index.86652af6.js";import{_ as he}from"./keys.c3aef01a.js";import{_ as de}from"./choose.481f6f66.js";import{b as fe}from"./index.c0ca431c.js";var L={empty:!0,name:"",chordType:""},H={};function P(e){return typeof e=="string"?H[e]||(H[e]=ge(e)):typeof e=="number"?P(W[e]||""):Q(e)?pe(e):ee(e)?P(e.name):L}function pe(e){return P(te(e.alt)+W[e.step])}var ye=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function ve(e){return ye.exec(e)||["","","",""]}var xe="I II III IV V VI VII",W=xe.split(" ");function ge(e){const[i,t,r,o]=ve(e);if(!r)return L;const x=r.toUpperCase(),c=W.indexOf(x),p=oe(t),m=1;return{empty:!1,name:i,roman:r,interval:B({step:c,alt:p,dir:m}).name,acc:t,chordType:o,alt:p,step:c,major:r===x,oct:0,dir:m}}function _e(e,i){return i.map(P).map(r=>se(e,B(r))+r.chordType)}function we(e,i){return i.map(t=>{const[r,o]=ie(t),x=ne(e,r);return P(B(x)).name+o})}var be={fromRomanNumerals:_e,toRomanNumerals:we};const $e={class:"font-bold"},ke={key:0,class:"text-sm"},Ne=["onMouseenter","onTouchstart"],Ce={__name:"stack",props:{pitch:{type:Number,default:null},chroma:{type:String,default:"1001000100101"},mode:{type:String,default:"O"},tonic:{type:Number,default:0},roman:{type:String,default:""}},setup(e){const i=e,t="101101011010".split(""),r=y(()=>i.pitch===0||i.pitch?i.pitch:g.tonic),o=y(()=>z.get(i.chroma));y(()=>M.get(i.chroma));const x=y(()=>A(i.chroma.split(""),-r.value).map((f,n)=>({active:f=="1",pitch:n})).reverse());function c(m){m.active&&p(m.pitch)}function p(m=0,f=0){let n=ae(m+57,"midi");ce(n.toNote()),le(n.toNote())}return(m,f)=>(l(),u("div",{class:"flex flex-col cursor-pointer select-none p-4 m-2 rounded-xl transition-all duration-300 ease w-full",style:T({backgroundColor:s(G)(e.chroma,r.value).hsl}),onMousedown:f[0]||(f[0]=n=>{s(q)(e.chroma,r.value),m.pressed=!0}),onTouchstart:f[1]||(f[1]=V(n=>{s(q)(e.chroma,r.value),m.pressed=!0},["prevent","stop"])),onTouchend:f[2]||(f[2]=n=>{s(k)(e.chroma,r.value),m.pressed=!1}),onTouchcancel:f[3]||(f[3]=n=>{s(k)(e.chroma,r.value),m.pressed=!1}),onMouseup:f[4]||(f[4]=n=>{s(k)(e.chroma,r.value),m.pressed=!1}),onMouseleave:f[5]||(f[5]=n=>{s(k)(e.chroma,r.value),m.pressed=!1})},[d("div",{class:"p-2 text-center mb-2 rounded-lg text-white",style:T({backgroundColor:s($)(r.value,3),color:s(R)(s($)(r.value),3).isDark()?"white":"black"})},[d("div",$e,_(e.pitch===!1?"":typeof e.pitch=="string"?e.pitch:s(S)[r.value])+_(o.value.aliases[0]),1),i.roman?(l(),u("div",ke,_(i.roman),1)):b("",!0)],4),(l(!0),u(N,null,C(x.value,(n,h)=>(l(),u("div",{class:"py-6px px-8 my-2px w-full text-sm text-center font-bold rounded transition-all duration-300 ease touch-none",onMouseenter:v=>c(n),onTouchstart:v=>c(n),key:h,style:T({backgroundColor:n.active?s($)(n.pitch):s(t)[n.pitch]==1?"hsla(0,0%,90%,0.8)":"hsla(0,0%,20%,0.6)"})},null,44,Ne))),128))],36))}};const Se={class:"select-none min-w-8em m-2",version:"1.1",baseProfile:"full",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none"},"font-family":"Commissioner, sans-serif","text-anchor":"middle","dominant-baseline":"middle"},Ie=["fill"],Te=["transform","onMousedown","opacity"],Pe=["width","height","fill"],ze=["y","x","fill"],Me=["y","x"],qe=["x","y","width","height","fill","stroke"],Oe=["x","y"],Ve=["x","y"],Ae={__name:"square",props:{pitch:{type:Number,default:null},chroma:{type:String,default:"1001000100101"},mode:{type:String,default:"O"},tonic:{type:Number,default:0},roman:{type:String,default:""},editable:{type:Boolean,default:!1}},emits:["update:chroma"],setup(e,{emit:i}){const t=e,r=Y(!1),o=j({width:100,height:100}),x=[[0,0],[1,0],[2,0],[3,0],[3,1],[3,2],[3,3],[2,3],[1,3],[0,3],[0,2],[0,1]],c=y(()=>t.pitch===0||t.pitch?t.pitch:g.tonic),p=y(()=>z.get(t.chroma));y(()=>M.get(t.chroma).name);function m(n,h=o.width,v=o.height){let a,w;return t.mode=="Z"?(a=n%4,w=Math.floor(n/4)+1,n>3&&n<8&&(a=3-a)):t.mode=="O"&&([a,w]=x[n]),`translate(${a*h/4},${w*v/4})`}function f(n){if(!t.editable)return;let h=[...t.chroma.split("")];h[n]=="1"?h[n]="0":h[n]="1",i("update:chroma",h.join(""))}return(n,h)=>(l(),u("svg",Se,[d("rect",{width:"100",height:"100",rx:"8",opacity:"0.6",fill:s(G)(e.chroma,c.value).hsl},null,8,Ie),(l(!0),u(N,null,C(e.chroma,(v,a)=>(l(),u("g",{class:"transition-all duration-400 ease-in-out cursor-pointer",key:a,transform:m(a),onMousedown:w=>f(a),opacity:v=="1"?1:.62},[d("rect",{class:"transition-all duration-200 ease-in-out",x:2,y:2,rx:"6",width:o.width/4-4,height:o.height/4-4,fill:s(R)(v=="1"?s($)((a+c.value)%12,3):s(S)[(a+s(g).tonic)%12].length!=2?"hsl(0,0%,85%)":"hsl(0,0%,40%)").toHex()},null,8,Pe),v=="1"?(l(),u("text",{key:0,y:o.height/8+1,x:o.width/8,"font-size":8,"font-weight":"bold",fill:s(R)(s($)(a+s(g).tonic)).isDark()?"white":"black"},_(s(S)[(a+c.value)%12]),9,ze)):b("",!0),v=="0"?(l(),u("text",{key:1,y:o.height/8+1,x:o.width/8,"font-size":"6px","font-weight":"normal",fill:"black",opacity:"0.5"},_(s(J)[a]),9,Me)):b("",!0)],40,Te))),128)),d("g",{class:D(["center cursor-pointer",{pressed:r.value}]),onMousedown:h[0]||(h[0]=V(v=>{s(q)(e.chroma,c.value),r.value=!0},["prevent","stop"])),onTouchstart:h[1]||(h[1]=V(v=>{s(q)(e.chroma,c.value),r.value=!0},["prevent","stop"])),onTouchend:h[2]||(h[2]=v=>{s(k)(e.chroma,c.value),r.value=!1}),onTouchcancel:h[3]||(h[3]=v=>{s(k)(e.chroma,c.value),r.value=!1}),onMouseup:h[4]||(h[4]=v=>{s(k)(e.chroma,c.value),r.value=!1}),onMouseleave:h[5]||(h[5]=v=>{s(k)(e.chroma,c.value),r.value=!1})},[d("rect",{class:"transition-all duration-400 ease-in-out",rx:"4",x:o.width/4+2,y:o.width/4+2,width:o.width/2-4,height:o.height/2-4,fill:e.pitch===!1?"none":s($)(c.value,3),stroke:s($)(s(g).tonic,3,1,.5),"stroke-width":"2"},null,8,qe),d("text",{x:o.width/2,y:o.height/2,"font-size":"10px","font-weight":"bold",fill:"white"},_(e.pitch===!1?"":typeof e.pitch=="string"?e.pitch:s(S)[c.value])+_(p.value.aliases[0]),9,Oe),t.roman?(l(),u("text",{key:0,class:"function",x:o.width/2,y:o.height/2+13,"font-size":"8px","font-weight":"normal",fill:"white"},_(t.roman),9,Ve)):b("",!0)],34)]))}},Re=X(Ae,[["__scopeId","data-v-e0b528e1"]]);const je={class:"flex justify-center"},Be={class:"text-2x font-bold"},We=["viewBox"],Fe={id:"fretboard"},Ue=["x2"],Ee=["x1","y1","y2"],He=["cy","cx"],Xe={id:"strings"},De=["transform"],Ge=["y2"],Le=["transform"],Ye=["opacity","r","fill"],Ze=["opacity"],Je={__name:"tab",props:{instrument:{type:String,default:"ukulele"},chroma:{type:String,default:"100000000000"},pitch:{type:Number,default:0},chordNotes:{type:Array,default:[]}},setup(e){const i=e,t={guitar:[7,0,5,10,2,7],ukulele:[10,3,7,0]},r=[3,5,7,10,12,15,17,19,21],o=j({strings:y(()=>t[i.instrument]),height:y(()=>(o.strings.length-1)*o.noteSize),width:y(()=>o.fretNum*o.fretWidth),isInChord:y(()=>re.isNoteIncludedIn(i.chordNotes)),chroma:y(()=>A(i.chroma.split(""),-i.pitch)),scale:y(()=>A(g.chroma.split(""),-i.pitch)),title:y(()=>{var x,c;return(x=z.get(i.chroma))!=null&&x.empty?(c=M.get(i.chroma))!=null&&c.empty?"":M.get(i.chroma):z.get(i.chroma).aliases[0]}),noteSize:50,fretWidth:50,fretNum:5});return(x,c)=>(l(),u("div",{class:"flex flex-col items-center justify-center rounded-3xl py-2",style:T({backgroundColor:s(U)(e.pitch,3,1,.3)})},[d("div",je,[d("div",Be,_(s(S)[e.pitch])+_(o.title),1)]),(l(),u("svg",{class:"max-h-3xl w-full my-2",id:"fretboard",version:"1.1",baseProfile:"full",viewBox:`-50 -50 ${o.height+100} ${o.width+60}`,xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif","font-size":"20px","text-anchor":"middle","dominant-baseline":"middle"},[d("g",Fe,[d("line",{stroke:"currentColor","stroke-width":"10",x1:"0",x2:o.height},null,8,Ue),(l(!0),u(N,null,C(o.fretNum,p=>(l(),u("g",{class:"fret",key:p},[d("line",{x1:o.height,y1:p*o.fretWidth,y2:p*o.fretWidth,stroke:"currentColor","stroke-width":"2",opacity:"0.5"},null,8,Ee),r.find(m=>m==p)?(l(),u("circle",{key:0,class:"inlay",cy:(p-.5)*o.fretWidth,cx:o.height/2,r:"5",opacity:"0.8",fill:"currentColor"},null,8,He)):b("",!0)]))),128))]),d("g",Xe,[(l(!0),u(N,null,C(o.strings,(p,m)=>(l(),u("g",{class:"string",key:p,transform:`translate(${m*o.noteSize} 0)`},[d("line",{y2:o.width,"stroke-width":"4",stroke:"currentColor",opacity:"0.5"},null,8,Ge),(l(!0),u(N,null,C(o.fretNum+1,(f,n)=>(l(),u("g",{class:"note",key:f,transform:`translate(0 ${(n-.5)*o.fretWidth})`},[d("circle",{opacity:o.chroma[(n+p)%12]==1?1:0,r:o.noteSize/2-8,fill:s(U)(p+n)},null,8,Ye),d("text",{opacity:o.chroma[(n+p)%12]==1?1:0,fill:"white","font-size":"18","font-weight":"bold"},_(s(S)[(n+p)%12]),9,Ze)],8,Le))),128))],8,De))),128))])],8,We))],4))}},Ke=X(Je,[["__scopeId","data-v-92354fef"]]),Qe={class:"flex flex-col"},et={class:"flex flex-wrap mx-auto my-4"},tt={class:"flex flex-col text-center mb-2 relative p-1"},ot={class:"text-2xl font-bold flex mx-auto items-center"},st=["href"],nt=d("div",{class:"i-la-wikipedia-w"},null,-1),rt=[nt],at={class:"text-lg"},lt={class:"flex flex-wrap p-4 items-start",style:{flex:"1 1 6rem"}},it=["onClick"],ct={class:"font-bold px-1 mb-1"},Nt={__name:"progressions",props:{list:{type:Object,required:!0},initial:{type:String,default:"major"}},setup(e){const i=e,t=j({mode:fe("progresions-mode","bars"),selected:i.initial,current:y(()=>i.list[t.selected]),scaleString:y(()=>`${g.note.name} ${i.list[t.selected].title}`.toLowerCase()),scale:y(()=>K.get(t.scaleString))}),r={ukulele:"Ukulele",guitar:"Guitar",piano:"Piano",circles:"Circles",squares:"Squares",bars:"Bars"};function o(x){let c=x.split("-");return be.fromRomanNumerals(g.note,c).map(f=>{let n=ue.get(f);return n.pitches=n.notes.map(h=>E[h]),n.tonicPitch=E[n.tonic],n})}return(x,c)=>{const p=de,m=he,f=Ke,n=me,h=Re,v=Ce;return l(),u("div",Qe,[d("div",et,[O(p,{modelValue:t.mode,"onUpdate:modelValue":c[0]||(c[0]=a=>t.mode=a),variants:r},null,8,["modelValue"])]),d("div",{class:"flex flex-wrap items-stretch my-2 p-8 gap-4 border-2 rounded-xl",style:T({borderColor:s($)(s(g).tonic,2),backgroundColor:s($)(s(g).tonic,2,1,.05)})},[O(m,{class:"w-20em mx-auto",chroma:s(g).chroma,style:{flex:"1 1 3rem"},pitch:s(g).tonic,"onUpdate:pitch":c[1]||(c[1]=a=>s(g).tonic=a)},{default:F(()=>[d("div",tt,[d("div",ot,_(s(g).note.name)+" "+_(t.current.title),1),t.current.link?(l(),u("a",{key:0,class:"p-1 text-2xl absolute right-2 top-2 rounded-full shadow-xl",href:t.current.link,target:"_blank"},rt,8,st)):b("",!0),d("div",at,_(t.current.degrees),1)])]),_:1},8,["chroma","pitch"]),d("div",lt,[(l(!0),u(N,null,C(e.list,(a,w)=>(l(),u("button",{class:D(["text-button flex flex-col",{active:a==t.current}]),key:a,onClick:ut=>{t.selected=w,s(g).chroma=t.scale.chroma}},[d("div",ct,_(a.title),1)],10,it))),128))]),O(Z,{name:"fade",mode:"out-in"},{default:F(()=>[(l(),u("div",{class:"flex flex-wrap gap-2",key:t.current},[(l(!0),u(N,null,C(o(t.current.degrees),(a,w)=>(l(),u("div",{class:"flex flex-col select-none max-w-16rem",style:{flex:"1 1 10rem"},key:w},[t.mode=="piano"?(l(),I(m,{key:0,class:"flex-1 p-1 min-w-150px",chroma:a.chroma,pitch:a.tonicPitch,roman:t.current.degrees.split("-")[w],playAll:!0},null,8,["chroma","pitch","roman"])):b("",!0),t.mode=="guitar"||t.mode=="ukulele"?(l(),I(f,{key:1,instrument:t.mode,chroma:a.chroma,pitch:a.tonicPitch},null,8,["instrument","chroma","pitch"])):b("",!0),t.mode=="circles"?(l(),I(n,{key:2,class:"min-w-8em",chroma:a.chroma,pitch:a.tonicPitch,type:t.current.degrees.split("-")[w]},null,8,["chroma","pitch","type"])):b("",!0),t.mode=="squares"?(l(),I(h,{key:3,class:"self-center my-4 min-w-8em",chroma:a.chroma,pitch:a.tonicPitch,roman:t.current.degrees.split("-")[w]},null,8,["chroma","pitch","roman"])):b("",!0),t.mode=="bars"?(l(),I(v,{key:4,class:"mx-8",chroma:a.chroma,pitch:a.tonicPitch,roman:t.current.degrees.split("-")[w]},null,8,["chroma","pitch","roman"])):b("",!0)]))),128))]))]),_:1})],4)])}}};export{Nt as _};
