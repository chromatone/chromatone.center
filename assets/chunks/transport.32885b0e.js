import{_ as P}from"./knob.f0f020ec.js";import{Q as T,r as x,v as s,b as l,F as i,f as v,_ as S,j as k,Z as a,N as t,T as h,z as f,X as c,w as $,A as z,c as M}from"./framework.7e747cd7.js";import{u as I,a as g}from"./tempo.fceb0f15.js";import{u as D}from"./tuner.f1245b29.js";const A=["viewBox","stroke-width"],B=["r","stroke"],E=T({__name:"move",props:{color:String,progress:Number,size:{type:Number,default:10},stroke:{type:Number,default:2}},setup(r){const o=r,p=x(()=>o.size/2-1),n=x(()=>p.value*Math.PI*2);return(b,_)=>(s(),l("svg",{version:"1.1",baseProfile:"full",viewBox:`${-r.size/2} ${-r.size/2} ${r.size} ${r.size}`,xmlns:"http://www.w3.org/2000/svg","stroke-width":r.stroke},[i("circle",{r:p.value,fill:"none",stroke:r.color,transform:"rotate(-90)",style:v({strokeDasharray:`${n.value/2}, ${n.value/2}`,strokeDashoffset:1.5*n.value-r.progress*n.value})},null,12,B)],8,A))}});const m=r=>(z("data-v-cbd6bca8"),r=r(),M(),r),F={class:"flex flex-col w-full mx-auto justify-center gap-2"},N={class:"tempo-grid text-xl"},U=["transform"],L={key:0,class:"i-la-play"},j={key:1,class:"i-la-pause"},V=m(()=>i("div",{class:"i-la-stop"},null,-1)),G=[V],O=m(()=>i("div",{class:"i-la-minus"},null,-1)),H=[O],K=m(()=>i("div",{class:"i-la-plus"},null,-1)),Y=[K],Z=m(()=>i("div",{class:"i-la-slash"},null,-1)),q=[Z],Q=m(()=>i("div",{class:"i-la-times"},null,-1)),X=[Q],J={class:"font-bold font-mono flex-1 -mt-4 flex justify-center items-end",style:{"font-variant-numeric":"tabular-nums"}},R={class:"text-4xl"},W={class:"m-0"},tt=m(()=>i("div",{class:"text-sm mt-1px ml-1 absolute bottom-3"},"BPM",-1)),ot={class:"text-4xl font-bold"},et={class:"flex-1 -mt-2 font-bold font-mono"},st=m(()=>i("div",{class:"text-sm mt-1px absolute bottom-3"},"Hz",-1)),lt=m(()=>i("div",{class:"i-fluent-tap-double-20-regular mt-1"},null,-1)),it=[lt],nt={key:0,class:"font-bold"},at={key:1,class:"opacity-40"},rt={key:0,class:"i-tabler-ear"},dt={key:1,class:"i-tabler-ear-off"},ut={key:0,class:"font-bold"},ct={key:1,class:"opacity-40"},mt={class:"flex font-mono text-sm gap-4"},pt={class:"flex-1"},vt={class:"flex-1"},_t={__name:"transport",props:{secondary:Boolean},setup(r){const o=I(),{init:p,tuner:n}=D();function b(_){o.bpm+=(_.delta[0]-_.delta[1])/16}return(_,e)=>{const C=E,w=P,d=k("tooltip"),y=k("drag");return s(),l("div",F,[i("div",N,[a((s(),l("button",{class:"relative overflow-hidden",style:v([{"grid-area":"CLICK"},{color:t(o).blink?t(o).color:"currentColor"}]),onClick:e[0]||(e[0]=u=>t(o).mute=!t(o).mute),"aria-label":"Toggle metronome"},[i("div",{class:"i-mdi-metronome z-4",style:v([{transition:"all 300ms ease-out"},{opacity:t(o).mute?.3:1}]),transform:`scale(${!t(o).mute&&t(o).blink?1.1:1})`},null,12,U),h(C,{class:"opacity-30 z-2 absolute top-0 bottom-0 w-full h-full",progress:t(o).progress,color:t(o).color,stroke:10},null,8,["progress","color"])],4)),[[d,"Toggle metronome",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"PLAY"},onClick:e[1]||(e[1]=u=>t(o).playing=!t(o).playing)},[t(o).playing?(s(),l("div",j)):(s(),l("div",L))])),[[d,"Play",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"STOP"},onClick:e[2]||(e[2]=u=>t(o).stopped=Date.now())},G)),[[d,"Stop",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"MINUS"},onClick:e[3]||(e[3]=u=>t(o).set(-1))},H)),[[d,"Subtract 1 BPM",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"PLUS"},onClick:e[4]||(e[4]=u=>t(o).set(1))},Y)),[[d,"Add 1 BPM",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"DIVIDE"},onClick:e[5]||(e[5]=u=>t(o).set(-t(o).bpm/2))},q)),[[d,"Half speed",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"MULTIPLY"},onClick:e[6]||(e[6]=u=>t(o).set(t(o).bpm))},X)),[[d,"Double speed",void 0,{top:!0}]]),a((s(),l("button",{class:f(["relative touch-none text-center flex",{active:t(n).blink}]),style:v([{"grid-area":"BPM"},{borderColor:t(o).blink?t(o).color:"currentColor"}])},[i("div",J,[i("div",R,c(t(o).bpm.toFixed(0)),1),i("div",W,c((t(o).bpm-Math.floor(t(o).bpm)).toFixed(1).substring(1)),1)]),tt],6)),[[y,b]]),a((s(),l("button",{class:"relative flex flex-col gap-2 touch-none",style:v([{"grid-area":"Hz"},{color:t(o).color,borderColor:t(o).color}])},[i("div",ot,c(t(o).note),1),i("div",et,c(t(o).hz),1),st],4)),[[y,b],[d,"Tempo frequency and pitch class",void 0,{top:!0}]]),a(h(w,{class:"font-bold w-full",style:{"grid-area":"NOTE"},modelValue:t(o).volume,"onUpdate:modelValue":e[7]||(e[7]=u=>t(o).volume=u),min:0,max:1,step:.01,param:"VOL",cc:16},null,8,["modelValue"]),[[d,"Metronome volume",void 0,{top:!0}]]),a((s(),l("button",{style:{"grid-area":"TAP"},onMousedown:e[8]||(e[8]=$(u=>t(g)(),["stop","prevent"])),onTouchstart:e[9]||(e[9]=$(u=>t(g)(),["stop","prevent"])),class:f({active:t(o).tap.last})},it,34)),[[d,"Tap tempo",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"TAPPED"},onClick:e[10]||(e[10]=u=>t(o).tap.bpm&&t(o).tap.last?t(o).bpm=t(o).tap.bpm:t(g)())},[t(o).tap.bpm&&t(o).tap.last?(s(),l("div",nt,c(t(o).tap.bpm.toFixed(1)),1)):(s(),l("div",at,"TAP"))])),[[d,"Click to set tap tempo",void 0,{bottom:!0}]]),a((s(),l("button",{style:{"grid-area":"GUESS"},onClick:e[11]||(e[11]=u=>t(n).initiated?t(n).listen=!t(n).listen:t(p)())},[t(n).listen?(s(),l("div",dt)):(s(),l("div",rt))])),[[d,"Guess tempo from audio",void 0,{top:!0}]]),a((s(),l("button",{class:f(["duration-100",{active:t(n).blink}]),style:{"grid-area":"GUESSED"},onClick:e[12]||(e[12]=u=>t(n).initiated?t(n).listen&&t(n).bpm?t(o).bpm=t(n).bpm:t(n).listen=!0:t(p)())},[t(n).listen?(s(),l("div",ut,c(t(n).bpm.toFixed(0)),1)):(s(),l("div",ct,"GUESS"))],2)),[[d,"Click to set guessed tempo",void 0,{top:!0}]])]),i("div",mt,[i("div",pt,"POS "+c(t(o).position),1),i("div",vt,"TICK "+c(t(o).ticks),1)])])}}},xt=S(_t,[["__scopeId","data-v-cbd6bca8"]]);export{xt as _};
