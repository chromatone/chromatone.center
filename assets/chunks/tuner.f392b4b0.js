import{n as Qt}from"./colors.f742d7d3.js";import{i as er}from"./audio.e9cddac8.js";import{c as tr,g as rr}from"./commonjsHelpers.de833af9.js";import{r as nr}from"./calculations.65ee336d.js";import{B as ar,i as Tt,A as ir}from"./framework.f429e15e.js";var or=function(_){_=_||{};var r;r||(r=typeof _<"u"?_:{});var q={},B;for(B in r)r.hasOwnProperty(B)&&(q[B]=r[B]);r.arguments=[],r.thisProgram="./this.program",r.quit=function(e,t){throw t},r.preRun=[],r.postRun=[];var U=!1,C=!1,I=!1,V=!1;U=typeof window=="object",C=typeof importScripts=="function",I=typeof process=="object"&&typeof require=="function"&&!U&&!C,V=!U&&!I&&!C;var Y="";function X(e){return r.locateFile?r.locateFile(e,Y):Y+e}if(I){Y=__dirname+"/";var W,w;r.read=function(e,t){return W||(W=require("fs")),w||(w=require("path")),e=w.normalize(e),e=W.readFileSync(e),t?e:e.toString()},r.readBinary=function(e){return e=r.read(e,!0),e.buffer||(e=new Uint8Array(e)),ae(e.buffer),e},1<process.argv.length&&(r.thisProgram=process.argv[1].replace(/\\/g,"/")),r.arguments=process.argv.slice(2),process.on("uncaughtException",function(e){throw e}),process.on("unhandledRejection",function(){process.exit(1)}),r.quit=function(e){process.exit(e)},r.inspect=function(){return"[Emscripten Module object]"}}else if(V)typeof read<"u"&&(r.read=function(e){return read(e)}),r.readBinary=function(e){return typeof readbuffer=="function"?new Uint8Array(readbuffer(e)):(e=read(e,"binary"),ae(typeof e=="object"),e)},typeof scriptArgs<"u"?r.arguments=scriptArgs:typeof arguments<"u"&&(r.arguments=arguments),typeof quit=="function"&&(r.quit=function(e){quit(e)});else if(U||C){if(U){var k=this._currentScript;k.src.indexOf("blob:")!==0&&(Y="/")}else C&&(Y="/");r.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},C&&(r.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),r.readAsync=function(e,t,i){var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=function(){u.status==200||u.status==0&&u.response?t(u.response):i()},u.onerror=i,u.send(null)},r.setWindowTitle=function(e){}}var G=r.print||(typeof console<"u"?console.log.bind(console):typeof print<"u"?print:null),D=r.printErr||(typeof printErr<"u"?printErr:typeof console<"u"&&console.warn.bind(console)||G);for(B in q)q.hasOwnProperty(B)&&(r[B]=q[B]);q=void 0;function ee(e){var t;return t||(t=16),Math.ceil(e/t)*t}var $={"f64-rem":function(e,t){return e%t},debugger:function(){debugger}},ce=0;function ae(e,t){e||he("Assertion failed: "+t)}var ge=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;typeof TextDecoder<"u"&&new TextDecoder("utf-16le");var H,fe,o,n,s,a,c,p,P;function j(){r.HEAP8=fe=new Int8Array(H),r.HEAP16=n=new Int16Array(H),r.HEAP32=a=new Int32Array(H),r.HEAPU8=o=new Uint8Array(H),r.HEAPU16=s=new Uint16Array(H),r.HEAPU32=c=new Uint32Array(H),r.HEAPF32=p=new Float32Array(H),r.HEAPF64=P=new Float64Array(H)}var b,d,F,Z,M,le,ie;b=d=F=Z=M=le=ie=0;function oe(){he("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+N+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}var Pe=r.TOTAL_STACK||5242880,N=r.TOTAL_MEMORY||16777216;N<Pe&&D("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+N+"! (TOTAL_STACK="+Pe+")"),r.buffer?H=r.buffer:(typeof WebAssembly=="object"&&typeof WebAssembly.Memory=="function"?(r.wasmMemory=new WebAssembly.Memory({initial:N/65536,maximum:N/65536}),H=r.wasmMemory.buffer):H=new ArrayBuffer(N),r.buffer=H),j();function J(e){for(;0<e.length;){var t=e.shift();if(typeof t=="function")t();else{var i=t.B;typeof i=="number"?t.F===void 0?r.dynCall_v(i):r.dynCall_vi(i,t.F):i(t.F===void 0?null:t.F)}}}var te=[],ue=[],Rt=[],st=[],ct=!1;function Pt(){var e=r.preRun.shift();te.unshift(e)}var jt=Math.cos,zt=Math.sin,_e=0,je=null;r.preloadedImages={},r.preloadedAudios={};function De(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):e.indexOf("data:application/octet-stream;base64,")===0}(function(){function e(){try{if(r.wasmBinary)return new Uint8Array(r.wasmBinary);if(r.readBinary)return r.readBinary(l);throw"both async and sync fetching of the wasm failed"}catch(f){he(f)}}function t(){return r.wasmBinary||!U&&!C||typeof fetch!="function"?new Promise(function(f){f(e())}):fetch(l,{credentials:"same-origin"}).then(function(f){if(!f.ok)throw"failed to load wasm binary file at '"+l+"'";return f.arrayBuffer()}).catch(function(){return e()})}function i(f){function g(S){if(m=S.exports,m.memory){S=m.memory;var L=r.buffer;S.byteLength<L.byteLength&&D("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here"),L=new Int8Array(L),new Int8Array(S).set(L),r.buffer=H=S,j()}r.asm=m,r.usingWasm=!0,_e--,r.monitorRunDependencies&&r.monitorRunDependencies(_e),_e==0&&je&&(S=je,je=null,S())}function y(S){g(S.instance)}function K(S){t().then(function(L){return WebAssembly.instantiate(L,A)}).then(S).catch(function(L){D("failed to asynchronously prepare wasm: "+L),he(L)})}if(typeof WebAssembly!="object")return D("no native wasm support detected"),!1;if(!(r.wasmMemory instanceof WebAssembly.Memory))return D("no native wasm Memory in use"),!1;if(f.memory=r.wasmMemory,A.global={NaN:NaN,Infinity:1/0},A["global.Math"]=Math,A.env=f,_e++,r.monitorRunDependencies&&r.monitorRunDependencies(_e),r.instantiateWasm)try{return r.instantiateWasm(A,g)}catch(S){return D("Module.instantiateWasm callback failed with error: "+S),!1}return r.wasmBinary||typeof WebAssembly.instantiateStreaming!="function"||De(l)||typeof fetch!="function"?K(y):WebAssembly.instantiateStreaming(fetch(l,{credentials:"same-origin"}),A).then(y).catch(function(S){D("wasm streaming compile failed: "+S),D("falling back to ArrayBuffer instantiation"),K(y)}),{}}var u="aubio.wast",l="aubio.wasm",h="aubio.temp.asm.js";De(u)||(u=X(u)),De(l)||(l=X(l)),De(h)||(h=X(h));var A={global:null,env:null,asm2wasm:$,parent:r},m=null;r.asmPreload=r.asm;var T=r.reallocBuffer;r.reallocBuffer=function(f){if(v==="asmjs")var g=T(f);else e:{var y=r.usingWasm?65536:16777216;if(0<f%y&&(f+=y-f%y),y=r.buffer.byteLength,r.usingWasm)try{g=r.wasmMemory.grow((f-y)/65536)!==-1?r.buffer=r.wasmMemory.buffer:null;break e}catch{g=null;break e}g=void 0}return g};var v="";r.asm=function(f,g){if(!g.table){f=r.wasmTableSize,f===void 0&&(f=1024);var y=r.wasmMaxTableSize;g.table=typeof WebAssembly=="object"&&typeof WebAssembly.Table=="function"?y!==void 0?new WebAssembly.Table({initial:f,maximum:y,element:"anyfunc"}):new WebAssembly.Table({initial:f,element:"anyfunc"}):Array(f),r.wasmTable=g.table}return g.memoryBase||(g.memoryBase=r.STATIC_BASE),g.tableBase||(g.tableBase=0),g=i(g),ae(g,"no binaryen method succeeded."),g}})(),b=1024,d=b+9312,ue.push({B:function(){Yt()}},{B:function(){$t()}},{B:function(){Jt()}},{B:function(){Kt()}}),r.STATIC_BASE=b,r.STATIC_BUMP=9312,d+=16;var Ce=0;function we(){return Ce+=4,a[Ce-4>>2]}var ft={};function Te(e,t){Ce=t;try{var i=we(),u=we(),l=we();for(e=0,Te.J||(Te.J=[null,[],[]],Te.P=function(T,v){var f=Te.J[T];if(ae(f),v===0||v===10){T=T===1?G:D;e:{for(var g=v=0;f[g];)++g;if(16<g-v&&f.subarray&&ge)v=ge.decode(f.subarray(v,g));else for(g="";;){var y=f[v++];if(!y){v=g;break e}if(y&128){var K=f[v++]&63;if((y&224)==192)g+=String.fromCharCode((y&31)<<6|K);else{var S=f[v++]&63;if((y&240)==224)y=(y&15)<<12|K<<6|S;else{var L=f[v++]&63;if((y&248)==240)y=(y&7)<<18|K<<12|S<<6|L;else{var E=f[v++]&63;if((y&252)==248)y=(y&3)<<24|K<<18|S<<12|L<<6|E;else{var se=f[v++]&63;y=(y&1)<<30|K<<24|S<<18|L<<12|E<<6|se}}}65536>y?g+=String.fromCharCode(y):(y-=65536,g+=String.fromCharCode(55296|y>>10,56320|y&1023))}}else g+=String.fromCharCode(y)}}T(v),f.length=0}else f.push(v)}),t=0;t<l;t++){for(var h=a[u+8*t>>2],A=a[u+(8*t+4)>>2],m=0;m<A;m++)Te.P(i,o[h+m]);e+=A}return e}catch(T){return typeof FS<"u"&&T instanceof FS.I||he(T),-T.L}}function He(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var lt=void 0;function re(e){for(var t="";o[e];)t+=lt[o[e++]];return t}var Me={},be={},Le={};function Ve(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return 48<=t&&57>=t?"_"+e:e}function Xe(e,t){return e=Ve(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(t)}function Ke(e){var t=Error,i=Xe(e,function(u){this.name=e,this.message=u,u=Error(u).stack,u!==void 0&&(this.stack=this.toString()+`
`+u.replace(/^Error(:[^\n]*)?\n/,""))});return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},i}var Ee=void 0;function z(e){throw new Ee(e)}var mt=void 0;function Ue(e){throw new mt(e)}function ze(e,t,i){function u(m){m=i(m),m.length!==e.length&&Ue("Mismatched type converter count");for(var T=0;T<e.length;++T)me(e[T],m[T])}e.forEach(function(m){Le[m]=t});var l=Array(t.length),h=[],A=0;t.forEach(function(m,T){be.hasOwnProperty(m)?l[T]=be[m]:(h.push(m),Me.hasOwnProperty(m)||(Me[m]=[]),Me[m].push(function(){l[T]=be[m],++A,A===h.length&&u(l)}))}),h.length===0&&u(l)}function me(e,t,i){if(i=i||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var u=t.name;if(e||z('type "'+u+'" must have a positive integer typeid pointer'),be.hasOwnProperty(e)){if(i.X)return;z("Cannot register type '"+u+"' twice")}be[e]=t,delete Le[e],Me.hasOwnProperty(e)&&(t=Me[e],delete Me[e],t.forEach(function(l){l()}))}function Ye(e){z(e.a.f.b.name+" instance already deleted")}var ke=void 0,Ie=[];function Je(){for(;Ie.length;){var e=Ie.pop();e.a.s=!1,e.delete()}}function ye(){}var pt={};function ht(e,t,i){if(e[t].j===void 0){var u=e[t];e[t]=function(){return e[t].j.hasOwnProperty(arguments.length)||z("Function '"+i+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].j+")!"),e[t].j[arguments.length].apply(this,arguments)},e[t].j=[],e[t].j[u.A]=u}}function kt(e,t){r.hasOwnProperty(e)?(z("Cannot register public name '"+e+"' twice"),ht(r,e,e),r.hasOwnProperty(void 0)&&z("Cannot register multiple overloads of a function with the same number of arguments (undefined)!"),r[e].j[void 0]=t):r[e]=t}function It(e,t,i,u,l,h,A,m){this.name=e,this.constructor=t,this.u=i,this.o=u,this.i=l,this.T=h,this.w=A,this.S=m,this.Z=[]}function $e(e,t,i){for(;t!==i;)t.w||z("Expected null or instance of "+i.name+", got an instance of "+t.name),e=t.w(e),t=t.i;return e}function Wt(e,t){return t===null?(this.G&&z("null is not a valid "+this.name),0):(t.a||z('Cannot pass "'+Be(t)+'" as a '+this.name),t.a.c||z("Cannot pass deleted object as a pointer of type "+this.name),$e(t.a.c,t.a.f.b,this.b))}function Dt(e,t){if(t===null){if(this.G&&z("null is not a valid "+this.name),this.D){var i=this.$();return e!==null&&e.push(this.o,i),i}return 0}if(t.a||z('Cannot pass "'+Be(t)+'" as a '+this.name),t.a.c||z("Cannot pass deleted object as a pointer of type "+this.name),!this.C&&t.a.f.C&&z("Cannot convert argument of type "+(t.a.h?t.a.h.name:t.a.f.name)+" to parameter type "+this.name),i=$e(t.a.c,t.a.f.b,this.b),this.D)switch(t.a.g===void 0&&z("Passing raw pointer to smart pointer is illegal"),this.ba){case 0:t.a.h===this?i=t.a.g:z("Cannot convert argument of type "+(t.a.h?t.a.h.name:t.a.f.name)+" to parameter type "+this.name);break;case 1:i=t.a.g;break;case 2:if(t.a.h===this)i=t.a.g;else{var u=t.clone();i=this.aa(i,de(function(){u.delete()})),e!==null&&e.push(this.o,i)}break;default:z("Unsupporting sharing policy")}return i}function Lt(e,t){return t===null?(this.G&&z("null is not a valid "+this.name),0):(t.a||z('Cannot pass "'+Be(t)+'" as a '+this.name),t.a.c||z("Cannot pass deleted object as a pointer of type "+this.name),t.a.f.C&&z("Cannot convert argument of type "+t.a.f.name+" to parameter type "+this.name),$e(t.a.c,t.a.f.b,this.b))}function qe(e){return this.fromWireType(c[e>>2])}function yt(e,t,i){return t===i?e:i.i===void 0?null:(e=yt(e,t,i.i),e===null?null:i.S(e))}var We={};function Ut(e,t){for(t===void 0&&z("ptr should not be undefined");e.i;)t=e.w(t),e=e.i;return We[t]}function Ne(e,t){return t.f&&t.c||Ue("makeClassHandle requires ptr and ptrType"),!!t.h!=!!t.g&&Ue("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Object.create(e,{a:{value:t}})}function pe(e,t,i,u,l,h,A,m,T,v,f){this.name=e,this.b=t,this.G=i,this.C=u,this.D=l,this.Y=h,this.ba=A,this.M=m,this.$=T,this.aa=v,this.o=f,l||t.i!==void 0?this.toWireType=Dt:(this.toWireType=u?Wt:Lt,this.l=null)}function qt(e,t){r.hasOwnProperty(e)||Ue("Replacing nonexistant public symbol"),r[e]=t,r[e].A=void 0}function Fe(e,t){if(e=re(e),r["FUNCTION_TABLE_"+e]!==void 0)var i=r["FUNCTION_TABLE_"+e][t];else if(typeof FUNCTION_TABLE<"u")i=FUNCTION_TABLE[t];else{i=r.asm["dynCall_"+e],i===void 0&&(i=r.asm["dynCall_"+e.replace(/f/g,"d")],i===void 0&&z("No dynCall invoker for signature: "+e));for(var u=[],l=1;l<e.length;++l)u.push("a"+l);l="return function "+("dynCall_"+e+"_"+t)+"("+u.join(", ")+`) {
`,l+="    return dynCall(rawFunction"+(u.length?", ":"")+u.join(", ")+`);
`,i=new Function("dynCall","rawFunction",l+`};
`)(i,t)}return typeof i!="function"&&z("unknown function pointer with signature "+e+": "+t),i}var dt=void 0;function vt(e){e=Zt(e);var t=re(e);return ve(e),t}function Ze(e,t){function i(h){l[h]||be[h]||(Le[h]?Le[h].forEach(i):(u.push(h),l[h]=!0))}var u=[],l={};throw t.forEach(i),new dt(e+": "+u.map(vt).join([", "]))}function gt(e,t){for(var i=[],u=0;u<e;u++)i.push(a[(t>>2)+u]);return i}function Qe(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function Nt(e){var t=Function;if(!(t instanceof Function))throw new TypeError("new_ called with constructor type "+typeof t+" which is not a function");var i=Xe(t.name||"unknownFunctionName",function(){});return i.prototype=t.prototype,i=new i,e=t.apply(i,e),e instanceof Object?e:i}var et=[],ne=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function tt(e){4<e&&--ne[e].H===0&&(ne[e]=void 0,et.push(e))}function de(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=et.length?et.pop():ne.length;return ne[t]={H:1,value:e},t}}function Be(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function Gt(e,t){switch(t){case 2:return function(i){return this.fromWireType(p[i>>2])};case 3:return function(i){return this.fromWireType(P[i>>3])};default:throw new TypeError("Unknown float type: "+e)}}function Ht(e,t,i){switch(t){case 0:return i?function(u){return fe[u]}:function(u){return o[u]};case 1:return i?function(u){return n[u>>1]}:function(u){return s[u>>1]};case 2:return i?function(u){return a[u>>2]}:function(u){return c[u>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function xe(e){return e||z("Cannot use deleted val. handle = "+e),ne[e].value}function _t(e,t){var i=be[e];return i===void 0&&z(t+" has unknown type "+vt(e)),i}for(var Vt={},wt=Array(256),Ge=0;256>Ge;++Ge)wt[Ge]=String.fromCharCode(Ge);lt=wt,Ee=r.BindingError=Ke("BindingError"),mt=r.InternalError=Ke("InternalError"),ye.prototype.isAliasOf=function(e){if(!(this instanceof ye&&e instanceof ye))return!1;var t=this.a.f.b,i=this.a.c,u=e.a.f.b;for(e=e.a.c;t.i;)i=t.w(i),t=t.i;for(;u.i;)e=u.w(e),u=u.i;return t===u&&i===e},ye.prototype.clone=function(){if(this.a.c||Ye(this),this.a.v)return this.a.count.value+=1,this;var e=this.a;return e=Object.create(Object.getPrototypeOf(this),{a:{value:{count:e.count,s:e.s,v:e.v,c:e.c,f:e.f,g:e.g,h:e.h}}}),e.a.count.value+=1,e.a.s=!1,e},ye.prototype.delete=function(){if(this.a.c||Ye(this),this.a.s&&!this.a.v&&z("Object already scheduled for deletion"),--this.a.count.value,this.a.count.value===0){var e=this.a;e.g?e.h.o(e.g):e.f.b.o(e.c)}this.a.v||(this.a.g=void 0,this.a.c=void 0)},ye.prototype.isDeleted=function(){return!this.a.c},ye.prototype.deleteLater=function(){return this.a.c||Ye(this),this.a.s&&!this.a.v&&z("Object already scheduled for deletion"),Ie.push(this),Ie.length===1&&ke&&ke(Je),this.a.s=!0,this},pe.prototype.U=function(e){return this.M&&(e=this.M(e)),e},pe.prototype.K=function(e){this.o&&this.o(e)},pe.prototype.argPackAdvance=8,pe.prototype.readValueFromPointer=qe,pe.prototype.deleteObject=function(e){e!==null&&e.delete()},pe.prototype.fromWireType=function(e){function t(){return this.D?Ne(this.b.u,{f:this.Y,c:i,h:this,g:e}):Ne(this.b.u,{f:this,c:e})}var i=this.U(e);if(!i)return this.K(e),null;var u=Ut(this.b,i);if(u!==void 0)return u.a.count.value===0?(u.a.c=i,u.a.g=e,u.clone()):(u=u.clone(),this.K(e),u);if(u=this.b.T(i),u=pt[u],!u)return t.call(this);u=this.C?u.R:u.pointerType;var l=yt(i,this.b,u.b);return l===null?t.call(this):this.D?Ne(u.b.u,{f:u,c:l,h:this,g:e}):Ne(u.b.u,{f:u,c:l})},r.getInheritedInstanceCount=function(){return Object.keys(We).length},r.getLiveInheritedInstances=function(){var e=[],t;for(t in We)We.hasOwnProperty(t)&&e.push(We[t]);return e},r.flushPendingDeletes=Je,r.setDelayFunction=function(e){ke=e,Ie.length&&ke&&ke(Je)},dt=r.UnboundTypeError=Ke("UnboundTypeError"),r.count_emval_handles=function(){for(var e=0,t=5;t<ne.length;++t)ne[t]!==void 0&&++e;return e},r.get_first_emval=function(){for(var e=5;e<ne.length;++e)if(ne[e]!==void 0)return ne[e];return null};var Xt=d;d=d+4+15&-16,ie=Xt,F=Z=ee(d),M=F+Pe,le=ee(M),a[ie>>2]=le,r.wasmTableSize=83,r.wasmMaxTableSize=83,r.N={},r.O={abort:he,enlargeMemory:function(){oe()},getTotalMemory:function(){return N},abortOnCannotGrowMemory:oe,___setErrNo:function(e){return r.___errno_location&&(a[r.___errno_location()>>2]=e),e},___syscall140:function(e,t){Ce=t;try{var i=ft.V();we();var u=we(),l=we(),h=we();return FS.ea(i,u,h),a[l>>2]=i.position,i.W&&u===0&&h===0&&(i.W=null),0}catch(A){return typeof FS<"u"&&A instanceof FS.I||he(A),-A.L}},___syscall146:Te,___syscall54:function(e,t){return Ce=t,0},___syscall6:function(e,t){Ce=t;try{var i=ft.V();return FS.close(i),0}catch(u){return typeof FS<"u"&&u instanceof FS.I||he(u),-u.L}},__embind_register_bool:function(e,t,i,u,l){var h=He(i);t=re(t),me(e,{name:t,fromWireType:function(A){return!!A},toWireType:function(A,m){return m?u:l},argPackAdvance:8,readValueFromPointer:function(A){if(i===1)var m=fe;else if(i===2)m=n;else if(i===4)m=a;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(m[A>>h])},l:null})},__embind_register_class:function(e,t,i,u,l,h,A,m,T,v,f,g,y){f=re(f),h=Fe(l,h),m&&(m=Fe(A,m)),v&&(v=Fe(T,v)),y=Fe(g,y);var K=Ve(f);kt(K,function(){Ze("Cannot construct "+f+" due to unbound types",[u])}),ze([e,t,i],u?[u]:[],function(S){if(S=S[0],u)var L=S.b,E=L.u;else E=ye.prototype;S=Xe(K,function(){if(Object.getPrototypeOf(this)!==se)throw new Ee("Use 'new' to construct "+f);if(Q.m===void 0)throw new Ee(f+" has no accessible constructor");var Ae=Q.m[arguments.length];if(Ae===void 0)throw new Ee("Tried to invoke ctor of "+f+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Q.m).toString()+") parameters instead!");return Ae.apply(this,arguments)});var se=Object.create(E,{constructor:{value:S}});S.prototype=se;var Q=new It(f,S,se,y,L,h,m,v);L=new pe(f,Q,!0,!1,!1),E=new pe(f+"*",Q,!1,!1,!1);var Oe=new pe(f+" const*",Q,!1,!0,!1);return pt[e]={pointerType:E,R:Oe},qt(K,S),[L,E,Oe]})},__embind_register_class_constructor:function(e,t,i,u,l,h){var A=gt(t,i);l=Fe(u,l),ze([],[e],function(m){m=m[0];var T="constructor "+m.name;if(m.b.m===void 0&&(m.b.m=[]),m.b.m[t-1]!==void 0)throw new Ee("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+m.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return m.b.m[t-1]=function(){Ze("Cannot construct "+m.name+" due to unbound types",A)},ze([],A,function(v){return m.b.m[t-1]=function(){arguments.length!==t-1&&z(T+" called with "+arguments.length+" arguments, expected "+(t-1));var f=[],g=Array(t);g[0]=h;for(var y=1;y<t;++y)g[y]=v[y].toWireType(f,arguments[y-1]);return g=l.apply(null,g),Qe(f),v[0].fromWireType(g)},[]}),[]})},__embind_register_class_function:function(e,t,i,u,l,h,A,m){var T=gt(i,u);t=re(t),h=Fe(l,h),ze([],[e],function(v){function f(){Ze("Cannot call "+g+" due to unbound types",T)}v=v[0];var g=v.name+"."+t;m&&v.b.Z.push(t);var y=v.b.u,K=y[t];return K===void 0||K.j===void 0&&K.className!==v.name&&K.A===i-2?(f.A=i-2,f.className=v.name,y[t]=f):(ht(y,t,g),y[t].j[i-2]=f),ze([],T,function(S){var L=g,E=v,se=h,Q=S.length;2>Q&&z("argTypes array size mismatch! Must at least get return value and 'this' types!");var Oe=S[1]!==null&&E!==null,Ae=!1;for(E=1;E<S.length;++E)if(S[E]!==null&&S[E].l===void 0){Ae=!0;break}var St=S[0].name!=="void",Se="",Re="";for(E=0;E<Q-2;++E)Se+=(E!==0?", ":"")+"arg"+E,Re+=(E!==0?", ":"")+"arg"+E+"Wired";L="return function "+Ve(L)+"("+Se+`) {
if (arguments.length !== `+(Q-2)+`) {
throwBindingError('function `+L+" called with ' + arguments.length + ' arguments, expected "+(Q-2)+` args!');
}
`,Ae&&(L+=`var destructors = [];
`);var Ct=Ae?"destructors":"null";for(Se="throwBindingError invoker fn runDestructors retType classParam".split(" "),se=[z,se,A,Qe,S[0],S[1]],Oe&&(L+="var thisWired = classParam.toWireType("+Ct+`, this);
`),E=0;E<Q-2;++E)L+="var arg"+E+"Wired = argType"+E+".toWireType("+Ct+", arg"+E+"); // "+S[E+2].name+`
`,Se.push("argType"+E),se.push(S[E+2]);if(Oe&&(Re="thisWired"+(0<Re.length?", ":"")+Re),L+=(St?"var rv = ":"")+"invoker(fn"+(0<Re.length?", ":"")+Re+`);
`,Ae)L+=`runDestructors(destructors);
`;else for(E=Oe?1:2;E<S.length;++E)Q=E===1?"thisWired":"arg"+(E-2)+"Wired",S[E].l!==null&&(L+=Q+"_dtor("+Q+"); // "+S[E].name+`
`,Se.push(Q+"_dtor"),se.push(S[E].l));return St&&(L+=`var ret = retType.fromWireType(rv);
return ret;
`),Se.push(L+`}
`),S=Nt(Se).apply(null,se),y[t].j===void 0?(S.A=i-2,y[t]=S):y[t].j[i-2]=S,[]}),[]})},__embind_register_emval:function(e,t){t=re(t),me(e,{name:t,fromWireType:function(i){var u=ne[i].value;return tt(i),u},toWireType:function(i,u){return de(u)},argPackAdvance:8,readValueFromPointer:qe,l:null})},__embind_register_float:function(e,t,i){i=He(i),t=re(t),me(e,{name:t,fromWireType:function(u){return u},toWireType:function(u,l){if(typeof l!="number"&&typeof l!="boolean")throw new TypeError('Cannot convert "'+Be(l)+'" to '+this.name);return l},argPackAdvance:8,readValueFromPointer:Gt(t,i),l:null})},__embind_register_integer:function(e,t,i,u,l){function h(v){return v}t=re(t),l===-1&&(l=4294967295);var A=He(i);if(u===0){var m=32-8*i;h=function(v){return v<<m>>>m}}var T=t.indexOf("unsigned")!=-1;me(e,{name:t,fromWireType:h,toWireType:function(v,f){if(typeof f!="number"&&typeof f!="boolean")throw new TypeError('Cannot convert "'+Be(f)+'" to '+this.name);if(f<u||f>l)throw new TypeError('Passing a number "'+Be(f)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+u+", "+l+"]!");return T?f>>>0:f|0},argPackAdvance:8,readValueFromPointer:Ht(t,A,u!==0),l:null})},__embind_register_memory_view:function(e,t,i){function u(h){h>>=2;var A=c;return new l(A.buffer,A[h+1],A[h])}var l=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];i=re(i),me(e,{name:i,fromWireType:u,argPackAdvance:8,readValueFromPointer:u},{X:!0})},__embind_register_std_string:function(e,t){t=re(t),me(e,{name:t,fromWireType:function(i){for(var u=c[i>>2],l=Array(u),h=0;h<u;++h)l[h]=String.fromCharCode(o[i+4+h]);return ve(i),l.join("")},toWireType:function(i,u){function l(g,y){return g[y]}function h(g,y){return g.charCodeAt(y)}u instanceof ArrayBuffer&&(u=new Uint8Array(u));var A;u instanceof Uint8Array||u instanceof Uint8ClampedArray||u instanceof Int8Array?A=l:typeof u=="string"?A=h:z("Cannot pass non-string to std::string");var m=u.length,T=At(4+m);c[T>>2]=m;for(var v=0;v<m;++v){var f=A(u,v);255<f&&(ve(T),z("String has UTF-16 code units that do not fit in 8 bits")),o[T+4+v]=f}return i!==null&&i.push(ve,T),T},argPackAdvance:8,readValueFromPointer:qe,l:function(i){ve(i)}})},__embind_register_std_wstring:function(e,t,i){if(i=re(i),t===2)var u=function(){return s},l=1;else t===4&&(u=function(){return c},l=2);me(e,{name:i,fromWireType:function(h){for(var A=u(),m=c[h>>2],T=Array(m),v=h+4>>l,f=0;f<m;++f)T[f]=String.fromCharCode(A[v+f]);return ve(h),T.join("")},toWireType:function(h,A){var m=u(),T=A.length,v=At(4+T*t);c[v>>2]=T;for(var f=v+4>>l,g=0;g<T;++g)m[f+g]=A.charCodeAt(g);return h!==null&&h.push(ve,v),v},argPackAdvance:8,readValueFromPointer:qe,l:function(h){ve(h)}})},__embind_register_void:function(e,t){t=re(t),me(e,{da:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},__emval_as:function(e,t,i){e=xe(e),t=_t(t,"emval::as");var u=[],l=de(u);return a[i>>2]=l,t.toWireType(u,e)},__emval_decref:tt,__emval_get_property:function(e,t){return e=xe(e),t=xe(t),de(e[t])},__emval_incref:function(e){4<e&&(ne[e].H+=1)},__emval_new_array:function(){return de([])},__emval_new_cstring:function(e){var t=Vt[e];return de(t===void 0?re(e):t)},__emval_new_object:function(){return de({})},__emval_run_destructors:function(e){Qe(ne[e].value),tt(e)},__emval_set_property:function(e,t,i){e=xe(e),t=xe(t),i=xe(i),e[t]=i},__emval_take_value:function(e,t){return e=_t(e,"_emval_take_value"),e=e.readValueFromPointer(t),de(e)},_abort:function(){r.abort()},_emscripten_memcpy_big:function(e,t,i){return o.set(o.subarray(t,t+i),e),e},_llvm_cos_f32:jt,_llvm_log10_f32:function(e){return Math.log(e)/Math.LN10},_llvm_sin_f32:zt,DYNAMICTOP_PTR:ie,STACKTOP:Z};var bt=r.asm(r.N,r.O,H);r.asm=bt;var Kt=r.__GLOBAL__sub_I_bind_cpp=function(){return r.asm.__GLOBAL__sub_I_bind_cpp.apply(null,arguments)},Yt=r.__GLOBAL__sub_I_fft_cc=function(){return r.asm.__GLOBAL__sub_I_fft_cc.apply(null,arguments)},Jt=r.__GLOBAL__sub_I_pitch_cc=function(){return r.asm.__GLOBAL__sub_I_pitch_cc.apply(null,arguments)},$t=r.__GLOBAL__sub_I_tempo_cc=function(){return r.asm.__GLOBAL__sub_I_tempo_cc.apply(null,arguments)},Zt=r.___getTypeName=function(){return r.asm.___getTypeName.apply(null,arguments)},ve=r._free=function(){return r.asm._free.apply(null,arguments)},At=r._malloc=function(){return r.asm._malloc.apply(null,arguments)};r.dynCall_ffii=function(){return r.asm.dynCall_ffii.apply(null,arguments)},r.dynCall_fi=function(){return r.asm.dynCall_fi.apply(null,arguments)},r.dynCall_fii=function(){return r.asm.dynCall_fii.apply(null,arguments)},r.dynCall_fiii=function(){return r.asm.dynCall_fiii.apply(null,arguments)},r.dynCall_ii=function(){return r.asm.dynCall_ii.apply(null,arguments)},r.dynCall_iii=function(){return r.asm.dynCall_iii.apply(null,arguments)},r.dynCall_iiii=function(){return r.asm.dynCall_iiii.apply(null,arguments)},r.dynCall_iiiii=function(){return r.asm.dynCall_iiiii.apply(null,arguments)},r.dynCall_iiiiii=function(){return r.asm.dynCall_iiiiii.apply(null,arguments)},r.dynCall_v=function(){return r.asm.dynCall_v.apply(null,arguments)},r.dynCall_vi=function(){return r.asm.dynCall_vi.apply(null,arguments)},r.dynCall_viii=function(){return r.asm.dynCall_viii.apply(null,arguments)},r.asm=bt,r.then=function(e){if(r.calledRun)e(r);else{var t=r.onRuntimeInitialized;r.onRuntimeInitialized=function(){t&&t(),e(r)}}return r},je=function e(){r.calledRun||rt(),r.calledRun||(je=e)};function rt(){function e(){if(!r.calledRun&&(r.calledRun=!0,!ce)){if(ct||(ct=!0,J(ue)),J(Rt),r.onRuntimeInitialized&&r.onRuntimeInitialized(),r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;){var t=r.postRun.shift();st.unshift(t)}J(st)}}if(!(0<_e)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Pt();J(te),0<_e||r.calledRun||(r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),e()},1)):e())}}r.run=rt;function he(e){throw r.onAbort&&r.onAbort(e),e!==void 0?(G(e),D(e),e=JSON.stringify(e)):e="",ce=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(r.abort=he,r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);0<r.preInit.length;)r.preInit.pop()();return r.noExitRuntime=!0,rt(),_};const ur=or.bind({_currentScript:{src:"/aubio.js"}});var xt={exports:{}},nt,Mt;function sr(){if(Mt)return nt;Mt=1;var _=null,r=function(B){_=_||{},_[B]=new Array(B*B);for(var U=Math.PI/B,C=0;C<B;C++)for(var I=0;I<B;I++)_[B][I+C*B]=Math.cos(U*(I+.5)*C)};function q(B,U){var C=B.length;U=U||2,(!_||!_[C])&&r(C);var I=B.map(function(){return 0});return I.map(function(V,Y){return U*B.reduce(function(X,W,w,k){return X+W*_[C][w+Y*C]},0)})}return nt=q,nt}var at,Et;function cr(){return Et||(Et=1,at=sr()),at}var it,Ft;function fr(){if(Ft)return it;Ft=1;function _(W){if(Array.isArray(W)){for(var w=0,k=Array(W.length);w<W.length;w++)k[w]=W[w];return k}else return Array.from(W)}var r={},q={},B=function(w){var k={};k.real=w.real===void 0?w.slice():w.real.slice();var G=k.real.length;return q[G]===void 0&&(q[G]=Array.apply(null,Array(G)).map(Number.prototype.valueOf,0)),k.imag=q[G].slice(),k},U=function(w){if(r[w]===void 0){for(var k=(w-1).toString(2).length,G="0".repeat(k),D={},ee=0;ee<w;ee++){var $=ee.toString(2);$=G.substr($.length)+$,$=[].concat(_($)).reverse().join(""),D[ee]=parseInt($,2)}r[w]=D}return r[w]},C=function(w,k){return{real:w.real*k.real-w.imag*k.imag,imag:w.real*k.imag+w.imag*k.real}},I=function(w,k){return{real:w.real+k.real,imag:w.imag+k.imag}},V=function(w,k){return{real:w.real-k.real,imag:w.imag-k.imag}},Y=function(w,k){var G=-2*Math.PI*w/k;return{real:Math.cos(G),imag:Math.sin(G)}},X=function(w){return w.imag*=-1,w};return it={bitReverseArray:U,multiply:C,add:I,subtract:V,euler:Y,conj:X,constructComplexArray:B},it}var ot,Bt;function lr(){if(Bt)return ot;Bt=1;var _=fr(),r=function(U){var C={};U.real===void 0||U.imag===void 0?C=_.constructComplexArray(U):(C.real=U.real.slice(),C.imag=U.imag.slice());var I=C.real.length,V=Math.log2(I);if(Math.round(V)!=V)throw new Error("Input size must be a power of 2.");if(C.real.length!=C.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var Y=_.bitReverseArray(I),X={real:[],imag:[]},W=0;W<I;W++)X.real[Y[W]]=C.real[W],X.imag[Y[W]]=C.imag[W];for(var w=0;w<I;w++)C.real[w]=X.real[w],C.imag[w]=X.imag[w];for(var k=1;k<=V;k++)for(var G=Math.pow(2,k),D=0;D<G/2;D++)for(var ee=_.euler(D,G),$=0;$<I/G;$++){var ce=G*$+D,ae=G*$+D+G/2,ge={real:C.real[ce],imag:C.imag[ce]},H={real:C.real[ae],imag:C.imag[ae]},fe=_.multiply(ee,H),o=_.subtract(ge,fe);C.real[ae]=o.real,C.imag[ae]=o.imag;var n=_.add(fe,ge);C.real[ce]=n.real,C.imag[ce]=n.imag}return C},q=function(U){if(U.real===void 0||U.imag===void 0)throw new Error("IFFT only accepts a complex input.");for(var C=U.real.length,I={real:[],imag:[]},V=0;V<C;V++){var Y={real:U.real[V],imag:U.imag[V]},X=_.conj(Y);I.real[V]=X.real,I.imag[V]=X.imag}var W=r(I);return I.real=W.real.map(function(w){return w/C}),I.imag=W.imag.map(function(w){return w/C}),I};return ot={fft:r,ifft:q},ot}(function(_,r){(function(q,B){_.exports=B(cr(),lr())})(tr,function(q,B){function U(o,n,s){if(s||arguments.length===2)for(var a,c=0,p=n.length;c<p;c++)!a&&c in n||(a||(a=Array.prototype.slice.call(n,0,c)),a[c]=n[c]);return o.concat(a||Array.prototype.slice.call(n))}var C=Object.freeze({__proto__:null,blackman:function(o){for(var n=new Float32Array(o),s=2*Math.PI/(o-1),a=2*s,c=0;c<o/2;c++)n[c]=.42-.5*Math.cos(c*s)+.08*Math.cos(c*a);for(c=Math.ceil(o/2);c>0;c--)n[o-c]=n[c-1];return n},hamming:function(o){for(var n=new Float32Array(o),s=0;s<o;s++)n[s]=.54-.46*Math.cos(2*Math.PI*(s/o-1));return n},hanning:function(o){for(var n=new Float32Array(o),s=0;s<o;s++)n[s]=.5-.5*Math.cos(2*Math.PI*s/(o-1));return n},sine:function(o){for(var n=Math.PI/(o-1),s=new Float32Array(o),a=0;a<o;a++)s[a]=Math.sin(n*a);return s}}),I={};function V(o){for(;o%2==0&&o>1;)o/=2;return o===1}function Y(o,n){if(n!=="rect"){if(n!==""&&n||(n="hanning"),I[n]||(I[n]={}),!I[n][o.length])try{I[n][o.length]=C[n](o.length)}catch{throw new Error("Invalid windowing function")}o=function(s,a){for(var c=[],p=0;p<Math.min(s.length,a.length);p++)c[p]=s[p]*a[p];return c}(o,I[n][o.length])}return o}function X(o,n,s){for(var a=new Float32Array(o),c=0;c<a.length;c++)a[c]=c*n/s,a[c]=13*Math.atan(a[c]/1315.8)+3.5*Math.atan(Math.pow(a[c]/7518,2));return a}function W(o){return Float32Array.from(o)}function w(o){return 1125*Math.log(1+o/700)}function k(o,n,s){for(var a,c=new Float32Array(o+2),p=new Float32Array(o+2),P=n/2,j=w(0),b=(w(P)-j)/(o+1),d=new Array(o+2),F=0;F<c.length;F++)c[F]=F*b,p[F]=(a=c[F],700*(Math.exp(a/1125)-1)),d[F]=Math.floor((s+1)*p[F]/n);for(var Z=new Array(o),M=0;M<Z.length;M++){for(Z[M]=new Array(s/2+1).fill(0),F=d[M];F<d[M+1];F++)Z[M][F]=(F-d[M])/(d[M+1]-d[M]);for(F=d[M+1];F<d[M+2];F++)Z[M][F]=(d[M+2]-F)/(d[M+2]-d[M+1])}return Z}function G(o,n,s,a,c,p,P){a===void 0&&(a=5),c===void 0&&(c=2),p===void 0&&(p=!0),P===void 0&&(P=440);var j=Math.floor(s/2)+1,b=new Array(s).fill(0).map(function(N,J){return o*function(te,ue){return Math.log2(16*te/ue)}(n*J/s,P)});b[0]=b[1]-1.5*o;var d,F,Z,M=b.slice(1).map(function(N,J){return Math.max(N-b[J])},1).concat([1]),le=Math.round(o/2),ie=new Array(o).fill(0).map(function(N,J){return b.map(function(te){return(10*o+le+te-J)%o-le})}),oe=ie.map(function(N,J){return N.map(function(te,ue){return Math.exp(-.5*Math.pow(2*ie[J][ue]/M[ue],2))})});if(F=(d=oe)[0].map(function(){return 0}),Z=d.reduce(function(N,J){return J.forEach(function(te,ue){N[ue]+=Math.pow(te,2)}),N},F).map(Math.sqrt),oe=d.map(function(N,J){return N.map(function(te,ue){return te/(Z[ue]||1)})}),c){var Pe=b.map(function(N){return Math.exp(-.5*Math.pow((N/o-a)/c,2))});oe=oe.map(function(N){return N.map(function(J,te){return J*Pe[te]})})}return p&&(oe=U(U([],oe.slice(3),!0),oe.slice(0,3),!0)),oe.map(function(N){return N.slice(0,j)})}function D(o,n){for(var s=0,a=0,c=0;c<n.length;c++)s+=Math.pow(c,o)*Math.abs(n[c]),a+=n[c];return s/a}function ee(o){var n=o.ampSpectrum,s=o.barkScale,a=o.numberOfBarkBands,c=a===void 0?24:a;if(typeof n!="object"||typeof s!="object")throw new TypeError;var p=c,P=new Float32Array(p),j=0,b=n,d=new Int32Array(p+1);d[0]=0;for(var F=s[b.length-1]/p,Z=1,M=0;M<b.length;M++)for(;s[M]>F;)d[Z++]=M,F=Z*s[b.length-1]/p;for(d[p]=b.length-1,M=0;M<p;M++){for(var le=0,ie=d[M];ie<d[M+1];ie++)le+=b[ie];P[M]=Math.pow(le,.23)}for(M=0;M<P.length;M++)j+=P[M];return{specific:P,total:j}}function $(o){var n=o.ampSpectrum;if(typeof n!="object")throw new TypeError;for(var s=new Float32Array(n.length),a=0;a<s.length;a++)s[a]=Math.pow(n[a],2);return s}function ce(o){var n=o.ampSpectrum,s=o.melFilterBank,a=o.bufferSize;if(typeof n!="object")throw new TypeError("Valid ampSpectrum is required to generate melBands");if(typeof s!="object")throw new TypeError("Valid melFilterBank is required to generate melBands");for(var c=$({ampSpectrum:n}),p=s.length,P=Array(p),j=new Float32Array(p),b=0;b<j.length;b++){P[b]=new Float32Array(a/2),j[b]=0;for(var d=0;d<a/2;d++)P[b][d]=s[b][d]*c[d],j[b]+=P[b][d];j[b]=Math.log(j[b]+1)}return Array.prototype.slice.call(j)}var ae=Object.freeze({__proto__:null,amplitudeSpectrum:function(o){return o.ampSpectrum},buffer:function(o){return o.signal},chroma:function(o){var n=o.ampSpectrum,s=o.chromaFilterBank;if(typeof n!="object")throw new TypeError("Valid ampSpectrum is required to generate chroma");if(typeof s!="object")throw new TypeError("Valid chromaFilterBank is required to generate chroma");var a=s.map(function(p,P){return n.reduce(function(j,b,d){return j+b*p[d]},0)}),c=Math.max.apply(Math,a);return c?a.map(function(p){return p/c}):a},complexSpectrum:function(o){return o.complexSpectrum},energy:function(o){var n=o.signal;if(typeof n!="object")throw new TypeError;for(var s=0,a=0;a<n.length;a++)s+=Math.pow(Math.abs(n[a]),2);return s},loudness:ee,melBands:ce,mfcc:function(o){var n=o.ampSpectrum,s=o.melFilterBank,a=o.numberOfMFCCCoefficients,c=o.bufferSize,p=Math.min(40,Math.max(1,a||13));if(s.length<p)throw new Error("Insufficient filter bank for requested number of coefficients");var P=ce({ampSpectrum:n,melFilterBank:s,bufferSize:c});return q(P).slice(0,p)},perceptualSharpness:function(o){for(var n=ee({ampSpectrum:o.ampSpectrum,barkScale:o.barkScale}),s=n.specific,a=0,c=0;c<s.length;c++)a+=c<15?(c+1)*s[c+1]:.066*Math.exp(.171*(c+1));return a*=.11/n.total},perceptualSpread:function(o){for(var n=ee({ampSpectrum:o.ampSpectrum,barkScale:o.barkScale}),s=0,a=0;a<n.specific.length;a++)n.specific[a]>s&&(s=n.specific[a]);return Math.pow((n.total-s)/n.total,2)},powerSpectrum:$,rms:function(o){var n=o.signal;if(typeof n!="object")throw new TypeError;for(var s=0,a=0;a<n.length;a++)s+=Math.pow(n[a],2);return s/=n.length,s=Math.sqrt(s)},spectralCentroid:function(o){var n=o.ampSpectrum;if(typeof n!="object")throw new TypeError;return D(1,n)},spectralCrest:function(o){var n=o.ampSpectrum;if(typeof n!="object")throw new TypeError;var s=0,a=-1/0;return n.forEach(function(c){s+=Math.pow(c,2),a=c>a?c:a}),s/=n.length,s=Math.sqrt(s),a/s},spectralFlatness:function(o){var n=o.ampSpectrum;if(typeof n!="object")throw new TypeError;for(var s=0,a=0,c=0;c<n.length;c++)s+=Math.log(n[c]),a+=n[c];return Math.exp(s/n.length)*n.length/a},spectralFlux:function(o){var n=o.signal,s=o.previousSignal,a=o.bufferSize;if(typeof n!="object"||typeof s!="object")throw new TypeError;for(var c=0,p=-a/2;p<n.length/2-1;p++)x=Math.abs(n[p])-Math.abs(s[p]),c+=(x+Math.abs(x))/2;return c},spectralKurtosis:function(o){var n=o.ampSpectrum;if(typeof n!="object")throw new TypeError;var s=n,a=D(1,s),c=D(2,s),p=D(3,s),P=D(4,s);return(-3*Math.pow(a,4)+6*a*c-4*a*p+P)/Math.pow(Math.sqrt(c-Math.pow(a,2)),4)},spectralRolloff:function(o){var n=o.ampSpectrum,s=o.sampleRate;if(typeof n!="object")throw new TypeError;for(var a=n,c=s/(2*(a.length-1)),p=0,P=0;P<a.length;P++)p+=a[P];for(var j=.99*p,b=a.length-1;p>j&&b>=0;)p-=a[b],--b;return(b+1)*c},spectralSkewness:function(o){var n=o.ampSpectrum;if(typeof n!="object")throw new TypeError;var s=D(1,n),a=D(2,n),c=D(3,n);return(2*Math.pow(s,3)-3*s*a+c)/Math.pow(Math.sqrt(a-Math.pow(s,2)),3)},spectralSlope:function(o){var n=o.ampSpectrum,s=o.sampleRate,a=o.bufferSize;if(typeof n!="object")throw new TypeError;for(var c=0,p=0,P=new Float32Array(n.length),j=0,b=0,d=0;d<n.length;d++){c+=n[d];var F=d*s/a;P[d]=F,j+=F*F,p+=F,b+=F*n[d]}return(n.length*b-p*c)/(c*(j-Math.pow(p,2)))},spectralSpread:function(o){var n=o.ampSpectrum;if(typeof n!="object")throw new TypeError;return Math.sqrt(D(2,n)-Math.pow(D(1,n),2))},zcr:function(o){var n=o.signal;if(typeof n!="object")throw new TypeError;for(var s=0,a=1;a<n.length;a++)(n[a-1]>=0&&n[a]<0||n[a-1]<0&&n[a]>=0)&&s++;return s}}),ge=function(){function o(n,s){var a=this;if(this._m=s,!n.audioContext)throw this._m.errors.noAC;if(n.bufferSize&&!V(n.bufferSize))throw this._m._errors.notPow2;if(!n.source)throw this._m._errors.noSource;this._m.audioContext=n.audioContext,this._m.bufferSize=n.bufferSize||this._m.bufferSize||256,this._m.hopSize=n.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=n.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=n.callback,this._m.windowingFunction=n.windowingFunction||"hanning",this._m.featureExtractors=ae,this._m.EXTRACTION_STARTED=n.startImmediately||!1,this._m.channel=typeof n.channel=="number"?n.channel:0,this._m.inputs=n.inputs||1,this._m.outputs=n.outputs||1,this._m.numberOfMFCCCoefficients=n.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.numberOfBarkBands=n.numberOfBarkBands||this._m.numberOfBarkBands||24,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=n.featureExtractors||[],this._m.barkScale=X(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=k(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(n.source),this._m.spn.onaudioprocess=function(c){var p;a._m.inputData!==null&&(a._m.previousInputData=a._m.inputData),a._m.inputData=c.inputBuffer.getChannelData(a._m.channel),a._m.previousInputData?((p=new Float32Array(a._m.previousInputData.length+a._m.inputData.length-a._m.hopSize)).set(a._m.previousInputData.slice(a._m.hopSize)),p.set(a._m.inputData,a._m.previousInputData.length-a._m.hopSize)):p=a._m.inputData;var P=function(j,b,d){if(j.length<b)throw new Error("Buffer is too short for frame length");if(d<1)throw new Error("Hop length cannot be less that 1");if(b<1)throw new Error("Frame length cannot be less that 1");var F=1+Math.floor((j.length-b)/d);return new Array(F).fill(0).map(function(Z,M){return j.slice(M*d,M*d+b)})}(p,a._m.bufferSize,a._m.hopSize);P.forEach(function(j){a._m.frame=j;var b=a._m.extract(a._m._featuresToExtract,a._m.frame,a._m.previousFrame);typeof a._m.callback=="function"&&a._m.EXTRACTION_STARTED&&a._m.callback(b),a._m.previousFrame=a._m.frame})}}return o.prototype.start=function(n){this._m._featuresToExtract=n||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0},o.prototype.stop=function(){this._m.EXTRACTION_STARTED=!1},o.prototype.setSource=function(n){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=n,this._m.source.connect(this._m.spn)},o.prototype.setChannel=function(n){n<=this._m.inputs?this._m.channel=n:console.error("Channel ".concat(n," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(n," when instantiating the MeydaAnalyzer"))},o.prototype.get=function(n){return this._m.inputData?this._m.extract(n||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null},o}(),H={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:ae,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,numberOfBarkBands:24,_featuresToExtract:[],windowing:Y,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(o){return new ge(o,Object.assign({},H))},listAvailableFeatureExtractors:function(){return Object.keys(this.featureExtractors)},extract:function(o,n,s){var a=this;if(!n)throw this._errors.invalidInput;if(typeof n!="object")throw this._errors.invalidInput;if(!o)throw this._errors.featureUndef;if(!V(n.length))throw this._errors.notPow2;this.barkScale!==void 0&&this.barkScale.length==this.bufferSize||(this.barkScale=X(this.bufferSize,this.sampleRate,this.bufferSize)),this.melFilterBank!==void 0&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=k(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),this.chromaFilterBank!==void 0&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=G(this.chromaBands,this.sampleRate,this.bufferSize)),"buffer"in n&&n.buffer===void 0?this.signal=W(n):this.signal=n;var c=fe(n,this.windowingFunction,this.bufferSize);if(this.signal=c.windowedSignal,this.complexSpectrum=c.complexSpectrum,this.ampSpectrum=c.ampSpectrum,s){var p=fe(s,this.windowingFunction,this.bufferSize);this.previousSignal=p.windowedSignal,this.previousComplexSpectrum=p.complexSpectrum,this.previousAmpSpectrum=p.ampSpectrum}var P=function(j){return a.featureExtractors[j]({ampSpectrum:a.ampSpectrum,chromaFilterBank:a.chromaFilterBank,complexSpectrum:a.complexSpectrum,signal:a.signal,bufferSize:a.bufferSize,sampleRate:a.sampleRate,barkScale:a.barkScale,melFilterBank:a.melFilterBank,previousSignal:a.previousSignal,previousAmpSpectrum:a.previousAmpSpectrum,previousComplexSpectrum:a.previousComplexSpectrum,numberOfMFCCCoefficients:a.numberOfMFCCCoefficients,numberOfBarkBands:a.numberOfBarkBands})};if(typeof o=="object")return o.reduce(function(j,b){var d;return Object.assign({},j,((d={})[b]=P(b),d))},{});if(typeof o=="string")return P(o);throw this._errors.invalidFeatureFmt}},fe=function(o,n,s){var a={};o.buffer===void 0?a.signal=W(o):a.signal=o,a.windowedSignal=Y(a.signal,n),a.complexSpectrum=B.fft(a.windowedSignal),a.ampSpectrum=new Float32Array(s/2);for(var c=0;c<s/2;c++)a.ampSpectrum[c]=Math.sqrt(Math.pow(a.complexSpectrum.real[c],2)+Math.pow(a.complexSpectrum.imag[c],2));return a};return typeof window<"u"&&(window.Meyda=H),H})})(xt);var mr=xt.exports;const pr=rr(mr),hr=["C","C♯","D","D♯","E","F","F♯","G","G♯","A","A♯","B"],ut={middleA:440,semitone:69},R=ar({initiated:!1,stream:null,middleA:ut.middleA,semitone:ut.semitone,note:{name:"A",value:69,cents:0,octave:4,frequency:440,color:Ot(440),silent:!1},span:64,bufferSize:4096,tempoBufferSize:512,frequencyData:null,running:!1,frame:0,beat:0,bpm:0,confidence:0,listenBeat:!1,prevBeat:0,blink:!1,chroma:[0,0,0,0,0,0,0,0,0,0,0,0],aChroma:Tt(()=>nr(R.chroma,-3)),chromaAvg:Tt(()=>R.chroma.reduce((_,r)=>_+r,0)/12),spec:[],rms:0}),O={};function Mr(){return er(),{init:yr,tuner:R,chain:O}}function yr(){R.initiated||(O.audioContext=new window.AudioContext,O.analyser=O.audioContext.createAnalyser(),O.scriptProcessor=O.audioContext.createScriptProcessor(R.bufferSize,1,1),O.beatProcessor=O.audioContext.createScriptProcessor(R.tempoBufferSize,1,1),ir(()=>R.frame,()=>{R.listen&&R.beat>R.prevBeat&&(R.prevBeat=R.beat,R.blink=!0,setTimeout(()=>{R.blink=!1},60))}),O.meyda=pr.createMeydaAnalyzer({audioContext:O.audioContext,source:O.analyser,bufferSize:4096,featureExtractors:["chroma","amplitudeSpectrum","rms"],callback:_=>{R.rms=_.rms,R.chroma=_.chroma,R.spec=_.amplitudeSpectrum}}),O.meyda.start(),R.frequencyData=new Uint8Array(O.analyser.frequencyBinCount),ur().then(function(_){O.pitchDetector=new _.Pitch("default",R.bufferSize,1,O.audioContext.sampleRate),O.tempoAnalyzer=new _.Tempo(R.tempoBufferSize*4,R.tempoBufferSize,O.audioContext.sampleRate),R.running=!0,dr()}),R.initiated=!0)}function dr(){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(_){R.stream=_,O.audioContext.createMediaStreamSource(_).connect(O.analyser),O.analyser.connect(O.scriptProcessor),O.analyser.connect(O.beatProcessor),O.scriptProcessor.connect(O.audioContext.destination),O.beatProcessor.connect(O.audioContext.destination),O.beatProcessor.addEventListener("audioprocess",r=>{if(!O.tempoAnalyzer)return;O.tempoAnalyzer.do(r.inputBuffer.getChannelData(0))&&(R.beat++,R.confidence=O.tempoAnalyzer.getConfidence(),R.bpm=O.tempoAnalyzer.getBpm())}),O.scriptProcessor.addEventListener("audioprocess",function(r){if(!O.pitchDetector)return;const q=O.pitchDetector.do(r.inputBuffer.getChannelData(0));if(R.frame++,q){const B=vr(q);R.note={name:hr[B%12],value:B,cents:_r(q,B),octave:Math.floor(B/12)-1,frequency:q,color:Ot(q),silent:!1}}else R.note.silent=!0})}).catch(function(_){console.log(_.name+": "+_.message)})}function vr(_){const r=12*(Math.log(_/R.middleA)/Math.log(2));return Math.round(r)+R.semitone}function gr(_){return R.middleA*Math.pow(2,(_-R.semitone)/12)}function _r(_,r){return Math.floor(1200*Math.log(_/gr(r))/Math.log(2))}function Ot(_){const r=wr(_);if(!r)return"#333";const q=Math.floor(r/12)+2;return Qt(r,q)}function wr(_){return 12*(Math.log(_/ut.middleA)/Math.log(2))%12}export{Mr as u};
