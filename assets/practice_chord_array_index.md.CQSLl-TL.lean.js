import{u as P,F as j,p as A,n as k,a as F,s as q,m as O,b as D,c as E,g as T,r as M}from"./chunks/theme.DRfkbxnY.js";import{r as H,c as g,C as l,D as i,F as y,K as p,L as S,B as I,b as R,G as x,H as w,R as L,a0 as B,$ as N,P as U,Q as V,S as z,a5 as G}from"./chunks/framework.C3LH_Uf3.js";const J={class:"cursor-pointer"},K=["r","stroke-width","fill"],Q={style:{"user-select":"none","pointer-events":"none"},"font-size":"22px","text-anchor":"middle",fill:"white",x:0,y:8},Z={__name:"TonalArrayNote",props:{note:{type:Object,default:()=>{}},r:{type:Number,default:10},pressed:{type:Boolean,default:!1},available:{type:Boolean,default:!1},tonic:{type:Number,default:0}},emits:["update:pressed"],setup(a){const{midi:$}=P(),o=a,s=H(!1),v=g(()=>{let m=o.tonic>o.note.pitch?3:2;return j(A(o.note.pitch,m)).toNote()});function c(){s.value=!0,F(v.value)}function f(){s.value=!1,q(v.value)}return(m,e)=>{var n,u;return l(),i("g",J,[y("circle",{class:"transition-all duration-50",r:a.r,cx:0,cy:0,"stroke-width":a.tonic==a.note.pitch?4:a.available?2:0,stroke:"white",fill:p(k)(a.note.pitch,s.value||((n=p($).activeChroma)==null?void 0:n[a.note.pitch])>0?5:a.available?3:2,s.value||((u=p($).activeChroma)==null?void 0:u[a.note.pitch])>0?1:.4),onMousedown:e[0]||(e[0]=r=>c()),onTouchstart:e[1]||(e[1]=r=>c()),onMouseenter:e[2]||(e[2]=r=>a.pressed?c():null),onMouseup:e[3]||(e[3]=r=>f()),onMouseleave:e[4]||(e[4]=r=>f()),onTouchend:e[5]||(e[5]=r=>f()),onTouchcancel:e[6]||(e[6]=r=>f())},null,40,K),y("text",Q,S(a.note.name),1)])}}},W=["transform","fill","stroke-width"],X={__name:"TonalArrayTrigger",props:{pressed:Boolean,note:{type:Object,default:()=>{}},chord:{type:Object,default:()=>{}},p:{type:Number,default:0},activeSteps:{type:Array,default:()=>[]}},setup(a){const{midi:$}=P(),o=a,s=H(!1),v=g(()=>o.chord.map(u=>u+o.note.pitch)),c=g(()=>{let u=!0;return v.value.map(t=>t>11?t%12:t).forEach(t=>{o.activeSteps[t]!="1"&&(u=!1)}),u}),f=g(()=>{let u=!0;return v.value.map(t=>t>11?t%12:t).forEach(t=>{$.activeChroma[t]!="1"&&(u=!1)}),u}),m=g(()=>v.value.map(u=>j(A(u)).transpose(-12).toNote()));function e(){s.value=!0,F(m.value),O(m.value)}function n(){s.value=!1,q(m.value),D(m.value)}return(u,r)=>(l(),i("polygon",{class:"chord-trigger",style:{"mix-blend-mode":"screen"},transform:"rotate("+60*a.p+")",fill:p(k)(a.note.pitch,s.value||f.value?5:c.value?.5:-2,c.value?1:.2),opacity:1,"stroke-width":c.value?4:.5,stroke:"hsla(0,0%,100%,0.5)",points:"0,0 80,0 80,46.188 40,69.28",onMousedown:r[0]||(r[0]=t=>e()),onMouseenter:r[1]||(r[1]=t=>a.pressed?e():null),onTouchstart:r[2]||(r[2]=t=>e()),onMouseleave:r[3]||(r[3]=t=>n()),onMouseup:r[4]||(r[4]=t=>n()),onTouchend:r[5]||(r[5]=t=>n()),onTouchcancel:r[6]||(r[6]=t=>n())},null,40,W))}},Y=a=>(U("data-v-da805530"),a=a(),V(),a),ee=Y(()=>y("clipPath",{id:"grid-mask"},[y("rect",{x:-80,y:-110,width:1040,height:770})],-1)),te=["transform"],oe=["fill"],ne=["fill"],re={class:"chord-name","text-anchor":"middle",fill:"white",x:80,y:-40},ae={class:"chord-name","text-anchor":"middle",fill:"white",x:80,y:55},se=["transform"],le=["transform"],ie={__name:"TonalArray",setup(a){const $=[...E].map((e,n)=>({name:e,pitch:n})),o=R({pressed:!1,r:28,dx:80,rowNum:12,colNum:12,rows:[0,9,5,2,10],bgRows:[4,0,9,5,2,10,7],chords:[[0,3,7],[0,3,8],[0,5,8],[0,5,9],[0,4,9],[0,4,7]]}),s=g(()=>{let e=T.chroma.split("").map(Number);return M(e,-T.tonic)}),v=g(()=>o.dx*2*.866),c=g(()=>{let e=[];for(let n=0;n<12;n++)e[n]=$[7*n%12];return e});function f(e){return!s.value[e]||!s.value[(e+4)%12]||!s.value[(e+7)%12]}function m(e){return!s.value[e]||!s.value[(e+3)%12]||!s.value[(e+7)%12]}return(e,n)=>{const u=X,r=Z;return l(),i("svg",{class:"min-h-80svh max-h-100svh",id:"tonal-array",viewBox:"-80 -110 1040 770",version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none"},onTouchstart:n[1]||(n[1]=N(t=>o.pressed=!0,["stop","prevent"])),onTouchend:n[2]||(n[2]=N(t=>o.pressed=!1,["stop","prevent"])),onMousedown:n[3]||(n[3]=N(t=>o.pressed=!0,["stop","prevent"])),onMouseup:n[4]||(n[4]=N(t=>o.pressed=!1,["stop","prevent"])),onMouseleave:n[5]||(n[5]=t=>o.pressed=!1)},[ee,(l(!0),i(x,null,w(o.bgRows,(t,h)=>(l(),i("g",{key:t,"clip-path":"url(#grid-mask)"},[(l(!0),i(x,null,w(p(M)(c.value,t-1).splice(0,7),(d,b)=>(l(),i("g",{key:d,transform:`translate(${(b-1)*2*o.dx+(h+1)%2*o.dx}, ${(h-1)*v.value})`},[y("polygon",{class:"chord-triangle",fill:m(d.pitch)?p(k)(d.pitch,1,.2):p(k)(d.pitch,3),points:"0,0 160,0 80,138.56"},null,8,oe),y("polygon",{class:"chord-triangle major",fill:f(d.pitch)?p(k)(d.pitch,1,.2):p(k)(d.pitch,2),points:"0,0 160,0 80,-138.56"},null,8,ne),y("text",re,S(d.name)+"M",1),y("text",ae,S(d.name)+"m",1)],8,te))),128))]))),128)),(l(!0),i(x,null,w(o.rows,(t,h)=>(l(),i("g",{class:"cursor-crosshair",key:h},[(l(!0),i(x,null,w(p(M)(c.value,t).splice(0,7),(d,b)=>(l(),i("g",{key:d,transform:`translate(${b*2*o.dx+h%2*o.dx}, ${h*v.value})`},[(l(!0),i(x,null,w(o.chords,(_,C)=>(l(),L(u,{key:C,"active-steps":s.value,chord:_,p:C,note:d,pressed:o.pressed},null,8,["active-steps","chord","p","note","pressed"]))),128))],8,se))),128))]))),128)),(l(!0),i(x,null,w(o.rows,(t,h)=>(l(),i("g",{key:h},[(l(!0),i(x,null,w(p(M)(c.value,t).splice(0,6),(d,b)=>(l(),i("g",{key:b,transform:"translate("+(b*2*o.dx+h%2*o.dx)+","+h*v.value+")"},[B(r,{pressed:o.pressed,"onUpdate:pressed":n[0]||(n[0]=_=>o.pressed=_),available:!!s.value[d.pitch],tonic:p(T).tonic,note:d,r:o.r},null,8,["pressed","available","tonic","note","r"])],8,le))),128))]))),128))],32)}}},ue=I(ie,[["__scopeId","data-v-da805530"]]),fe=JSON.parse('{"title":"Tonal array","description":"Harmonic table note layout - symmetrical hexagonal pattern of interval sequences","frontmatter":{"title":"Tonal array","description":"Harmonic table note layout - symmetrical hexagonal pattern of interval sequences","cover":"array.png","date":"2022-02-01T00:00:00.000Z","layout":"app"},"headers":[],"relativePath":"practice/chord/array/index.md","filePath":"practice/chord/array/index.md","lastUpdated":1720375267000}'),de={name:"practice/chord/array/index.md"},ce=y("p",null,[y("a",{href:"https://en.wikipedia.org/wiki/Harmonic_table_note_layout",target:"_blank",rel:"noreferrer"},"wiki")],-1);function pe(a,$,o,s,v,c){const f=ue,m=G("client-only");return l(),i("div",null,[B(m,null,{default:z(()=>[B(f)]),_:1}),ce])}const he=I(de,[["render",pe]]);export{fe as __pageData,he as default};
