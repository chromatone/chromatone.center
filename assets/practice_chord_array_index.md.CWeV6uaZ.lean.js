import{_ as O}from"./chunks/ControlScale.BbB-Lv7G.js";import{u as I,F as P,p as j,n as k,a as q,s as E,b as D,m as H,c as R,d as V,e as J,g as S,r as M}from"./chunks/theme.CWquGTT4.js";import{r as F,c as g,E as l,F as i,G as f,C as v,I as C,d as U,D as B,b as z,V as x,W as $,a2 as G,O as b,Q as N,J as K,K as L,X as Q,a4 as W}from"./chunks/framework.Ci2j13v1.js";import"./chunks/ChromaKeys.MHT78e33.js";const X={class:"cursor-pointer"},Z=["r","stroke-width","fill"],Y={style:{"user-select":"none","pointer-events":"none"},"font-size":"22px","text-anchor":"middle",fill:"white",x:0,y:8},ee={__name:"TonalArrayNote",props:{note:{type:Object,default:()=>{}},r:{type:Number,default:10},pressed:{type:Boolean,default:!1},available:{type:Boolean,default:!1},tonic:{type:Number,default:0}},emits:["update:pressed"],setup(a){const{midi:_}=I(),t=a,r=F(!1),d=g(()=>{let m=t.tonic>t.note.pitch?3:2;return P(j(t.note.pitch,m)).toNote()});function p(){r.value=!0,q(d.value)}function h(){r.value=!1,E(d.value)}return(m,e)=>{var n,u;return l(),i("g",X,[f("circle",{class:"transition-all duration-50",r:a.r,cx:0,cy:0,"stroke-width":a.tonic==a.note.pitch?4:a.available?2:0,stroke:"white",fill:v(k)(a.note.pitch,r.value||((n=v(_).activeChroma)==null?void 0:n[a.note.pitch])>0?5:a.available?3:2,r.value||((u=v(_).activeChroma)==null?void 0:u[a.note.pitch])>0?1:.4),onMousedown:e[0]||(e[0]=s=>p()),onTouchstart:e[1]||(e[1]=s=>p()),onMouseenter:e[2]||(e[2]=s=>a.pressed?p():null),onMouseup:e[3]||(e[3]=s=>h()),onMouseleave:e[4]||(e[4]=s=>h()),onTouchend:e[5]||(e[5]=s=>h()),onTouchcancel:e[6]||(e[6]=s=>h())},null,40,Z),f("text",Y,C(a.note.name),1)])}}},te=["transform","fill","stroke-width"],oe={__name:"TonalArrayTrigger",props:{pressed:Boolean,note:{type:Object,default:()=>{}},chord:{type:Object,default:()=>{}},p:{type:Number,default:0},activeSteps:{type:Array,default:()=>[]}},setup(a){const{midi:_}=I(),t=a,r=F(!1),d=g(()=>t.chord.map(u=>u+t.note.pitch)),p=g(()=>{let u=!0;return d.value.map(o=>o>11?o%12:o).forEach(o=>{t.activeSteps[o]!="1"&&(u=!1)}),u}),h=g(()=>{let u=!0;return d.value.map(o=>o>11?o%12:o).forEach(o=>{_.activeChroma[o]!="1"&&(u=!1)}),u}),m=g(()=>d.value.map(u=>P(j(u)).transpose(-12).toNote()));function e(){r.value=!0,D(m.value),H(m.value)}function n(){r.value=!1,R(m.value),V(m.value)}return U(()=>_.activeChroma,u=>{console.log(u)}),(u,s)=>(l(),i("polygon",{class:"chord-trigger",style:{"mix-blend-mode":"screen"},transform:"rotate("+60*a.p+")",fill:v(k)(a.note.pitch,r.value||h.value?5:p.value?.5:-2,p.value?1:.2),opacity:1,"stroke-width":p.value?4:.5,stroke:"hsla(0,0%,100%,0.5)",points:"0,0 80,0 80,46.188 40,69.28",onMousedown:s[0]||(s[0]=o=>e()),onMouseenter:s[1]||(s[1]=o=>a.pressed?e():null),onTouchstart:s[2]||(s[2]=o=>e()),onMouseleave:s[3]||(s[3]=o=>n()),onMouseup:s[4]||(s[4]=o=>n()),onTouchend:s[5]||(s[5]=o=>n()),onTouchcancel:s[6]||(s[6]=o=>n())},null,40,te))}},ne=a=>(K("data-v-f8cd76a7"),a=a(),L(),a),se=ne(()=>f("clipPath",{id:"grid-mask"},[f("rect",{x:-80,y:-110,width:1040,height:770,ry:20,rx:20})],-1)),ae=["transform"],re=["fill"],le=["fill"],ie={class:"chord-name","text-anchor":"middle",fill:"white",x:80,y:-40},ue={class:"chord-name","text-anchor":"middle",fill:"white",x:80,y:55},ce=["transform"],de=["transform"],pe={__name:"TonalArray",setup(a){const _=[...J].map((e,n)=>({name:e,pitch:n})),t=z({pressed:!1,r:28,dx:80,rowNum:12,colNum:12,rows:[0,9,5,2,10],bgRows:[4,0,9,5,2,10,7],chords:[[0,3,7],[0,3,8],[0,5,8],[0,5,9],[0,4,9],[0,4,7]]}),r=g(()=>{let e=S.chroma.split("").map(Number);return M(e,-S.tonic)}),d=g(()=>t.dx*2*.866),p=g(()=>{let e=[];for(let n=0;n<12;n++)e[n]=_[7*n%12];return e});function h(e){return!r.value[e]||!r.value[(e+4)%12]||!r.value[(e+7)%12]}function m(e){return!r.value[e]||!r.value[(e+3)%12]||!r.value[(e+7)%12]}return(e,n)=>{const u=oe,s=ee;return l(),i("svg",{class:"rounded-3xl min-h-80svh max-h-100svh w-full",id:"tonal-array",viewBox:"-80 -110 1040 770",version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none"},onTouchstart:n[1]||(n[1]=N(o=>t.pressed=!0,["stop","prevent"])),onTouchend:n[2]||(n[2]=N(o=>t.pressed=!1,["stop","prevent"])),onMousedown:n[3]||(n[3]=N(o=>t.pressed=!0,["stop","prevent"])),onMouseup:n[4]||(n[4]=N(o=>t.pressed=!1,["stop","prevent"])),onMouseleave:n[5]||(n[5]=o=>t.pressed=!1)},[se,(l(!0),i(x,null,$(t.bgRows,(o,y)=>(l(),i("g",{key:o,"clip-path":"url(#grid-mask)"},[(l(!0),i(x,null,$(v(M)(p.value,o-1).splice(0,7),(c,w)=>(l(),i("g",{key:c,transform:`translate(${(w-1)*2*t.dx+(y+1)%2*t.dx}, ${(y-1)*d.value})`},[f("polygon",{class:"chord-triangle",fill:m(c.pitch)?v(k)(c.pitch,1,.2):v(k)(c.pitch,3),points:"0,0 160,0 80,138.56"},null,8,re),f("polygon",{class:"chord-triangle major",fill:h(c.pitch)?v(k)(c.pitch,1,.2):v(k)(c.pitch,2),points:"0,0 160,0 80,-138.56"},null,8,le),f("text",ie,C(c.name)+"M",1),f("text",ue,C(c.name)+"m",1)],8,ae))),128))]))),128)),(l(!0),i(x,null,$(t.rows,(o,y)=>(l(),i("g",{class:"cursor-crosshair",key:y},[(l(!0),i(x,null,$(v(M)(p.value,o).splice(0,7),(c,w)=>(l(),i("g",{key:c,transform:`translate(${w*2*t.dx+y%2*t.dx}, ${y*d.value})`},[(l(!0),i(x,null,$(t.chords,(T,A)=>(l(),G(u,{key:A,"active-steps":r.value,chord:T,p:A,note:c,pressed:t.pressed},null,8,["active-steps","chord","p","note","pressed"]))),128))],8,ce))),128))]))),128)),(l(!0),i(x,null,$(t.rows,(o,y)=>(l(),i("g",{key:y},[(l(!0),i(x,null,$(v(M)(p.value,o).splice(0,6),(c,w)=>(l(),i("g",{key:w,transform:"translate("+(w*2*t.dx+y%2*t.dx)+","+y*d.value+")"},[b(s,{pressed:t.pressed,"onUpdate:pressed":n[0]||(n[0]=T=>t.pressed=T),available:!!r.value[c.pitch],tonic:v(S).tonic,note:c,r:t.r},null,8,["pressed","available","tonic","note","r"])],8,de))),128))]))),128))],32)}}},ve=B(pe,[["__scopeId","data-v-f8cd76a7"]]),me={class:"flex flex-col gap-4"},fe={class:"fullscreen-container rounded-3xl",id:"screen"},he={__name:"TonalSpace",setup(a){return(_,t)=>{const r=ve,d=O;return l(),i("div",me,[f("div",fe,[b(r)]),b(d)])}}},ye=B(he,[["__scopeId","data-v-d4fc29ac"]]),Me=JSON.parse('{"title":"Tonal array","description":"Harmonic table note layout - symmetrical hexagonal pattern of interval sequences","frontmatter":{"title":"Tonal array","description":"Harmonic table note layout - symmetrical hexagonal pattern of interval sequences","cover":"array.png","date":"2022-02-01T00:00:00.000Z","layout":"app"},"headers":[],"relativePath":"practice/chord/array/index.md","filePath":"practice/chord/array/index.md","lastUpdated":1714381463000}'),_e={name:"practice/chord/array/index.md"},ge=f("p",null,[f("a",{href:"https://en.wikipedia.org/wiki/Harmonic_table_note_layout",target:"_blank",rel:"noreferrer"},"wiki")],-1);function xe(a,_,t,r,d,p){const h=ye,m=W("client-only");return l(),i("div",null,[b(m,null,{default:Q(()=>[b(h)]),_:1}),ge])}const Ne=B(_e,[["render",xe]]);export{Me as __pageData,Ne as default};
