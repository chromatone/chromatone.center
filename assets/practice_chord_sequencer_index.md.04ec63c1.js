import{_ as Z}from"./chunks/ControlRotary.64f87b82.js";import{_ as G}from"./chunks/ControlScale.75a7f72f.js";import{_ as j,u as Q,k as q,j as A,z as X,A as Y,w as C,B as ee,q as te,o as l,c as m,a as r,F,r as E,x as $,g as _,t as U,v as O,l as N,s as d,f as b,C as oe,y as se,b as B,p as ae,d as ne}from"./chunks/framework.f277db28.js";import{g as T,a as re,n as x}from"./chunks/colors.a5d5ae39.js";import"./chunks/index.b30cd6d2.js";import"./chunks/index.86652af6.js";import{n as ie}from"./chunks/index.9f721bc0.js";import{e as pe,f as le}from"./chunks/midi.36560961.js";import{u as g,b as me}from"./chunks/index.8dc0b613.js";import{n as ue}from"./chunks/theory.61e5aadb.js";import{s as H,S as de,D as ce,T as I}from"./chunks/index.e98b5e67.js";import{b as fe}from"./chunks/synth.8a2ee66e.js";import{c as ve}from"./chunks/audio.aba48680.js";import{t as R}from"./chunks/tempo.4e2f4c38.js";import{P as _e}from"./chunks/Pattern.76bd7482.js";import"./chunks/index.64a8684b.js";import"./chunks/index.911cb71e.js";import"./chunks/ChromaKeys.e1b1bcd4.js";import"./chunks/calculations.2bac3e9a.js";import"./chunks/index.654bd828.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/Scale.b6214b1d.js";import"./chunks/Subtract.109130cb.js";import"./chunks/PingPongDelay.719d1232.js";import"./chunks/AutoPanner.a9d5a784.js";import"./chunks/MonoSynth.c00b1270.js";import"./chunks/Filter.ca6be54c.js";import"./chunks/Loop.14cab9e9.js";let k;function J(){if(H(),k)return;const{channel:v}=ve("piano");k=new de({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,volume:-10,baseUrl:"/audio/piano/"}).connect(v)}function ge(v="A4",y="8n",t){if(!k)return J();k.triggerAttackRelease(v,y,t)}const w=v=>(ae("data-v-e26763e5"),v=v(),ne(),v),he={class:"flex flex-col"},be=w(()=>r("div",{class:"row"},[r("div",{class:"title"})],-1)),ye=["id","onMousedown","onMouseenter"],Ce={class:"flex flex-wrap items-center justify-center"},xe={class:"flex flex-wrap justify-center flex-1 bg-light-900 p-4 rounded-2xl dark-bg-dark-800 gap-2"},we=["value"],De={class:"is-group flex flex-wrap p-2"},Ae={class:"is-group"},ke=w(()=>r("div",{class:"i-la-trash-alt"},null,-1)),Se=[ke],Ve={class:"is-group flex items-center"},qe=w(()=>r("div",{class:"i-la-play"},null,-1)),Fe=[qe],Ee=w(()=>r("div",{class:"i-la-pause"},null,-1)),$e=[Ee],Me=w(()=>r("div",{class:"i-la-stop"},null,-1)),ze=[Me],Pe={__name:"StepSequencer",setup(v){const{isDark:y}=Q(),t=q({started:!1,playing:!1,hover:!1,mounted:!1,current:0,octave:g("seq-octave",3),bpm:g("seq-bpm",120),steps:g("seq-steps",16),type:g("seq-type","up"),probability:g("seq-prob",1),humanize:g("seq-human",!1),interval:g("seq-interval","8n"),note:A(()=>ue[T.tonic]),range:A(()=>re.rangeOf(t.note+t.octave+" "+T.set.name)(t.note+t.octave,t.note+(t.octave+2)).map(o=>ie.simplify(o)).reverse()),midi:A(()=>t.range.map(o=>pe.toMidi(o))),pitches:A(()=>t.midi.map(o=>(o+3)%12)),progress:0}),M=["up","down","upDown","downUp","alternateUp","alternateDown","random","randomWalk","randomOnce"],n=q([]),h=q([]);let u=[];me(" ",o=>{o.preventDefault(),t.playing=!t.playing}),X(()=>{t.range.forEach((o,e)=>{n[e]=n[e]||[],n[e].length=t.steps,n.length=t.range.length,Array.apply(null,n[e]).forEach((s,i)=>{n[e][i]={row:e,cell:i,note:o,active:(s==null?void 0:s.active)||!1}})})}),Y(()=>{t.mounted=!0,J(),S()}),C(()=>t.steps,()=>{t.mounted&&S()},{immediate:!0});function S(){u.forEach(o=>{o.stop(0),o.dispose()}),u=[],n.forEach((o,e)=>{u[e]=new _e((c,s)=>{ce.schedule(()=>{h[e]=s==null?void 0:s.cell,s!=null&&s.active&&le(s==null?void 0:s.note)},c),s!=null&&s.active&&(fe(s.note,t.interval,c),ge(s.note,t.interval,c))},n[e],t.type).start(0),u[e].interval=t.interval})}let z;function P(o,e,c,s){!t.hover&&!c||!c&&z==s.target.id||(z=s.target.id,n[o][e].active?n[o][e].active=!1:n[o][e].active=!0)}function K(){n.forEach((o,e)=>{o.forEach((c,s)=>n[e][s].active=!1)})}C(()=>t.playing,o=>{o?(u.forEach(e=>{e.start(0)}),I.start(),t.started||(H(),t.started=!0)):(u.forEach(e=>{e.stop()}),I.stop())}),C(()=>t.type,o=>{u.forEach(e=>{e.pattern=o})},{immediate:!0}),C(()=>t.probability,o=>{u.forEach(e=>{e.probability=o})},{immediate:!0}),C(()=>t.humanize,o=>{u.forEach(e=>{e.humanize=o})},{immediate:!0});function L(){t.playing=!1,S()}ee(()=>{u.forEach(o=>{o.stop(0),o.dispose()})});function W(o,e){return o.active?x(t.pitches[e]):o.cell==h[e]?y.value?"#eee7":"#3337":"#4444"}return(o,e)=>{const c=G,s=Z,i=te("tooltip");return l(),m("div",he,[r("div",{class:"rows",onMousedown:e[0]||(e[0]=a=>t.hover=!0),onMouseleave:e[1]||(e[1]=N(a=>t.hover=!1,["self"])),onMouseup:e[2]||(e[2]=a=>t.hover=!1)},[be,(l(!0),m(F,null,E(n,(a,p)=>(l(),m("div",{class:"row",key:a},[r("div",{class:"title m-1 rounded-md shadow",style:$({color:_(x)(t.pitches[p]),backgroundColor:t.range[p].length>2?"#0005":"#aaa5"})},U(t.range[p]),5),(l(!0),m(F,null,E(a,(f,D)=>(l(),m("div",{class:O(["cell",{active:f==null?void 0:f.active,current:f.cell==h[p]}]),id:`c${p}-${D}`,key:f,style:$({color:_(x)(t.pitches[p]),borderColor:W(f,p),backgroundColor:f.cell==h[p]?f.active?_(x)(t.pitches[p],3):_(y)?"#0005":"#fff5":"transparent",marginRight:D%4==3?"12px":"1px"}),onMousedown:N(V=>P(p,D,!0,V),["prevent"]),onMouseenter:V=>P(p,D,!1,V)},[r("div",{class:"dot",style:$({backgroundColor:f.active?_(x)(t.pitches[p]):f.cell==h[p]?"currentColor":"#4448"})},null,4)],46,ye))),128))]))),128))],32),r("div",Ce,[d(b(c,{class:"flex-1"},null,512),[[i,"Select root note and scale",void 0,{top:!0}]]),r("div",xe,[d((l(),m("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.type=a)},[(l(),m(F,null,E(M,a=>r("option",{key:a,value:a},U(a),9,we)),64))])),[[oe,t.type],[i,"Pattern type",void 0,{top:!0}]]),r("div",De,[d(b(s,{modelValue:t.octave,"onUpdate:modelValue":e[4]||(e[4]=a=>t.octave=a),max:4,min:2,fixed:0,param:"OCTAVE"},null,8,["modelValue"]),[[i,"Octave",void 0,{top:!0}]]),d(b(s,{modelValue:t.steps,"onUpdate:modelValue":e[5]||(e[5]=a=>t.steps=a),max:32,min:4,step:1,fixed:0,param:"steps"},null,8,["modelValue"]),[[i,"Number of steps",void 0,{top:!0}]]),d(b(s,{modelValue:t.probability,"onUpdate:modelValue":e[6]||(e[6]=a=>t.probability=a),max:1,min:0,step:.01,fixed:2,param:"prob"},null,8,["modelValue"]),[[i,"Probability",void 0,{top:!0}]]),d(b(s,{modelValue:_(R).bpm,"onUpdate:modelValue":e[7]||(e[7]=a=>_(R).bpm=a),step:1,max:400,min:10,fixed:0,param:"BPM"},null,8,["modelValue"]),[[i,"Set tempo",void 0,{top:!0}]])]),r("div",Ae,[d((l(),m("button",{class:O(["text-button",{active:t.humanize}]),onClick:e[8]||(e[8]=a=>t.humanize=!t.humanize)},[se("HMN")],2)),[[i,"Humanize rhythm",void 0,{bottom:!0}]]),d((l(),m("button",{class:"text-button",onClick:e[9]||(e[9]=a=>K())},Se)),[[i,"Clear pattern",void 0,{bottom:!0}]])]),r("div",Ve,[t.playing?B("",!0):d((l(),m("button",{key:0,class:"text-button",onClick:e[10]||(e[10]=a=>t.playing=!0)},Fe)),[[i,"Play",void 0,{bottom:!0}]]),t.playing?d((l(),m("button",{key:1,class:"text-button",onClick:e[11]||(e[11]=a=>t.playing=!1)},$e)),[[i,"Pause",void 0,{bottom:!0}]]):B("",!0),d((l(),m("button",{class:"text-button",onClick:e[12]||(e[12]=a=>L())},ze)),[[i,"Stop",void 0,{bottom:!0}]])])])])])}}},Ue=j(Pe,[["__scopeId","data-v-e26763e5"]]),ct=JSON.parse('{"title":"Step sequencer","description":"A simple tool to build up melodies and chord progressions","frontmatter":{"title":"Step sequencer","description":"A simple tool to build up melodies and chord progressions","layout":"app","date":"2021-08-19T00:00:00.000Z","cover":"sequencer.png"},"headers":[],"relativePath":"practice/chord/sequencer/index.md","filePath":"practice/chord/sequencer/index.md","lastUpdated":1698940336000}'),Oe={name:"practice/chord/sequencer/index.md"};function Ne(v,y,t,M,n,h){const u=Ue;return l(),m("div",null,[b(u)])}const ft=j(Oe,[["render",Ne]]);export{ct as __pageData,ft as default};
