import{_ as W}from"./chunks/ControlRotary._Hazk9zv.js";import{_ as Z}from"./chunks/ControlScale.J2pgaRLJ.js";import{_ as j,u as Q,k as E,v as _,j as A,C as X,D as Y,E as tt,w as C,G as et,x as ot,o as l,c as m,a as r,F,r as q,A as $,g,t as U,z as O,l as N,y as d,f as b,H as st,B as at,b as B,p as nt,d as rt}from"./chunks/framework.KnxPB1sj.js";import{g as T,a as it,n as x}from"./chunks/colors.hHBI9fPI.js";import"./chunks/index.bnjSkgpl.js";import"./chunks/index._4u9I4xi.js";import{n as pt}from"./chunks/index.QyW-2vQe.js";import{e as lt,f as mt}from"./chunks/midi.91UwWBqe.js";import{n as ut}from"./chunks/theory.c9f85u7m.js";import{s as H,S as dt,D as ct,T as I}from"./chunks/index.RYxauP_R.js";import{b as ft}from"./chunks/synth.TVJKhjDp.js";import{c as vt}from"./chunks/audio.pG3RnClx.js";import{t as R}from"./chunks/tempo.fl6CFXyY.js";import{P as _t}from"./chunks/Pattern.WpUcisoD.js";import"./chunks/index.rstREGm8.js";import"./chunks/ChromaKeys.GVc4DN9x.js";import"./chunks/calculations.uITx2GSi.js";import"./chunks/index.kn6emmbE.js";import"./chunks/commonjsHelpers.4gQjN7DL.js";import"./chunks/Scale.nioafpJK.js";import"./chunks/Subtract.6yvEFIfU.js";import"./chunks/PingPongDelay.a3-runAV.js";import"./chunks/AutoPanner.02Sltg0b.js";import"./chunks/MonoSynth.pp_JS1sF.js";import"./chunks/Filter.CUstuK5R.js";import"./chunks/Loop.bmxnTff3.js";let k;function G(){if(H(),k)return;const{channel:v}=vt("piano");k=new dt({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,volume:-10,baseUrl:"/audio/piano/"}).connect(v)}function gt(v="A4",y="8n",e){if(!k)return G();k.triggerAttackRelease(v,y,e)}const D=v=>(nt("data-v-e26763e5"),v=v(),rt(),v),ht={class:"flex flex-col"},bt=D(()=>r("div",{class:"row"},[r("div",{class:"title"})],-1)),yt=["id","onMousedown","onMouseenter"],Ct={class:"flex flex-wrap items-center justify-center"},xt={class:"flex flex-wrap justify-center flex-1 bg-light-900 p-4 rounded-2xl dark-bg-dark-800 gap-2"},Dt=["value"],wt={class:"is-group flex flex-wrap p-2"},At={class:"is-group"},kt=D(()=>r("div",{class:"i-la-trash-alt"},null,-1)),St=[kt],Vt={class:"is-group flex items-center"},Et=D(()=>r("div",{class:"i-la-play"},null,-1)),Ft=[Et],qt=D(()=>r("div",{class:"i-la-pause"},null,-1)),$t=[qt],Mt=D(()=>r("div",{class:"i-la-stop"},null,-1)),zt=[Mt],Pt={__name:"StepSequencer",setup(v){const{isDark:y}=Q(),e=E({started:!1,playing:!1,hover:!1,mounted:!1,current:0,octave:_("seq-octave",3),bpm:_("seq-bpm",120),steps:_("seq-steps",16),type:_("seq-type","up"),probability:_("seq-prob",1),humanize:_("seq-human",!1),interval:_("seq-interval","8n"),note:A(()=>ut[T.tonic]),range:A(()=>it.rangeOf(e.note+e.octave+" "+T.set.name)(e.note+e.octave,e.note+(e.octave+2)).map(o=>pt.simplify(o)).reverse()),midi:A(()=>e.range.map(o=>lt.toMidi(o))),pitches:A(()=>e.midi.map(o=>(o+3)%12)),progress:0}),M=["up","down","upDown","downUp","alternateUp","alternateDown","random","randomWalk","randomOnce"],n=E([]),h=E([]);let u=[];X(" ",o=>{o.preventDefault(),e.playing=!e.playing}),Y(()=>{e.range.forEach((o,t)=>{n[t]=n[t]||[],n[t].length=e.steps,n.length=e.range.length,Array.apply(null,n[t]).forEach((s,i)=>{n[t][i]={row:t,cell:i,note:o,active:(s==null?void 0:s.active)||!1}})})}),tt(()=>{e.mounted=!0,G(),S()}),C(()=>e.steps,()=>{e.mounted&&S()},{immediate:!0});function S(){u.forEach(o=>{o.stop(0),o.dispose()}),u=[],n.forEach((o,t)=>{u[t]=new _t((c,s)=>{ct.schedule(()=>{h[t]=s==null?void 0:s.cell,s!=null&&s.active&&mt(s==null?void 0:s.note)},c),s!=null&&s.active&&(ft(s.note,e.interval,c),gt(s.note,e.interval,c))},n[t],e.type).start(0),u[t].interval=e.interval})}let z;function P(o,t,c,s){!e.hover&&!c||!c&&z==s.target.id||(z=s.target.id,n[o][t].active?n[o][t].active=!1:n[o][t].active=!0)}function J(){n.forEach((o,t)=>{o.forEach((c,s)=>n[t][s].active=!1)})}C(()=>e.playing,o=>{o?(u.forEach(t=>{t.start(0)}),I.start(),e.started||(H(),e.started=!0)):(u.forEach(t=>{t.stop()}),I.stop())}),C(()=>e.type,o=>{u.forEach(t=>{t.pattern=o})},{immediate:!0}),C(()=>e.probability,o=>{u.forEach(t=>{t.probability=o})},{immediate:!0}),C(()=>e.humanize,o=>{u.forEach(t=>{t.humanize=o})},{immediate:!0});function K(){e.playing=!1,S()}et(()=>{u.forEach(o=>{o.stop(0),o.dispose()})});function L(o,t){return o.active?x(e.pitches[t]):o.cell==h[t]?y.value?"#eee7":"#3337":"#4444"}return(o,t)=>{const c=Z,s=W,i=ot("tooltip");return l(),m("div",ht,[r("div",{class:"rows",onMousedown:t[0]||(t[0]=a=>e.hover=!0),onMouseleave:t[1]||(t[1]=N(a=>e.hover=!1,["self"])),onMouseup:t[2]||(t[2]=a=>e.hover=!1)},[bt,(l(!0),m(F,null,q(n,(a,p)=>(l(),m("div",{class:"row",key:a},[r("div",{class:"title m-1 rounded-md shadow",style:$({color:g(x)(e.pitches[p]),backgroundColor:e.range[p].length>2?"#0005":"#aaa5"})},U(e.range[p]),5),(l(!0),m(F,null,q(a,(f,w)=>(l(),m("div",{class:O(["cell",{active:f==null?void 0:f.active,current:f.cell==h[p]}]),id:`c${p}-${w}`,key:f,style:$({color:g(x)(e.pitches[p]),borderColor:L(f,p),backgroundColor:f.cell==h[p]?f.active?g(x)(e.pitches[p],3):g(y)?"#0005":"#fff5":"transparent",marginRight:w%4==3?"12px":"1px"}),onMousedown:N(V=>P(p,w,!0,V),["prevent"]),onMouseenter:V=>P(p,w,!1,V)},[r("div",{class:"dot",style:$({backgroundColor:f.active?g(x)(e.pitches[p]):f.cell==h[p]?"currentColor":"#4448"})},null,4)],46,yt))),128))]))),128))],32),r("div",Ct,[d(b(c,{class:"flex-1"},null,512),[[i,"Select root note and scale",void 0,{top:!0}]]),r("div",xt,[d((l(),m("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>e.type=a)},[(l(),m(F,null,q(M,a=>r("option",{key:a,value:a},U(a),9,Dt)),64))])),[[st,e.type],[i,"Pattern type",void 0,{top:!0}]]),r("div",wt,[d(b(s,{modelValue:e.octave,"onUpdate:modelValue":t[4]||(t[4]=a=>e.octave=a),max:4,min:2,fixed:0,param:"OCTAVE"},null,8,["modelValue"]),[[i,"Octave",void 0,{top:!0}]]),d(b(s,{modelValue:e.steps,"onUpdate:modelValue":t[5]||(t[5]=a=>e.steps=a),max:32,min:4,step:1,fixed:0,param:"steps"},null,8,["modelValue"]),[[i,"Number of steps",void 0,{top:!0}]]),d(b(s,{modelValue:e.probability,"onUpdate:modelValue":t[6]||(t[6]=a=>e.probability=a),max:1,min:0,step:.01,fixed:2,param:"prob"},null,8,["modelValue"]),[[i,"Probability",void 0,{top:!0}]]),d(b(s,{modelValue:g(R).bpm,"onUpdate:modelValue":t[7]||(t[7]=a=>g(R).bpm=a),step:1,max:400,min:10,fixed:0,param:"BPM"},null,8,["modelValue"]),[[i,"Set tempo",void 0,{top:!0}]])]),r("div",At,[d((l(),m("button",{class:O(["text-button",{active:e.humanize}]),onClick:t[8]||(t[8]=a=>e.humanize=!e.humanize)},[at("HMN")],2)),[[i,"Humanize rhythm",void 0,{bottom:!0}]]),d((l(),m("button",{class:"text-button",onClick:t[9]||(t[9]=a=>J())},St)),[[i,"Clear pattern",void 0,{bottom:!0}]])]),r("div",Vt,[e.playing?B("",!0):d((l(),m("button",{key:0,class:"text-button",onClick:t[10]||(t[10]=a=>e.playing=!0)},Ft)),[[i,"Play",void 0,{bottom:!0}]]),e.playing?d((l(),m("button",{key:1,class:"text-button",onClick:t[11]||(t[11]=a=>e.playing=!1)},$t)),[[i,"Pause",void 0,{bottom:!0}]]):B("",!0),d((l(),m("button",{class:"text-button",onClick:t[12]||(t[12]=a=>K())},zt)),[[i,"Stop",void 0,{bottom:!0}]])])])])])}}},Ut=j(Pt,[["__scopeId","data-v-e26763e5"]]),ue=JSON.parse('{"title":"Step sequencer","description":"A simple tool to build up melodies and chord progressions","frontmatter":{"title":"Step sequencer","description":"A simple tool to build up melodies and chord progressions","layout":"app","date":"2021-08-19T00:00:00.000Z","cover":"sequencer.png"},"headers":[],"relativePath":"practice/chord/sequencer/index.md","filePath":"practice/chord/sequencer/index.md","lastUpdated":1704280285000}'),Ot={name:"practice/chord/sequencer/index.md"};function Nt(v,y,e,M,n,h){const u=Ut;return l(),m("div",null,[b(u)])}const de=j(Ot,[["render",Nt]]);export{ue as __pageData,de as default};
