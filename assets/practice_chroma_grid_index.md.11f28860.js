import{_ as T}from"./chunks/StateTransport.8d861bf6.js";import{_ as D,j as S,w as j,x as B,o as c,c as f,F as w,r as y,a as l,h as o,y as M,D as q,t as C,k as G,J as E,A as b,K as L,p as O,e as W,g as v,n as k,f as z,u as A,v as F,z as J,T as K,m as H}from"./chunks/framework.adad30f1.js";import{g as V,n as N,l as I}from"./chunks/colors.2b16ac98.js";import{u as Y,F as Z}from"./chunks/index.d12b1cdf.js";import{d as Q}from"./chunks/midi.f2fed5fb.js";import"./chunks/index.b30cd6d2.js";import{n as R}from"./chunks/theory.61e5aadb.js";import{u as X,r as tt}from"./chunks/loop.c3f5487e.js";import{_ as et}from"./chunks/ControlScale.2d9d470f.js";import"./chunks/ControlKnob.a929e2ca.js";import"./chunks/index.fe57d3d9.js";import"./chunks/tempo.388f8e76.js";import"./chunks/calculations.2bac3e9a.js";import"./chunks/index.48e7c1d9.js";import"./chunks/audio.5ebf557e.js";import"./chunks/Loop.1fcec729.js";import"./chunks/tuner.bbe71c0f.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.654bd828.js";import"./chunks/synth.04c1f5d8.js";import"./chunks/Scale.cdb1ed5f.js";import"./chunks/Subtract.61ab647b.js";import"./chunks/PingPongDelay.ee28ff36.js";import"./chunks/AutoPanner.4e1ec92f.js";import"./chunks/MonoSynth.6e153bb8.js";import"./chunks/Filter.7f4fa158.js";import"./chunks/index.86652af6.js";import"./chunks/midiRender.caca9545.js";import"./chunks/Midi.1f918097.js";import"./chunks/Sequence.9f352590.js";import"./chunks/ChromaKeys.d99c895d.js";const ot=["transform"],lt=["transform"],st=["x","width","height","fill","onMousedown"],nt=["x1","x2","stroke-width","stroke"],it=["transform"],at=["width","height"],rt=["transform"],dt=["data-pos","height","width"],ut=["x","font-size"],ct={__name:"ChromaGridsColumn",props:{step:{type:Array,default:()=>{}},pos:{type:Number,default:0},width:{type:Number,default:100},height:{type:Number,default:500},footer:{type:Number,default:60},color:{type:String,default:"gray"},active:{type:Boolean,default:!1}},emits:["subdivide"],setup(e,{emit:g}){const n=e,t=Y(0,20,160),p=S(()=>Math.floor(t.value/20));j(p,(s,d)=>{if(s==d)return;let a=[...n.step];if(s<a.length)a.length=s;else for(let r=a.length;r<s;r++)a.push({});g("subdivide",a.map(r=>({...r,sub:s})))});function i(s){t.value+=s.delta[0]-s.delta[1]}const m=S(()=>(V.set.chroma+V.set.chroma+1).split(""));function _(s){let d=Object.entries(s).map(a=>{if(a[0]!="sub"&&a[1])return Z(Number(a[0])+V.tonic+69,"midi").toNote()}).filter(a=>a!=null);return Q.detect(d)[0]||d[0]}return(s,d)=>{const a=B("drag");return c(),f("g",{class:"col",transform:`translate(${e.pos*e.width} 0)`},[(c(),f(w,null,y(25,(r,u)=>l("g",{class:"cell",key:u,transform:`translate(0 ${e.height-r*e.height/25})`},[(c(!0),f(w,null,y(e.step,(h,x)=>(c(),f("g",{class:"sub",key:h},[l("rect",{class:"transition-all duration-200 ease-out","stroke-width":"0",x:x*e.width/e.step.length+1,width:e.width/e.step.length-2,height:e.height/25-2,rx:"4",fill:o(N)(r+o(V).tonic-1,3,m.value[u]==1?1:.1,h[u]?1:.1),onMousedown:$=>h[u]=!h[u]},null,40,st),l("line",{class:"line pointer-events-none transition-all duration-200 ease-out",x1:x*e.width/e.step.length,x2:(x+1)*e.width/e.step.length,y1:10,y2:10,"stroke-width":h[u]?4:6,"stroke-opacity":"0.1",stroke:h[u]?"black":o(N)(r+o(V).tonic-1,3,m.value[u]==1?1:.1,h[u]?1:.5)},null,8,nt)]))),128))],8,lt)),64)),M(l("g",{class:"subs",transform:`translate(0 ${e.height})`},[M(l("rect",{width:e.width,height:e.footer,fill:"transparent"},null,8,at),[[a,i]]),(c(!0),f(w,null,y(e.step,(r,u)=>(c(),f("g",{class:"pointer-events-none",key:r,transform:`translate(${u*e.width/e.step.length} 0)`},[l("rect",{"data-pos":e.pos,height:e.footer,stroke:"currentColor",fill:"#5552",width:e.width/e.step.length},null,8,dt),l("text",{class:"font-bold",x:e.width/e.step.length/2,y:40,"font-size":20*(1-.15*(e.step.length-1)),fill:"currentColor","text-anchor":"middle","dominant-baseline":"cental"},C(_(r)),9,ut)],8,rt))),128))],8,it),[[q,e.active]])],8,ot)}}},mt=D(ct,[["__scopeId","data-v-13dc99aa"]]);const U=e=>(O("data-v-81a66231"),e=e(),W(),e),ht={class:"knob","drag-options":{preventWindowScrollY:!0}},ft={class:"flex items-center"},pt=U(()=>l("div",{class:"i-la-minus"},null,-1)),vt=[pt],gt={class:"text-lg font-bold"},_t=U(()=>l("div",{class:"i-la-plus"},null,-1)),xt=[_t],wt={__name:"ControlChange",props:{max:{type:Number,default:100},min:{type:Number,default:0},modelValue:{type:Number,default:50},step:{type:Number,default:1},param:{type:String,default:"param"},unit:{type:String,default:""},fixed:{type:Number,default:0},ratio:{type:Number,default:1}},emits:["update:modelValue"],setup(e,{emit:g}){const n=e,t=G({active:!1,internal:0,initial:0,external:S(()=>s(t.internal))});function p(a){const{delta:[r,u],dragging:h,shiftKey:x}=a;t.active=h;let $=n.ratio;t.internal-=u/$,t.internal+=r/$,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),g("update:modelValue",t.external)}function i(a=1){let r=n.step/(n.max-n.min);t.internal+=100*r*a,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),g("update:modelValue",t.external)}E(()=>{t.internal=_(n.modelValue)});function m(){t.internal=t.initial,g("update:modelValue",t.external)}function _(a){return d(a,n.min,n.max,0,100,n.step)}function s(a){return d(a,0,100,n.min,n.max,n.step)}function d(a,r=0,u=100,h=0,x=100,$=1){x=parseFloat(x),h=parseFloat(h),u=parseFloat(u),r=parseFloat(r);let P=(a-r)*(x-h)/(u-r)+h;return Math.round(P/$)*$}return(a,r)=>{const u=B("drag");return M((c(),f("div",ht,[l("div",{class:"level",style:b({width:t.internal+"%"})},null,4),l("div",ft,[l("div",{class:"pl-1 absolute",onMousedown:r[0]||(r[0]=h=>i(-1))},vt,32),l("div",{class:"px-1 flex-1 text-center",onDblclick:r[1]||(r[1]=h=>m())},[L(a.$slots,"default",{},()=>[l("div",gt,C(e.modelValue.toFixed(e.fixed))+C(e.unit),1)],!0)],32),l("div",{class:"pr-1 absolute right-0",onMousedown:r[2]||(r[2]=h=>i(1))},xt,32)])])),[[u,p]])}}},yt=D(wt,[["__scopeId","data-v-81a66231"]]),$t={class:"is-group flex p-1 mx-1 items-center"},bt=l("div",{class:"p-2 text-xl"},"/",-1),kt={class:"is-group flex p-1 m-1"},Ct=l("div",{class:"i-la-angle-left"},null,-1),Vt=[Ct],Nt=l("div",{class:"i-la-angle-right"},null,-1),St=[Nt],Mt={class:"is-group p-1 flex mx-1"},Dt=l("div",{class:"i-la-dice text-xl"},null,-1),Ft=l("div",{class:"i-mdi-pan-horizontal"},null,-1),It=l("div",{class:"i-la-volume-up"},null,-1),Bt=l("div",{class:"flex-1"},null,-1),Gt=l("div",{class:"i-la-trash-alt"},null,-1),zt=[Gt],Ut=l("div",{class:"i-la-times"},null,-1),Pt=[Ut],Tt=["viewBox","opacity"],jt={id:"grid-mask"},qt=["width","height"],Et={class:"all","clip-path":"url(#grid-mask)"},Lt={class:"grid"},Ot=["stroke","width","height"],Wt=["y2","stroke-width","stroke","transform"],At=["transform","stroke"],Jt=["transform"],Kt=["y2","stroke"],Ht={__name:"ChromaGridsGrid",props:{order:{type:Number,default:0},color:{type:String,default:"currentColor"},active:{type:Boolean,default:!0}},emits:["del"],setup(e){const g=e,n=G({width:1e3,height:720,footer:60}),t=X(g.order);return(p,i)=>{const m=yt,_=mt;return c(),f("div",{class:"flex flex-col shadow-xl rounded-3xl overflow-hidden border-4",style:b({zIndex:e.active?100:1,opacity:e.active?1:.25,borderColor:e.color})},[l("div",{class:"flex flex-wrap p-2",style:b({opacity:e.active?1:0,backgroundColor:e.color,pointerEvents:e.active?"auto":"none"})},[l("div",$t,[v(m,{class:"w-5em",modelValue:o(t).metre.over,"onUpdate:modelValue":i[0]||(i[0]=s=>o(t).metre.over=s),step:1,min:1,max:48,param:""},null,8,["modelValue"]),bt,v(m,{class:"w-5em",modelValue:o(t).metre.under,"onUpdate:modelValue":i[1]||(i[1]=s=>o(t).metre.under=s),step:1,min:1,max:16,param:""},null,8,["modelValue"])]),l("div",kt,[l("button",{class:"text-button",onClick:i[2]||(i[2]=s=>o(t).rotate(-1))},Vt),l("button",{class:"text-button",onClick:i[3]||(i[3]=s=>o(t).rotate())},St)]),l("div",{class:"is-group p-1 flex mx-1 transition-all duration-300 ease",style:b({borderColor:o(N)(o(t).pitch,o(t).octave)})},[v(m,{class:"w-5em",modelValue:o(t).octave,"onUpdate:modelValue":i[4]||(i[4]=s=>o(t).octave=s),step:1,min:0,max:7,ratio:4},{default:k(()=>[l("div",{class:"font-bold transition-all duration-300 ease",style:b({color:o(N)(o(t).pitch,o(t).octave)})},C(o(R)[o(t).pitch])+C(o(t).octave),5)]),_:1},8,["modelValue"])],4),l("div",Mt,[v(m,{class:"w-5em",modelValue:o(t).probability,"onUpdate:modelValue":i[5]||(i[5]=s=>o(t).probability=s),step:.01,min:0,max:1,fixed:2},{default:k(()=>[Dt]),_:1},8,["modelValue"]),v(m,{class:"w-4em",modelValue:o(t).pan,"onUpdate:modelValue":i[6]||(i[6]=s=>o(t).pan=s),step:.01,min:-1,max:1,fixed:1,ratio:2},{default:k(()=>[Ft]),_:1},8,["modelValue"]),v(m,{class:"w-4em",modelValue:o(t).volume,"onUpdate:modelValue":i[7]||(i[7]=s=>o(t).volume=s),step:.01,min:0,max:1,fixed:1,ratio:2,onDblclick:i[8]||(i[8]=s=>o(t).volume>0?o(t).volume=0:o(t).volume=.75)},{default:k(()=>[It]),_:1},8,["modelValue"])]),Bt,l("button",{class:"text-button",onMousedown:i[9]||(i[9]=s=>o(t).clear())},zt,32),l("button",{class:"text-button",onMousedown:i[10]||(i[10]=s=>p.$emit("del"))},Pt,32)],4),(c(),f("svg",{class:"w-full cursor-pointer",ref:"svg",version:"1.1",baseProfile:"full",viewBox:`0 0 ${n.width} ${n.height+n.footer}`,xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"},opacity:o(t).volume},[l("clipPath",jt,[l("rect",{x:0,y:-10,width:n.width,height:n.height+n.footer+10,rx:10},null,8,qt)]),l("g",Et,[l("g",Lt,[l("rect",{ref:"area",stroke:e.color,"stroke-width":10,fill:"transparent",rx:"10",width:n.width,height:n.height},null,8,Ot),(c(!0),f(w,null,y(o(t).metre.over,s=>(c(),f("line",{key:s,y2:n.height,"stroke-width":s%o(t).metre.under==0?8:s%4==0?4:e.active?1:0,stroke:e.color,transform:`translate(${s*n.width/o(t).metre.over} 0)`},null,8,Wt))),128)),l("line",{x2:"1000",transform:`translate(0 ${n.height/2})`,"stroke-width":"4",stroke:o(N)(o(t).pitch)},null,8,At)]),(c(!0),f(w,null,y(o(t).steps,(s,d)=>(c(),z(_,{key:d,step:s,pos:d,color:e.color,width:n.width/o(t).steps.length,height:n.height,footer:n.footer,active:e.active,onSubdivide:a=>o(t).steps[d]=a},null,8,["step","pos","color","width","height","footer","active","onSubdivide"]))),128)),l("g",{class:"progress",transform:`translate(${n.width*o(t).progress} 0)`},[l("line",{y1:"0",y2:n.height,"stroke-width":"4",stroke:e.color},null,8,Kt)],8,Jt)])],8,Tt))],4)}}},Yt={class:"flex flex-col items-center rounded-3xl fullscreen-container p-2",id:"screen"},Zt={class:"flex flex-wrap mt-4 w-full justify-start px-6"},Qt=["onMousedown"],Rt={class:"px-4 py-2"},Xt=l("div",{class:"i-la-plus"},null,-1),te=[Xt],ee=l("div",{class:"flex-1"},null,-1),oe=l("div",{class:"i-la-file-download"},null,-1),le=[oe],se={class:"flex flex-col mb-4 mx-4 w-full relative h-840px"},ne={__name:"ChromaGrids",setup(e){const{isDark:g}=A(),n=F("pitch-bars",[1]);function t(){n.value.push(Math.ceil(Math.random()*100)),p.value=n.value.length-1}const p=F("pitch-bars-active",0);return(i,m)=>{const _=Ht;return c(),f("div",Yt,[l("div",Zt,[(c(!0),f(w,null,y(o(n),(s,d)=>(c(),f("button",{class:J(["px-2 rounded-t-xl mx-2px transition-all duration-300 ease flex items-center",{active:o(p)==d}]),key:s,style:b({backgroundColor:o(I)(d,o(n).length,o(p)==d?1:.3)}),onMousedown:a=>p.value=d},[l("div",Rt,C(d),1)],46,Qt))),128)),l("button",{class:"text-button",onClick:m[0]||(m[0]=s=>t())},te),ee,l("button",{class:"text-button flex items-center",onClick:m[1]||(m[1]=s=>o(tt)())},le)]),l("div",se,[v(K,{name:"fade"},{default:k(()=>[(c(!0),f(w,null,y(o(n),(s,d)=>(c(),z(_,{class:"absolute w-full",key:s,order:d,active:o(p)==d,color:o(I)(d,o(n).length,o(g)?.3:1),onDel:a=>{o(n).splice(d,1),p.value=o(n).length-1}},null,8,["order","active","color","onDel"]))),128))]),_:1})])])}}},je=JSON.parse('{"title":"Chroma Grid","description":"Write note sequences in flexible grids","frontmatter":{"title":"Chroma Grid","description":"Write note sequences in flexible grids","date":"2021-11-02T00:00:00.000Z","cover":"grid.png","todo":["MIDI out channels","midi out on-off","solo","mutes","synth"]},"headers":[],"relativePath":"practice/chroma/grid/index.md","filePath":"practice/chroma/grid/index.md","lastUpdated":1694022443000}'),ie={name:"practice/chroma/grid/index.md"};function ae(e,g,n,t,p,i){const m=et,_=ne,s=T,d=H("client-only");return c(),f("div",null,[v(d,null,{default:k(()=>[v(m),v(_),v(s)]),_:1})])}const qe=D(ie,[["render",ae]]);export{je as __pageData,qe as default};
