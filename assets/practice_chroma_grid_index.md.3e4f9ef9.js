import{_ as E}from"./chunks/StateTransport.1da70a81.js";import{_ as P}from"./chunks/ControlScale.d8a8e9b3.js";import{_ as D,j as S,w as j,q as G,o as c,c as f,F as w,r as y,a as s,g as o,s as M,E as L,t as C,k as z,z as O,x as b,I as W,p as A,d as H,f as v,n as k,e as U,u as J,v as F,T as K,m as Y,y as Z}from"./chunks/framework.88db3c26.js";import{g as V,n as N,l as I}from"./chunks/colors.71e97f2b.js";import{F as Q}from"./chunks/index.e98b5e67.js";import{d as R}from"./chunks/midi.b5556f9f.js";import{u as X}from"./chunks/index.edce5462.js";import{n as tt}from"./chunks/theory.f78bd4d6.js";import{u as et,r as ot}from"./chunks/loop.88bd9d68.js";import{u as B}from"./chunks/index.70261d75.js";import"./chunks/ControlKnob.badfbad9.js";import"./chunks/index.c020f286.js";import"./chunks/tempo.84043c62.js";import"./chunks/calculations.2bac3e9a.js";import"./chunks/index.78e9bb27.js";import"./chunks/audio.e7507cf6.js";import"./chunks/Loop.14cab9e9.js";import"./chunks/tuner.5a4b9afc.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/ChromaKeys.734b9bba.js";import"./chunks/index.654bd828.js";import"./chunks/synth.9919606b.js";import"./chunks/Scale.b6214b1d.js";import"./chunks/Subtract.109130cb.js";import"./chunks/PingPongDelay.7799470c.js";import"./chunks/AutoPanner.fd8dabdc.js";import"./chunks/MonoSynth.c00b1270.js";import"./chunks/Filter.ca6be54c.js";import"./chunks/index.28e8ae3d.js";import"./chunks/midiRender.1914f0ed.js";import"./chunks/Midi.1f918097.js";import"./chunks/Sequence.873f0209.js";const st=["transform"],lt=["transform"],nt=["x","width","height","fill","onMousedown"],it=["x1","x2","stroke-width","stroke"],at=["transform"],rt=["width","height"],dt=["transform"],ut=["data-pos","height","width"],ct=["x","font-size"],mt={__name:"ChromaGridsColumn",props:{step:{type:Array,default:()=>{}},pos:{type:Number,default:0},width:{type:Number,default:100},height:{type:Number,default:500},footer:{type:Number,default:60},color:{type:String,default:"gray"},active:{type:Boolean,default:!1}},emits:["subdivide"],setup(e,{emit:g}){const n=e,t=X(0,20,160),p=S(()=>Math.floor(t.value/20));j(p,(l,d)=>{if(l==d)return;let a=[...n.step];if(l<a.length)a.length=l;else for(let r=a.length;r<l;r++)a.push({});g("subdivide",a.map(r=>({...r,sub:l})))});function i(l){t.value+=l.delta[0]-l.delta[1]}const m=S(()=>(V.set.chroma+V.set.chroma+1).split(""));function x(l){let d=Object.entries(l).map(a=>{if(a[0]!="sub"&&a[1])return Q(Number(a[0])+V.tonic+69,"midi").toNote()}).filter(a=>a!=null);return R.detect(d)[0]||d[0]}return(l,d)=>{const a=G("drag");return c(),f("g",{class:"col",transform:`translate(${e.pos*e.width} 0)`},[(c(),f(w,null,y(25,(r,u)=>s("g",{class:"cell",key:u,transform:`translate(0 ${e.height-r*e.height/25})`},[(c(!0),f(w,null,y(e.step,(h,_)=>(c(),f("g",{class:"sub",key:h},[s("rect",{class:"transition-all duration-200 ease-out","stroke-width":"0",x:_*e.width/e.step.length+1,width:e.width/e.step.length-2,height:e.height/25-2,rx:"4",fill:o(N)(r+o(V).tonic-1,3,m.value[u]==1?1:.1,h[u]?1:.1),onMousedown:$=>h[u]=!h[u]},null,40,nt),s("line",{class:"line pointer-events-none transition-all duration-200 ease-out",x1:_*e.width/e.step.length,x2:(_+1)*e.width/e.step.length,y1:10,y2:10,"stroke-width":h[u]?4:6,"stroke-opacity":"0.1",stroke:h[u]?"black":o(N)(r+o(V).tonic-1,3,m.value[u]==1?1:.1,h[u]?1:.5)},null,8,it)]))),128))],8,lt)),64)),M(s("g",{class:"subs",transform:`translate(0 ${e.height})`},[M(s("rect",{width:e.width,height:e.footer,fill:"transparent"},null,8,rt),[[a,i]]),(c(!0),f(w,null,y(e.step,(r,u)=>(c(),f("g",{class:"pointer-events-none",key:r,transform:`translate(${u*e.width/e.step.length} 0)`},[s("rect",{"data-pos":e.pos,height:e.footer,stroke:"currentColor",fill:"#5552",width:e.width/e.step.length},null,8,ut),s("text",{class:"font-bold",x:e.width/e.step.length/2,y:40,"font-size":20*(1-.15*(e.step.length-1)),fill:"currentColor","text-anchor":"middle","dominant-baseline":"cental"},C(x(r)),9,ct)],8,dt))),128))],8,at),[[L,e.active]])],8,st)}}},ht=D(mt,[["__scopeId","data-v-13dc99aa"]]);const T=e=>(A("data-v-81a66231"),e=e(),H(),e),ft={class:"knob","drag-options":{preventWindowScrollY:!0}},pt={class:"flex items-center"},vt=T(()=>s("div",{class:"i-la-minus"},null,-1)),gt=[vt],xt={class:"text-lg font-bold"},_t=T(()=>s("div",{class:"i-la-plus"},null,-1)),wt=[_t],yt={__name:"ControlChange",props:{max:{type:Number,default:100},min:{type:Number,default:0},modelValue:{type:Number,default:50},step:{type:Number,default:1},param:{type:String,default:"param"},unit:{type:String,default:""},fixed:{type:Number,default:0},ratio:{type:Number,default:1}},emits:["update:modelValue"],setup(e,{emit:g}){const n=e,t=z({active:!1,internal:0,initial:0,external:S(()=>l(t.internal))});function p(a){const{delta:[r,u],dragging:h,shiftKey:_}=a;t.active=h;let $=n.ratio;t.internal-=u/$,t.internal+=r/$,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),g("update:modelValue",t.external)}function i(a=1){let r=n.step/(n.max-n.min);t.internal+=100*r*a,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),g("update:modelValue",t.external)}O(()=>{t.internal=x(n.modelValue)});function m(){t.internal=t.initial,g("update:modelValue",t.external)}function x(a){return d(a,n.min,n.max,0,100,n.step)}function l(a){return d(a,0,100,n.min,n.max,n.step)}function d(a,r=0,u=100,h=0,_=100,$=1){_=parseFloat(_),h=parseFloat(h),u=parseFloat(u),r=parseFloat(r);let q=(a-r)*(_-h)/(u-r)+h;return Math.round(q/$)*$}return(a,r)=>{const u=G("drag");return M((c(),f("div",ft,[s("div",{class:"level",style:b({width:t.internal+"%"})},null,4),s("div",pt,[s("div",{class:"pl-1 absolute",onMousedown:r[0]||(r[0]=h=>i(-1))},gt,32),s("div",{class:"px-1 flex-1 text-center",onDblclick:r[1]||(r[1]=h=>m())},[W(a.$slots,"default",{},()=>[s("div",xt,C(e.modelValue.toFixed(e.fixed))+C(e.unit),1)],!0)],32),s("div",{class:"pr-1 absolute right-0",onMousedown:r[2]||(r[2]=h=>i(1))},wt,32)])])),[[u,p]])}}},$t=D(yt,[["__scopeId","data-v-81a66231"]]),bt={class:"is-group flex p-1 mx-1 items-center"},kt=s("div",{class:"p-2 text-xl"},"/",-1),Ct={class:"is-group flex p-1 m-1"},Vt=s("div",{class:"i-la-angle-left"},null,-1),Nt=[Vt],St=s("div",{class:"i-la-angle-right"},null,-1),Mt=[St],Dt={class:"is-group p-1 flex mx-1"},Ft=s("div",{class:"i-la-dice text-xl"},null,-1),It=s("div",{class:"i-mdi-pan-horizontal"},null,-1),Bt=s("div",{class:"i-la-volume-up"},null,-1),Gt=s("div",{class:"flex-1"},null,-1),zt=s("div",{class:"i-la-trash-alt"},null,-1),Ut=[zt],Tt=s("div",{class:"i-la-times"},null,-1),qt=[Tt],Et=["viewBox","opacity"],Pt={id:"grid-mask"},jt=["width","height"],Lt={class:"all","clip-path":"url(#grid-mask)"},Ot={class:"grid"},Wt=["stroke","width","height"],At=["y2","stroke-width","stroke","transform"],Ht=["transform","stroke"],Jt=["transform"],Kt=["y2","stroke"],Yt={__name:"ChromaGridsGrid",props:{order:{type:Number,default:0},color:{type:String,default:"currentColor"},active:{type:Boolean,default:!0}},emits:["del"],setup(e){const g=e,n=z({width:1e3,height:720,footer:60}),t=et(g.order);return(p,i)=>{const m=$t,x=ht;return c(),f("div",{class:"flex flex-col shadow-xl rounded-3xl overflow-hidden border-4",style:b({zIndex:e.active?100:1,opacity:e.active?1:.25,borderColor:e.color})},[s("div",{class:"flex flex-wrap p-2",style:b({opacity:e.active?1:0,backgroundColor:e.color,pointerEvents:e.active?"auto":"none"})},[s("div",bt,[v(m,{class:"w-5em",modelValue:o(t).metre.over,"onUpdate:modelValue":i[0]||(i[0]=l=>o(t).metre.over=l),step:1,min:1,max:48,param:""},null,8,["modelValue"]),kt,v(m,{class:"w-5em",modelValue:o(t).metre.under,"onUpdate:modelValue":i[1]||(i[1]=l=>o(t).metre.under=l),step:1,min:1,max:16,param:""},null,8,["modelValue"])]),s("div",Ct,[s("button",{class:"text-button",onClick:i[2]||(i[2]=l=>o(t).rotate(-1))},Nt),s("button",{class:"text-button",onClick:i[3]||(i[3]=l=>o(t).rotate())},Mt)]),s("div",{class:"is-group p-1 flex mx-1 transition-all duration-300 ease",style:b({borderColor:o(N)(o(t).pitch,o(t).octave)})},[v(m,{class:"w-5em",modelValue:o(t).octave,"onUpdate:modelValue":i[4]||(i[4]=l=>o(t).octave=l),step:1,min:0,max:7,ratio:4},{default:k(()=>[s("div",{class:"font-bold transition-all duration-300 ease",style:b({color:o(N)(o(t).pitch,o(t).octave)})},C(o(tt)[o(t).pitch])+C(o(t).octave),5)]),_:1},8,["modelValue"])],4),s("div",Dt,[v(m,{class:"w-5em",modelValue:o(t).probability,"onUpdate:modelValue":i[5]||(i[5]=l=>o(t).probability=l),step:.01,min:0,max:1,fixed:2},{default:k(()=>[Ft]),_:1},8,["modelValue"]),v(m,{class:"w-4em",modelValue:o(t).pan,"onUpdate:modelValue":i[6]||(i[6]=l=>o(t).pan=l),step:.01,min:-1,max:1,fixed:1,ratio:2},{default:k(()=>[It]),_:1},8,["modelValue"]),v(m,{class:"w-4em",modelValue:o(t).volume,"onUpdate:modelValue":i[7]||(i[7]=l=>o(t).volume=l),step:.01,min:0,max:1,fixed:1,ratio:2,onDblclick:i[8]||(i[8]=l=>o(t).volume>0?o(t).volume=0:o(t).volume=.75)},{default:k(()=>[Bt]),_:1},8,["modelValue"])]),Gt,s("button",{class:"text-button",onMousedown:i[9]||(i[9]=l=>o(t).clear())},Ut,32),s("button",{class:"text-button",onMousedown:i[10]||(i[10]=l=>p.$emit("del"))},qt,32)],4),(c(),f("svg",{class:"w-full cursor-pointer",ref:"svg",version:"1.1",baseProfile:"full",viewBox:`0 0 ${n.width} ${n.height+n.footer}`,xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"},opacity:o(t).volume},[s("clipPath",Pt,[s("rect",{x:0,y:-10,width:n.width,height:n.height+n.footer+10,rx:10},null,8,jt)]),s("g",Lt,[s("g",Ot,[s("rect",{ref:"area",stroke:e.color,"stroke-width":10,fill:"transparent",rx:"10",width:n.width,height:n.height},null,8,Wt),(c(!0),f(w,null,y(o(t).metre.over,l=>(c(),f("line",{key:l,y2:n.height,"stroke-width":l%o(t).metre.under==0?8:l%4==0?4:e.active?1:0,stroke:e.color,transform:`translate(${l*n.width/o(t).metre.over} 0)`},null,8,At))),128)),s("line",{x2:"1000",transform:`translate(0 ${n.height/2})`,"stroke-width":"4",stroke:o(N)(o(t).pitch)},null,8,Ht)]),(c(!0),f(w,null,y(o(t).steps,(l,d)=>(c(),U(x,{key:d,step:l,pos:d,color:e.color,width:n.width/o(t).steps.length,height:n.height,footer:n.footer,active:e.active,onSubdivide:a=>o(t).steps[d]=a},null,8,["step","pos","color","width","height","footer","active","onSubdivide"]))),128)),s("g",{class:"progress",transform:`translate(${n.width*o(t).progress} 0)`},[s("line",{y1:"0",y2:n.height,"stroke-width":"4",stroke:e.color},null,8,Kt)],8,Jt)])],8,Et))],4)}}},Zt={class:"flex flex-col items-center rounded-3xl fullscreen-container p-2",id:"screen"},Qt={class:"flex flex-wrap mt-4 w-full justify-start px-6"},Rt=["onMousedown"],Xt={class:"px-4 py-2"},te=s("div",{class:"i-la-plus"},null,-1),ee=[te],oe=s("div",{class:"flex-1"},null,-1),se=s("div",{class:"i-la-file-download"},null,-1),le=[se],ne={class:"flex flex-col mb-4 mx-4 w-full relative"},ie={__name:"ChromaGrids",setup(e){const{isDark:g}=J(),n=B("pitch-bars",[1]);function t(){n.value.push(Math.ceil(Math.random()*100)),p.value=n.value.length-1}const p=B("pitch-bars-active",0);return(i,m)=>{const x=Yt;return c(),f("div",Zt,[s("div",Qt,[(c(!0),f(w,null,y(o(n),(l,d)=>(c(),f("button",{class:F(["px-2 rounded-t-xl mx-2px transition-all duration-300 ease flex items-center",{active:o(p)==d}]),key:l,style:b({backgroundColor:o(I)(d,o(n).length,o(p)==d?1:.3)}),onMousedown:a=>p.value=d},[s("div",Xt,C(d),1)],46,Rt))),128)),s("button",{class:"text-button",onClick:m[0]||(m[0]=l=>t())},ee),oe,s("button",{class:"text-button flex items-center",onClick:m[1]||(m[1]=l=>o(ot)())},le)]),s("div",ne,[v(K,{name:"fade"},{default:k(()=>[(c(!0),f(w,null,y(o(n),(l,d)=>(c(),U(x,{class:F(["w-full",{absolute:d>0}]),key:l,order:d,active:o(p)==d,color:o(I)(d,o(n).length,o(g)?.3:1),onDel:a=>{o(n).splice(d,1),p.value=o(n).length-1}},null,8,["class","order","active","color","onDel"]))),128))]),_:1})])])}}},Le=JSON.parse('{"title":"Chroma Grid","description":"Write note sequences in flexible grids","frontmatter":{"title":"Chroma Grid","description":"Write note sequences in flexible grids","layout":"app","date":"2021-11-02T00:00:00.000Z","cover":"grid.png","todo":["MIDI out channels","midi out on-off","solo","mutes","synth"]},"headers":[],"relativePath":"practice/chroma/grid/index.md","filePath":"practice/chroma/grid/index.md","lastUpdated":1699971868000}'),ae={name:"practice/chroma/grid/index.md"},re={class:"flex flex-wrap"};function de(e,g,n,t,p,i){const m=ie,x=P,l=E,d=Y("client-only");return c(),f("div",null,[v(d,null,{default:k(()=>[v(m),Z(),s("div",re,[v(x,{style:{flex:"1 1 20px"}}),v(l,{style:{flex:"1 1 20px"}})])]),_:1})])}const Oe=D(ae,[["render",de]]);export{Le as __pageData,Oe as default};
