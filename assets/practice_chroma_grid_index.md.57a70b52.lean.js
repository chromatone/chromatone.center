import{_ as T}from"./chunks/transport.c7b215a2.js";import{_ as j}from"./chunks/scale.8900de63.js";import{_ as B,A as I,i as N,C as q,l as z,w as M,o as c,c as p,a as l,m as $,S as E,t as V,p as G,h as L,z as W,F as w,r as y,u as o,y as A,e as v,x as k,f as U,n as H,T as J,B as K}from"./chunks/framework.eba39b59.js";import{g as C,n as S,l as D}from"./chunks/colors.de66a068.js";import{F as Y}from"./chunks/index.83aed4fc.js";import{d as Z}from"./chunks/midi.bddd4f92.js";import"./chunks/index.b30cd6d2.js";import{u as Q}from"./chunks/index.d912cb41.js";import{n as R}from"./chunks/theory.61e5aadb.js";import{u as X,r as tt}from"./chunks/loop.98b34775.js";import{i as et}from"./chunks/state.3e7769cb.js";import{b as F}from"./chunks/index.7d5af125.js";import"./chunks/knob.f7ec25c4.js";import"./chunks/index.2e01f6e2.js";import"./chunks/tempo.720ba7db.js";import"./chunks/calculations.3384a913.js";import"./chunks/index.12cb0072.js";import"./chunks/audio.b52dacdb.js";import"./chunks/Loop.b192c9c2.js";import"./chunks/tuner.36fa6797.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/keys.3310bd3a.js";import"./chunks/synth.1d50230a.js";import"./chunks/Scale.7b617051.js";import"./chunks/Subtract.f0fef764.js";import"./chunks/PingPongDelay.6f2be586.js";import"./chunks/AutoPanner.255ea60f.js";import"./chunks/MonoSynth.4cac63d2.js";import"./chunks/Filter.2b531c53.js";import"./chunks/index.86652af6.js";import"./chunks/midiRender.a93b111d.js";import"./chunks/Midi.1f918097.js";import"./chunks/Sequence.a9c1c185.js";const O=e=>(G("data-v-531a0961"),e=e(),L(),e),ot={class:"knob","drag-options":{preventWindowScrollY:!0}},lt={class:"flex items-center"},st=O(()=>l("div",{class:"i-la-minus"},null,-1)),nt=[st],it={class:"text-lg font-bold"},at=O(()=>l("div",{class:"i-la-plus"},null,-1)),rt=[at],dt={__name:"change",props:{max:{type:Number,default:100},min:{type:Number,default:0},modelValue:{type:Number,default:50},step:{type:Number,default:1},param:{type:String,default:"param"},unit:{type:String,default:""},fixed:{type:Number,default:0},ratio:{type:Number,default:1}},emits:["update:modelValue"],setup(e,{emit:m}){const i=e,t=I({active:!1,internal:0,initial:0,external:N(()=>d(t.internal))});function x(r){const{delta:[a,u],dragging:f,shiftKey:_}=r;t.active=f;let b=i.ratio;t.internal-=u/b,t.internal+=a/b,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),m("update:modelValue",t.external)}function n(r=1){let a=i.step/(i.max-i.min);t.internal+=100*a*r,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),m("update:modelValue",t.external)}q(()=>{t.internal=s(i.modelValue)});function h(){t.internal=t.initial,m("update:modelValue",t.external)}function s(r){return g(r,i.min,i.max,0,100,i.step)}function d(r){return g(r,0,100,i.min,i.max,i.step)}function g(r,a=0,u=100,f=0,_=100,b=1){_=parseFloat(_),f=parseFloat(f),u=parseFloat(u),a=parseFloat(a);let P=(r-a)*(_-f)/(u-a)+f;return Math.round(P/b)*b}return(r,a)=>{const u=z("drag");return M((c(),p("div",ot,[l("div",{class:"level",style:$({width:t.internal+"%"})},null,4),l("div",lt,[l("div",{class:"pl-1 absolute",onMousedown:a[0]||(a[0]=f=>n(-1))},nt,32),l("div",{class:"px-1 flex-1 text-center",onDblclick:a[1]||(a[1]=f=>h())},[E(r.$slots,"default",{},()=>[l("div",it,V(e.modelValue.toFixed(e.fixed))+V(e.unit),1)],!0)],32),l("div",{class:"pr-1 absolute right-0",onMousedown:a[2]||(a[2]=f=>n(1))},rt,32)])])),[[u,x]])}}},ut=B(dt,[["__scopeId","data-v-531a0961"]]);const ct=["transform"],mt=["transform"],ht=["x","width","height","fill","onMousedown"],ft=["x1","x2","stroke-width","stroke"],pt=["transform"],vt=["width","height"],gt=["transform"],xt=["data-pos","height","width"],_t=["x","font-size"],wt={__name:"column",props:{step:{type:Array,default:()=>{}},pos:{type:Number,default:0},width:{type:Number,default:100},height:{type:Number,default:500},footer:{type:Number,default:60},color:{type:String,default:"gray"},active:{type:Boolean,default:!1}},emits:["subdivide"],setup(e,{emit:m}){const i=e,t=Q(0,20,160),x=N(()=>Math.floor(t.value/20));W(x,(d,g)=>{if(d==g)return;let r=[...i.step];if(d<r.length)r.length=d;else for(let a=r.length;a<d;a++)r.push({});m("subdivide",r.map(a=>({...a,sub:d})))});function n(d){t.value+=d.delta[0]-d.delta[1]}const h=N(()=>(C.set.chroma+C.set.chroma+1).split(""));function s(d){let g=Object.entries(d).map(r=>{if(r[0]!="sub"&&r[1])return Y(Number(r[0])+C.tonic+69,"midi").toNote()}).filter(r=>r!=null);return Z.detect(g)[0]||g[0]}return(d,g)=>{const r=z("drag");return c(),p("g",{class:"col",transform:`translate(${e.pos*e.width} 0)`},[(c(),p(w,null,y(25,(a,u)=>l("g",{class:"cell",key:u,transform:`translate(0 ${e.height-a*e.height/25})`},[(c(!0),p(w,null,y(e.step,(f,_)=>(c(),p("g",{class:"sub",key:f},[l("rect",{class:"transition-all duration-200 ease-out","stroke-width":"0",x:_*e.width/e.step.length+1,width:e.width/e.step.length-2,height:e.height/25-2,rx:"4",fill:o(S)(a+o(C).tonic-1,3,h.value[u]==1?1:.1,f[u]?1:.1),onMousedown:b=>f[u]=!f[u]},null,40,ht),l("line",{class:"line pointer-events-none transition-all duration-200 ease-out",x1:_*e.width/e.step.length,x2:(_+1)*e.width/e.step.length,y1:10,y2:10,"stroke-width":f[u]?4:6,"stroke-opacity":"0.1",stroke:f[u]?"black":o(S)(a+o(C).tonic-1,3,h.value[u]==1?1:.1,f[u]?1:.5)},null,8,ft)]))),128))],8,mt)),64)),M(l("g",{class:"subs",transform:`translate(0 ${e.height})`},[M(l("rect",{width:e.width,height:e.footer,fill:"transparent"},null,8,vt),[[r,n]]),(c(!0),p(w,null,y(e.step,(a,u)=>(c(),p("g",{class:"pointer-events-none",key:a,transform:`translate(${u*e.width/e.step.length} 0)`},[l("rect",{"data-pos":e.pos,height:e.footer,stroke:"currentColor",fill:"#5552",width:e.width/e.step.length},null,8,xt),l("text",{class:"font-bold",x:e.width/e.step.length/2,y:40,"font-size":20*(1-.15*(e.step.length-1)),fill:"currentColor","text-anchor":"middle","dominant-baseline":"cental"},V(s(a)),9,_t)],8,gt))),128))],8,pt),[[A,e.active]])],8,ct)}}},yt=B(wt,[["__scopeId","data-v-1ad84a58"]]),bt={class:"is-group flex p-1 mx-1 items-center"},$t=l("div",{class:"p-2 text-xl"},"/",-1),kt={class:"is-group flex p-1 m-1"},Vt=l("div",{class:"i-la-angle-left"},null,-1),Ct=[Vt],St=l("div",{class:"i-la-angle-right"},null,-1),Nt=[St],Mt={class:"is-group p-1 flex mx-1"},Dt=l("div",{class:"i-la-dice text-xl"},null,-1),Ft=l("div",{class:"i-mdi-pan-horizontal"},null,-1),Bt=l("div",{class:"i-la-volume-up"},null,-1),It=l("div",{class:"flex-1"},null,-1),zt=l("div",{class:"i-la-trash-alt"},null,-1),Ut=[zt],Ot=l("div",{class:"i-la-times"},null,-1),Pt=[Ot],Tt=["viewBox","opacity"],jt={id:"grid-mask"},qt=["width","height"],Et={class:"all","clip-path":"url(#grid-mask)"},Gt={class:"grid"},Lt=["stroke","width","height"],Wt=["y2","stroke-width","stroke","transform"],At=["transform","stroke"],Ht=["transform"],Jt=["y2","stroke"],Kt={__name:"grid",props:{order:{type:Number,default:0},color:{type:String,default:"currentColor"},active:{type:Boolean,default:!0}},emits:["del"],setup(e){const m=e,i=I({width:1e3,height:720,footer:60}),t=X(m.order);return(x,n)=>{const h=ut;return c(),p("div",{class:"flex flex-col shadow-xl rounded-3xl overflow-hidden border-4",style:$({zIndex:e.active?100:1,opacity:e.active?1:.25,borderColor:e.color})},[l("div",{class:"flex flex-wrap p-2",style:$({opacity:e.active?1:0,backgroundColor:e.color,pointerEvents:e.active?"auto":"none"})},[l("div",bt,[v(h,{class:"w-5em",modelValue:o(t).metre.over,"onUpdate:modelValue":n[0]||(n[0]=s=>o(t).metre.over=s),step:1,min:1,max:48,param:""},null,8,["modelValue"]),$t,v(h,{class:"w-5em",modelValue:o(t).metre.under,"onUpdate:modelValue":n[1]||(n[1]=s=>o(t).metre.under=s),step:1,min:1,max:16,param:""},null,8,["modelValue"])]),l("div",kt,[l("button",{class:"text-button",onClick:n[2]||(n[2]=s=>o(t).rotate(-1))},Ct),l("button",{class:"text-button",onClick:n[3]||(n[3]=s=>o(t).rotate())},Nt)]),l("div",{class:"is-group p-1 flex mx-1 transition-all duration-300 ease",style:$({borderColor:o(S)(o(t).pitch,o(t).octave)})},[v(h,{class:"w-5em",modelValue:o(t).octave,"onUpdate:modelValue":n[4]||(n[4]=s=>o(t).octave=s),step:1,min:0,max:7,ratio:4},{default:k(()=>[l("div",{class:"font-bold transition-all duration-300 ease",style:$({color:o(S)(o(t).pitch,o(t).octave)})},V(o(R)[o(t).pitch])+V(o(t).octave),5)]),_:1},8,["modelValue"])],4),l("div",Mt,[v(h,{class:"w-5em",modelValue:o(t).probability,"onUpdate:modelValue":n[5]||(n[5]=s=>o(t).probability=s),step:.01,min:0,max:1,fixed:2},{default:k(()=>[Dt]),_:1},8,["modelValue"]),v(h,{class:"w-4em",modelValue:o(t).pan,"onUpdate:modelValue":n[6]||(n[6]=s=>o(t).pan=s),step:.01,min:-1,max:1,fixed:1,ratio:2},{default:k(()=>[Ft]),_:1},8,["modelValue"]),v(h,{class:"w-4em",modelValue:o(t).volume,"onUpdate:modelValue":n[7]||(n[7]=s=>o(t).volume=s),step:.01,min:0,max:1,fixed:1,ratio:2,onDblclick:n[8]||(n[8]=s=>o(t).volume>0?o(t).volume=0:o(t).volume=.75)},{default:k(()=>[Bt]),_:1},8,["modelValue"])]),It,l("button",{class:"text-button",onMousedown:n[9]||(n[9]=s=>o(t).clear())},Ut,32),l("button",{class:"text-button",onMousedown:n[10]||(n[10]=s=>x.$emit("del"))},Pt,32)],4),(c(),p("svg",{class:"w-full cursor-pointer",ref:"svg",version:"1.1",baseProfile:"full",viewBox:`0 0 ${i.width} ${i.height+i.footer}`,xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"},opacity:o(t).volume},[l("clipPath",jt,[l("rect",{x:0,y:-10,width:i.width,height:i.height+i.footer+10,rx:10},null,8,qt)]),l("g",Et,[l("g",Gt,[l("rect",{ref:"area",stroke:e.color,"stroke-width":10,fill:"transparent",rx:"10",width:i.width,height:i.height},null,8,Lt),(c(!0),p(w,null,y(o(t).metre.over,s=>(c(),p("line",{key:s,y2:i.height,"stroke-width":s%o(t).metre.under==0?8:s%4==0?4:e.active?1:0,stroke:e.color,transform:`translate(${s*i.width/o(t).metre.over} 0)`},null,8,Wt))),128)),l("line",{x2:"1000",transform:`translate(0 ${i.height/2})`,"stroke-width":"4",stroke:o(S)(o(t).pitch)},null,8,At)]),(c(!0),p(w,null,y(o(t).steps,(s,d)=>(c(),U(yt,{key:d,step:s,pos:d,color:e.color,width:i.width/o(t).steps.length,height:i.height,footer:i.footer,active:e.active,onSubdivide:g=>o(t).steps[d]=g},null,8,["step","pos","color","width","height","footer","active","onSubdivide"]))),128)),l("g",{class:"progress",transform:`translate(${i.width*o(t).progress} 0)`},[l("line",{y1:"0",y2:i.height,"stroke-width":"4",stroke:e.color},null,8,Jt)],8,Ht)])],8,Tt))],4)}}},Yt={class:"flex flex-col items-center rounded-3xl fullscreen-container p-2",id:"screen"},Zt={class:"flex flex-wrap mt-4 w-full justify-start px-6"},Qt=["onMousedown"],Rt={class:"px-4 py-2"},Xt=l("div",{class:"i-la-plus"},null,-1),te=[Xt],ee=l("div",{class:"flex-1"},null,-1),oe=l("div",{class:"i-la-file-download"},null,-1),le=[oe],se={class:"flex flex-col mb-4 mx-4 w-full relative h-840px"},ne={__name:"grids",setup(e){const m=F("pitch-bars",[1]);function i(){m.value.push(Math.ceil(Math.random()*100)),t.value=m.value.length-1}const t=F("pitch-bars-active",0);return(x,n)=>(c(),p("div",Yt,[l("div",Zt,[(c(!0),p(w,null,y(o(m),(h,s)=>(c(),p("button",{class:H(["px-2 rounded-t-xl mx-2px transition-all duration-300 ease flex items-center",{active:o(t)==s}]),key:h,style:$({backgroundColor:o(D)(s,o(m).length,o(t)==s?1:.3)}),onMousedown:d=>t.value=s},[l("div",Rt,V(s),1)],46,Qt))),128)),l("button",{class:"text-button",onClick:n[0]||(n[0]=h=>i())},te),ee,l("button",{class:"text-button flex items-center",onClick:n[1]||(n[1]=h=>o(tt)())},le)]),l("div",se,[v(J,{name:"fade"},{default:k(()=>[(c(!0),p(w,null,y(o(m),(h,s)=>(c(),U(Kt,{class:"absolute w-full",key:h,order:s,active:o(t)==s,color:o(D)(s,o(m).length,o(et)?.3:1),onDel:d=>{o(m).splice(s,1),t.value=o(m).length-1}},null,8,["order","active","color","onDel"]))),128))]),_:1})])]))}},qe=JSON.parse('{"title":"Chroma Grid","description":"Write note sequences in flexible grids","frontmatter":{"title":"Chroma Grid","description":"Write note sequences in flexible grids","date":"2021-11-02T00:00:00.000Z","cover":"grid.png","todo":["MIDI out channels","midi out on-off","solo","mutes","synth"]},"headers":[],"relativePath":"practice/chroma/grid/index.md","filePath":"practice/chroma/grid/index.md"}'),ie={name:"practice/chroma/grid/index.md"},Ee=Object.assign(ie,{setup(e){return(m,i)=>{const t=j,x=T,n=K("client-only");return c(),p("div",null,[v(n,null,{default:k(()=>[v(t),v(ne),v(x)]),_:1})])}}});export{qe as __pageData,Ee as default};
