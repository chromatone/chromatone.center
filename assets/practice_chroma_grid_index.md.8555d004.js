import{_ as q}from"./chunks/StateTransport.7ac35001.js";import{_ as D,b as S,H as L,A as B,o as u,c as h,F as w,d as y,a as n,u as o,B as M,G as T,t as C,r as G,P as E,C as b,Q as O,p as W,q as j,f as g,w as k,g as U,L as F,n as A,T as H,I as J}from"./chunks/framework.c7ad3ca2.js";import{g as V,n as N,l as I}from"./chunks/colors.394b294c.js";import{u as K,F as Q}from"./chunks/index.098dc14b.js";import{d as Y}from"./chunks/midi.9486e5fa.js";import"./chunks/index.b30cd6d2.js";import{n as Z}from"./chunks/theory.61e5aadb.js";import{u as R,r as X}from"./chunks/loop.93be4422.js";import{i as tt}from"./chunks/state.94f7e80e.js";import{_ as et}from"./chunks/ControlScale.aa9a1b0b.js";import"./chunks/ControlKnob.762a1b28.js";import"./chunks/index.4016c1de.js";import"./chunks/tempo.4bdd83c1.js";import"./chunks/calculations.65ee336d.js";import"./chunks/index.b3129a1a.js";import"./chunks/audio.01373f6f.js";import"./chunks/Loop.97b07c3f.js";import"./chunks/tuner.11147eb4.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.654bd828.js";import"./chunks/synth.97f998a0.js";import"./chunks/Scale.22b16e3d.js";import"./chunks/Subtract.beb0cc34.js";import"./chunks/PingPongDelay.187daa12.js";import"./chunks/AutoPanner.8d278bb2.js";import"./chunks/MonoSynth.ecb6ed30.js";import"./chunks/Filter.fb7acdf5.js";import"./chunks/index.86652af6.js";import"./chunks/midiRender.bb5d7d88.js";import"./chunks/Midi.1f918097.js";import"./chunks/Sequence.dc8acd0f.js";import"./chunks/ChromaKeys.5e11627e.js";const ot=["transform"],lt=["transform"],nt=["x","width","height","fill","onMousedown"],st=["x1","x2","stroke-width","stroke"],it=["transform"],at=["width","height"],rt=["transform"],dt=["data-pos","height","width"],ut=["x","font-size"],ct={__name:"ChromaGridsColumn",props:{step:{type:Array,default:()=>{}},pos:{type:Number,default:0},width:{type:Number,default:100},height:{type:Number,default:500},footer:{type:Number,default:60},color:{type:String,default:"gray"},active:{type:Boolean,default:!1}},emits:["subdivide"],setup(e,{emit:c}){const s=e,t=K(0,20,160),x=S(()=>Math.floor(t.value/20));L(x,(l,f)=>{if(l==f)return;let a=[...s.step];if(l<a.length)a.length=l;else for(let r=a.length;r<l;r++)a.push({});c("subdivide",a.map(r=>({...r,sub:l})))});function i(l){t.value+=l.delta[0]-l.delta[1]}const p=S(()=>(V.set.chroma+V.set.chroma+1).split(""));function v(l){let f=Object.entries(l).map(a=>{if(a[0]!="sub"&&a[1])return Q(Number(a[0])+V.tonic+69,"midi").toNote()}).filter(a=>a!=null);return Y.detect(f)[0]||f[0]}return(l,f)=>{const a=B("drag");return u(),h("g",{class:"col",transform:`translate(${e.pos*e.width} 0)`},[(u(),h(w,null,y(25,(r,d)=>n("g",{class:"cell",key:d,transform:`translate(0 ${e.height-r*e.height/25})`},[(u(!0),h(w,null,y(e.step,(m,_)=>(u(),h("g",{class:"sub",key:m},[n("rect",{class:"transition-all duration-200 ease-out","stroke-width":"0",x:_*e.width/e.step.length+1,width:e.width/e.step.length-2,height:e.height/25-2,rx:"4",fill:o(N)(r+o(V).tonic-1,3,p.value[d]==1?1:.1,m[d]?1:.1),onMousedown:$=>m[d]=!m[d]},null,40,nt),n("line",{class:"line pointer-events-none transition-all duration-200 ease-out",x1:_*e.width/e.step.length,x2:(_+1)*e.width/e.step.length,y1:10,y2:10,"stroke-width":m[d]?4:6,"stroke-opacity":"0.1",stroke:m[d]?"black":o(N)(r+o(V).tonic-1,3,p.value[d]==1?1:.1,m[d]?1:.5)},null,8,st)]))),128))],8,lt)),64)),M(n("g",{class:"subs",transform:`translate(0 ${e.height})`},[M(n("rect",{width:e.width,height:e.footer,fill:"transparent"},null,8,at),[[a,i]]),(u(!0),h(w,null,y(e.step,(r,d)=>(u(),h("g",{class:"pointer-events-none",key:r,transform:`translate(${d*e.width/e.step.length} 0)`},[n("rect",{"data-pos":e.pos,height:e.footer,stroke:"currentColor",fill:"#5552",width:e.width/e.step.length},null,8,dt),n("text",{class:"font-bold",x:e.width/e.step.length/2,y:40,"font-size":20*(1-.15*(e.step.length-1)),fill:"currentColor","text-anchor":"middle","dominant-baseline":"cental"},C(v(r)),9,ut)],8,rt))),128))],8,it),[[T,e.active]])],8,ot)}}},mt=D(ct,[["__scopeId","data-v-13dc99aa"]]);const z=e=>(W("data-v-81a66231"),e=e(),j(),e),ht={class:"knob","drag-options":{preventWindowScrollY:!0}},ft={class:"flex items-center"},pt=z(()=>n("div",{class:"i-la-minus"},null,-1)),vt=[pt],gt={class:"text-lg font-bold"},_t=z(()=>n("div",{class:"i-la-plus"},null,-1)),xt=[_t],wt={__name:"ControlChange",props:{max:{type:Number,default:100},min:{type:Number,default:0},modelValue:{type:Number,default:50},step:{type:Number,default:1},param:{type:String,default:"param"},unit:{type:String,default:""},fixed:{type:Number,default:0},ratio:{type:Number,default:1}},emits:["update:modelValue"],setup(e,{emit:c}){const s=e,t=G({active:!1,internal:0,initial:0,external:S(()=>l(t.internal))});function x(a){const{delta:[r,d],dragging:m,shiftKey:_}=a;t.active=m;let $=s.ratio;t.internal-=d/$,t.internal+=r/$,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),c("update:modelValue",t.external)}function i(a=1){let r=s.step/(s.max-s.min);t.internal+=100*r*a,t.internal>100&&(t.internal=100),t.internal<0&&(t.internal=0),c("update:modelValue",t.external)}E(()=>{t.internal=v(s.modelValue)});function p(){t.internal=t.initial,c("update:modelValue",t.external)}function v(a){return f(a,s.min,s.max,0,100,s.step)}function l(a){return f(a,0,100,s.min,s.max,s.step)}function f(a,r=0,d=100,m=0,_=100,$=1){_=parseFloat(_),m=parseFloat(m),d=parseFloat(d),r=parseFloat(r);let P=(a-r)*(_-m)/(d-r)+m;return Math.round(P/$)*$}return(a,r)=>{const d=B("drag");return M((u(),h("div",ht,[n("div",{class:"level",style:b({width:t.internal+"%"})},null,4),n("div",ft,[n("div",{class:"pl-1 absolute",onMousedown:r[0]||(r[0]=m=>i(-1))},vt,32),n("div",{class:"px-1 flex-1 text-center",onDblclick:r[1]||(r[1]=m=>p())},[O(a.$slots,"default",{},()=>[n("div",gt,C(e.modelValue.toFixed(e.fixed))+C(e.unit),1)],!0)],32),n("div",{class:"pr-1 absolute right-0",onMousedown:r[2]||(r[2]=m=>i(1))},xt,32)])])),[[d,x]])}}},yt=D(wt,[["__scopeId","data-v-81a66231"]]),$t={class:"is-group flex p-1 mx-1 items-center"},bt=n("div",{class:"p-2 text-xl"},"/",-1),kt={class:"is-group flex p-1 m-1"},Ct=n("div",{class:"i-la-angle-left"},null,-1),Vt=[Ct],Nt=n("div",{class:"i-la-angle-right"},null,-1),St=[Nt],Mt={class:"is-group p-1 flex mx-1"},Dt=n("div",{class:"i-la-dice text-xl"},null,-1),Ft=n("div",{class:"i-mdi-pan-horizontal"},null,-1),It=n("div",{class:"i-la-volume-up"},null,-1),Bt=n("div",{class:"flex-1"},null,-1),Gt=n("div",{class:"i-la-trash-alt"},null,-1),Ut=[Gt],zt=n("div",{class:"i-la-times"},null,-1),Pt=[zt],qt=["viewBox","opacity"],Lt={id:"grid-mask"},Tt=["width","height"],Et={class:"all","clip-path":"url(#grid-mask)"},Ot={class:"grid"},Wt=["stroke","width","height"],jt=["y2","stroke-width","stroke","transform"],At=["transform","stroke"],Ht=["transform"],Jt=["y2","stroke"],Kt={__name:"ChromaGridsGrid",props:{order:{type:Number,default:0},color:{type:String,default:"currentColor"},active:{type:Boolean,default:!0}},emits:["del"],setup(e){const c=e,s=G({width:1e3,height:720,footer:60}),t=R(c.order);return(x,i)=>{const p=yt,v=mt;return u(),h("div",{class:"flex flex-col shadow-xl rounded-3xl overflow-hidden border-4",style:b({zIndex:e.active?100:1,opacity:e.active?1:.25,borderColor:e.color})},[n("div",{class:"flex flex-wrap p-2",style:b({opacity:e.active?1:0,backgroundColor:e.color,pointerEvents:e.active?"auto":"none"})},[n("div",$t,[g(p,{class:"w-5em",modelValue:o(t).metre.over,"onUpdate:modelValue":i[0]||(i[0]=l=>o(t).metre.over=l),step:1,min:1,max:48,param:""},null,8,["modelValue"]),bt,g(p,{class:"w-5em",modelValue:o(t).metre.under,"onUpdate:modelValue":i[1]||(i[1]=l=>o(t).metre.under=l),step:1,min:1,max:16,param:""},null,8,["modelValue"])]),n("div",kt,[n("button",{class:"text-button",onClick:i[2]||(i[2]=l=>o(t).rotate(-1))},Vt),n("button",{class:"text-button",onClick:i[3]||(i[3]=l=>o(t).rotate())},St)]),n("div",{class:"is-group p-1 flex mx-1 transition-all duration-300 ease",style:b({borderColor:o(N)(o(t).pitch,o(t).octave)})},[g(p,{class:"w-5em",modelValue:o(t).octave,"onUpdate:modelValue":i[4]||(i[4]=l=>o(t).octave=l),step:1,min:0,max:7,ratio:4},{default:k(()=>[n("div",{class:"font-bold transition-all duration-300 ease",style:b({color:o(N)(o(t).pitch,o(t).octave)})},C(o(Z)[o(t).pitch])+C(o(t).octave),5)]),_:1},8,["modelValue"])],4),n("div",Mt,[g(p,{class:"w-5em",modelValue:o(t).probability,"onUpdate:modelValue":i[5]||(i[5]=l=>o(t).probability=l),step:.01,min:0,max:1,fixed:2},{default:k(()=>[Dt]),_:1},8,["modelValue"]),g(p,{class:"w-4em",modelValue:o(t).pan,"onUpdate:modelValue":i[6]||(i[6]=l=>o(t).pan=l),step:.01,min:-1,max:1,fixed:1,ratio:2},{default:k(()=>[Ft]),_:1},8,["modelValue"]),g(p,{class:"w-4em",modelValue:o(t).volume,"onUpdate:modelValue":i[7]||(i[7]=l=>o(t).volume=l),step:.01,min:0,max:1,fixed:1,ratio:2,onDblclick:i[8]||(i[8]=l=>o(t).volume>0?o(t).volume=0:o(t).volume=.75)},{default:k(()=>[It]),_:1},8,["modelValue"])]),Bt,n("button",{class:"text-button",onMousedown:i[9]||(i[9]=l=>o(t).clear())},Ut,32),n("button",{class:"text-button",onMousedown:i[10]||(i[10]=l=>x.$emit("del"))},Pt,32)],4),(u(),h("svg",{class:"w-full cursor-pointer",ref:"svg",version:"1.1",baseProfile:"full",viewBox:`0 0 ${s.width} ${s.height+s.footer}`,xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"},opacity:o(t).volume},[n("clipPath",Lt,[n("rect",{x:0,y:-10,width:s.width,height:s.height+s.footer+10,rx:10},null,8,Tt)]),n("g",Et,[n("g",Ot,[n("rect",{ref:"area",stroke:e.color,"stroke-width":10,fill:"transparent",rx:"10",width:s.width,height:s.height},null,8,Wt),(u(!0),h(w,null,y(o(t).metre.over,l=>(u(),h("line",{key:l,y2:s.height,"stroke-width":l%o(t).metre.under==0?8:l%4==0?4:e.active?1:0,stroke:e.color,transform:`translate(${l*s.width/o(t).metre.over} 0)`},null,8,jt))),128)),n("line",{x2:"1000",transform:`translate(0 ${s.height/2})`,"stroke-width":"4",stroke:o(N)(o(t).pitch)},null,8,At)]),(u(!0),h(w,null,y(o(t).steps,(l,f)=>(u(),U(v,{key:f,step:l,pos:f,color:e.color,width:s.width/o(t).steps.length,height:s.height,footer:s.footer,active:e.active,onSubdivide:a=>o(t).steps[f]=a},null,8,["step","pos","color","width","height","footer","active","onSubdivide"]))),128)),n("g",{class:"progress",transform:`translate(${s.width*o(t).progress} 0)`},[n("line",{y1:"0",y2:s.height,"stroke-width":"4",stroke:e.color},null,8,Jt)],8,Ht)])],8,qt))],4)}}},Qt={class:"flex flex-col items-center rounded-3xl fullscreen-container p-2",id:"screen"},Yt={class:"flex flex-wrap mt-4 w-full justify-start px-6"},Zt=["onMousedown"],Rt={class:"px-4 py-2"},Xt=n("div",{class:"i-la-plus"},null,-1),te=[Xt],ee=n("div",{class:"flex-1"},null,-1),oe=n("div",{class:"i-la-file-download"},null,-1),le=[oe],ne={class:"flex flex-col mb-4 mx-4 w-full relative h-840px"},se={__name:"ChromaGrids",setup(e){const c=F("pitch-bars",[1]);function s(){c.value.push(Math.ceil(Math.random()*100)),t.value=c.value.length-1}const t=F("pitch-bars-active",0);return(x,i)=>{const p=Kt;return u(),h("div",Qt,[n("div",Yt,[(u(!0),h(w,null,y(o(c),(v,l)=>(u(),h("button",{class:A(["px-2 rounded-t-xl mx-2px transition-all duration-300 ease flex items-center",{active:o(t)==l}]),key:v,style:b({backgroundColor:o(I)(l,o(c).length,o(t)==l?1:.3)}),onMousedown:f=>t.value=l},[n("div",Rt,C(l),1)],46,Zt))),128)),n("button",{class:"text-button",onClick:i[0]||(i[0]=v=>s())},te),ee,n("button",{class:"text-button flex items-center",onClick:i[1]||(i[1]=v=>o(X)())},le)]),n("div",ne,[g(H,{name:"fade"},{default:k(()=>[(u(!0),h(w,null,y(o(c),(v,l)=>(u(),U(p,{class:"absolute w-full",key:v,order:l,active:o(t)==l,color:o(I)(l,o(c).length,o(tt)?.3:1),onDel:f=>{o(c).splice(l,1),t.value=o(c).length-1}},null,8,["order","active","color","onDel"]))),128))]),_:1})])])}}},Te=JSON.parse('{"title":"Chroma Grid","description":"Write note sequences in flexible grids","frontmatter":{"title":"Chroma Grid","description":"Write note sequences in flexible grids","date":"2021-11-02T00:00:00.000Z","cover":"grid.png","todo":["MIDI out channels","midi out on-off","solo","mutes","synth"]},"headers":[],"relativePath":"practice/chroma/grid/index.md","filePath":"practice/chroma/grid/index.md","lastUpdated":1689843676000}'),ie={name:"practice/chroma/grid/index.md"};function ae(e,c,s,t,x,i){const p=et,v=se,l=q,f=J("client-only");return u(),h("div",null,[g(f,null,{default:k(()=>[g(p),g(v),g(l)]),_:1})])}const Ee=D(ie,[["render",ae]]);export{Te as __pageData,Ee as default};
