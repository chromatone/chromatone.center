import{Q as L,g as N,n as S,F as P,i as W,R as O,e as j,S as I,T as A,_ as J,U as K}from"./chunks/theme.D0Tws7Nb.js";import{q as F,c as M,d as H,V as U,v as h,x as v,F as y,A as $,z as o,D as e,B as D,C as Q,E as C,b as z,w as R,G as k,I as Y,J as Z,K as X,W as g,M as V,L as T,af as tt,u as B,y as G,a0 as et,a4 as ot,a1 as st}from"./chunks/framework.BrrbF0ng.js";const lt=["transform"],nt=["transform"],it=["x","width","height","fill","onMousedown"],at=["x1","x2","stroke-width","stroke"],rt=["transform"],dt=["width","height"],ct=["transform"],ut=["data-pos","height","width"],ht=["x","font-size"],mt={__name:"ChromaGridsColumn",props:{step:{type:Array,default:()=>{}},pos:{type:Number,default:0},width:{type:Number,default:100},height:{type:Number,default:500},footer:{type:Number,default:60},color:{type:String,default:"gray"},active:{type:Boolean,default:!1}},emits:["subdivide"],setup(t,{emit:_}){const l=t,s=_,i=L(0,20,160),r=M(()=>Math.floor(i.value/20));H(r,(a,p)=>{if(a==p)return;let c=[...l.step];if(a<c.length)c.length=a;else for(let d=c.length;d<a;d++)c.push({});s("subdivide",c.map(d=>({...d,sub:a})))});function m(a){i.value+=a.delta[0]-a.delta[1]}const x=M(()=>(N.set.chroma+N.set.chroma+1).split(""));function n(a){let p=Object.entries(a).map(c=>{if(c[0]!="sub"&&c[1])return P(Number(c[0])+N.tonic+69,"midi").toNote()}).filter(c=>c!=null);return W.detect(p)[0]||p[0]}return(a,p)=>{const c=U("drag");return h(),v("g",{class:"col",transform:`translate(${t.pos*t.width} 0)`},[(h(),v(y,null,$(25,(d,u)=>o("g",{class:"cell",key:u,transform:`translate(0 ${t.height-d*t.height/25})`},[(h(!0),v(y,null,$(t.step,(f,w)=>(h(),v("g",{class:"sub",key:f},[o("rect",{class:"transition-all duration-200 ease-out","stroke-width":"0",x:w*t.width/t.step.length+1,width:t.width/t.step.length-2,height:t.height/25-2,rx:"4",fill:e(S)(d+e(N).tonic-1,3,x.value[u]==1?1:.1,f[u]?1:.1),onMousedown:b=>f[u]=!f[u]},null,40,it),o("line",{class:"line pointer-events-none transition-all duration-200 ease-out",x1:w*t.width/t.step.length,x2:(w+1)*t.width/t.step.length,y1:10,y2:10,"stroke-width":f[u]?4:6,"stroke-opacity":"0.1",stroke:f[u]?"black":e(S)(d+e(N).tonic-1,3,x.value[u]==1?1:.1,f[u]?1:.5)},null,8,at)]))),128))],8,nt)),64)),D(o("g",{class:"subs",transform:`translate(0 ${t.height})`},[D(o("rect",{width:t.width,height:t.footer,fill:"transparent"},null,8,dt),[[c,m]]),(h(!0),v(y,null,$(t.step,(d,u)=>(h(),v("g",{class:"pointer-events-none",key:d,transform:`translate(${u*t.width/t.step.length} 0)`},[o("rect",{"data-pos":t.pos,height:t.footer,stroke:"currentColor",fill:"#5552",width:t.width/t.step.length},null,8,ut),o("text",{class:"font-bold",x:t.width/t.step.length/2,y:40,"font-size":20*(1-.15*(t.step.length-1)),fill:"currentColor","text-anchor":"middle","dominant-baseline":"cental"},C(n(d)),9,ht)],8,ct))),128))],8,rt),[[Q,t.active]])],8,lt)}}},ft=F(mt,[["__scopeId","data-v-13dc99aa"]]),q=t=>(Z("data-v-81a66231"),t=t(),X(),t),vt={class:"knob","drag-options":{preventWindowScrollY:!0}},pt={class:"flex items-center"},gt=q(()=>o("div",{class:"i-la-minus"},null,-1)),xt=[gt],_t={class:"text-lg font-bold"},wt=q(()=>o("div",{class:"i-la-plus"},null,-1)),yt=[wt],$t={__name:"ControlChange",props:{max:{type:Number,default:100},min:{type:Number,default:0},modelValue:{type:Number,default:50},step:{type:Number,default:1},param:{type:String,default:"param"},unit:{type:String,default:""},fixed:{type:Number,default:0},ratio:{type:Number,default:1}},emits:["update:modelValue"],setup(t,{emit:_}){const l=t,s=_,i=z({active:!1,internal:0,initial:0,external:M(()=>a(i.internal))});function r(c){const{delta:[d,u],dragging:f,shiftKey:w}=c;i.active=f;let b=l.ratio;i.internal-=u/b,i.internal+=d/b,i.internal>100&&(i.internal=100),i.internal<0&&(i.internal=0),s("update:modelValue",i.external)}function m(c=1){let d=l.step/(l.max-l.min);i.internal+=100*d*c,i.internal>100&&(i.internal=100),i.internal<0&&(i.internal=0),s("update:modelValue",i.external)}R(()=>{i.internal=n(l.modelValue)});function x(){i.internal=i.initial,s("update:modelValue",i.external)}function n(c){return p(c,l.min,l.max,0,100,l.step)}function a(c){return p(c,0,100,l.min,l.max,l.step)}function p(c,d=0,u=100,f=0,w=100,b=1){w=parseFloat(w),f=parseFloat(f),u=parseFloat(u),d=parseFloat(d);let E=(c-d)*(w-f)/(u-d)+f;return Math.round(E/b)*b}return(c,d)=>{const u=U("drag");return D((h(),v("div",vt,[o("div",{class:"level",style:k({width:i.internal+"%"})},null,4),o("div",pt,[o("div",{class:"pl-1 absolute",onMousedown:d[0]||(d[0]=f=>m(-1))},xt,32),o("div",{class:"px-1 flex-1 text-center",onDblclick:d[1]||(d[1]=f=>x())},[Y(c.$slots,"default",{},()=>[o("div",_t,C(t.modelValue.toFixed(t.fixed))+C(t.unit),1)],!0)],32),o("div",{class:"pr-1 absolute right-0",onMousedown:d[2]||(d[2]=f=>m(1))},yt,32)])])),[[u,r]])}}},bt=F($t,[["__scopeId","data-v-81a66231"]]),kt={class:"is-group flex p-1 mx-1 items-center"},Vt=o("div",{class:"p-2 text-xl"},"/",-1),Ct={class:"is-group flex p-1 m-1"},Nt=o("div",{class:"i-la-angle-left"},null,-1),St=[Nt],Mt=o("div",{class:"i-la-angle-right"},null,-1),Dt=[Mt],Ft={class:"is-group p-1 flex mx-1"},It=o("div",{class:"i-la-dice text-xl"},null,-1),Bt=o("div",{class:"i-mdi-pan-horizontal"},null,-1),Gt=o("div",{class:"i-la-volume-up"},null,-1),Ut=o("div",{class:"flex-1"},null,-1),zt=o("div",{class:"i-la-trash-alt"},null,-1),Tt=[zt],qt=o("div",{class:"i-la-times"},null,-1),Et=[qt],Lt=["viewBox","opacity"],Pt={id:"grid-mask"},Wt=["width","height"],Ot={class:"all","clip-path":"url(#grid-mask)"},jt={class:"grid"},At=["stroke","width","height"],Jt=["y2","stroke-width","stroke","transform"],Kt=["transform","stroke"],Ht=["transform"],Qt=["y2","stroke"],Rt={__name:"ChromaGridsGrid",props:{order:{type:Number,default:0},color:{type:String,default:"currentColor"},active:{type:Boolean,default:!0}},emits:["del"],setup(t){const _=t,l=z({width:1e3,height:720,footer:60}),s=O(_.order);return(i,r)=>{const m=bt,x=ft;return h(),v("div",{class:"flex flex-col shadow-xl rounded-3xl overflow-hidden border-4",style:k({zIndex:t.active?100:1,opacity:t.active?1:.25,borderColor:t.color})},[o("div",{class:"flex flex-wrap p-2",style:k({opacity:t.active?1:0,backgroundColor:t.color,pointerEvents:t.active?"auto":"none"})},[o("div",kt,[g(m,{class:"w-5em",modelValue:e(s).metre.over,"onUpdate:modelValue":r[0]||(r[0]=n=>e(s).metre.over=n),step:1,min:1,max:48,param:""},null,8,["modelValue"]),Vt,g(m,{class:"w-5em",modelValue:e(s).metre.under,"onUpdate:modelValue":r[1]||(r[1]=n=>e(s).metre.under=n),step:1,min:1,max:16,param:""},null,8,["modelValue"])]),o("div",Ct,[o("button",{class:"text-button",onClick:r[2]||(r[2]=n=>e(s).rotate(-1))},St),o("button",{class:"text-button",onClick:r[3]||(r[3]=n=>e(s).rotate())},Dt)]),o("div",{class:"is-group p-1 flex mx-1 transition-all duration-300 ease",style:k({borderColor:e(S)(e(s).pitch,e(s).octave)})},[g(m,{class:"w-5em",modelValue:e(s).octave,"onUpdate:modelValue":r[4]||(r[4]=n=>e(s).octave=n),step:1,min:0,max:7,ratio:4},{default:V(()=>[o("div",{class:"font-bold transition-all duration-300 ease",style:k({color:e(S)(e(s).pitch,e(s).octave)})},C(e(j)[e(s).pitch])+C(e(s).octave),5)]),_:1},8,["modelValue"])],4),o("div",Ft,[g(m,{class:"w-5em",modelValue:e(s).probability,"onUpdate:modelValue":r[5]||(r[5]=n=>e(s).probability=n),step:.01,min:0,max:1,fixed:2},{default:V(()=>[It]),_:1},8,["modelValue"]),g(m,{class:"w-4em",modelValue:e(s).pan,"onUpdate:modelValue":r[6]||(r[6]=n=>e(s).pan=n),step:.01,min:-1,max:1,fixed:1,ratio:2},{default:V(()=>[Bt]),_:1},8,["modelValue"]),g(m,{class:"w-4em",modelValue:e(s).volume,"onUpdate:modelValue":r[7]||(r[7]=n=>e(s).volume=n),step:.01,min:0,max:1,fixed:1,ratio:2,onDblclick:r[8]||(r[8]=n=>e(s).volume>0?e(s).volume=0:e(s).volume=.75)},{default:V(()=>[Gt]),_:1},8,["modelValue"])]),Ut,o("button",{class:"text-button",onMousedown:r[9]||(r[9]=n=>e(s).clear())},Tt,32),o("button",{class:"text-button",onMousedown:r[10]||(r[10]=n=>i.$emit("del"))},Et,32)],4),(h(),v("svg",{class:"w-full cursor-pointer",ref:"svg",version:"1.1",baseProfile:"full",viewBox:`0 0 ${l.width} ${l.height+l.footer}`,xmlns:"http://www.w3.org/2000/svg",style:{"user-select":"none","touch-action":"none"},opacity:e(s).volume},[o("clipPath",Pt,[o("rect",{x:0,y:-10,width:l.width,height:l.height+l.footer+10,rx:10},null,8,Wt)]),o("g",Ot,[o("g",jt,[o("rect",{ref:"area",stroke:t.color,"stroke-width":10,fill:"transparent",rx:"10",width:l.width,height:l.height},null,8,At),(h(!0),v(y,null,$(e(s).metre.over,n=>(h(),v("line",{key:n,y2:l.height,"stroke-width":n%e(s).metre.under==0?8:n%4==0?4:t.active?1:0,stroke:t.color,transform:`translate(${n*l.width/e(s).metre.over} 0)`},null,8,Jt))),128)),o("line",{x2:"1000",transform:`translate(0 ${l.height/2})`,"stroke-width":"4",stroke:e(S)(e(s).pitch)},null,8,Kt)]),(h(!0),v(y,null,$(e(s).steps,(n,a)=>(h(),T(x,{key:a,step:n,pos:a,color:t.color,width:l.width/e(s).steps.length,height:l.height,footer:l.footer,active:t.active,onSubdivide:p=>e(s).steps[a]=p},null,8,["step","pos","color","width","height","footer","active","onSubdivide"]))),128)),o("g",{class:"progress",transform:`translate(${l.width*e(s).progress} 0)`},[o("line",{y1:"0",y2:l.height,"stroke-width":"4",stroke:t.color},null,8,Qt)],8,Ht)])],8,Lt))],4)}}},Yt={class:"flex flex-col items-center rounded-3xl fullscreen-container p-2",id:"screen"},Zt={class:"flex flex-wrap mt-4 w-full justify-start px-6"},Xt=["onMousedown"],te={class:"px-4 py-2"},ee=o("div",{class:"i-la-plus"},null,-1),oe=[ee],se=o("div",{class:"flex-1"},null,-1),le=o("div",{class:"i-la-file-download"},null,-1),ne=[le],ie={class:"flex flex-col mb-4 mx-4 w-full relative"},ae={__name:"ChromaGrids",setup(t){const{isDark:_}=tt(),l=B("pitch-bars",[1]);function s(){l.value.push(Math.ceil(Math.random()*100)),i.value=l.value.length-1}const i=B("pitch-bars-active",0);return(r,m)=>{const x=Rt;return h(),v("div",Yt,[o("div",Zt,[(h(!0),v(y,null,$(e(l),(n,a)=>(h(),v("button",{class:G(["px-2 rounded-t-xl mx-2px transition-all duration-300 ease flex items-center",{active:e(i)==a}]),key:n,style:k({backgroundColor:e(I)(a,e(l).length,e(i)==a?1:.3)}),onMousedown:p=>i.value=a},[o("div",te,C(a),1)],46,Xt))),128)),o("button",{class:"text-button",onClick:m[0]||(m[0]=n=>s())},oe),se,o("button",{class:"text-button flex items-center",onClick:m[1]||(m[1]=n=>e(A)())},ne)]),o("div",ie,[g(et,{name:"fade"},{default:V(()=>[(h(!0),v(y,null,$(e(l),(n,a)=>(h(),T(x,{class:G(["w-full",{absolute:a>0}]),key:n,order:a,active:e(i)==a,color:e(I)(a,e(l).length,e(_)?.3:1),onDel:p=>{e(l).splice(a,1),i.value=e(l).length-1}},null,8,["class","order","active","color","onDel"]))),128))]),_:1})])])}}},me=JSON.parse('{"title":"Chroma Grid","description":"Write note sequences in flexible grids","frontmatter":{"title":"Chroma Grid","description":"Write note sequences in flexible grids","layout":"app","date":"2021-11-02T00:00:00.000Z","cover":"grid.png","todo":["MIDI out channels","midi out on-off","solo","mutes","synth"]},"headers":[],"relativePath":"practice/chroma/grid/index.md","filePath":"practice/chroma/grid/index.md","lastUpdated":1717520064000}'),re={name:"practice/chroma/grid/index.md"},de={class:"flex flex-wrap"};function ce(t,_,l,s,i,r){const m=ae,x=J,n=K,a=ot("client-only");return h(),v("div",null,[g(a,null,{default:V(()=>[g(m),st(),o("div",de,[g(x,{style:{flex:"1 1 20px"}}),g(n,{style:{flex:"1 1 20px"}})])]),_:1})])}const fe=F(re,[["render",ce]]);export{me as __pageData,fe as default};
