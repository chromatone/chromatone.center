import{_ as G}from"./chunks/ChromaKeys.TJFI2vJX.js";import{_ as L}from"./chunks/JamScale.cm7Dob76.js";import{_ as R}from"./chunks/SvgRing.DU2HI9uw.js";import{U as N,e as C,V as j,W as J,r as W,g as p,n as K,f as O}from"./chunks/theme.BfFXtHPj.js";import{D as A,ak as X,r as I,b as Z,c as q,d as H,n as Q,E as m,F as d,G as _,V as T,W as S,C as n,O as b,X as U,L as Y,I as z,T as ee}from"./chunks/framework.YjWD1Pnt.js";import"./chunks/ChromaCode.DmXnzt94.js";const te={class:"w-full max-w-full h-100vh"},oe=["viewBox"],ne={class:"octaves"},ae={class:"touches"},se=["stroke","x2","y2"],ce=["transform"],ie=["fill"],re={class:"fill-black text-6px"},le={__name:"ChromaTouch",setup(E){const{isDark:D}=X(),v=I(4),x=I(2),a={pad:.5,r:50},w=I(),c=Z({}),F=q(()=>{const e={};for(let t in c){const{angle:r,distance:l}=c[t],i=Math.ceil((r-15)/30)%12,h=Math.floor((1-l)*v.value+x.value-2),f=(h+4)*12+i-3;e[t]={pitch:i,octave:h,num:f}}return e});function $({clientX:e,clientY:t}){const r=w.value.createSVGPoint();r.x=e,r.y=t;let{x:l,y:i}=r.matrixTransform(w.value.getScreenCTM().inverse());return{x:l,y:i,angle:180*(Math.PI-Math.atan2(l,i))/Math.PI,distance:Math.hypot(l,i)/a.r}}function y(e){e.type=="mousedown"?c.mouse=$(e):["mouseup","mouseleave","mouseout"].includes(e.type)?delete c.mouse:c.mouse&&e.type=="mousemove"&&(c.mouse=$(e))}function M(e){for(let t of e.changedTouches)["touchend","touchcancel"].includes(e.type)?delete c[t.identifier]:c[t.identifier]=$(t)}return H(F,(e,t)=>{var r,l,i,h,f,s;for(let o in e)((r=e[o])==null?void 0:r.num)!=((l=t[o])==null?void 0:l.num)&&(N(C[(i=e[o])==null?void 0:i.pitch],((h=e[o])==null?void 0:h.octave)-x.value+(((f=e[o])==null?void 0:f.pitch)>=3?1:0)),j({number:(s=e[o])==null?void 0:s.num}));Q(()=>{var o,k,u,P,V,B;for(let g in t)((o=t[g])==null?void 0:o.num)!=((k=e[g])==null?void 0:k.num)&&(N(C[(u=t[g])==null?void 0:u.pitch],((P=t[g])==null?void 0:P.octave)-x.value+(((V=t[g])==null?void 0:V.pitch)>=3?1:0),!0),J({number:(B=t[g])==null?void 0:B.num}))})}),(e,t)=>{var h,f;const r=R,l=L,i=G;return m(),d(T,null,[_("div",te,[(m(),d("svg",{class:"select-none touch-action-none max-h-full",ref_key:"svg",ref:w,version:"1.1",baseProfile:"full",viewBox:`${-a.r-a.pad} ${-a.r-a.pad} ${a.r*2+2*a.pad} ${a.r*2+2*a.pad}`,xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none","-webkit-user-select":"none !important","-webkit-touch-callout":"none"},"font-family":"Commissioner, sans-serif","text-anchor":"middle","dominant-baseline":"middle",onTouchstart:M,onTouchmove:M,onTouchend:M,onTouchcancel:M,onMouseenter:y,onMousemove:y,onMousedown:y,onMouseup:y,onMouseleave:y},[_("g",ne,[(m(!0),d(T,null,S(v.value,(s,o)=>(m(),d("g",{class:"octave op-90",key:s},[(m(!0),d(T,null,S(n(C),(k,u)=>(m(),d("g",{key:k},[b(r,{cx:0,cy:0,radius:a.r-o*(a.r/v.value),thickness:a.r/v.value,from:u*30-15,to:(u+1)*30-15,fill:n(K)(u,o+x.value,n(W)(n(p).chroma,-n(p).tonic)[u]==1?1:.5,n(O).activeNotes[u+(o+x.value+1)*12+9]?1:.8)},{default:U(()=>[o==0?(m(),d("text",{key:0,class:"fill-black text-4px",style:Y({fontWeight:n(W)(n(p).chroma,-n(p).tonic)[u]==1?"bold":"normal",fontSize:n(p).tonic==u?"8px":"4px"}),y:"1"},z(k),5)):ee("",!0)]),_:2},1032,["radius","thickness","from","to","fill"])]))),128))]))),128)),_("g",ae,[(m(!0),d(T,null,S(c,(s,o)=>(m(),d("g",{class:"touch",key:o},[_("line",{"stroke-linecap":"round",stroke:`hsl(${s.angle}deg, 50%,50%)`,x2:s.x,y2:s.y},null,8,se),_("g",{transform:`translate(${s.x} ${s.y})`},[_("circle",{r:"2",fill:n(D)?"#fff3":"#3333"},null,8,ie)],8,ce)]))),128))])]),_("text",re,z((f=(h=n(O))==null?void 0:h.guessChords)==null?void 0:f[0]),1)],40,oe))]),b(i,{class:"max-w-100 mt-10",pitch:n(p).tonic,"onUpdate:pitch":t[0]||(t[0]=s=>n(p).tonic=s)},{default:U(()=>[b(l,{class:"min-w-full"})]),_:1},8,["pitch"])],64)}}},ue=A(le,[["__scopeId","data-v-1f16c8e2"]]),ve=JSON.parse('{"title":"Chroma Touch","description":"Intuitive and performant WebMIDI intstrument","frontmatter":{"title":"Chroma Touch","description":"Intuitive and performant WebMIDI intstrument","date":"2024-05-20T00:00:00.000Z","layout":"app","cover":"cover.png"},"headers":[],"relativePath":"practice/chroma/touch/index.md","filePath":"practice/chroma/touch/index.md","lastUpdated":1716216495000}'),me={name:"practice/chroma/touch/index.md"};function de(E,D,v,x,a,w){const c=ue;return m(),d("div",null,[b(c)])}const ye=A(me,[["render",de]]);export{ve as __pageData,ye as default};
