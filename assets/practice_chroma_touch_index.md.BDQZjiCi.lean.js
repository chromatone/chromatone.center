import{L as V,c as C,M as K,N as O,r as L,g as p,n as R,d as U,_ as j}from"./chunks/theme.EZv__huw.js";import{_ as E}from"./chunks/JamScale.C3KJBNsd.js";import{_ as H}from"./chunks/SvgRing.D-8o4UDf.js";import{B as A,U as J,r as I,b as Z,c as q,d as Q,n as X,C as m,D as d,F as _,G as $,H as S,K as n,a0 as b,S as W,M as Y,L as z,N as ee}from"./chunks/framework.BmjQO8gg.js";import"./chunks/ChromaCode.CVbyywir.js";const te={class:"w-full max-w-full h-100vh"},oe=["viewBox"],ne={class:"octaves"},ae={class:"touches"},se=["stroke","x2","y2"],ce=["transform"],ie=["fill"],re={class:"fill-black text-6px"},le={__name:"ChromaTouch",setup(F){const{isDark:D}=J(),v=I(4),x=I(2),a={pad:.5,r:50},M=I(),c=Z({}),G=q(()=>{const e={};for(let t in c){const{angle:r,distance:l}=c[t],i=Math.ceil((r-15)/30)%12,h=Math.floor((1-l)*v.value+x.value-2),f=(h+4)*12+i-3;e[t]={pitch:i,octave:h,num:f}}return e});function T({clientX:e,clientY:t}){const r=M.value.createSVGPoint();r.x=e,r.y=t;let{x:l,y:i}=r.matrixTransform(M.value.getScreenCTM().inverse());return{x:l,y:i,angle:180*(Math.PI-Math.atan2(l,i))/Math.PI,distance:Math.hypot(l,i)/a.r}}function y(e){e.type=="mousedown"?c.mouse=T(e):["mouseup","mouseleave","mouseout"].includes(e.type)?delete c.mouse:c.mouse&&e.type=="mousemove"&&(c.mouse=T(e))}function w(e){for(let t of e.changedTouches)["touchend","touchcancel"].includes(e.type)?delete c[t.identifier]:c[t.identifier]=T(t)}return Q(G,(e,t)=>{var r,l,i,h,f,s;for(let o in e)((r=e[o])==null?void 0:r.num)!=((l=t[o])==null?void 0:l.num)&&(V(C[(i=e[o])==null?void 0:i.pitch],((h=e[o])==null?void 0:h.octave)-x.value+(((f=e[o])==null?void 0:f.pitch)>=3?1:0)),K({number:(s=e[o])==null?void 0:s.num}));X(()=>{var o,k,u,N,P,B;for(let g in t)((o=t[g])==null?void 0:o.num)!=((k=e[g])==null?void 0:k.num)&&(V(C[(u=t[g])==null?void 0:u.pitch],((N=t[g])==null?void 0:N.octave)-x.value+(((P=t[g])==null?void 0:P.pitch)>=3?1:0),!0),O({number:(B=t[g])==null?void 0:B.num}))})}),(e,t)=>{var h,f;const r=H,l=E,i=j;return m(),d($,null,[_("div",te,[(m(),d("svg",{class:"select-none touch-action-none max-h-full",ref_key:"svg",ref:M,version:"1.1",baseProfile:"full",viewBox:`${-a.r-a.pad} ${-a.r-a.pad} ${a.r*2+2*a.pad} ${a.r*2+2*a.pad}`,xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none","-webkit-user-select":"none !important","-webkit-touch-callout":"none"},"font-family":"Commissioner, sans-serif","text-anchor":"middle","dominant-baseline":"middle",onTouchstart:w,onTouchmove:w,onTouchend:w,onTouchcancel:w,onMouseenter:y,onMousemove:y,onMousedown:y,onMouseup:y,onMouseleave:y},[_("g",ne,[(m(!0),d($,null,S(v.value,(s,o)=>(m(),d("g",{class:"octave op-90",key:s},[(m(!0),d($,null,S(n(C),(k,u)=>(m(),d("g",{key:k},[b(r,{cx:0,cy:0,radius:a.r-o*(a.r/v.value),thickness:a.r/v.value,from:u*30-15,to:(u+1)*30-15,fill:n(R)(u,o+x.value,n(L)(n(p).chroma,-n(p).tonic)[u]==1?1:.5,n(U).activeNotes[u+(o+x.value+1)*12+9]?1:.8)},{default:W(()=>[o==0?(m(),d("text",{key:0,class:"fill-black text-4px",style:Y({fontWeight:n(L)(n(p).chroma,-n(p).tonic)[u]==1?"bold":"normal",fontSize:n(p).tonic==u?"8px":"4px"}),y:"1"},z(k),5)):ee("",!0)]),_:2},1032,["radius","thickness","from","to","fill"])]))),128))]))),128)),_("g",ae,[(m(!0),d($,null,S(c,(s,o)=>(m(),d("g",{class:"touch",key:o},[_("line",{"stroke-linecap":"round",stroke:`hsl(${s.angle}deg, 50%,50%)`,x2:s.x,y2:s.y},null,8,se),_("g",{transform:`translate(${s.x} ${s.y})`},[_("circle",{r:"2",fill:n(D)?"#fff3":"#3333"},null,8,ie)],8,ce)]))),128))])]),_("text",re,z((f=(h=n(U))==null?void 0:h.guessChords)==null?void 0:f[0]),1)],40,oe))]),b(i,{class:"max-w-100 mt-10",pitch:n(p).tonic,"onUpdate:pitch":t[0]||(t[0]=s=>n(p).tonic=s)},{default:W(()=>[b(l,{class:"min-w-full"})]),_:1},8,["pitch"])],64)}}},ue=A(le,[["__scopeId","data-v-1f16c8e2"]]),ge=JSON.parse('{"title":"Chroma Touch","description":"Intuitive and performant WebMIDI intstrument","frontmatter":{"title":"Chroma Touch","description":"Intuitive and performant WebMIDI intstrument","date":"2021-04-20T00:00:00.000Z","layout":"app","cover":"cover.png"},"headers":[],"relativePath":"practice/chroma/touch/index.md","filePath":"practice/chroma/touch/index.md","lastUpdated":1720255337000}'),me={name:"practice/chroma/touch/index.md"};function de(F,D,v,x,a,M){const c=ue;return m(),d("div",null,[b(c)])}const ve=A(me,[["render",de]]);export{ge as __pageData,ve as default};
