import{X as V,e as C,Y as R,Z as U,r as z,g as p,n as X,f as A,D as Z}from"./chunks/theme.cr2e1FW-.js";import{_ as j}from"./chunks/JamScale.DrY6g5N2.js";import{_ as q}from"./chunks/SvgRing.DeL1KXQD.js";import{q as F,V as H,r as I,b as J,c as K,d as L,n as Y,v as m,x as d,z as _,F as $,A as D,D as n,X as b,M as W,G as Q,E,H as ee}from"./chunks/framework.CwYnjAeV.js";import"./chunks/ChromaCode.CqjtWvtq.js";const te={class:"w-full max-w-full h-100vh"},oe=["viewBox"],ne={class:"octaves"},se={class:"touches"},ae=["stroke","x2","y2"],ce=["transform"],ie=["fill"],re={class:"fill-black text-6px"},le={__name:"ChromaTouch",setup(G){const{isDark:S}=H(),v=I(4),x=I(2),s={pad:.5,r:50},w=I(),c=J({}),O=K(()=>{const e={};for(let t in c){const{angle:r,distance:l}=c[t],i=Math.ceil((r-15)/30)%12,h=Math.floor((1-l)*v.value+x.value-2),f=(h+4)*12+i-3;e[t]={pitch:i,octave:h,num:f}}return e});function T({clientX:e,clientY:t}){const r=w.value.createSVGPoint();r.x=e,r.y=t;let{x:l,y:i}=r.matrixTransform(w.value.getScreenCTM().inverse());return{x:l,y:i,angle:180*(Math.PI-Math.atan2(l,i))/Math.PI,distance:Math.hypot(l,i)/s.r}}function y(e){e.type=="mousedown"?c.mouse=T(e):["mouseup","mouseleave","mouseout"].includes(e.type)?delete c.mouse:c.mouse&&e.type=="mousemove"&&(c.mouse=T(e))}function M(e){for(let t of e.changedTouches)["touchend","touchcancel"].includes(e.type)?delete c[t.identifier]:c[t.identifier]=T(t)}return L(O,(e,t)=>{var r,l,i,h,f,a;for(let o in e)((r=e[o])==null?void 0:r.num)!=((l=t[o])==null?void 0:l.num)&&(V(C[(i=e[o])==null?void 0:i.pitch],((h=e[o])==null?void 0:h.octave)-x.value+(((f=e[o])==null?void 0:f.pitch)>=3?1:0)),R({number:(a=e[o])==null?void 0:a.num}));Y(()=>{var o,k,u,P,B,N;for(let g in t)((o=t[g])==null?void 0:o.num)!=((k=e[g])==null?void 0:k.num)&&(V(C[(u=t[g])==null?void 0:u.pitch],((P=t[g])==null?void 0:P.octave)-x.value+(((B=t[g])==null?void 0:B.pitch)>=3?1:0),!0),U({number:(N=t[g])==null?void 0:N.num}))})}),(e,t)=>{var h,f;const r=q,l=j,i=Z;return m(),d($,null,[_("div",te,[(m(),d("svg",{class:"select-none touch-action-none max-h-full",ref_key:"svg",ref:w,version:"1.1",baseProfile:"full",viewBox:`${-s.r-s.pad} ${-s.r-s.pad} ${s.r*2+2*s.pad} ${s.r*2+2*s.pad}`,xmlns:"http://www.w3.org/2000/svg",style:{"touch-action":"none","-webkit-user-select":"none !important","-webkit-touch-callout":"none"},"font-family":"Commissioner, sans-serif","text-anchor":"middle","dominant-baseline":"middle",onTouchstart:M,onTouchmove:M,onTouchend:M,onTouchcancel:M,onMouseenter:y,onMousemove:y,onMousedown:y,onMouseup:y,onMouseleave:y},[_("g",ne,[(m(!0),d($,null,D(v.value,(a,o)=>(m(),d("g",{class:"octave op-90",key:a},[(m(!0),d($,null,D(n(C),(k,u)=>(m(),d("g",{key:k},[b(r,{cx:0,cy:0,radius:s.r-o*(s.r/v.value),thickness:s.r/v.value,from:u*30-15,to:(u+1)*30-15,fill:n(X)(u,o+x.value,n(z)(n(p).chroma,-n(p).tonic)[u]==1?1:.5,n(A).activeNotes[u+(o+x.value+1)*12+9]?1:.8)},{default:W(()=>[o==0?(m(),d("text",{key:0,class:"fill-black text-4px",style:Q({fontWeight:n(z)(n(p).chroma,-n(p).tonic)[u]==1?"bold":"normal",fontSize:n(p).tonic==u?"8px":"4px"}),y:"1"},E(k),5)):ee("",!0)]),_:2},1032,["radius","thickness","from","to","fill"])]))),128))]))),128)),_("g",se,[(m(!0),d($,null,D(c,(a,o)=>(m(),d("g",{class:"touch",key:o},[_("line",{"stroke-linecap":"round",stroke:`hsl(${a.angle}deg, 50%,50%)`,x2:a.x,y2:a.y},null,8,ae),_("g",{transform:`translate(${a.x} ${a.y})`},[_("circle",{r:"2",fill:n(S)?"#fff3":"#3333"},null,8,ie)],8,ce)]))),128))])]),_("text",re,E((f=(h=n(A))==null?void 0:h.guessChords)==null?void 0:f[0]),1)],40,oe))]),b(i,{class:"max-w-100 mt-10",pitch:n(p).tonic,"onUpdate:pitch":t[0]||(t[0]=a=>n(p).tonic=a)},{default:W(()=>[b(l,{class:"min-w-full"})]),_:1},8,["pitch"])],64)}}},ue=F(le,[["__scopeId","data-v-1f16c8e2"]]),ge=JSON.parse('{"title":"Chroma Touch","description":"Intuitive and performant WebMIDI intstrument","frontmatter":{"title":"Chroma Touch","description":"Intuitive and performant WebMIDI intstrument","date":"2024-05-20T00:00:00.000Z","layout":"app","cover":"cover.png"},"headers":[],"relativePath":"practice/chroma/touch/index.md","filePath":"practice/chroma/touch/index.md","lastUpdated":1719568728000}'),me={name:"practice/chroma/touch/index.md"};function de(G,S,v,x,s,w){const c=ue;return m(),d("div",null,[b(c)])}const ve=F(me,[["render",de]]);export{ge as __pageData,ve as default};
