import"./chunks/tuner.0-FZg3vi.js";import"./chunks/audio.pG3RnClx.js";import"./chunks/colors.hHBI9fPI.js";import{u as T}from"./chunks/midi.91UwWBqe.js";import"./chunks/loop.CI0tpsQr.js";import"./chunks/mic.v1-AeFkx.js";import"./chunks/midiRender.c86h86WZ.js";import{M as D}from"./chunks/Midi.6fTTQsck.js";import{u as N}from"./chunks/tempo.fl6CFXyY.js";import"./chunks/noise.bpaR192Z.js";import{T as B,F as w}from"./chunks/index.RYxauP_R.js";import{u as F}from"./chunks/sequence.lQXqylrG.js";import{u as P,b as y}from"./chunks/synth.TVJKhjDp.js";import"./chunks/theory.c9f85u7m.js";import{P as R}from"./chunks/Sequence.kPz-JF-q.js";import{k as f,j as x,w as S,o as a,c,a as t,t as l,g as s,F as b,r as $,B as q,_ as O,f as M,m as V,n as E}from"./chunks/framework.KnxPB1sj.js";import"./chunks/commonjsHelpers.4gQjN7DL.js";import"./chunks/calculations.uITx2GSi.js";import"./chunks/index.bnjSkgpl.js";import"./chunks/index.kn6emmbE.js";import"./chunks/index.QyW-2vQe.js";import"./chunks/UserMedia.XqLXAXtE.js";import"./chunks/Subtract.6yvEFIfU.js";import"./chunks/OnePoleFilter.5ASB6TIv.js";import"./chunks/Loop.bmxnTff3.js";import"./chunks/BitCrusher.Qqt3OxKC.js";import"./chunks/Filter.CUstuK5R.js";import"./chunks/AutoPanner.02Sltg0b.js";import"./chunks/Scale.nioafpJK.js";import"./chunks/PingPongDelay.a3-runAV.js";import"./chunks/MonoSynth.pp_JS1sF.js";import"./chunks/index._4u9I4xi.js";const j={class:"flex flex-col"},z={class:"text-2xl"},J={class:"flex flex-wrap"},L={key:0,class:"i-la-circle"},Q={key:1,class:"i-mdi-checkbox-blank-circle"},U={key:0,class:"i-la-play"},W={key:1,class:"i-la-pause"},Z=t("div",{class:"i-la-stop"},null,-1),A=[Z],G=t("div",{class:"i-la-trash-alt"},null,-1),H=[G],K=t("div",{class:"i-la-plus"},null,-1),X=[K],Y={class:"p-1"},tt=t("div",{class:"i-la-minus"},null,-1),et=[tt],st=t("div",{class:"p-1"},"/",-1),ot=t("div",{class:"i-la-plus"},null,-1),it=[ot],nt={class:"p-1"},rt=t("div",{class:"i-la-minus"},null,-1),lt=[rt],at={class:"flex flex-col"},ct=["viewBox"],dt=["width","height"],pt=["x1","x2","y2"],mt=["transform"],ut=["y2"],_t={y:"3",x:"1","font-size":"2"},ht={class:"flex text-xs p-4"},vt={class:"grid grid-cols-3 text-xs gap-2"},ft={__name:"MidiRows",setup(C){P();const{midi:u}=T(),{seq:n}=F(null,1,"row"),d=N(),i=f({width:100,height:30,progress:x(()=>i.width*n.progress),recording:!1}),_=x(()=>n.meter.over*B.PPQ*4/n.meter.under),p=x(()=>d.ticks%_.value),v=new R((r,e)=>{console.log(e),y(w(e.midi,"midi").toNote(),e.duration+"i")}).set({loop:!0,loopEnd:"800i",loopStart:0,playbackRate:1,probability:1}).start(0),h=f({}),k=f([]),{track:g,midiFile:gt}=I();S(()=>u.note,r=>{if(y(w(r.number,"midi").toNote()+"","196i"),!(!i.recording||!d.playing))if(r.velocity>0)h[r.number]=p.value;else{const e=h==null?void 0:h[r.number],m=p.value;let o;m>e?o=m-e:o=_.value-e+m,k.push({ticks:p.value,midi:r.number,channel:r.channel,start:e,stop:m,duration:o}),v.add({time:p.value+"i",midi:r.number,duration:o})}});function I(){const r=new D.Midi;r.name="Chromatone recording";const e=r.addTrack();return{midiFile:r,track:e}}return(r,e)=>{var m;return a(),c("div",j,[t("div",z,"MIDI ROWS "+l(p.value)+"/"+l(_.value),1),t("div",J,[t("button",{onClick:e[0]||(e[0]=o=>i.recording=!i.recording)},[i.recording?(a(),c("div",Q)):(a(),c("div",L))]),t("button",{onClick:e[1]||(e[1]=o=>s(d).playing=!s(d).playing)},[s(d).playing?(a(),c("div",W)):(a(),c("div",U))]),t("button",{onClick:e[2]||(e[2]=o=>s(d).stopped=Date.now())},A),t("button",{onClick:e[3]||(e[3]=o=>s(g).notes=[])},H),t("button",{onClick:e[4]||(e[4]=o=>s(n).meter.over++)},X),t("div",Y,l(s(n).meter.over),1),t("button",{onClick:e[5]||(e[5]=o=>s(n).meter.over--)},et),st,t("button",{onClick:e[6]||(e[6]=o=>s(n).meter.under++)},it),t("div",nt,l(s(n).meter.under),1),t("button",{onClick:e[7]||(e[7]=o=>s(n).meter.under--)},lt)]),t("div",at,[(a(),c("svg",{viewBox:`0 0 ${i.width} ${i.height}`},[t("rect",{width:i.width,height:i.height,fill:"#999"},null,8,dt),(a(!0),c(b,null,$((m=s(u))==null?void 0:m.channels,o=>(a(),c("g",{class:"channel",key:o}))),128)),t("line",{x1:i.progress,x2:i.progress,y1:0,y2:i.height,stroke:"black"},null,8,pt),(a(!0),c(b,null,$(s(n).steps,o=>(a(),c("g",{key:o,transform:`translate(${i.width*o[0].split("-")[0]/s(n).steps.length})`},[t("line",{y2:i.height,stroke:"black","stroke-width":"0.1"},null,8,ut),t("text",_t,l(Number(o[0].split("-")[0])+1),1)],8,mt))),128))],8,ct))]),t("div",ht,l(k),1),t("div",vt,[t("pre",null,l(s(n)),1),t("pre",null,l(s(d)),1),t("pre",null,[q(),t("p",null," "+l(s(g)),1),t("p",null,l(s(u).clock),1),t("p",null,l(s(u).note),1)])])])}}},Yt=JSON.parse('{"title":"MIDI Rows","description":"Measurewise MIDI recorder","frontmatter":{"title":"MIDI Rows","description":"Measurewise MIDI recorder","date":"2020-02-02T00:00:00.000Z","layout":"app"},"headers":[],"relativePath":"practice/experiments/rows/index.md","filePath":"practice/experiments/rows/index.md","lastUpdated":1704280285000}'),xt={name:"practice/experiments/rows/index.md"};function kt(C,u,n,d,i,_){const p=ft,v=E("client-only");return a(),c("div",null,[M(v,null,{default:V(()=>[M(p)]),_:1})])}const te=O(xt,[["render",kt]]);export{Yt as __pageData,te as default};
