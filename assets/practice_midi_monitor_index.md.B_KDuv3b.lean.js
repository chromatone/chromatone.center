import{n as D,u as C,q as w,B,au as O,av as T}from"./chunks/theme.NJ_Xky9a.js";import{D as M,M as j,N as P,E as s,F as d,G as m,I as x,L as k,r as S,Q as U,C as _,c as V,V as g,W as $,a2 as N,J as z,K as A,O as I,X as E,a4 as F}from"./chunks/framework.avS8w96o.js";const J={class:"cc"},L={class:"p-1 text-center flex-1"},q={__name:"MidiMonitorCc",props:{cc:{type:Object,default:()=>{}}},emits:["update"],setup(t,{emit:v}){const u=t,a=v;let o=0;function h({movement:[i],dragging:l}){let n=i/2-o;o=i/2,l||(o=0);let e=Math.round(u.cc.raw+n);e>127&&(e=127),e<0&&(e=0),a("update",e)}return(i,l)=>{var e,p;const n=j("drag");return P((s(),d("div",J,[m("div",L,x((e=t.cc)==null?void 0:e.number),1),m("div",{class:"absolute h-full z-10 bg-gray-500 top-0 bg-opacity-40 self-start",style:k({width:((p=t.cc)==null?void 0:p.value)*100+"%"})},null,4)])),[[n,h]])}}},G=M(q,[["__scopeId","data-v-5d5f8574"]]),K={class:"font-bold"},Q={class:"text-sm"},R={__name:"MidiMonitorNote",props:{note:{type:Object,default:()=>{}},active:Boolean},emits:["play","stop","update:active"],setup(t,{emit:v}){const u=t,a=v,o=S(!1);function h(){o.value=!0,a("update:active",!0),a("play")}function i(n=!1){o.value&&(o.value=!1,n||a("update:active",!1),a("stop"))}function l(){u.active&&!o.value&&(o.value=!0,a("update:active",!0),a("play"))}return(n,e)=>{var p,c,f;return s(),d("div",{class:"note",onMousedown:e[0]||(e[0]=r=>h()),onMouseup:e[1]||(e[1]=r=>i()),onMouseleave:e[2]||(e[2]=r=>i(!0)),onTouchstart:e[3]||(e[3]=U(r=>h(),["prevent"])),onTouchend:e[4]||(e[4]=r=>i()),onMousemove:e[5]||(e[5]=r=>l()),onTouchmove:e[6]||(e[6]=r=>l()),style:k({backgroundColor:_(D)(t.note.pitch,t.note.octA-1,t.note.velocity)})},[m("div",K,x((p=t.note)==null?void 0:p._name)+x((c=t.note)==null?void 0:c._accidental),1),m("div",Q,x((f=t.note)==null?void 0:f.number),1)],36)}}},W=M(R,[["__scopeId","data-v-4edb83ef"]]),X=t=>(z("data-v-51180af5"),t=t(),A(),t),Z={class:"flex flex-col gap-4 items-start"},H={class:"flex w-full h-full mt-4"},Y={class:"header absolute w-full text-center"},ee=X(()=>m("div",{class:"p-6"},null,-1)),te={class:"flex w-full"},ne={__name:"MidiMonitor",setup(t){const v=S(!1),{midi:u,midiAttack:a,midiRelease:o,setCC:h}=C(),i=V(()=>{const l={};for(let n in u.channels){const e=Object.keys(u.channels[n].activeNotes).map(p=>w.midiToNoteName(p,{sharps:!0}));l[n]=e.length>2?B.detect(e):[]}return l});return(l,n)=>{const e=W,p=G;return s(),d("div",Z,[m("div",{class:"fullscreen-container",id:"screen",onMouseleave:n[1]||(n[1]=c=>v.value=!1)},[m("div",H,[(s(!0),d(g,null,$(_(u).channels,(c,f)=>{var r;return s(),d("div",{class:"flex flex-col flex-1 text-center relative",key:c.num},[m("div",Y,x(((r=i.value[f])==null?void 0:r[0])||Object.keys(c.activeNotes).map(y=>_(w).midiToNoteName(y,{sharps:!0})).join(" ")||c.num),1),ee,(s(!0),d(g,null,$(_(O)(c.notes),y=>(s(),N(e,{key:y.number,active:v.value,"onUpdate:active":n[0]||(n[0]=b=>v.value=b),note:y,onPlay:b=>_(a)(y),onStop:b=>_(o)(y)},null,8,["active","note","onPlay","onStop"]))),128))])}),128))]),m("div",te,[(s(!0),d(g,null,$(_(u).channels,c=>(s(),d("div",{class:"flex flex-col flex-1 text-center",key:c.num},[(s(!0),d(g,null,$(c.cc,f=>(s(),N(p,{key:f,cc:f,onUpdate:r=>_(h)(f,r)},null,8,["cc","onUpdate"]))),128))]))),128))])],32)])}}},oe=M(ne,[["__scopeId","data-v-51180af5"]]),ce=JSON.parse(`{"title":"MIDI Monitor","description":"See everything that's happening on your MIDI-bus right in the browser","frontmatter":{"title":"MIDI Monitor","description":"See everything that's happening on your MIDI-bus right in the browser","layout":"app","cover":"monitor.png","date":"2022-06-12T00:00:00.000Z"},"headers":[],"relativePath":"practice/midi/monitor/index.md","filePath":"practice/midi/monitor/index.md","lastUpdated":1709374066000}`),se={name:"practice/midi/monitor/index.md"};function ae(t,v,u,a,o,h){const i=oe,l=T,n=F("client-only");return s(),d("div",null,[I(n,null,{default:E(()=>[I(i),I(l,{"to-channel":!1})]),_:1})])}const re=M(se,[["render",ae]]);export{ce as __pageData,re as default};
