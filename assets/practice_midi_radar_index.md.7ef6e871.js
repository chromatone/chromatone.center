import{_ as B}from"./chunks/MidiPanel.95aa1b81.js";import{m as h}from"./chunks/midi.9486e5fa.js";import{t as E}from"./chunks/tempo.4bdd83c1.js";import{p as i}from"./chunks/paper-full.efdb79eb.js";import{r as D,x as P,v as O,Y as k,H as m,o as f,c as v,A as W,B as L,a as p,t as R,u as z,f as l,l as V,_ as j,I as U,w as Y,e as N}from"./chunks/framework.c7ad3ca2.js";import{n as $}from"./chunks/colors.394b294c.js";import{g as S}from"./chunks/calculations.65ee336d.js";import{i as _}from"./chunks/state.94f7e80e.js";import{u as q}from"./chunks/index.098dc14b.js";import"./chunks/synth.97f998a0.js";import"./chunks/audio.01373f6f.js";import"./chunks/Scale.22b16e3d.js";import"./chunks/Subtract.beb0cc34.js";import"./chunks/PingPongDelay.187daa12.js";import"./chunks/AutoPanner.8d278bb2.js";import"./chunks/MonoSynth.ecb6ed30.js";import"./chunks/Filter.fb7acdf5.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.b30cd6d2.js";import"./chunks/index.b3129a1a.js";import"./chunks/Loop.97b07c3f.js";import"./chunks/index.654bd828.js";import"./chunks/theory.61e5aadb.js";import"./chunks/index.86652af6.js";const d=D({angle:0,loaded:!1,zoom:2});function A(){const c=P();return O(()=>{i.setup(c.value),i.view.draw(),d.loaded=!0}),k(()=>{i.project.clear(),d.loaded=!1}),m(()=>E.ticks,e=>{h.playing||(d.angle=e/(192*4)*(360/d.zoom))}),m(()=>h.clock,()=>{h.playing?d.angle+=360/192/d.zoom:(!E.playing||h.stopped)&&(d.angle=0)}),{screen:c,radar:d}}function I(c={x:100,y:100},e=0,a=0){let o=(a-90)*Math.PI/180;return{x:c.x+e*Math.cos(o),y:c.y+e*Math.sin(o)}}const y=60,C={__name:"circles",props:{channel:{type:Number,default:7},grow:{type:Number,default:0},toCenter:{type:Boolean,default:!1},size:{type:Number,default:10},lineWidth:{type:Number,default:1},opacity:{type:Number,default:1},blendMode:{type:String,default:"normal"}},setup(c){const e=c,a=i.view,o=[],t=[],u=P({pitch:0});return m(()=>h.note,s=>{var r;if(s.type=="noteon"&&s.channel==e.channel){let n=I(a.center,(s.octA+s.pitch/12)/9*500,d.angle),w=new i.Point(n.x,n.y),g=new i.Path.Line({strokeColor:$(u.value.pitch),strokeWidth:e.lineWidth,from:((r=o[0])==null?void 0:r.position)||w,to:w,strokeCap:"round",blendMode:e.blendMode});g.tween({opacity:e.opacity},200).then(()=>{g.tween({opacity:0,easing:"easeInOutCubic"},8e3)});let x=new i.Shape.Circle({center:w,radius:e.size,opacity:0,fillColor:$(s.pitch),blendMode:e.blendMode});x.tween({opacity:e.opacity},200).then(()=>{x.tween({opacity:0,easing:"easeInOutCubic"},8e3)}),e.grow>0&&x.tween({radius:e.grow,easing:"easeInOutCubic"},8e3),e.toCenter&&x.tween({position:a.center,easing:"easeInOutCubic"},4e3),o.unshift(x),t.unshift(g),u.value=s}if(o.length>y){for(let n=y;n<=o.length;n++){if(!o[n]||!o[n].remove)return;o[n].remove()}o.length=y}if(t.length>y){for(let n=y;n<=t.length;n++){if(!t[n]||!t[n].remove)return;t[n].remove()}t.length=y}}),m(()=>h.playing,s=>{s||(o.forEach(r=>{r&&r.remove&&r.remove()}),t.forEach(r=>{r&&r.remove&&r.remove()}))}),k(()=>{o.forEach(s=>{s&&s.remove&&s.remove()}),t.forEach(s=>{s&&s.remove&&s.remove()})}),(s,r)=>(f(),v("div"))}},H={__name:"clock",props:{zoom:{type:Number,default:4}},setup(c){const e=i.view,a=new i.Path.Line({from:e.center,to:[e.center.x,e.bounds.y],strokeColor:_.value?"#eee":"#888",strokeCap:"round",strokeWidth:1,pivot:e.center}),o=new i.Shape.Circle({center:e.center,radius:4,fillColor:_.value?"#eee":"#888"});let t=[];for(let r=1;r<8;r++){let n=new i.Path.Circle(i.view.center,r/9*a.length);n.strokeColor="#f002",t.push(n)}const u=D([]),s=D([]);return m(()=>d.zoom,r=>{u.forEach(n=>n.remove()),s.forEach(n=>n.remove());for(let n=0;n<=r;n++){let w=S(n,r,e.size.width,e.size.width),g=S(n+.5,r,e.size.width,e.size.width);s[n]=new i.Path.Line({from:e.center,to:[g.x,g.y],strokeColor:_.value?"#eee1":"#8881",strokeCap:"round",strokeWidth:1,pivot:e.center}),u[n]=new i.Path.Line({from:e.center,to:[w.x,w.y],strokeColor:_.value?"#eee6":"#8886",strokeCap:"round",strokeWidth:1,pivot:e.center})}}),m(_,()=>{a.strokeColor=_.value?"#eee":"#888",o.fillColor=_.value?"#eee":"#888"}),i.view.on("resize",()=>{a.firstSegment.point=i.view.center,o.position=i.view.center,t.forEach(r=>r.position=e.center)}),m(()=>d.angle,r=>{let n=I(i.view.center,400,r);a.lastSegment.point=n}),k(()=>{a.remove(),o.remove(),t.forEach(r=>r.remove())}),(r,n)=>(f(),v("div"))}},T={__name:"pointer",setup(c){new i.Layer({name:"poiner"});const e=P([0,0]),a=new i.Shape.Circle({center:i.view.center,radius:5,opacity:.5,fillColor:"#555"}),o=new i.Shape.Circle({center:i.view.center,radius:40,opacity:.1,fillColor:"#555"});return i.view.on("mousemove",t=>{a.set({position:t.point})}),i.view.on("mousedown",t=>{e.value[0]=t.point.x,e.value[1]=t.point.y,o.tween({position:t.point},{easing:"easeInOutCubic",duration:600})}),k(()=>{a.remove(),o.remove(),i.view.off("mousemove"),i.view.off("nousedown")}),(t,u)=>(f(),v("div"))}},M=100,b={__name:"ticks",props:{channel:{type:Number,default:7},in:{type:Number,default:380},out:{type:Number,default:400},width:{type:Number,default:2},rounded:{type:Boolean,default:!0}},setup(c){const e=c,a=[];return m(()=>h.note,o=>{if(o.type=="noteon"&&o.channel==e.channel){let t=new i.Path.Line({from:I(i.view.center,e.in,d.angle),to:I(i.view.center,e.out,d.angle),opacity:1,strokeColor:$(o.pitch,3,.2),strokeWidth:e.width,strokeCap:e.rounded?"round":""});t.tween({opacity:0,easing:"easeInOutCubic"},8e3),a.unshift(t)}if(a.length>M){for(let t=M;t<=a.length;t++){if(!a[t]||!a[t].remove)return;a[t].remove()}a.length=M}}),m(()=>h.playing,o=>{o||a.forEach(t=>{t&&t.remove&&t.remove()})}),k(()=>{a.forEach(o=>{o&&o.remove&&o.remove()})}),(o,t)=>(f(),v("div"))}},Z={class:"flex flex-col"},J={class:"flex flex-col w-full items-stretch relative fullscreen-container rounded-3xl shadow-xl",id:"screen"},X={class:"absolute top-4 left-4 flex items-center select-none"},F=p("div",{class:"i-la-times"},null,-1),G={class:"p-0"},K={key:0},Q={__name:"MidiRadar",setup(c){const{screen:e,radar:a}=A(),o=q(1,1,8);function t(u){o.value+=u.delta[0]/100-u.delta[1]/100,a.zoom=Math.round(o.value)}return(u,s)=>{const r=W("drag");return f(),v("div",Z,[L((f(),v("div",J,[p("div",X,[F,p("div",G,R(z(a).zoom),1)]),p("canvas",{class:"max-w-full max-h-full h-full w-full min-h-600px",ref_key:"screen",ref:e,style:{cursor:"none"},resize:"true",width:"1000",height:"1000"},[z(a).loaded?(f(),v("div",K,[l(H,{zoom:z(a).zoom},null,8,["zoom"]),l(T),l(C,{class:"lead",channel:0,size:8,"line-width":20,grow:20}),l(C,{class:"bass",channel:5,size:10,"line-width":10,grow:60}),l(C,{class:"lead",channel:6,size:12,"line-width":20}),l(C,{class:"arp",channel:7,grow:12,size:6,"line-width":.5}),l(C,{class:"chords",channel:8,grow:80,size:36,"line-width":.1,"blend-mode":"overlay",opacity:.6}),l(b,{class:"kick",channel:1,in:30,out:80,width:18,rounded:!0}),l(b,{class:"snare",channel:2,in:30,out:420,width:2}),l(b,{class:"hihat",channel:3,width:8}),l(b,{class:"fx",channel:4,in:320,out:360,width:12,rounded:!1})])):V("",!0)],512)])),[[r,t]])])}}},Pe=JSON.parse('{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","frontmatter":{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","date":"2021-11-09T00:00:00.000Z","cover":"geometry.png"},"headers":[],"relativePath":"practice/midi/radar/index.md","filePath":"practice/midi/radar/index.md","lastUpdated":1689843676000}'),ee={name:"practice/midi/radar/index.md"},te=p("h3",{id:"see-all-the-midi-signals-on-the-clock",tabindex:"-1"},[N("See all the MIDI signals on the clock "),p("a",{class:"header-anchor",href:"#see-all-the-midi-signals-on-the-clock","aria-label":'Permalink to "See all the MIDI signals on the clock"'},"â€‹")],-1),oe=p("p",null,[N("Press play on your sequencer to start run the radar by incoming MIDI-clock signal, or just press "),p("code",null,"spacebar"),N(" to start internal metronome, that will drive the radar clocks.")],-1),ne=p("p",null,"Drag across the circle up and down to adjust temporal zoom - ther higher the zoom, the longer the loop (from one to 8 measures).",-1),re=p("p",null,"Use MIDI channel filter section to cut visualize the exact voices of a multichannel MIDI signal.",-1),ie=p("p",null,"You can toggle the internal synth on and off for using your MIDI-controller or enable audio input monitoring for your using your synths and sequencers.",-1);function ae(c,e,a,o,t,u){const s=Q,r=B,n=U("client-only");return f(),v("div",null,[l(n,null,{default:Y(()=>[l(s),l(r,{class:"mb-4"})]),_:1}),te,oe,ne,re,ie])}const Ee=j(ee,[["render",ae]]);export{Pe as __pageData,Ee as default};
