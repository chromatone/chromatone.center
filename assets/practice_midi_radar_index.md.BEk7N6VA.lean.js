import{aj as v,ak as E,c as D,q as S,H as $,ai as O}from"./chunks/theme.T-vkwoWg.js";import{p as a}from"./chunks/paper-full.1b-nL1hr.js";import{b as N,r as P,o as W,K as C,d as m,f as w,g,e as B,P as L,k as R,h,m as j,l as I,R as c,q,_ as V,A as U,au as z,$ as A}from"./chunks/framework.BX1Y-ISu.js";const u=N({angle:0,loaded:!1,zoom:2});function H(){const d=P();return W(()=>{a.setup(d.value),a.view.draw(),u.loaded=!0}),C(()=>{a.project.clear(),u.loaded=!1}),m(()=>E.ticks,e=>{v.playing||(u.angle=e/(192*4)*(360/u.zoom))}),m(()=>v.clock,()=>{v.playing?u.angle+=360/192/u.zoom:(!E.playing||v.stopped)&&(u.angle=0)}),{screen:d,radar:u}}function b(d={x:100,y:100},e=0,t=0){let o=(t-90)*Math.PI/180;return{x:d.x+e*Math.cos(o),y:d.y+e*Math.sin(o)}}const y=60,x={__name:"circles",props:{channel:{type:Number,default:7},grow:{type:Number,default:0},toCenter:{type:Boolean,default:!1},size:{type:Number,default:10},lineWidth:{type:Number,default:1},opacity:{type:Number,default:1},blendMode:{type:String,default:"normal"}},setup(d){const e=d,t=a.view,o=[],n=[],p=P({pitch:0});return m(()=>v.note,i=>{var l;if(i.type=="noteon"&&i.channel==e.channel){let r=b(t.center,(i.octA+i.pitch/12)/9*500,u.angle),s=new a.Point(r.x,r.y),_=new a.Path.Line({strokeColor:D(p.value.pitch),strokeWidth:e.lineWidth,from:((l=o[0])==null?void 0:l.position)||s,to:s,strokeCap:"round",blendMode:e.blendMode});_.tween({opacity:e.opacity},200).then(()=>{_.tween({opacity:0,easing:"easeInOutCubic"},8e3)});let f=new a.Shape.Circle({center:s,radius:e.size,opacity:0,fillColor:D(i.pitch),blendMode:e.blendMode});f.tween({opacity:e.opacity},200).then(()=>{f.tween({opacity:0,easing:"easeInOutCubic"},8e3)}),e.grow>0&&f.tween({radius:e.grow,easing:"easeInOutCubic"},8e3),e.toCenter&&f.tween({position:t.center,easing:"easeInOutCubic"},4e3),o.unshift(f),n.unshift(_),p.value=i}if(o.length>y){for(let r=y;r<=o.length;r++){if(!o[r]||!o[r].remove)return;o[r].remove()}o.length=y}if(n.length>y){for(let r=y;r<=n.length;r++){if(!n[r]||!n[r].remove)return;n[r].remove()}n.length=y}}),m(()=>v.playing,i=>{i||(o.forEach(l=>{l&&l.remove&&l.remove()}),n.forEach(l=>{l&&l.remove&&l.remove()}))}),C(()=>{o.forEach(i=>{i&&i.remove&&i.remove()}),n.forEach(i=>{i&&i.remove&&i.remove()})}),(i,l)=>(w(),g("div"))}},T={__name:"clock",props:{zoom:{type:Number,default:4}},setup(d){const{isDark:e}=B(),t=a.view,o=new a.Path.Line({from:t.center,to:[t.center.x,t.bounds.y],strokeColor:e.value?"#eee":"#888",strokeCap:"round",strokeWidth:1,pivot:t.center}),n=new a.Shape.Circle({center:t.center,radius:4,fillColor:e.value?"#eee":"#888"});let p=[];for(let r=1;r<8;r++){let s=new a.Path.Circle(a.view.center,r/9*o.length);s.strokeColor="#f002",p.push(s)}const i=N([]),l=N([]);return m(()=>u.zoom,r=>{i.forEach(s=>s.remove()),l.forEach(s=>s.remove());for(let s=0;s<=r;s++){let _=S(s,r,t.size.width,t.size.width),f=S(s+.5,r,t.size.width,t.size.width);l[s]=new a.Path.Line({from:t.center,to:[f.x,f.y],strokeColor:e.value?"#eee1":"#8881",strokeCap:"round",strokeWidth:1,pivot:t.center}),i[s]=new a.Path.Line({from:t.center,to:[_.x,_.y],strokeColor:e.value?"#eee6":"#8886",strokeCap:"round",strokeWidth:1,pivot:t.center})}}),m(e,()=>{o.strokeColor=e.value?"#eee":"#888",n.fillColor=e.value?"#eee":"#888"}),a.view.on("resize",()=>{o.firstSegment.point=a.view.center,n.position=a.view.center,p.forEach(r=>r.position=t.center)}),m(()=>u.angle,r=>{let s=b(a.view.center,400,r);o.lastSegment.point=s}),C(()=>{o.remove(),n.remove(),p.forEach(r=>r.remove())}),(r,s)=>(w(),g("div"))}},Y={__name:"pointer",setup(d){new a.Layer({name:"poiner"});const e=P([0,0]),t=new a.Shape.Circle({center:a.view.center,radius:5,opacity:.5,fillColor:"#555"}),o=new a.Shape.Circle({center:a.view.center,radius:40,opacity:.1,fillColor:"#555"});return a.view.on("mousemove",n=>{t.set({position:n.point})}),a.view.on("mousedown",n=>{e.value[0]=n.point.x,e.value[1]=n.point.y,o.tween({position:n.point},{easing:"easeInOutCubic",duration:600})}),C(()=>{t.remove(),o.remove(),a.view.off("mousemove"),a.view.off("nousedown")}),(n,p)=>(w(),g("div"))}},M=100,k={__name:"ticks",props:{channel:{type:Number,default:7},in:{type:Number,default:380},out:{type:Number,default:400},width:{type:Number,default:2},rounded:{type:Boolean,default:!0}},setup(d){const e=d,t=[];return m(()=>v.note,o=>{if(o.type=="noteon"&&o.channel==e.channel){let n=new a.Path.Line({from:b(a.view.center,e.in,u.angle),to:b(a.view.center,e.out,u.angle),opacity:1,strokeColor:D(o.pitch,3,.2),strokeWidth:e.width,strokeCap:e.rounded?"round":""});n.tween({opacity:0,easing:"easeInOutCubic"},8e3),t.unshift(n)}if(t.length>M){for(let n=M;n<=t.length;n++){if(!t[n]||!t[n].remove)return;t[n].remove()}t.length=M}}),m(()=>v.playing,o=>{o||t.forEach(n=>{n&&n.remove&&n.remove()})}),C(()=>{t.forEach(o=>{o&&o.remove&&o.remove()})}),(o,n)=>(w(),g("div"))}},Z={class:"flex flex-col"},J={class:"flex flex-col w-full items-stretch relative fullscreen-container rounded-3xl shadow-xl max-h-100vh",id:"screen"},K={class:"absolute top-4 left-4 flex items-center select-none"},X={class:"p-0"},F={key:0},G={__name:"MidiRadar",setup(d){const{screen:e,radar:t}=H(),o=$(1,1,8);function n(p){o.value+=p.delta[0]/100-p.delta[1]/100,t.zoom=Math.round(o.value)}return(p,i)=>{const l=L("drag");return w(),g("div",Z,[R((w(),g("div",J,[h("div",K,[i[0]||(i[0]=h("div",{class:"i-la-times"},null,-1)),h("div",X,j(I(t).zoom),1)]),h("canvas",{class:"max-w-full max-h-full h-full w-full min-h-600px",ref_key:"screen",ref:e,style:{cursor:"none"},resize:"true",width:"1000",height:"1000"},[I(t).loaded?(w(),g("div",F,[c(T,{zoom:I(t).zoom},null,8,["zoom"]),c(Y),c(x,{class:"lead",channel:0,size:8,"line-width":20,grow:20}),c(x,{class:"bass",channel:5,size:10,"line-width":10,grow:60}),c(x,{class:"lead",channel:6,size:12,"line-width":20}),c(x,{class:"arp",channel:7,grow:12,size:6,"line-width":.5}),c(x,{class:"chords",channel:8,grow:80,size:36,"line-width":.1,"blend-mode":"overlay",opacity:.6}),c(k,{class:"kick",channel:1,in:30,out:80,width:18,rounded:!0}),c(k,{class:"snare",channel:2,in:30,out:420,width:2}),c(k,{class:"hihat",channel:3,width:8}),c(k,{class:"fx",channel:4,in:320,out:360,width:12,rounded:!1})])):q("",!0)],512)])),[[l,n]])])}}},re=JSON.parse('{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","frontmatter":{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","layout":"app","date":"2021-11-09T00:00:00.000Z","cover":"geometry.png"},"headers":[],"relativePath":"practice/midi/radar/index.md","filePath":"practice/midi/radar/index.md","lastUpdated":1725531069000}'),Q={name:"practice/midi/radar/index.md"};function ee(d,e,t,o,n,p){const i=G,l=O,r=A("client-only");return w(),g("div",null,[c(r,null,{default:U(()=>[c(i),c(l,{class:"mb-4"})]),_:1}),e[0]||(e[0]=h("h3",{id:"see-all-the-midi-signals-on-the-clock",tabindex:"-1"},[z("See all the MIDI signals on the clock "),h("a",{class:"header-anchor",href:"#see-all-the-midi-signals-on-the-clock","aria-label":'Permalink to "See all the MIDI signals on the clock"'},"â€‹")],-1)),e[1]||(e[1]=h("p",null,[z("Press play on your sequencer to start run the radar by incoming MIDI-clock signal, or just press "),h("code",null,"spacebar"),z(" to start internal metronome, that will drive the radar clocks.")],-1)),e[2]||(e[2]=h("p",null,"Drag across the circle up and down to adjust temporal zoom - ther higher the zoom, the longer the loop (from one to 8 measures).",-1)),e[3]||(e[3]=h("p",null,"Use MIDI channel filter section to cut visualize the exact voices of a multichannel MIDI signal.",-1)),e[4]||(e[4]=h("p",null,"You can toggle the internal synth on and off for using your MIDI-controller or enable audio input monitoring for your using your synths and sequencers.",-1))])}const ae=V(Q,[["render",ee]]);export{re as __pageData,ae as default};
