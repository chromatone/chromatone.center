import{R as O,O as E,c as M,al as k,m as S,F as W,ak as B}from"./chunks/theme.DKUtGHOP.js";import{p as a}from"./chunks/paper-full.BnrfrmqB.js";import{D,r as N,o as L,a2 as y,I as m,q as v,f as w,a4 as R,a1 as j,Z as V,s as u,z as q,u as b,t as U,l as c,_ as Z,i as F,j as T,aw as I}from"./chunks/framework.Bbwy4zmA.js";const p=D({angle:0,loaded:!1,zoom:2}),{midi:$,clock:Y}=O();function A(){const d=N();return L(()=>{a.setup(d.value),a.view.draw(),p.loaded=!0}),y(()=>{a.project.clear(),p.loaded=!1}),m(()=>E.ticks,t=>{p.angle=t/(192*4)*(360/p.zoom)}),m(Y,()=>{$.playing?p.angle+=360/192/p.zoom:(!E.playing||$.stopped)&&(p.angle=0)}),{screen:d,radar:p}}function C(d={x:100,y:100},t=0,e=0){let o=(e-90)*Math.PI/180;return{x:d.x+t*Math.cos(o),y:d.y+t*Math.sin(o)}}const _=60,g={__name:"circles",props:{channel:{type:Number,default:7},grow:{type:Number,default:0},toCenter:{type:Boolean,default:!1},size:{type:Number,default:10},lineWidth:{type:Number,default:1},opacity:{type:Number,default:1},blendMode:{type:String,default:"normal"}},setup(d){const t=d,e=a.view,o=[],n=[],h=N({pitch:0});return m(()=>k.note,i=>{if(i.type=="noteon"&&i.channel==t.channel){let r=C(e.center,(i.octA+i.pitch/12)/9*500,p.angle),s=new a.Point(r.x,r.y),l=new a.Path.Line({strokeColor:M(h.value.pitch),strokeWidth:t.lineWidth,from:o[0]?.position||s,to:s,strokeCap:"round",blendMode:t.blendMode});l.tween({opacity:t.opacity},200).then(()=>{l.tween({opacity:0,easing:"easeInOutCubic"},8e3)});let f=new a.Shape.Circle({center:s,radius:t.size,opacity:0,fillColor:M(i.pitch),blendMode:t.blendMode});f.tween({opacity:t.opacity},200).then(()=>{f.tween({opacity:0,easing:"easeInOutCubic"},8e3)}),t.grow>0&&f.tween({radius:t.grow,easing:"easeInOutCubic"},8e3),t.toCenter&&f.tween({position:e.center,easing:"easeInOutCubic"},4e3),o.unshift(f),n.unshift(l),h.value=i}if(o.length>_){for(let r=_;r<=o.length;r++){if(!o[r]||!o[r].remove)return;o[r].remove()}o.length=_}if(n.length>_){for(let r=_;r<=n.length;r++){if(!n[r]||!n[r].remove)return;n[r].remove()}n.length=_}}),m(()=>k.playing,i=>{i||(o.forEach(r=>{r&&r.remove&&r.remove()}),n.forEach(r=>{r&&r.remove&&r.remove()}))}),y(()=>{o.forEach(i=>{i&&i.remove&&i.remove()}),n.forEach(i=>{i&&i.remove&&i.remove()})}),(i,r)=>(w(),v("div"))}},H={__name:"clock",props:{zoom:{type:Number,default:4}},setup(d){const{isDark:t}=R(),e=a.view,o=new a.Path.Line({from:e.center,to:[e.center.x,e.bounds.y],strokeColor:t.value?"#eee":"#888",strokeCap:"round",strokeWidth:1,pivot:e.center}),n=new a.Shape.Circle({center:e.center,radius:4,fillColor:t.value?"#eee":"#888"});let h=[];for(let s=1;s<8;s++){let l=new a.Path.Circle(a.view.center,s/9*o.length);l.strokeColor="#f002",h.push(l)}const i=D([]),r=D([]);return m(()=>p.zoom,s=>{i.forEach(l=>l.remove()),r.forEach(l=>l.remove());for(let l=0;l<=s;l++){let f=S(l,s,e.size.width,e.size.width),P=S(l+.5,s,e.size.width,e.size.width);r[l]=new a.Path.Line({from:e.center,to:[P.x,P.y],strokeColor:t.value?"#eee1":"#8881",strokeCap:"round",strokeWidth:1,pivot:e.center}),i[l]=new a.Path.Line({from:e.center,to:[f.x,f.y],strokeColor:t.value?"#eee6":"#8886",strokeCap:"round",strokeWidth:1,pivot:e.center})}}),m(t,()=>{o.strokeColor=t.value?"#eee":"#888",n.fillColor=t.value?"#eee":"#888"}),a.view.on("resize",()=>{o.firstSegment.point=a.view.center,n.position=a.view.center,h.forEach(s=>s.position=e.center)}),m(()=>p.angle,s=>{let l=C(a.view.center,400,s);o.lastSegment.point=l}),y(()=>{o.remove(),n.remove(),h.forEach(s=>s.remove())}),(s,l)=>(w(),v("div"))}},J={__name:"pointer",setup(d){new a.Layer({name:"poiner"});const t=N([0,0]),e=new a.Shape.Circle({center:a.view.center,radius:5,opacity:.5,fillColor:"#555"}),o=new a.Shape.Circle({center:a.view.center,radius:40,opacity:.1,fillColor:"#555"});return a.view.on("mousemove",n=>{e.set({position:n.point})}),a.view.on("mousedown",n=>{t.value[0]=n.point.x,t.value[1]=n.point.y,o.tween({position:n.point},{easing:"easeInOutCubic",duration:600})}),y(()=>{e.remove(),o.remove(),a.view.off("mousemove"),a.view.off("nousedown")}),(n,h)=>(w(),v("div"))}},z=100,x={__name:"ticks",props:{channel:{type:Number,default:7},in:{type:Number,default:380},out:{type:Number,default:400},width:{type:Number,default:2},rounded:{type:Boolean,default:!0}},setup(d){const t=d,e=[];return m(()=>k.note,o=>{if(o.type=="noteon"&&o.channel==t.channel){let n=new a.Path.Line({from:C(a.view.center,t.in,p.angle),to:C(a.view.center,t.out,p.angle),opacity:1,strokeColor:M(o.pitch,3,.2),strokeWidth:t.width,strokeCap:t.rounded?"round":""});n.tween({opacity:0,easing:"easeInOutCubic"},8e3),e.unshift(n)}if(e.length>z){for(let n=z;n<=e.length;n++){if(!e[n]||!e[n].remove)return;e[n].remove()}e.length=z}}),m(()=>k.playing,o=>{o||e.forEach(n=>{n&&n.remove&&n.remove()})}),y(()=>{e.forEach(o=>{o&&o.remove&&o.remove()})}),(o,n)=>(w(),v("div"))}},X={class:"flex flex-col"},G={class:"flex flex-col w-full items-stretch relative fullscreen-container rounded-3xl shadow-xl max-h-100vh",id:"screen"},K={class:"absolute top-4 left-4 flex items-center select-none"},Q={class:"p-0"},ee={key:0},te={__name:"MidiRadar",setup(d){const{screen:t,radar:e}=A(),o=W(1,1,8);function n(h){o.value+=h.delta[0]/100-h.delta[1]/100,e.zoom=Math.round(o.value)}return(h,i)=>{const r=j("drag");return w(),v("div",X,[V((w(),v("div",G,[u("div",K,[i[0]||(i[0]=u("div",{class:"i-la-times"},null,-1)),u("div",Q,q(b(e).zoom),1)]),u("canvas",{class:"max-w-full max-h-full h-full w-full min-h-600px",ref_key:"screen",ref:t,style:{cursor:"none"},resize:"true",width:"1000",height:"1000"},[b(e).loaded?(w(),v("div",ee,[c(H,{zoom:b(e).zoom},null,8,["zoom"]),c(J),c(g,{class:"lead",channel:0,size:8,"line-width":20,grow:20}),c(g,{class:"bass",channel:5,size:10,"line-width":10,grow:60}),c(g,{class:"lead",channel:6,size:12,"line-width":20}),c(g,{class:"arp",channel:7,grow:12,size:6,"line-width":.5}),c(g,{class:"chords",channel:8,grow:80,size:36,"line-width":.1,"blend-mode":"overlay",opacity:.6}),c(x,{class:"kick",channel:1,in:30,out:80,width:18,rounded:!0}),c(x,{class:"snare",channel:2,in:30,out:420,width:2}),c(x,{class:"hihat",channel:3,width:8}),c(x,{class:"fx",channel:4,in:320,out:360,width:12,rounded:!1})])):U("",!0)],512)])),[[r,n]])])}}},se=JSON.parse('{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","frontmatter":{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","layout":"app","date":"2021-11-09T00:00:00.000Z","cover":"geometry.png"},"headers":[],"relativePath":"practice/midi/radar/index.md","filePath":"practice/midi/radar/index.md","lastUpdated":1752981864000}'),oe={name:"practice/midi/radar/index.md"};function ne(d,t,e,o,n,h){const i=te,r=B,s=F("client-only");return w(),v("div",null,[c(s,null,{default:T(()=>[c(i,{style:{position:"sticky",top:"0"}}),c(r,{class:"mx-2 max-w-55ch"})]),_:1}),t[0]||(t[0]=u("div",{class:"info custom-block"},[u("p",{class:"custom-block-title custom-block-title-default"},"INFO"),u("h3",{id:"see-all-the-midi-signals-on-the-clock",tabindex:"-1"},[I("See all the MIDI signals on the clock "),u("a",{class:"header-anchor",href:"#see-all-the-midi-signals-on-the-clock","aria-label":"Permalink to “See all the MIDI signals on the clock”"},"​")]),u("p",null,[I("Press play on your sequencer to start run the radar by incoming MIDI-clock signal, or just press "),u("code",null,"spacebar"),I(" to start internal metronome, that will drive the radar clocks.")]),u("p",null,"Drag across the circle up and down to adjust temporal zoom - ther higher the zoom, the longer the loop (from one to 8 measures)."),u("p",null,"Use MIDI channel filter section to cut visualize the exact voices of a multichannel MIDI signal."),u("p",null,"You can toggle the internal synth on and off for using your MIDI-controller or enable audio input monitoring for your using your synths and sequencers.")],-1))])}const le=Z(oe,[["render",ne]]);export{se as __pageData,le as default};
