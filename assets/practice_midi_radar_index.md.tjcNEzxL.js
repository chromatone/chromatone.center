import{_ as S}from"./chunks/MidiPanel.4xMz3Bdq.js";import{c as v}from"./chunks/midi.91UwWBqe.js";import{t as P}from"./chunks/tempo.fl6CFXyY.js";import{p as i}from"./chunks/paper-full.GEG6FhU-.js";import{k as M,i as $,E as B,G as C,w as h,o as _,c as w,u as O,x as W,y as L,a as m,t as R,g as I,f as c,b as V,_ as j,m as U,B as D,n as q}from"./chunks/framework.KnxPB1sj.js";import{n as N}from"./chunks/colors.hHBI9fPI.js";import{g as E}from"./chunks/calculations.uITx2GSi.js";import{u as T}from"./chunks/index.bnjSkgpl.js";import"./chunks/synth.TVJKhjDp.js";import"./chunks/index.RYxauP_R.js";import"./chunks/audio.pG3RnClx.js";import"./chunks/Scale.nioafpJK.js";import"./chunks/Subtract.6yvEFIfU.js";import"./chunks/PingPongDelay.a3-runAV.js";import"./chunks/AutoPanner.02Sltg0b.js";import"./chunks/MonoSynth.pp_JS1sF.js";import"./chunks/Filter.CUstuK5R.js";import"./chunks/commonjsHelpers.4gQjN7DL.js";import"./chunks/index.QyW-2vQe.js";import"./chunks/Loop.bmxnTff3.js";import"./chunks/index.kn6emmbE.js";import"./chunks/theory.c9f85u7m.js";import"./chunks/index._4u9I4xi.js";const u=M({angle:0,loaded:!1,zoom:2});function Y(){const d=$();return B(()=>{i.setup(d.value),i.view.draw(),u.loaded=!0}),C(()=>{i.project.clear(),u.loaded=!1}),h(()=>P.ticks,n=>{v.playing||(u.angle=n/(192*4)*(360/u.zoom))}),h(()=>v.clock,()=>{v.playing?u.angle+=360/192/u.zoom:(!P.playing||v.stopped)&&(u.angle=0)}),{screen:d,radar:u}}function b(d={x:100,y:100},n=0,e=0){let t=(e-90)*Math.PI/180;return{x:d.x+n*Math.cos(t),y:d.y+n*Math.sin(t)}}const y=60,x={__name:"circles",props:{channel:{type:Number,default:7},grow:{type:Number,default:0},toCenter:{type:Boolean,default:!1},size:{type:Number,default:10},lineWidth:{type:Number,default:1},opacity:{type:Number,default:1},blendMode:{type:String,default:"normal"}},setup(d){const n=d,e=i.view,t=[],o=[],p=$({pitch:0});return h(()=>v.note,a=>{var l;if(a.type=="noteon"&&a.channel==n.channel){let r=b(e.center,(a.octA+a.pitch/12)/9*500,u.angle),s=new i.Point(r.x,r.y),g=new i.Path.Line({strokeColor:N(p.value.pitch),strokeWidth:n.lineWidth,from:((l=t[0])==null?void 0:l.position)||s,to:s,strokeCap:"round",blendMode:n.blendMode});g.tween({opacity:n.opacity},200).then(()=>{g.tween({opacity:0,easing:"easeInOutCubic"},8e3)});let f=new i.Shape.Circle({center:s,radius:n.size,opacity:0,fillColor:N(a.pitch),blendMode:n.blendMode});f.tween({opacity:n.opacity},200).then(()=>{f.tween({opacity:0,easing:"easeInOutCubic"},8e3)}),n.grow>0&&f.tween({radius:n.grow,easing:"easeInOutCubic"},8e3),n.toCenter&&f.tween({position:e.center,easing:"easeInOutCubic"},4e3),t.unshift(f),o.unshift(g),p.value=a}if(t.length>y){for(let r=y;r<=t.length;r++){if(!t[r]||!t[r].remove)return;t[r].remove()}t.length=y}if(o.length>y){for(let r=y;r<=o.length;r++){if(!o[r]||!o[r].remove)return;o[r].remove()}o.length=y}}),h(()=>v.playing,a=>{a||(t.forEach(l=>{l&&l.remove&&l.remove()}),o.forEach(l=>{l&&l.remove&&l.remove()}))}),C(()=>{t.forEach(a=>{a&&a.remove&&a.remove()}),o.forEach(a=>{a&&a.remove&&a.remove()})}),(a,l)=>(_(),w("div"))}},Z={__name:"clock",props:{zoom:{type:Number,default:4}},setup(d){const{isDark:n}=O(),e=i.view,t=new i.Path.Line({from:e.center,to:[e.center.x,e.bounds.y],strokeColor:n.value?"#eee":"#888",strokeCap:"round",strokeWidth:1,pivot:e.center}),o=new i.Shape.Circle({center:e.center,radius:4,fillColor:n.value?"#eee":"#888"});let p=[];for(let r=1;r<8;r++){let s=new i.Path.Circle(i.view.center,r/9*t.length);s.strokeColor="#f002",p.push(s)}const a=M([]),l=M([]);return h(()=>u.zoom,r=>{a.forEach(s=>s.remove()),l.forEach(s=>s.remove());for(let s=0;s<=r;s++){let g=E(s,r,e.size.width,e.size.width),f=E(s+.5,r,e.size.width,e.size.width);l[s]=new i.Path.Line({from:e.center,to:[f.x,f.y],strokeColor:n.value?"#eee1":"#8881",strokeCap:"round",strokeWidth:1,pivot:e.center}),a[s]=new i.Path.Line({from:e.center,to:[g.x,g.y],strokeColor:n.value?"#eee6":"#8886",strokeCap:"round",strokeWidth:1,pivot:e.center})}}),h(n,()=>{t.strokeColor=n.value?"#eee":"#888",o.fillColor=n.value?"#eee":"#888"}),i.view.on("resize",()=>{t.firstSegment.point=i.view.center,o.position=i.view.center,p.forEach(r=>r.position=e.center)}),h(()=>u.angle,r=>{let s=b(i.view.center,400,r);t.lastSegment.point=s}),C(()=>{t.remove(),o.remove(),p.forEach(r=>r.remove())}),(r,s)=>(_(),w("div"))}},A={__name:"pointer",setup(d){new i.Layer({name:"poiner"});const n=$([0,0]),e=new i.Shape.Circle({center:i.view.center,radius:5,opacity:.5,fillColor:"#555"}),t=new i.Shape.Circle({center:i.view.center,radius:40,opacity:.1,fillColor:"#555"});return i.view.on("mousemove",o=>{e.set({position:o.point})}),i.view.on("mousedown",o=>{n.value[0]=o.point.x,n.value[1]=o.point.y,t.tween({position:o.point},{easing:"easeInOutCubic",duration:600})}),C(()=>{e.remove(),t.remove(),i.view.off("mousemove"),i.view.off("nousedown")}),(o,p)=>(_(),w("div"))}},z=100,k={__name:"ticks",props:{channel:{type:Number,default:7},in:{type:Number,default:380},out:{type:Number,default:400},width:{type:Number,default:2},rounded:{type:Boolean,default:!0}},setup(d){const n=d,e=[];return h(()=>v.note,t=>{if(t.type=="noteon"&&t.channel==n.channel){let o=new i.Path.Line({from:b(i.view.center,n.in,u.angle),to:b(i.view.center,n.out,u.angle),opacity:1,strokeColor:N(t.pitch,3,.2),strokeWidth:n.width,strokeCap:n.rounded?"round":""});o.tween({opacity:0,easing:"easeInOutCubic"},8e3),e.unshift(o)}if(e.length>z){for(let o=z;o<=e.length;o++){if(!e[o]||!e[o].remove)return;e[o].remove()}e.length=z}}),h(()=>v.playing,t=>{t||e.forEach(o=>{o&&o.remove&&o.remove()})}),C(()=>{e.forEach(t=>{t&&t.remove&&t.remove()})}),(t,o)=>(_(),w("div"))}},G={class:"flex flex-col"},H={class:"flex flex-col w-full items-stretch relative fullscreen-container rounded-3xl shadow-xl",id:"screen"},J={class:"absolute top-4 left-4 flex items-center select-none"},X=m("div",{class:"i-la-times"},null,-1),F={class:"p-0"},K={key:0},Q={__name:"MidiRadar",setup(d){const{screen:n,radar:e}=Y(),t=T(1,1,8);function o(p){t.value+=p.delta[0]/100-p.delta[1]/100,e.zoom=Math.round(t.value)}return(p,a)=>{const l=W("drag");return _(),w("div",G,[L((_(),w("div",H,[m("div",J,[X,m("div",F,R(I(e).zoom),1)]),m("canvas",{class:"max-w-full max-h-full h-full w-full min-h-600px",ref_key:"screen",ref:n,style:{cursor:"none"},resize:"true",width:"1000",height:"1000"},[I(e).loaded?(_(),w("div",K,[c(Z,{zoom:I(e).zoom},null,8,["zoom"]),c(A),c(x,{class:"lead",channel:0,size:8,"line-width":20,grow:20}),c(x,{class:"bass",channel:5,size:10,"line-width":10,grow:60}),c(x,{class:"lead",channel:6,size:12,"line-width":20}),c(x,{class:"arp",channel:7,grow:12,size:6,"line-width":.5}),c(x,{class:"chords",channel:8,grow:80,size:36,"line-width":.1,"blend-mode":"overlay",opacity:.6}),c(k,{class:"kick",channel:1,in:30,out:80,width:18,rounded:!0}),c(k,{class:"snare",channel:2,in:30,out:420,width:2}),c(k,{class:"hihat",channel:3,width:8}),c(k,{class:"fx",channel:4,in:320,out:360,width:12,rounded:!1})])):V("",!0)],512)])),[[l,o]])])}}},$e=JSON.parse('{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","frontmatter":{"title":"MIDI Radar","description":"Circular MIDI visualisation experiment","layout":"app","date":"2021-11-09T00:00:00.000Z","cover":"geometry.png"},"headers":[],"relativePath":"practice/midi/radar/index.md","filePath":"practice/midi/radar/index.md","lastUpdated":1704994927000}'),ee={name:"practice/midi/radar/index.md"},te=m("h3",{id:"see-all-the-midi-signals-on-the-clock",tabindex:"-1"},[D("See all the MIDI signals on the clock "),m("a",{class:"header-anchor",href:"#see-all-the-midi-signals-on-the-clock","aria-label":'Permalink to "See all the MIDI signals on the clock"'},"â€‹")],-1),oe=m("p",null,[D("Press play on your sequencer to start run the radar by incoming MIDI-clock signal, or just press "),m("code",null,"spacebar"),D(" to start internal metronome, that will drive the radar clocks.")],-1),ne=m("p",null,"Drag across the circle up and down to adjust temporal zoom - ther higher the zoom, the longer the loop (from one to 8 measures).",-1),re=m("p",null,"Use MIDI channel filter section to cut visualize the exact voices of a multichannel MIDI signal.",-1),ie=m("p",null,"You can toggle the internal synth on and off for using your MIDI-controller or enable audio input monitoring for your using your synths and sequencers.",-1);function ae(d,n,e,t,o,p){const a=Q,l=S,r=q("client-only");return _(),w("div",null,[c(r,null,{default:U(()=>[c(a),c(l,{class:"mb-4"})]),_:1}),te,oe,ne,re,ie])}const Pe=j(ee,[["render",ae]]);export{$e as __pageData,Pe as default};
