import{_ as b,i as u,r as k,q as w,v as n,b as l,F as a,f as x,a as f,H as _,N as I,A as T,c as M,T as v,O as $,L as j,M as R}from"./chunks/framework.7e747cd7.js";import{M as D}from"./chunks/Midi.1f918097.js";import{n as P}from"./chunks/colors.fcf9eae3.js";import{af as S,S as C}from"./chunks/index.83aed4fc.js";import{m as A}from"./chunks/midi.290fabf9.js";import{u as O}from"./chunks/audio.170dbcbf.js";import{P as F}from"./chunks/synth.220fb0dd.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.c0ca431c.js";import"./chunks/index.17b4cde5.js";import"./chunks/index.b30cd6d2.js";import"./chunks/calculations.3384a913.js";import"./chunks/theory.61e5aadb.js";import"./chunks/index.86652af6.js";import"./chunks/index.0b97d2b2.js";import"./chunks/Scale.7b617051.js";import"./chunks/Subtract.f0fef764.js";import"./chunks/PingPongDelay.38a34857.js";import"./chunks/AutoPanner.94a306f8.js";import"./chunks/MonoSynth.4cac63d2.js";import"./chunks/Filter.2b531c53.js";const h=d=>(T("data-v-8286ed4a"),d=d(),M(),d),L={class:"flex flex-col items-center"},N=h(()=>a("div",{class:"text-2xl"},"MIDI Recorder",-1)),q={class:"flex flex-wrap"},z={key:0,class:"i-la-play"},B={key:1,class:"i-la-stop"},E=h(()=>a("div",{class:"i-la-trash-alt"},null,-1)),H=[E],W=h(()=>a("div",{class:"i-la-download"},null,-1)),J=[W],X=["viewBox"],Y=["x","y","width","height","fill"],Z={__name:"recorder",setup(d){new D.Midi;const e=u({title:"",author:"",header:"",duration:k(()=>e.latest-e.started),tracks:{},first:0,last:1e3,top:61,bottom:60}),r=u({width:1e3,height:500,playing:!1,recording:!1,hiddenTracks:[]});w(()=>A.note,t=>{var s,i,o;if(r.recording)if(e.tracks[t.channel]||(e.tracks[t.channel]={active:{},notes:[]}),e.first==0&&(e.first=t.timestamp),t.number>=e.top&&(e.top=t.number),t.number<=e.bottom&&(e.bottom=t.number),t.type=="noteon")e.tracks[t.channel].active[t.number]=t;else{e.last=t.timestamp;let c=(o=(i=(s=e.tracks)==null?void 0:s[t.channel].active)==null?void 0:i[t.number])==null?void 0:o.timestamp;t.duration=t.timestamp-c,delete e.tracks[t.channel].active[t.number],e.tracks[t.channel].notes.push(t)}});function m(t){let s=t-e.first,i=e.last-e.first||1;return s/i*r.width}function g(t){let s=e.top-t,i=t-e.bottom-1;return s/(i+s)*r.height}const p=[];function y(){r.playing=!r.playing;const{master:t}=O();if(r.playing){const s=S()+.5;e.filteredTracks.forEach(i=>{const o=new F(C,{envelope:{attack:.02,decay:.1,sustain:.3,release:1}}).connect(t.limiter);p.push(o),i.notes.forEach(c=>{o.triggerAttackRelease(c.name,c.duration,c.time+s,c.velocity)})})}else for(;p.length;)p.shift().dispose()}return(t,s)=>(n(),l("div",L,[N,a("div",q,[a("button",{onClick:s[0]||(s[0]=i=>y())},[r.playing?(n(),l("div",B)):(n(),l("div",z))]),a("button",{onClick:s[1]||(s[1]=i=>r.recording=!r.recording)},[a("div",{class:"i-la-circle",style:x({color:r.recording?"red":""})},null,4)]),a("button",{onClick:s[2]||(s[2]=i=>t.clear())},H),a("button",{onClick:s[3]||(s[3]=(...i)=>t.download&&t.download(...i))},J)]),(n(),l("svg",{class:"h-30em w-full",version:"1.1",baseProfile:"full",viewBox:`0 0 ${r.width} ${r.height}`,xmlns:"http://www.w3.org/2000/svg"},[(n(!0),l(f,null,_(e.tracks,i=>(n(),l("g",{key:i},[(n(!0),l(f,null,_(i.notes,o=>(n(),l("rect",{key:o,rx:"0.4",x:m(o.timestamp),y:g(o.number),width:o.duration*1e3/(e.last-e.first),height:r.height/(e.top-e.bottom),fill:I(P)((o.number+3)%12)},null,8,Y))),128))]))),128))],8,X))]))}},G=b(Z,[["__scopeId","data-v-8286ed4a"]]),K=a("h2",{id:"work-in-progress",tabindex:"-1"},[j("Work in progress "),a("a",{class:"header-anchor",href:"#work-in-progress","aria-label":'Permalink to "Work in progress"'},"​")],-1),Q=a("p",null,"This app is a draft to be iterated on. The idea is to make a tool to record some kind of visual midi sketches and store them as mid files and also directly in the browser.",-1),bt=JSON.parse('{"title":"MIDI Recorder","description":"Record MIDI as you play – visualize and save your music","frontmatter":{"title":"MIDI Recorder","description":"Record MIDI as you play – visualize and save your music","date":"2021-08-04T00:00:00.000Z","sources":["https://github.com/1j01/midi-recorder/","https://github.com/Tonejs/Midi","https://github.com/Tonejs/Tone.js/wiki/TransportTime","https://webmidijs.org/docs/v3.0.0-alpha.10/index.html"],"status":"alpha","version":0.1},"headers":[],"relativePath":"practice/midi/recorder/index.md","filePath":"practice/midi/recorder/index.md"}'),U={name:"practice/midi/recorder/index.md"},kt=Object.assign(U,{setup(d){return(e,r)=>{const m=R("client-only");return n(),l("div",null,[v(m,null,{default:$(()=>[v(G)]),_:1}),K,Q])}}});export{bt as __pageData,kt as default};
