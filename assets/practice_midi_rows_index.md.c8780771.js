import"./chunks/tuner.dded04c7.js";import"./chunks/audio.9297ee4b.js";import"./chunks/colors.0dc03560.js";import{u as F}from"./chunks/midi.a65cc3de.js";import"./chunks/loop.e2aca282.js";import"./chunks/mic.c3468f4b.js";import{M as N}from"./chunks/Midi.2c05a97b.js";import{u as B}from"./chunks/tempo.0cfd0346.js";import"./chunks/noise.a1cda708.js";import{$ as D,F as x}from"./chunks/index.d229a0c3.js";import{u as I}from"./chunks/sequence.45308720.js";import{u as P,b as w}from"./chunks/synth.99a34600.js";import"./chunks/theory.61e5aadb.js";import{P as S}from"./chunks/Sequence.de691730.js";import{X as O,A as v,i as f,z as R,o as a,c,a as t,t as l,u as i,F as y,r as b,d as q,B as V,f as $,x as z}from"./chunks/framework.aa37bc02.js";import"./chunks/commonjsHelpers.042e6b4d.js";import"./chunks/calculations.65ee336d.js";import"./chunks/index.9f2d097c.js";import"./chunks/index.0eeb4803.js";import"./chunks/index.f0fa50d9.js";import"./chunks/index.b30cd6d2.js";import"./chunks/midiRender.d2121094.js";import"./chunks/UserMedia.691988a1.js";import"./chunks/Subtract.07d62855.js";import"./chunks/OnePoleFilter.6b2b4bf4.js";import"./chunks/Loop.4b11eb3a.js";import"./chunks/FFT.cdefb282.js";import"./chunks/BitCrusher.a0f06686.js";import"./chunks/Filter.a766b417.js";import"./chunks/AutoPanner.82eeffdb.js";import"./chunks/Scale.79ce1516.js";import"./chunks/PingPongDelay.2fa9d1e0.js";import"./chunks/MonoSynth.d287d31a.js";import"./chunks/index.86652af6.js";const E={class:"flex flex-col"},j={class:"text-2xl"},A={class:"flex flex-wrap"},J={key:0,class:"i-la-circle"},L={key:1,class:"i-mdi-checkbox-blank-circle"},Q={key:0,class:"i-la-play"},W={key:1,class:"i-la-pause"},X=t("div",{class:"i-la-stop"},null,-1),Z=[X],G=t("div",{class:"i-la-trash-alt"},null,-1),H=[G],K=t("div",{class:"i-la-plus"},null,-1),U=[K],Y={class:"p-1"},tt=t("div",{class:"i-la-minus"},null,-1),et=[tt],it=t("div",{class:"p-1"},"/",-1),st=t("div",{class:"i-la-plus"},null,-1),ot=[st],nt={class:"p-1"},rt=t("div",{class:"i-la-minus"},null,-1),lt=[rt],at={class:"flex flex-col"},ct=["viewBox"],dt=["width","height"],mt=["x1","x2","y2"],pt=["transform"],ut=["y2"],_t={y:"3",x:"1","font-size":"2"},ht={class:"flex text-xs p-4"},vt={class:"grid grid-cols-3 text-xs gap-2"},ft=O({__name:"midi-rows",setup(C){P();const{midi:p}=F(),{seq:n}=I(null,1,"row"),d=B(),o=v({width:100,height:30,progress:f(()=>o.width*n.progress),recording:!1}),h=f(()=>n.meter.over*D.PPQ*4/n.meter.under),u=f(()=>d.ticks%h.value),M=new S((r,e)=>{console.log(e),w(x(e.midi,"midi").toNote(),e.duration+"i")}).set({loop:!0,loopEnd:"800i",loopStart:0,playbackRate:1,probability:1}).start(0),_=v({}),k=v([]),{track:g,midiFile:gt}=T();R(()=>p.note,r=>{if(w(x(r.number,"midi").toNote()+"","196i"),!(!o.recording||!d.playing))if(r.velocity>0)_[r.number]=u.value;else{const e=_==null?void 0:_[r.number],m=u.value;let s;m>e?s=m-e:s=h.value-e+m,k.push({ticks:u.value,midi:r.number,channel:r.channel,start:e,stop:m,duration:s}),M.add({time:u.value+"i",midi:r.number,duration:s})}});function T(){const r=new N.Midi;r.name="Chromatone recording";const e=r.addTrack();return{midiFile:r,track:e}}return(r,e)=>{var m;return a(),c("div",E,[t("div",j,"MIDI ROWS "+l(u.value)+"/"+l(h.value),1),t("div",A,[t("button",{onClick:e[0]||(e[0]=s=>o.recording=!o.recording)},[o.recording?(a(),c("div",L)):(a(),c("div",J))]),t("button",{onClick:e[1]||(e[1]=s=>i(d).playing=!i(d).playing)},[i(d).playing?(a(),c("div",W)):(a(),c("div",Q))]),t("button",{onClick:e[2]||(e[2]=s=>i(d).stopped=Date.now())},Z),t("button",{onClick:e[3]||(e[3]=s=>i(g).notes=[])},H),t("button",{onClick:e[4]||(e[4]=s=>i(n).meter.over++)},U),t("div",Y,l(i(n).meter.over),1),t("button",{onClick:e[5]||(e[5]=s=>i(n).meter.over--)},et),it,t("button",{onClick:e[6]||(e[6]=s=>i(n).meter.under++)},ot),t("div",nt,l(i(n).meter.under),1),t("button",{onClick:e[7]||(e[7]=s=>i(n).meter.under--)},lt)]),t("div",at,[(a(),c("svg",{viewBox:`0 0 ${o.width} ${o.height}`},[t("rect",{width:o.width,height:o.height,fill:"#999"},null,8,dt),(a(!0),c(y,null,b((m=i(p))==null?void 0:m.channels,s=>(a(),c("g",{class:"channel",key:s}))),128)),t("line",{x1:o.progress,x2:o.progress,y1:0,y2:o.height,stroke:"black"},null,8,mt),(a(!0),c(y,null,b(i(n).steps,s=>(a(),c("g",{key:s,transform:`translate(${o.width*s[0].split("-")[0]/i(n).steps.length})`},[t("line",{y2:o.height,stroke:"black","stroke-width":"0.1"},null,8,ut),t("text",_t,l(Number(s[0].split("-")[0])+1),1)],8,pt))),128))],8,ct))]),t("div",ht,l(k),1),t("div",vt,[t("pre",null,l(i(n)),1),t("pre",null,l(i(d)),1),t("pre",null,[q(),t("p",null," "+l(i(g)),1),t("p",null,l(i(p).clock),1),t("p",null,l(i(p).note),1)])])])}}}),te=JSON.parse('{"title":"Rows","description":"Measurewise MIDI recorder","frontmatter":{"title":"Rows","description":"Measurewise MIDI recorder","date":"2020-02-02T00:00:00.000Z"},"headers":[],"relativePath":"practice/midi/rows/index.md","filePath":"practice/midi/rows/index.md"}'),kt={name:"practice/midi/rows/index.md"},ee=Object.assign(kt,{setup(C){return(p,n)=>{const d=V("client-only");return a(),c("div",null,[$(d,null,{default:z(()=>[$(ft)]),_:1})])}}});export{te as __pageData,ee as default};
