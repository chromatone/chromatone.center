import{b as N,p as z,f as S}from"./chunks/calculations.65ee336d.js";import{F as P,G as j,X as O,s as b,S as B}from"./chunks/index.139b2562.js";import{r as F,L as x,b as f,Y as R,V as H,H as h,O as E,W as I,A as M,B as L,o as i,c as l,a as s,C as g,u as o,t as _,I as $,F as q,d as k,g as U,f as w,w as G,h as W}from"./chunks/framework.18a7d3ba.js";import{c as Y,b as J}from"./chunks/audio.4983d088.js";import{l as V}from"./chunks/midi.d68b2a41.js";import{u as T}from"./chunks/index.ff80e595.js";import{a as D}from"./chunks/AutoPanner.3abf4fbf.js";import{F as K}from"./chunks/Filter.3335ee5d.js";import{n as X}from"./chunks/colors.b83dc710.js";import{n as Z}from"./chunks/theory.61e5aadb.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.b30cd6d2.js";import"./chunks/Scale.a106cb29.js";import"./chunks/index.654bd828.js";import"./chunks/synth.f8bdd3f9.js";import"./chunks/Subtract.d22cbd0e.js";import"./chunks/PingPongDelay.0dd5299b.js";import"./chunks/MonoSynth.2582d87a.js";import"./chunks/index.8c24e7d1.js";import"./chunks/index.86652af6.js";const n=F({base:55,freq:T(x("drone-freq",110),27.5,220),started:!1,stopped:!0,filterFreq:x("drone-filter-freq",1e3),volume:x("drone-vol",.5),note:f(()=>P(n.freq).toNote()),pitch:f({get(){return Math.round((N(n.freq)+72)%12)},set(r){n.freq=z(r-36)}}),cents:f(()=>oe(n.freq)%1200),centDiff:f(()=>n.cents-n.pitch*100),color:f(()=>S(n.freq))}),c=R({initiated:!1});function A(){const{channel:r}=Y("drone");c.channel=r,c.gain=new j(n.volume).connect(r),c.filter=new K(n.filterFreq).connect(c.gain)}function Q(){return c.initiated||(A(),c.initiated=!0,n.started=!0,H(" ",r=>{r.preventDefault(),n.stopped=!n.stopped}),h(()=>n.volume,r=>{c.gain.gain.targetRampTo(r,1)}),h(()=>n.filterFreq,r=>{c.filter.frequency.targetRampTo(r,.1)})),n}let C=0;function ee(r){const e=R({}),t=F({play:!1,active:!1,vol:T(x(`drone-${r}-vol`,.8),0,1),pan:T(x(`drone-${r}-pan`,0),-1,1),freq:f(()=>n.freq*Math.pow(2,r/12)),note:f(()=>P(t.freq).toNote()),color:f(()=>S(t.freq)),lfo:0,panning:0}),m=V({param:`drone-${r}-vol`,number:5+C});h(m,a=>{t.vol=a,a>0&&(t.play=!0)});const d=V({param:`drone-${r}-pan`,number:6+C});h(d,a=>{t.pan=(a-.5)*2}),C+=2,h(()=>n.stopped,a=>{a?t.play=!1:t.active&&(t.play=!0)}),h(()=>t.play,a=>{a?(e.synth||(c.initiated||(A(),c.initiated=!0,n.started=!0),u(),y()),t.active=!0,n.stopped=!1,e.synth.triggerAttack(t.freq)):e.synth&&e.synth.triggerRelease()});function u(){e.meter=new J({normalRange:!0}),e.panner=new O({volume:b(n.volume)}).connect(c.filter),e.lfo=new D(Math.random()*.5+.01,-.25,.25).connect(e.panner.pan).start(),e.lfoVol=new D(Math.random()*.1+.001,-20,0).connect(e.panner.volume).connect(e.meter).start(),e.synth=new B({envelope:{attack:2,sustain:1,release:4},oscillator:{type:"sawtooth32"},volume:b(t.vol)-10}).connect(e.panner)}function y(){h(()=>t.freq,a=>{e.synth.frequency.targetRampTo(a)}),h(()=>t.vol,a=>{e.synth.volume.exponentialRampTo(b(a)-10,1)}),h(()=>t.pan,a=>{e.panner.pan.targetRampTo(a,1)}),E(()=>{t.lfo=e.meter.getValue()})}return I(()=>{e.synth&&e.synth.triggerRelease()}),t}function te(r,e=n.base){return e*Math.pow(2,r/12)}function oe(r,e=0){return Math.floor(1200*Math.log(r/te(e))/Math.log(2))}const re={class:"text-2xl z-100"},ne={__name:"voice",props:{interval:{type:Number,default:0}},setup(r){const t=ee(r.interval);function m(d){d.tap&&(t.play=!t.play,t.active=t.play),t.vol-=d.delta[1]/400,t.pan+=d.delta[0]/100}return(d,u)=>{const y=M("drag");return L((i(),l("div",{class:"py-16 flex-1 relative cursor-pointer rounded-xl overflow-hidden text-center font-bold border-6 touch-none",style:g({borderColor:o(t).play?o(t).color:"#3333"})},[s("div",{class:"vol -z-5 absolute left-0 right-0 bottom-0 bg-dark-100 bg-opacity-30 border-t-4",style:g({borderColor:o(t).color,height:o(t).vol*100+"%",opacity:o(t).play?1:.2})},null,4),s("div",{class:"vol -z-5 absolute left-0 right-0 bottom-0 bg-dark-900 bg-opacity-20 border-t-1",style:g({height:o(t).vol*100*o(t).lfo+"%",opacity:o(t).play?1:.2,backgroundColor:o(t).color})},null,4),s("div",{class:"pan -z-5 absolute left-0 top-0 bottom-0 border-r-2",style:g({width:o(t).pan*50+50+"%",opacity:o(t).play?1:.2})},null,4),s("div",re,_(o(t).note),1)],4)),[[y,m]])}}},ae={class:"drone w-full flex-1 justify-center flex flex-col p-2"},se={class:"intervals my-2"},ie={class:"flex flex-wrap"},le={class:"info my-4 flex flex-wrap justify-stretch items-center touch-none"},ce={class:"p-1 text-4xl font-bold"},pe={class:"p-1"},de={class:"p-1"},ue={class:"p-1 text-xl"},he={class:"controls min-w-10em flex-1 my-2 p-2 flex flex-wrap items-center justify-center is-group gap-2"},fe={key:0,class:"i-la-stop"},me={key:1,class:"i-la-play"},ve={class:"is-group flex p-2 gap-2"},ge={class:"notes w-full text-sm font-bold text-center flex flex-wrap"},ye=["onClick"],_e={__name:"drone-app",setup(r){const e=Q();function t(d){e.freq+=d.delta[0]/10}const m=F({fifths:{title:"5P",voices:[7,19,31]},octave:{title:"8P",voices:[-12,0,12]}});return(d,u)=>{const y=$("control-rotary"),a=M("drag");return i(),l("div",{class:"flex flex-col items-stretch w-full transition-all duration-500 ease-out select-none rounded-3xl shadow-xl border-8",style:g({borderColor:o(e).color})},[s("div",ae,[s("div",se,[(i(!0),l(q,null,k(m,p=>(i(),l("div",{class:"interval flex flex-col m-1",key:p},[s("div",ie,[(i(!0),l(q,null,k(p.voices,v=>(i(),U(ne,{class:"m-2",key:v,interval:v},null,8,["interval"]))),128))])]))),128))]),s("div",le,[L((i(),l("div",{class:"flex flex-wrap p-4 mx-2 flex-1 min-w-10em items-center rounded-xl text-white p-2 cursor-pointer transition-all duration-500 ease-out",style:g({backgroundColor:o(e).color})},[s("div",ce,_(o(e).note),1),s("div",pe,_(o(e).centDiff),1),s("div",de,_(o(e).cents)+" cents",1),s("div",ue,_(o(e).freq.toFixed(2))+" Hz",1)],4)),[[a,t]]),s("div",he,[s("button",{class:"text-button text-3xl",onClick:u[0]||(u[0]=p=>o(e).stopped=!o(e).stopped)},[o(e).stopped?(i(),l("div",me)):(i(),l("div",fe))]),s("div",ve,[w(y,{class:"w-4em",modelValue:o(e).volume,"onUpdate:modelValue":u[1]||(u[1]=p=>o(e).volume=p),min:0,max:1,step:.05,param:"VOL"},null,8,["modelValue"]),w(y,{class:"w-4em",modelValue:o(e).filterFreq,"onUpdate:modelValue":u[2]||(u[2]=p=>o(e).filterFreq=p),min:55,max:12e3,step:.05,fixed:0,param:"LP"},null,8,["modelValue"])])])]),s("div",ge,[(i(!0),l(q,null,k(o(Z),(p,v)=>(i(),l("div",{class:"p-2 m-1 flex-1 cursor-pointer rounded-xl",key:p,style:g({backgroundColor:o(X)(v,3,o(e).pitch==v?1:.2,o(e).pitch==v?1:.4)}),onClick:be=>o(e).pitch=v},_(p),13,ye))),128))])])],4)}}},xe=W("",4),Ee=JSON.parse('{"title":"Drone","description":"Digital shruti box or tanpura tool online","frontmatter":{"title":"Drone","description":"Digital shruti box or tanpura tool online","date":"2022-06-06T00:00:00.000Z","cover":"drone.png"},"headers":[],"relativePath":"practice/pitch/drone/index.md","filePath":"practice/pitch/drone/index.md","lastUpdated":1686812473000}'),we={name:"practice/pitch/drone/index.md"},Ie=Object.assign(we,{setup(r){return(e,t)=>{const m=$("client-only");return i(),l("div",null,[w(m,null,{default:G(()=>[w(_e,{class:"max-w-55ch"})]),_:1}),xe])}}});export{Ee as __pageData,Ie as default};
