import{_ as L}from"./chunks/rotary.536ffc42.js";import{b as N,p as z,f as D}from"./chunks/calculations.65ee336d.js";import{F as P,G as j,X as B,s as w,S as O}from"./chunks/index.cccf7ef0.js";import{b as x,e as E,c as H}from"./chunks/index.25d7e705.js";import{c as U,b as I}from"./chunks/audio.e9cddac8.js";import{l as S}from"./chunks/midi.231bd883.js";import{u as T}from"./chunks/index.92f70141.js";import{a as V}from"./chunks/AutoPanner.25817587.js";import{B as F,i as f,S as R,A as h,K as G,l as M,w as $,o as i,c as l,a as s,q as g,u as o,t as _,F as q,r as k,d as K,g as b,C as J,y as W,b as X}from"./chunks/framework.f429e15e.js";import{F as Y}from"./chunks/Filter.e19ab36f.js";import{n as Z}from"./chunks/colors.f742d7d3.js";import{n as Q}from"./chunks/theory.61e5aadb.js";import"./chunks/index.88f7cbf1.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.b30cd6d2.js";import"./chunks/Scale.f9a07a23.js";import"./chunks/index.654bd828.js";import"./chunks/synth.15b1a9f8.js";import"./chunks/Subtract.e7604129.js";import"./chunks/PingPongDelay.aa4960a4.js";import"./chunks/MonoSynth.3cdcc469.js";import"./chunks/index.37551f4c.js";import"./chunks/index.86652af6.js";const n=F({base:55,freq:T(x("drone-freq",110),27.5,220),started:!1,stopped:!0,filterFreq:x("drone-filter-freq",1e3),volume:x("drone-vol",.5),note:f(()=>P(n.freq).toNote()),pitch:f({get(){return Math.round((N(n.freq)+72)%12)},set(r){n.freq=z(r-36)}}),cents:f(()=>re(n.freq)%1200),centDiff:f(()=>n.cents-n.pitch*100),color:f(()=>D(n.freq))}),c=R({initiated:!1});function A(){const{channel:r}=U("drone");c.channel=r,c.gain=new j(n.volume).connect(r),c.filter=new Y(n.filterFreq).connect(c.gain)}function ee(){return c.initiated||(A(),c.initiated=!0,n.started=!0,E(" ",r=>{r.preventDefault(),n.stopped=!n.stopped}),h(()=>n.volume,r=>{c.gain.gain.targetRampTo(r,1)}),h(()=>n.filterFreq,r=>{c.filter.frequency.targetRampTo(r,.1)})),n}let C=0;function te(r){const e=R({}),t=F({play:!1,active:!1,vol:T(x(`drone-${r}-vol`,.8),0,1),pan:T(x(`drone-${r}-pan`,0),-1,1),freq:f(()=>n.freq*Math.pow(2,r/12)),note:f(()=>P(t.freq).toNote()),color:f(()=>D(t.freq)),lfo:0,panning:0}),m=S({param:`drone-${r}-vol`,number:5+C});h(m,a=>{t.vol=a,a>0&&(t.play=!0)});const d=S({param:`drone-${r}-pan`,number:6+C});h(d,a=>{t.pan=(a-.5)*2}),C+=2,h(()=>n.stopped,a=>{a?t.play=!1:t.active&&(t.play=!0)}),h(()=>t.play,a=>{a?(e.synth||(c.initiated||(A(),c.initiated=!0,n.started=!0),u(),y()),t.active=!0,n.stopped=!1,e.synth.triggerAttack(t.freq)):e.synth&&e.synth.triggerRelease()});function u(){e.meter=new I({normalRange:!0}),e.panner=new B({volume:w(n.volume)}).connect(c.filter),e.lfo=new V(Math.random()*.5+.01,-.25,.25).connect(e.panner.pan).start(),e.lfoVol=new V(Math.random()*.1+.001,-20,0).connect(e.panner.volume).connect(e.meter).start(),e.synth=new O({envelope:{attack:2,sustain:1,release:4},oscillator:{type:"sawtooth32"},volume:w(t.vol)-10}).connect(e.panner)}function y(){h(()=>t.freq,a=>{e.synth.frequency.targetRampTo(a)}),h(()=>t.vol,a=>{e.synth.volume.exponentialRampTo(w(a)-10,1)}),h(()=>t.pan,a=>{e.panner.pan.targetRampTo(a,1)}),H(()=>{t.lfo=e.meter.getValue()})}return G(()=>{e.synth&&e.synth.triggerRelease()}),t}function oe(r,e=n.base){return e*Math.pow(2,r/12)}function re(r,e=0){return Math.floor(1200*Math.log(r/oe(e))/Math.log(2))}const ne={class:"text-2xl z-100"},ae={__name:"voice",props:{interval:{type:Number,default:0}},setup(r){const t=te(r.interval);function m(d){d.tap&&(t.play=!t.play,t.active=t.play),t.vol-=d.delta[1]/400,t.pan+=d.delta[0]/100}return(d,u)=>{const y=M("drag");return $((i(),l("div",{class:"py-16 flex-1 relative cursor-pointer rounded-xl overflow-hidden text-center font-bold border-6 touch-none",style:g({borderColor:o(t).play?o(t).color:"#3333"})},[s("div",{class:"vol -z-5 absolute left-0 right-0 bottom-0 bg-dark-100 bg-opacity-30 border-t-4",style:g({borderColor:o(t).color,height:o(t).vol*100+"%",opacity:o(t).play?1:.2})},null,4),s("div",{class:"vol -z-5 absolute left-0 right-0 bottom-0 bg-dark-900 bg-opacity-20 border-t-1",style:g({height:o(t).vol*100*o(t).lfo+"%",opacity:o(t).play?1:.2,backgroundColor:o(t).color})},null,4),s("div",{class:"pan -z-5 absolute left-0 top-0 bottom-0 border-r-2",style:g({width:o(t).pan*50+50+"%",opacity:o(t).play?1:.2})},null,4),s("div",ne,_(o(t).note),1)],4)),[[y,m]])}}},se={class:"drone w-full flex-1 justify-center flex flex-col p-2"},ie={class:"intervals my-2"},le={class:"flex flex-wrap"},ce={class:"info my-4 flex flex-wrap justify-stretch items-center touch-none"},pe={class:"p-1 text-4xl font-bold"},de={class:"p-1"},ue={class:"p-1"},he={class:"p-1 text-xl"},fe={class:"controls min-w-10em flex-1 my-2 p-2 flex flex-wrap items-center justify-center is-group gap-2"},me={key:0,class:"i-la-stop"},ve={key:1,class:"i-la-play"},ge={class:"is-group flex p-2 gap-2"},ye={class:"notes w-full text-sm font-bold text-center flex flex-wrap"},_e=["onClick"],xe={__name:"drone-app",setup(r){const e=ee();function t(d){e.freq+=d.delta[0]/10}const m=F({fifths:{title:"5P",voices:[7,19,31]},octave:{title:"8P",voices:[-12,0,12]}});return(d,u)=>{const y=L,a=M("drag");return i(),l("div",{class:"flex flex-col items-stretch w-full transition-all duration-500 ease-out select-none rounded-3xl shadow-xl border-8",style:g({borderColor:o(e).color})},[s("div",se,[s("div",ie,[(i(!0),l(q,null,k(m,p=>(i(),l("div",{class:"interval flex flex-col m-1",key:p},[s("div",le,[(i(!0),l(q,null,k(p.voices,v=>(i(),K(ae,{class:"m-2",key:v,interval:v},null,8,["interval"]))),128))])]))),128))]),s("div",ce,[$((i(),l("div",{class:"flex flex-wrap p-4 mx-2 flex-1 min-w-10em items-center rounded-xl text-white p-2 cursor-pointer transition-all duration-500 ease-out",style:g({backgroundColor:o(e).color})},[s("div",pe,_(o(e).note),1),s("div",de,_(o(e).centDiff),1),s("div",ue,_(o(e).cents)+" cents",1),s("div",he,_(o(e).freq.toFixed(2))+" Hz",1)],4)),[[a,t]]),s("div",fe,[s("button",{class:"text-button text-3xl",onClick:u[0]||(u[0]=p=>o(e).stopped=!o(e).stopped)},[o(e).stopped?(i(),l("div",ve)):(i(),l("div",me))]),s("div",ge,[b(y,{class:"w-4em",modelValue:o(e).volume,"onUpdate:modelValue":u[1]||(u[1]=p=>o(e).volume=p),min:0,max:1,step:.05,param:"VOL"},null,8,["modelValue"]),b(y,{class:"w-4em",modelValue:o(e).filterFreq,"onUpdate:modelValue":u[2]||(u[2]=p=>o(e).filterFreq=p),min:55,max:12e3,step:.05,fixed:0,param:"LP"},null,8,["modelValue"])])])]),s("div",ye,[(i(!0),l(q,null,k(o(Q),(p,v)=>(i(),l("div",{class:"p-2 m-1 flex-1 cursor-pointer rounded-xl",key:p,style:g({backgroundColor:o(Z)(v,3,o(e).pitch==v?1:.2,o(e).pitch==v?1:.4)}),onClick:qe=>o(e).pitch=v},_(p),13,_e))),128))])])],4)}}},be=X("",4),Ke=JSON.parse('{"title":"Drone","description":"Digital shruti box or tanpura tool online","frontmatter":{"title":"Drone","description":"Digital shruti box or tanpura tool online","date":"2022-06-06T00:00:00.000Z","cover":"drone.png"},"headers":[],"relativePath":"practice/pitch/drone/index.md","filePath":"practice/pitch/drone/index.md","lastUpdated":1686812473000}'),we={name:"practice/pitch/drone/index.md"},Je=Object.assign(we,{setup(r){return(e,t)=>{const m=J("client-only");return i(),l("div",null,[b(m,null,{default:W(()=>[b(xe,{class:"max-w-55ch"})]),_:1}),be])}}});export{Ke as __pageData,Je as default};
