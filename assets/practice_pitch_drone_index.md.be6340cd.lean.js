import{_ as A}from"./chunks/rotary.9599638f.js";import{b as L,p as N,f as S}from"./chunks/calculations.65ee336d.js";import{F as P,G as j,R as B,l as w,S as O}from"./chunks/index.d229a0c3.js";import{b as x,j as H,i as E}from"./chunks/index.9f2d097c.js";import{c as I,b as U}from"./chunks/audio.9297ee4b.js";import{l as V}from"./chunks/midi.bee45e8c.js";import{u as T}from"./chunks/index.0eeb4803.js";import{a as D}from"./chunks/AutoPanner.82eeffdb.js";import{A as F,i as f,H as R,z as h,V as G,l as M,w as $,o as i,c as l,a as s,m as g,u as o,t as y,F as q,r as k,e as J,f as b,B as K,x as W,b as Y}from"./chunks/framework.aa37bc02.js";import{F as Z}from"./chunks/Filter.a766b417.js";import{n as Q}from"./chunks/colors.3defabfa.js";import{n as X}from"./chunks/theory.61e5aadb.js";import"./chunks/commonjsHelpers.042e6b4d.js";import"./chunks/index.b30cd6d2.js";import"./chunks/Scale.79ce1516.js";import"./chunks/index.b9b8bd08.js";import"./chunks/synth.b88d93ff.js";import"./chunks/Subtract.07d62855.js";import"./chunks/PingPongDelay.2fa9d1e0.js";import"./chunks/MonoSynth.d287d31a.js";import"./chunks/index.86652af6.js";const r=F({base:55,freq:T(x("drone-freq",110),27.5,220),started:!1,stopped:!0,filterFreq:x("drone-filter-freq",1e3),volume:x("drone-vol",.5),note:f(()=>P(r.freq).toNote()),pitch:f({get(){return Math.round((L(r.freq)+72)%12)},set(n){r.freq=N(n-36)}}),cents:f(()=>ne(r.freq)%1200),centDiff:f(()=>r.cents-r.pitch*100),color:f(()=>S(r.freq))}),c=R({initiated:!1});function z(){const{channel:n}=I("drone");c.channel=n,c.gain=new j(r.volume).connect(n),c.filter=new Z(r.filterFreq).connect(c.gain)}function ee(){return c.initiated||(z(),c.initiated=!0,r.started=!0,H(" ",n=>{n.preventDefault(),r.stopped=!r.stopped}),h(()=>r.volume,n=>{c.gain.gain.targetRampTo(n,1)}),h(()=>r.filterFreq,n=>{c.filter.frequency.targetRampTo(n,.1)})),r}let C=0;function te(n){const e=R({}),t=F({play:!1,active:!1,vol:T(x(`drone-${n}-vol`,.8),0,1),pan:T(x(`drone-${n}-pan`,0),-1,1),freq:f(()=>r.freq*Math.pow(2,n/12)),note:f(()=>P(t.freq).toNote()),color:f(()=>S(t.freq)),lfo:0,panning:0}),m=V({param:`drone-${n}-vol`,number:5+C});h(m,a=>{t.vol=a,a>0&&(t.play=!0)});const d=V({param:`drone-${n}-pan`,number:6+C});h(d,a=>{t.pan=(a-.5)*2}),C+=2,h(()=>r.stopped,a=>{a?t.play=!1:t.active&&(t.play=!0)}),h(()=>t.play,a=>{a?(e.synth||(c.initiated||(z(),c.initiated=!0,r.started=!0),u(),_()),t.active=!0,r.stopped=!1,e.synth.triggerAttack(t.freq)):e.synth&&e.synth.triggerRelease()});function u(){e.meter=new U({normalRange:!0}),e.panner=new B({volume:w(r.volume)}).connect(c.filter),e.lfo=new D(Math.random()*.5+.01,-.25,.25).connect(e.panner.pan).start(),e.lfoVol=new D(Math.random()*.1+.001,-20,0).connect(e.panner.volume).connect(e.meter).start(),e.synth=new O({envelope:{attack:2,sustain:1,release:4},oscillator:{type:"sawtooth32"},volume:w(t.vol)-10}).connect(e.panner)}function _(){h(()=>t.freq,a=>{e.synth.frequency.targetRampTo(a)}),h(()=>t.vol,a=>{e.synth.volume.exponentialRampTo(w(a)-10,1)}),h(()=>t.pan,a=>{e.panner.pan.targetRampTo(a,1)}),E(()=>{t.lfo=e.meter.getValue()})}return G(()=>{e.synth&&e.synth.triggerRelease()}),t}function oe(n,e=r.base){return e*Math.pow(2,n/12)}function ne(n,e=0){return Math.floor(1200*Math.log(n/oe(e))/Math.log(2))}const re={class:"text-2xl z-100"},ae={__name:"voice",props:{interval:{type:Number,default:0}},setup(n){const t=te(n.interval);function m(d){d.tap&&(t.play=!t.play,t.active=t.play),t.vol-=d.delta[1]/400,t.pan+=d.delta[0]/100}return(d,u)=>{const _=M("drag");return $((i(),l("div",{class:"py-16 flex-1 relative cursor-pointer rounded-xl overflow-hidden text-center font-bold border-6 touch-none",style:g({borderColor:o(t).play?o(t).color:"#3333"})},[s("div",{class:"vol -z-5 absolute left-0 right-0 bottom-0 bg-dark-100 bg-opacity-30 border-t-4",style:g({borderColor:o(t).color,height:o(t).vol*100+"%",opacity:o(t).play?1:.2})},null,4),s("div",{class:"vol -z-5 absolute left-0 right-0 bottom-0 bg-dark-900 bg-opacity-20 border-t-1",style:g({height:o(t).vol*100*o(t).lfo+"%",opacity:o(t).play?1:.2,backgroundColor:o(t).color})},null,4),s("div",{class:"pan -z-5 absolute left-0 top-0 bottom-0 border-r-2",style:g({width:o(t).pan*50+50+"%",opacity:o(t).play?1:.2})},null,4),s("div",re,y(o(t).note),1)],4)),[[_,m]])}}},se={class:"drone w-full flex-1 justify-center flex flex-col p-2"},ie={class:"intervals my-2"},le={class:"flex flex-wrap"},ce={class:"info my-4 flex flex-wrap justify-stretch items-center touch-none"},pe={class:"p-1 text-4xl font-bold"},de={class:"p-1"},ue={class:"p-1"},he={class:"p-1 text-xl"},fe={class:"controls min-w-10em flex-1 my-2 p-2 flex flex-wrap items-center justify-center is-group gap-2"},me={key:0,class:"i-la-stop"},ve={key:1,class:"i-la-play"},ge={class:"is-group flex p-2 gap-2"},_e={class:"notes w-full text-sm font-bold text-center flex flex-wrap"},ye=["onClick"],xe={__name:"drone-app",setup(n){const e=ee();function t(d){e.freq+=d.delta[0]/10}const m=F({fifths:{title:"5P",voices:[7,19,31]},octave:{title:"8P",voices:[-12,0,12]}});return(d,u)=>{const _=A,a=M("drag");return i(),l("div",{class:"flex flex-col items-stretch w-full transition-all duration-500 ease-out select-none rounded-3xl shadow-xl border-8",style:g({borderColor:o(e).color})},[s("div",se,[s("div",ie,[(i(!0),l(q,null,k(m,p=>(i(),l("div",{class:"interval flex flex-col m-1",key:p},[s("div",le,[(i(!0),l(q,null,k(p.voices,v=>(i(),J(ae,{class:"m-2",key:v,interval:v},null,8,["interval"]))),128))])]))),128))]),s("div",ce,[$((i(),l("div",{class:"flex flex-wrap p-4 mx-2 flex-1 min-w-10em items-center rounded-xl text-white p-2 cursor-pointer transition-all duration-500 ease-out",style:g({backgroundColor:o(e).color})},[s("div",pe,y(o(e).note),1),s("div",de,y(o(e).centDiff),1),s("div",ue,y(o(e).cents)+" cents",1),s("div",he,y(o(e).freq.toFixed(2))+" Hz",1)],4)),[[a,t]]),s("div",fe,[s("button",{class:"text-button text-3xl",onClick:u[0]||(u[0]=p=>o(e).stopped=!o(e).stopped)},[o(e).stopped?(i(),l("div",ve)):(i(),l("div",me))]),s("div",ge,[b(_,{class:"w-4em",modelValue:o(e).volume,"onUpdate:modelValue":u[1]||(u[1]=p=>o(e).volume=p),min:0,max:1,step:.05,param:"VOL"},null,8,["modelValue"]),b(_,{class:"w-4em",modelValue:o(e).filterFreq,"onUpdate:modelValue":u[2]||(u[2]=p=>o(e).filterFreq=p),min:55,max:12e3,step:.05,fixed:0,param:"LP"},null,8,["modelValue"])])])]),s("div",_e,[(i(!0),l(q,null,k(o(X),(p,v)=>(i(),l("div",{class:"p-2 m-1 flex-1 cursor-pointer rounded-xl",key:p,style:g({backgroundColor:o(Q)(v,3,o(e).pitch==v?1:.2,o(e).pitch==v?1:.4)}),onClick:qe=>o(e).pitch=v},y(p),13,ye))),128))])])],4)}}},be=Y("",4),Ue=JSON.parse('{"title":"Drone","description":"Digital shruti box or tanpura tool online","frontmatter":{"title":"Drone","description":"Digital shruti box or tanpura tool online","date":"2022-06-06T00:00:00.000Z","cover":"drone.png"},"headers":[],"relativePath":"practice/pitch/drone/index.md","filePath":"practice/pitch/drone/index.md"}'),we={name:"practice/pitch/drone/index.md"},Ge=Object.assign(we,{setup(n){return(e,t)=>{const m=K("client-only");return i(),l("div",null,[b(m,null,{default:W(()=>[b(xe,{class:"max-w-55ch"})]),_:1}),be])}}});export{Ue as __pageData,Ge as default};
