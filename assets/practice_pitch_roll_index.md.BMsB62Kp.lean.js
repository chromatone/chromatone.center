import{_ as $}from"./chunks/ControlStart.BHSG1dA3.js";import{I as C,H as B,w as D}from"./chunks/theme.DaHGH2Mp.js";import{_ as k,b as I,u as A,M as b,r as V,o as R,d as E,Y as M,e as c,f as h,g as s,k as a,A as z,B as S,a2 as F,p as P,l as r,j as H,m as W,y as Y,z as j,a0 as w,as as q,a5 as J}from"./chunks/framework.De1wmbud.js";const N=d=>(Y("data-v-fcb805a4"),d=d(),j(),d),K={class:"flex flex-col mb-8"},O={class:"fullscreen-container cursor-pointer",id:"screen"},U={class:"p-1 absolute top-2 left-2 flex items-center"},Z=N(()=>s("div",{class:"i-la-angle-double-right"},null,-1)),G={key:0,class:"flex p-8 items-center"},L={class:"p-1 w-2em"},Q={class:"p-1 w-1em"},X={class:"p-1 mt-2 w-6em text-sm"},ee={key:0,class:"i-la-play"},te={key:1,class:"i-la-pause"},oe=N(()=>s("div",{class:"i-la-times"},null,-1)),ne=[oe],le={class:"flex-1 text-center font-bold"},se={__name:"PitchRoll",setup(d){const e=I({running:!0,speed:C(A("pitch-roll-speed",4),4,20),runnerWidth:2,runnerAhead:4,maxPlotFrequency:880,maxPlotNote:97,minPlotNote:24,prevBeat:0,step:0});b(" ",i=>{i.preventDefault(),e.running=!e.running}),b("Enter",()=>{_()});function m(i){i.tap&&(e.running=!e.running),e.speed=e.speed+i.delta[0]/5}const g=[0,1,2,3,4,5,6,7,8],{init:v,tuner:o}=B(),n=V();let t;R(()=>{t=n.value.getContext("2d")}),E(()=>o==null?void 0:o.frame,i=>{if(!e.running)return;let l=i*e.speed%n.value.width;if(t.globalAlpha=1,t.clearRect(l,0,e.speed,n.value.height),t.beginPath(),t.fillStyle=o.note.color,t.fillRect(l+e.speed,0,e.runnerWidth,n.value.height),!o.note.silent){const p=n.value.height-(o.note.value-e.minPlotNote)/(e.maxPlotNote-e.minPlotNote)*n.value.height;t.arc(l-8,p,8,0,4*Math.PI),t.fillStyle=D(o.note.color).lighten(.3).toHex(),t.fill()}if(i%50==0){t.beginPath(),t.strokeStyle="hsla(90,50%,50%,0.1)",t.lineWidth="1";for(let p of g){let u=n.value.height-(p*12-e.minPlotNote)/(e.maxPlotNote-e.minPlotNote)*n.value.height;t.moveTo(0,u),t.lineTo(n.value.width,u)}t.stroke()}t.globalAlpha=.25,o.beat>e.prevBeat&&(e.prevBeat=o.beat,t.fillStyle=o.note.color,t.fillRect(l-5,0,1,n.value.height))});function T(){v(),e.running=!0}function _(){t.clearRect(0,0,n.value.width,n.value.height)}return(i,l)=>{var x,y;const p=$,u=M("drag");return c(),h("div",K,[s("div",O,[a(o).running?P("",!0):(c(),z(p,{key:0,class:"absolute",onClick:l[0]||(l[0]=f=>T())},{default:S(()=>[F("Start rolling ")]),_:1})),s("div",U,[Z,s("span",null,r(e.speed.toFixed(1)),1)]),H(s("canvas",{class:"w-full h-full",ref_key:"roll",ref:n,width:1920,height:1080,onDblclick:l[1]||(l[1]=f=>_())},null,544),[[u,m]])]),a(o).note?(c(),h("div",G,[s("div",{class:"flex-1 text-center font-bold text-4xl transition-all duration-200 flex items-center",style:W({color:a(o).note.color})},[s("div",L,r((x=a(o).note)==null?void 0:x.name),1),s("div",Q,r((y=a(o).note)==null?void 0:y.octave),1),s("div",X,r(a(o).note.cents>0?"+":"")+r(a(o).note.cents)+" cents",1)],4),s("div",{class:"btn",onClick:l[2]||(l[2]=f=>e.running=!e.running)},[e.running?(c(),h("div",te)):(c(),h("div",ee))]),s("div",{class:"btn",onClick:l[3]||(l[3]=f=>_())},ne),s("div",le,r(a(o).bpm.toFixed(1))+" BPM",1)])):P("",!0)])}}},ie=k(se,[["__scopeId","data-v-fcb805a4"]]),ue=JSON.parse('{"title":"Pitch roll","description":"Plot main pitch of any incoming audio on an endless roll","frontmatter":{"title":"Pitch roll","description":"Plot main pitch of any incoming audio on an endless roll","layout":"app","cover":"roll.png","date":"2022-06-12T00:00:00.000Z"},"headers":[],"relativePath":"practice/pitch/roll/index.md","filePath":"practice/pitch/roll/index.md","lastUpdated":1720167572000}'),ae={name:"practice/pitch/roll/index.md"},re=q("",2);function ce(d,e,m,g,v,o){const n=ie,t=J("client-only");return c(),h("div",null,[w(t,null,{default:S(()=>[w(n)]),_:1}),re])}const _e=k(ae,[["render",ce]]);export{ue as __pageData,_e as default};
