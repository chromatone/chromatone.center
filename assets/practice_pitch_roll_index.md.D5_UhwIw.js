import{_ as $}from"./chunks/ControlStart.TT8SFLzz.js";import{L as C,K as D,w as I}from"./chunks/theme.QZOV0H0D.js";import{D as k,b as B,u as V,q as b,r as A,o as R,d as E,M as F,E as c,F as h,G as s,C as a,a2 as M,X as S,$ as K,T as P,I as r,N as W,L as q,J as z,K as H,O as w,ar as J,a4 as L}from"./chunks/framework.zJCL7WGr.js";const N=d=>(z("data-v-41401c80"),d=d(),H(),d),O={class:"flex flex-col mb-8"},G={class:"fullscreen-container rounded-3xl cursor-pointer",id:"screen"},U={class:"p-1 absolute top-2 left-2 flex items-center"},X=N(()=>s("div",{class:"i-la-angle-double-right"},null,-1)),Y={key:0,class:"flex p-8 items-center"},Z={class:"p-1 w-2em"},j={class:"p-1 w-1em"},Q={class:"p-1 mt-2 w-6em text-sm"},ee={key:0,class:"i-la-play"},te={key:1,class:"i-la-pause"},oe=N(()=>s("div",{class:"i-la-times"},null,-1)),ne=[oe],le={class:"flex-1 text-center font-bold"},se={__name:"PitchRoll",setup(d){const e=B({running:!0,speed:C(V("pitch-roll-speed",4),4,20),runnerWidth:2,runnerAhead:4,maxPlotFrequency:880,maxPlotNote:97,minPlotNote:24,prevBeat:0,step:0});b(" ",i=>{i.preventDefault(),e.running=!e.running}),b("Enter",()=>{_()});function m(i){i.tap&&(e.running=!e.running),e.speed=e.speed+i.delta[0]/5}const g=[0,1,2,3,4,5,6,7,8],{init:v,tuner:o}=D(),n=A();let t;R(()=>{t=n.value.getContext("2d")}),E(()=>o==null?void 0:o.frame,i=>{if(!e.running)return;let l=i*e.speed%n.value.width;if(t.globalAlpha=1,t.clearRect(l,0,e.speed,n.value.height),t.beginPath(),t.fillStyle=o.note.color,t.fillRect(l+e.speed,0,e.runnerWidth,n.value.height),!o.note.silent){const p=n.value.height-(o.note.value-e.minPlotNote)/(e.maxPlotNote-e.minPlotNote)*n.value.height;t.arc(l-8,p,8,0,4*Math.PI),t.fillStyle=I(o.note.color).lighten(.3).toHex(),t.fill()}if(i%50==0){t.beginPath(),t.strokeStyle="hsla(90,50%,50%,0.1)",t.lineWidth="1";for(let p of g){let u=n.value.height-(p*12-e.minPlotNote)/(e.maxPlotNote-e.minPlotNote)*n.value.height;t.moveTo(0,u),t.lineTo(n.value.width,u)}t.stroke()}t.globalAlpha=.25,o.beat>e.prevBeat&&(e.prevBeat=o.beat,t.fillStyle=o.note.color,t.fillRect(l-5,0,1,n.value.height))});function T(){v(),e.running=!0}function _(){t.clearRect(0,0,n.value.width,n.value.height)}return(i,l)=>{var x,y;const p=$,u=F("drag");return c(),h("div",O,[s("div",G,[a(o).running?P("",!0):(c(),M(p,{key:0,class:"absolute",onClick:l[0]||(l[0]=f=>T())},{default:S(()=>[K("Start rolling ")]),_:1})),s("div",U,[X,s("span",null,r(e.speed.toFixed(1)),1)]),W(s("canvas",{class:"w-full h-full rounded-3xl",ref_key:"roll",ref:n,width:1920,height:1080,onDblclick:l[1]||(l[1]=f=>_())},null,544),[[u,m]])]),a(o).note?(c(),h("div",Y,[s("div",{class:"flex-1 text-center font-bold text-4xl transition-all duration-200 flex items-center",style:q({color:a(o).note.color})},[s("div",Z,r((x=a(o).note)==null?void 0:x.name),1),s("div",j,r((y=a(o).note)==null?void 0:y.octave),1),s("div",Q,r(a(o).note.cents>0?"+":"")+r(a(o).note.cents)+" cents",1)],4),s("div",{class:"btn",onClick:l[2]||(l[2]=f=>e.running=!e.running)},[e.running?(c(),h("div",te)):(c(),h("div",ee))]),s("div",{class:"btn",onClick:l[3]||(l[3]=f=>_())},ne),s("div",le,r(a(o).bpm.toFixed(1))+" BPM",1)])):P("",!0)])}}},ie=k(se,[["__scopeId","data-v-41401c80"]]),ue=JSON.parse('{"title":"Pitch roll","description":"Plot main pitch of any incoming audio on an endless roll","frontmatter":{"title":"Pitch roll","description":"Plot main pitch of any incoming audio on an endless roll","layout":"app","cover":"roll.png","date":"2022-06-12T00:00:00.000Z"},"headers":[],"relativePath":"practice/pitch/roll/index.md","filePath":"practice/pitch/roll/index.md","lastUpdated":1710414108000}'),ae={name:"practice/pitch/roll/index.md"},re=J('<p>This app listens to the incoming audio and analyzes it for the base pitch and tempo. The note with the cents difference is show at the top left. Tempo is shown at the top right. The pitch is plotted on the vertical axis with colored circles while beats are drawn as vertical lines.</p><ol><li>Press <i class="p-3 mr-1 i-la-play"></i> to start plotting the audio parameters. Press <i class="p-3 mr-1 i-la-pause"></i> to pause the process. You can also do this by clicking the graph itself or by pressing the <strong>Spacebar</strong> key on your keyboard.</li><li>Press <i class="p-3 mr-1 i-la-times"></i> to clear the graph. Double clicking the graph and pressing the <strong>Enter</strong> key will have the same effect</li><li>Drag across the graph plain left or right to increase or decrease the speed of the plot head.</li><li>If you see the <i class="p-3 mr-1 i-la-expand"></i> button at the bottom right, you browser is capable of stretching the graph to the full screen. Have fun!</li></ol>',2);function ce(d,e,m,g,v,o){const n=ie,t=L("client-only");return c(),h("div",null,[w(t,null,{default:S(()=>[w(n)]),_:1}),re])}const _e=k(ae,[["render",ce]]);export{ue as __pageData,_e as default};
