import{aG as jt,R as Kt,aH as Qt,aI as Jt,aA as Zt,_ as ei}from"./chunks/theme.GEXdnO73.js";import{_ as ti}from"./chunks/ControlStart.9tIfuge-.js";import{r as lt,q as Rt,b as ii,c as si,u as ht,o as ai,M as ni,E as Oe,F as Ge,G as de,N as ri,a2 as oi,T as li,I as hi,O as Ze,D as ci,X as di,ar as fi,a4 as _i}from"./chunks/framework.BbXr-hJc.js";/**!
 * audioMotion-analyzer
 * High-resolution real-time graphic audio spectrum analyzer JS module
 *
 * @version 4.5.0
 * @author  Henrique Avila Vianna <hvianna@gmail.com> <https://henriquevianna.com>
 * @license AGPL-3.0-or-later
 */const ui="4.5.0",pt=Math.PI,Ne=2*pt,ct=pt/2,Lt=8.17579892,bt="dual-combined",je="dual-horizontal",Le="single",ye="dual-vertical",xt="bar-index",St="bar-level",Je="gradient",Et=60,At="click",pi="fullscreenchange",Ht="resize",gi="#111",Pt="",Ct="A",Tt="B",Bt="C",kt="D",It="468",Ke="sans-serif",mi="#0f0",wi="#7f7f7f22",Me=10,Ot="create",Dt="fschange",vi="lores",yi=Ht,dt="user",Ri="#000c",Ft="#fff",Li="#4f4",Nt="#888",bi="#555",ft="bark",We="linear",qe="log",_t="mel",Mt=["#a35","#c66","#e94","#ed0","#9d5","#4d8","#2cb","#0bc","#09c","#36b"],zt=[["classic",{colorStops:["red",{color:"yellow",level:.85,pos:.6},{color:"lime",level:.475}]}],["prism",{colorStops:Mt}],["rainbow",{dir:"h",colorStops:["#817",...Mt,"#639"]}],["orangered",{bgColor:"#3e2f29",colorStops:["OrangeRed"]}],["steelblue",{bgColor:"#222c35",colorStops:["SteelBlue"]}]],Ve={alphaBars:!1,ansiBands:!1,barSpace:.1,bgAlpha:.7,channelLayout:Le,colorMode:Je,fadePeaks:!1,fftSize:8192,fillAlpha:1,frequencyScale:qe,gradient:zt[0][0],gravity:3.8,height:void 0,ledBars:!1,linearAmplitude:!1,linearBoost:1,lineWidth:0,loRes:!1,lumiBars:!1,maxDecibels:-25,maxFPS:0,maxFreq:22e3,minDecibels:-85,minFreq:20,mirror:0,mode:0,noteLabels:!1,outlineBars:!1,overlay:!1,peakFadeTime:750,peakHoldTime:500,peakLine:!1,radial:!1,radialInvert:!1,radius:.3,reflexAlpha:.15,reflexBright:1,reflexFit:!0,reflexRatio:0,roundBars:!1,showBgColor:!0,showFPS:!1,showPeaks:!0,showScaleX:!0,showScaleY:!1,smoothing:.5,spinSpeed:0,splitGradient:!1,start:!0,trueLeds:!1,useCanvas:!0,volume:1,weightingFilter:Pt,width:void 0},xi=["ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?"],Si=["ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid"],Ei=["ERR_UNKNOWN_GRADIENT","Unknown gradient"],ut=["ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1"],Ai=["ERR_INVALID_MODE","Invalid mode"],Ci=["ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1"],Ti=["ERR_INVALID_AUDIO_SOURCE","Audio source must be an instance of HTMLMediaElement or AudioNode"],Bi=["ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string"],ki=["ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object"],Ii=["ERR_GRADIENT_MISSING_COLOR","Gradient colorStops must be a non-empty array"];class ce extends Error{constructor(e,i){const[s,l]=e;super(l+(i!==void 0?`: ${i}`:"")),this.name="AudioMotionError",this.code=s}}const Gt=(ae,e)=>console.warn(`${ae} is deprecated. Use ${e} instead.`),qt=ae=>{for(const e in ae)return!1;return!0},Qe=(ae,e,i="toLowerCase")=>e[Math.max(0,e.indexOf((""+ae)[i]()))],Oi=(ae,e,i,s,l)=>e+(s-e)*(l-ae)/(i-ae);Array.prototype.findLastIndex||(Array.prototype.findLastIndex=function(ae){let e=this.length;for(;e-- >0;)if(ae(this[e]))return e;return-1});class Di{constructor(e,i={}){this._ready=!1,this._aux={},this._canvasGradients=[],this._destroyed=!1,this._energy={val:0,peak:0,hold:0},this._flg={},this._fps=0,this._gradients={},this._last=0,this._outNodes=[],this._ownContext=!1,this._selectedGrads=[],this._sources=[],e instanceof Element||(qt(i)&&!qt(e)&&(i=e),e=null),this._ownCanvas=!(i.canvas instanceof HTMLCanvasElement);const s=this._ownCanvas?document.createElement("canvas"):i.canvas;s.style="max-width: 100%;",this._ctx=s.getContext("2d");for(const[a,C]of zt)this.registerGradient(a,C);this._container=e||!this._ownCanvas&&s.parentElement||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270;let l;if(!(i.source&&(l=i.source.context))){if(!(l=i.audioCtx))try{l=new(window.AudioContext||window.webkitAudioContext),this._ownContext=!0}catch{throw new ce(xi)}}if(!l.createGain)throw new ce(Si);const h=this._analyzer=[l.createAnalyser(),l.createAnalyser()],o=this._splitter=l.createChannelSplitter(2),n=this._merger=l.createChannelMerger(2);this._input=l.createGain(),this._output=l.createGain(),i.source&&this.connectInput(i.source);for(const a of[0,1])o.connect(h[a],a);n.connect(this._output),i.connectSpeakers!==!1&&this.connectOutput();for(const a of["_scaleX","_scaleR"])this[a]=document.createElement("canvas").getContext("2d");this._fsEl=i.fsElement||s;const d=()=>{this._fsTimeout||(this._fsTimeout=window.setTimeout(()=>{this._fsChanging||(this._setCanvas(yi),this._fsTimeout=0)},Et))};window.ResizeObserver&&(this._observer=new ResizeObserver(d),this._observer.observe(this._container)),this._controller=new AbortController;const R=this._controller.signal;window.addEventListener(Ht,d,{signal:R}),s.addEventListener(pi,()=>{this._fsChanging=!0,this._fsTimeout&&window.clearTimeout(this._fsTimeout),this._setCanvas(Dt),this._fsTimeout=window.setTimeout(()=>{this._fsChanging=!1,this._fsTimeout=0},Et)},{signal:R});const g=()=>{l.state=="suspended"&&l.resume(),window.removeEventListener(At,g)};window.addEventListener(At,g),document.addEventListener("visibilitychange",()=>{document.visibilityState!="hidden"&&(this._frames=0,this._time=performance.now())},{signal:R}),this._setProps(i,!0),this.useCanvas&&this._ownCanvas&&this._container.appendChild(s),this._ready=!0,this._setCanvas(Ot)}get alphaBars(){return this._alphaBars}set alphaBars(e){this._alphaBars=!!e,this._calcBars()}get ansiBands(){return this._ansiBands}set ansiBands(e){this._ansiBands=!!e,this._calcBars()}get barSpace(){return this._barSpace}set barSpace(e){this._barSpace=+e||0,this._calcBars()}get channelLayout(){return this._chLayout}set channelLayout(e){this._chLayout=Qe(e,[Le,je,ye,bt]),this._input.disconnect(),this._input.connect(this._chLayout!=Le?this._splitter:this._analyzer[0]),this._analyzer[0].disconnect(),this._outNodes.length&&this._analyzer[0].connect(this._chLayout!=Le?this._merger:this._output),this._calcBars(),this._makeGrad()}get colorMode(){return this._colorMode}set colorMode(e){this._colorMode=Qe(e,[Je,xt,St])}get fadePeaks(){return this._fadePeaks}set fadePeaks(e){this._fadePeaks=!!e}get fftSize(){return this._analyzer[0].fftSize}set fftSize(e){for(const s of[0,1])this._analyzer[s].fftSize=e;const i=this._analyzer[0].frequencyBinCount;this._fftData=[new Float32Array(i),new Float32Array(i)],this._calcBars()}get frequencyScale(){return this._frequencyScale}set frequencyScale(e){this._frequencyScale=Qe(e,[qe,ft,_t,We]),this._calcBars()}get gradient(){return this._selectedGrads[0]}set gradient(e){this._setGradient(e)}get gradientLeft(){return this._selectedGrads[0]}set gradientLeft(e){this._setGradient(e,0)}get gradientRight(){return this._selectedGrads[1]}set gradientRight(e){this._setGradient(e,1)}get gravity(){return this._gravity}set gravity(e){this._gravity=e>0?+e:this._gravity||Ve.gravity}get height(){return this._height}set height(e){this._height=e,this._setCanvas(dt)}get ledBars(){return this._showLeds}set ledBars(e){this._showLeds=!!e,this._calcBars()}get linearAmplitude(){return this._linearAmplitude}set linearAmplitude(e){this._linearAmplitude=!!e}get linearBoost(){return this._linearBoost}set linearBoost(e){this._linearBoost=e>=1?+e:1}get lineWidth(){return this._lineWidth}set lineWidth(e){this._lineWidth=+e||0}get loRes(){return this._loRes}set loRes(e){this._loRes=!!e,this._setCanvas(vi)}get lumiBars(){return this._lumiBars}set lumiBars(e){this._lumiBars=!!e,this._calcBars(),this._makeGrad()}get maxDecibels(){return this._analyzer[0].maxDecibels}set maxDecibels(e){for(const i of[0,1])this._analyzer[i].maxDecibels=e}get maxFPS(){return this._maxFPS}set maxFPS(e){this._maxFPS=e<0?0:+e||0}get maxFreq(){return this._maxFreq}set maxFreq(e){if(e<1)throw new ce(ut);this._maxFreq=Math.min(e,this.audioCtx.sampleRate/2),this._calcBars()}get minDecibels(){return this._analyzer[0].minDecibels}set minDecibels(e){for(const i of[0,1])this._analyzer[i].minDecibels=e}get minFreq(){return this._minFreq}set minFreq(e){if(e<1)throw new ce(ut);this._minFreq=+e,this._calcBars()}get mirror(){return this._mirror}set mirror(e){this._mirror=Math.sign(e)|0,this._calcBars(),this._makeGrad()}get mode(){return this._mode}set mode(e){const i=e|0;if(i>=0&&i<=10&&i!=9)this._mode=i,this._calcBars(),this._makeGrad();else throw new ce(Ai,e)}get noteLabels(){return this._noteLabels}set noteLabels(e){this._noteLabels=!!e,this._createScales()}get outlineBars(){return this._outlineBars}set outlineBars(e){this._outlineBars=!!e,this._calcBars()}get peakFadeTime(){return this._peakFadeTime}set peakFadeTime(e){this._peakFadeTime=e>=0?+e:this._peakFadeTime||Ve.peakFadeTime}get peakHoldTime(){return this._peakHoldTime}set peakHoldTime(e){this._peakHoldTime=+e||0}get peakLine(){return this._peakLine}set peakLine(e){this._peakLine=!!e}get radial(){return this._radial}set radial(e){this._radial=!!e,this._calcBars(),this._makeGrad()}get radialInvert(){return this._radialInvert}set radialInvert(e){this._radialInvert=!!e,this._calcBars(),this._makeGrad()}get radius(){return this._radius}set radius(e){this._radius=+e||0,this._calcBars(),this._makeGrad()}get reflexRatio(){return this._reflexRatio}set reflexRatio(e){if(e=+e||0,e<0||e>=1)throw new ce(Ci);this._reflexRatio=e,this._calcBars(),this._makeGrad()}get roundBars(){return this._roundBars}set roundBars(e){this._roundBars=!!e,this._calcBars()}get smoothing(){return this._analyzer[0].smoothingTimeConstant}set smoothing(e){for(const i of[0,1])this._analyzer[i].smoothingTimeConstant=e}get spinSpeed(){return this._spinSpeed}set spinSpeed(e){e=+e||0,(this._spinSpeed===void 0||e==0)&&(this._spinAngle=-ct),this._spinSpeed=e}get splitGradient(){return this._splitGradient}set splitGradient(e){this._splitGradient=!!e,this._makeGrad()}get stereo(){return Gt("stereo","channelLayout"),this._chLayout!=Le}set stereo(e){Gt("stereo","channelLayout"),this.channelLayout=e?ye:Le}get trueLeds(){return this._trueLeds}set trueLeds(e){this._trueLeds=!!e}get volume(){return this._output.gain.value}set volume(e){this._output.gain.value=e}get weightingFilter(){return this._weightingFilter}set weightingFilter(e){this._weightingFilter=Qe(e,[Pt,Ct,Tt,Bt,kt,It],"toUpperCase")}get width(){return this._width}set width(e){this._width=e,this._setCanvas(dt)}get audioCtx(){return this._input.context}get canvas(){return this._ctx.canvas}get canvasCtx(){return this._ctx}get connectedSources(){return this._sources}get connectedTo(){return this._outNodes}get fps(){return this._fps}get fsHeight(){return this._fsHeight}get fsWidth(){return this._fsWidth}get isAlphaBars(){return this._flg.isAlpha}get isBandsMode(){return this._flg.isBands}get isDestroyed(){return this._destroyed}get isFullscreen(){return this._fsEl&&(document.fullscreenElement||document.webkitFullscreenElement)===this._fsEl}get isLedBars(){return this._flg.isLeds}get isLumiBars(){return this._flg.isLumi}get isOctaveBands(){return this._flg.isOctaves}get isOn(){return!!this._runId}get isOutlineBars(){return this._flg.isOutline}get pixelRatio(){return this._pixelRatio}get isRoundBars(){return this._flg.isRound}static get version(){return ui}connectInput(e){const i=e instanceof HTMLMediaElement;if(!(i||e.connect))throw new ce(Ti);const s=i?this.audioCtx.createMediaElementSource(e):e;return this._sources.includes(s)||(s.connect(this._input),this._sources.push(s)),s}connectOutput(e=this.audioCtx.destination){if(!this._outNodes.includes(e)&&(this._output.connect(e),this._outNodes.push(e),this._outNodes.length==1))for(const i of[0,1])this._analyzer[i].connect(this._chLayout==Le&&!i?this._output:this._merger,0,i)}destroy(){if(!this._ready)return;const{audioCtx:e,canvas:i,_controller:s,_input:l,_merger:h,_observer:o,_ownCanvas:n,_ownContext:d,_splitter:R}=this;this._destroyed=!0,this._ready=!1,this.stop(),s.abort(),o&&o.disconnect(),this.onCanvasResize=null,this.onCanvasDraw=null,this._fsEl=null,this.disconnectInput(),this.disconnectOutput(),l.disconnect(),R.disconnect(),h.disconnect(),d&&e.close(),n&&i.remove(),this._calcBars()}disconnectInput(e,i){e?Array.isArray(e)||(e=[e]):e=Array.from(this._sources);for(const s of e){const l=this._sources.indexOf(s);if(i&&s.mediaStream)for(const h of s.mediaStream.getAudioTracks())h.stop();l>=0&&(s.disconnect(this._input),this._sources.splice(l,1))}}disconnectOutput(e){if(!(e&&!this._outNodes.includes(e))&&(this._output.disconnect(e),this._outNodes=e?this._outNodes.filter(i=>i!==e):[],this._outNodes.length==0))for(const i of[0,1])this._analyzer[i].disconnect()}getBars(){return Array.from(this._bars,({posX:e,freq:i,freqLo:s,freqHi:l,hold:h,peak:o,value:n})=>({posX:e,freq:i,freqLo:s,freqHi:l,hold:h,peak:o,value:n}))}getEnergy(e,i){if(e===void 0)return this._energy.val;if(e!=+e){if(e=="peak")return this._energy.peak;const n={bass:[20,250],lowMid:[250,500],mid:[500,2e3],highMid:[2e3,4e3],treble:[4e3,16e3]};if(!n[e])return null;[e,i]=n[e]}const s=this._freqToBin(e),l=i?this._freqToBin(i):s,h=this._chLayout==Le?1:2;let o=0;for(let n=0;n<h;n++)for(let d=s;d<=l;d++)o+=this._normalizedB(this._fftData[n][d]);return o/(l-s+1)/h}getOptions(e){Array.isArray(e)||(e=[e]);let i={};for(const s of Object.keys(Ve))e.includes(s)||(s=="gradient"&&this.gradientLeft!=this.gradientRight?(i.gradientLeft=this.gradientLeft,i.gradientRight=this.gradientRight):s!="start"&&(i[s]=this[s]));return i}registerGradient(e,i){if(typeof e!="string"||e.trim().length==0)throw new ce(Bi);if(typeof i!="object")throw new ce(ki);const{colorStops:s}=i;if(!Array.isArray(s)||!s.length)throw new ce(Ii);const l=s.length,h=o=>+o!=o||o<0||o>1;s.forEach((o,n)=>{const d=n/Math.max(1,l-1);typeof o!="object"?s[n]={pos:d,color:o}:h(o.pos)&&(o.pos=d),h(o.level)&&(s[n].level=1-n/l)}),s.sort((o,n)=>o.level<n.level?1:o.level>n.level?-1:0),s[0].level=1,this._gradients[e]={bgColor:i.bgColor||gi,dir:i.dir,colorStops:s},this._selectedGrads.includes(e)&&this._makeGrad()}setCanvasSize(e,i){this._width=e,this._height=i,this._setCanvas(dt)}setFreqRange(e,i){if(e<1||i<1)throw new ce(ut);this._minFreq=Math.min(e,i),this.maxFreq=Math.max(e,i)}setLedParams(e){let i,s,l;e&&(i=e.maxLeds|0,s=+e.spaceV,l=+e.spaceH),this._ledParams=i>0&&s>0&&l>=0?[i,s,l]:void 0,this._calcBars()}setOptions(e){this._setProps(e)}setSensitivity(e,i){for(const s of[0,1])this._analyzer[s].minDecibels=Math.min(e,i),this._analyzer[s].maxDecibels=Math.max(e,i)}start(){this.toggleAnalyzer(!0)}stop(){this.toggleAnalyzer(!1)}toggleAnalyzer(e){const i=this.isOn;return e===void 0&&(e=!i),i&&!e?(cancelAnimationFrame(this._runId),this._runId=0):!i&&e&&!this._destroyed&&(this._frames=0,this._time=performance.now(),this._runId=requestAnimationFrame(s=>this._draw(s))),this.isOn}toggleFullscreen(){if(this.isFullscreen)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this._fsEl;if(!e)return;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}}_binToFreq(e){return e*this.audioCtx.sampleRate/this.fftSize||1}_calcBars(){const e=this._bars=[];if(!this._ready){this._flg={isAlpha:!1,isBands:!1,isLeds:!1,isLumi:!1,isOctaves:!1,isOutline:!1,isRound:!1,noLedGap:!1};return}const{_ansiBands:i,_barSpace:s,canvas:l,_chLayout:h,_maxFreq:o,_minFreq:n,_mirror:d,_mode:R,_radial:g,_radialInvert:a,_reflexRatio:C}=this,F=l.width>>1,Y=l.height>>1,W=h==ye&&!g,m=h==je,c=R%10!=0,E=c&&this._frequencyScale==qe,w=this._showLeds&&c&&!g,N=this._lumiBars&&c&&!g,U=this._alphaBars&&!N&&R!=Me,te=this._outlineBars&&c&&!N&&!w,b=this._roundBars&&c&&!N&&!w,J=h!=ye||C>0&&!N,z=l.height-(W&&!w?.5:0)>>W,K=z*(N||g?1:1-C)|0,t=l.width-F*(m||d!=0),Z=W?l.height-z*2:0,pe=F*(d==-1&&!m&&!g);let le=Math.min(l.width,l.height)*.375*(h==ye?1:this._radius)|0,M=Math.min(F,Y);a&&h!=ye&&([le,M]=[M,le]);const I=T=>e.push({...T,peak:[0,0],hold:[0],alpha:[0],value:[0]}),x=T=>{const O=this._freqToBin(T,"floor"),v=this._binToFreq(O),L=this._binToFreq(O+1),q=Math.log2(T/v)/Math.log2(L/v);return[O,q]};let p,X,k;if(E){const T=(B,P,A)=>+B.toPrecision(A?Math.max(P,1+Math.log10(B)|0):P),O=B=>{const P=[1,1.12,1.25,1.4,1.6,1.8,2,2.24,2.5,2.8,3.15,3.55,4,4.5,5,5.6,6.3,7.1,8,9,10],A=Math.log10(B)|0,ge=B/10**A;let _e=1;for(;_e<P.length&&ge>P[_e];)_e++;return ge-P[_e-1]<P[_e]-ge&&_e--,(P[_e]*10**(A+5)|0)/1e5},v=[0,24,12,8,6,4,3,2,1][R],L=i?10**(3/(v*10)):2**(1/v),q=L**.5;let ie=i?7.94328235/(v%2?1:q):Lt;do{let B=ie;const P=T(B/q,4,!0),A=T(B*q,4,!0),[ge,_e]=x(P),[He,me]=x(A);i?B=v<4?O(B):T(B,B.toString()[0]<5?3:2):B=T(B,4,!0),B>=n&&I({posX:0,freq:B,freqLo:P,freqHi:A,binLo:ge,binHi:He,ratioLo:_e,ratioHi:me}),ie*=L}while(ie<=o);p=t/e.length,e.forEach((B,P)=>B.posX=pe+P*p);const H=e[0],ee=e[e.length-1];X=this._freqScaling(H.freqLo),k=t/(this._freqScaling(ee.freqHi)-X),H.freqLo<n&&(H.freqLo=n,[H.binLo,H.ratioLo]=x(n)),ee.freqHi>o&&(ee.freqHi=o,[ee.binHi,ee.ratioHi]=x(o))}else if(c){const T=[0,24,12,8,6,4,3,2,1][R]*10,O=v=>{switch(this._frequencyScale){case ft:return 1960/(26.81/(v+.53)-1);case _t:return 700*(2**v-1);case We:return v}};p=t/T,X=this._freqScaling(n),k=t/(this._freqScaling(o)-X);for(let v=0,L=0;v<T;v++,L+=p){const q=O(X+L/k),ie=O(X+(L+p/2)/k),H=O(X+(L+p)/k),[ee,B]=x(q),[P,A]=x(H);I({posX:pe+L,freq:ie,freqLo:q,freqHi:H,binLo:ee,binHi:P,ratioLo:B,ratioHi:A})}}else{p=1,X=this._freqScaling(n),k=t/(this._freqScaling(o)-X);const T=this._freqToBin(n,"floor"),O=this._freqToBin(o);let v=-999;for(let L=T;L<=O;L++){const q=this._binToFreq(L),ie=pe+Math.round(k*(this._freqScaling(q)-X));if(ie>v)I({posX:ie,freq:q,freqLo:q,freqHi:q,binLo:L,binHi:L,ratioLo:0,ratioHi:0}),v=ie;else if(e.length){const H=e[e.length-1];H.binHi=L,H.freqHi=q,H.freq=(H.freqLo*q)**.5}}}let ne=0,$=0;if(w){const T=this._pixelRatio/(window.devicePixelRatio>1&&window.screen.height<=540?2:1),O=[[],[128,3,.45],[128,4,.225],[96,6,.225],[80,6,.225],[80,6,.125],[64,6,.125],[48,8,.125],[24,16,.125]],v=this._ledParams,[L,q,ie]=v||O[R];let H,ee=K;if(v){const B=2*T;let P;H=L+1;do H--,P=ee/H/(1+q),$=P*q;while((P<B||$<B)&&H>1)}else{const B=540/q;$=Math.min(q*T,Math.max(2,ee/B+.1|0))}J&&(ee+=$),v||(H=Math.min(L,ee/($*2)|0)),ne=ie>=1?ie:p*ie,this._leds=[H,ne,$,ee/H-$]}const S=Math.min(p-1,s*(s>0&&s<1?p:1));c&&(p-=Math.max(w?ne:0,S)),e.forEach((T,O)=>{let v=T.posX,L=p;c&&(s==0&&!w?(v|=0,L|=0,O>0&&v>e[O-1].posX+e[O-1].width&&(v--,L++)):v+=Math.max(w?ne:0,S)/2,T.posX=v),T.barCenter=v+(p==1?0:L/2),T.width=L});const fe=[];for(const T of[0,1]){const O=h==ye?(z+Z)*T:0,v=O+z,L=O+K-(!w||J?0:$);fe.push({channelTop:O,channelBottom:v,analyzerBottom:L})}this._aux={analyzerHeight:K,analyzerWidth:t,centerX:F,centerY:Y,channelCoords:fe,channelHeight:z,channelGap:Z,initialX:pe,innerRadius:le,outerRadius:M,scaleMin:X,unitWidth:k},this._flg={isAlpha:U,isBands:c,isLeds:w,isLumi:N,isOctaves:E,isOutline:te,isRound:b,noLedGap:J},this._createScales()}_createScales(){if(!this._ready)return;const{analyzerWidth:e,initialX:i,innerRadius:s,scaleMin:l,unitWidth:h}=this._aux,{canvas:o,_frequencyScale:n,_mirror:d,_noteLabels:R,_radial:g,_scaleX:a,_scaleR:C}=this,F=a.canvas,Y=C.canvas,W=[],m=this._chLayout==je,c=this._chLayout==ye,E=Math.min(o.width,o.height),w=["C",,"D",,"E","F",,"G",,"A",,"B"],N=E/34|0,U=F.height>>1,te=N>>1,b=U*(R?.7:1.5),J=te*(R?1:2),z=2**(1/12);if(!R&&(this._ansiBands||n!=qe))W.push(16,31.5,63,125,250,500,1e3,2e3,4e3),n==We?W.push(6e3,8e3,1e4,12e3,14e3,16e3,18e3,2e4,22e3):W.push(8e3,16e3);else{let M=Lt;for(let I=-1;I<11;I++)for(let x=0;x<12;x++){if(M>=this._minFreq&&M<=this._maxFreq){const p=w[x],X=p=="C";(p&&R&&!d&&!m||X)&&W.push(R?[M,p+(X?I:"")]:M)}M*=z}}Y.width=Y.height=Math.max(E*.15,(s<<1)+c*N);const K=Y.width>>1,t=K-N*.7,Z=(M,I)=>{const x=Ne*(M/o.width),p=x-ct,X=t*Math.cos(p),k=t*Math.sin(p);C.save(),C.translate(K+X,K+k),C.rotate(x),C.fillText(I,0,0),C.restore()};F.width|=0,a.fillStyle=C.strokeStyle=Ri,a.fillRect(0,0,F.width,F.height),C.arc(K,K,K-N/2,0,Ne),C.lineWidth=N,C.stroke(),a.fillStyle=C.fillStyle=Ft,a.font=`${U}px ${Ke}`,C.font=`${te}px ${Ke}`,a.textAlign=C.textAlign="center";let pe=-b/4,le=-J;for(const M of W){const[I,x]=Array.isArray(M)?M:[M,M<1e3?M|0:`${(M/100|0)/10}k`],p=h*(this._freqScaling(I)-l),X=F.height*.75,k=x[0]=="C",ne=U*(R&&!d&&!m?k?1.2:.6:3);if(a.fillStyle=C.fillStyle=k&&!d&&!m?Li:Ft,R){const $=n==qe,S=n==We;let fe=["C"];if(($||I>2e3||!S&&I>250||(!g||c)&&(!S&&I>125||I>1e3))&&fe.push("G"),($||I>4e3||!S&&I>500||(!g||c)&&(!S&&I>250||I>2e3))&&fe.push("E"),(S&&I>4e3||(!g||c)&&($||I>2e3||!S&&I>500))&&fe.push("D","F","A","B"),!fe.includes(x[0]))continue}p>=pe+b/2&&p<=e&&(a.fillText(x,m&&d==-1?e-p:i+p,X,ne),(m||d&&(p>b||d==1))&&a.fillText(x,m&&d!=1?e+p:(i||o.width)-p,X,ne),pe=p+Math.min(ne,a.measureText(x).width)/2),p>=le+J&&p<e-J&&(Z(m&&d==1?e-p:p,x),(m||d&&(p>J||d==1))&&Z(m&&d!=-1?e+p:-p,x),le=p)}}_draw(e){this._runId=requestAnimationFrame(r=>this._draw(r));const i=e-this._time,s=e-this._last,l=this._maxFPS?975/this._maxFPS:0;if(s<l)return;this._last=e-(l?s%l:0),this._frames++,i>=1e3&&(this._fps=this._frames/i*1e3,this._frames=0,this._time=e);const{isAlpha:h,isBands:o,isLeds:n,isLumi:d,isOctaves:R,isOutline:g,isRound:a,noLedGap:C}=this._flg,{analyzerHeight:F,centerX:Y,centerY:W,channelCoords:m,channelHeight:c,channelGap:E,initialX:w,innerRadius:N,outerRadius:U}=this._aux,{_bars:te,canvas:b,_canvasGradients:J,_chLayout:z,_colorMode:K,_ctx:t,_energy:Z,_fadePeaks:pe,fillAlpha:le,_fps:M,_linearAmplitude:I,_lineWidth:x,maxDecibels:p,minDecibels:X,_mirror:k,_mode:ne,overlay:$,_radial:S,showBgColor:fe,showPeaks:T,useCanvas:O,_weightingFilter:v}=this,L=this._scaleX.canvas,q=this._scaleR.canvas,ie=M*this._peakFadeTime/1e3,H=M**2,ee=this._gravity*1e3,B=M*this._peakHoldTime/1e3,P=z==bt,A=z==je,ge=z==ye,_e=z==Le,He=n&&this._trueLeds&&K==Je,me=S?b.width:this._aux.analyzerWidth,et=w+me,Pe=T&&this._peakLine&&ne==Me,be=S?U-N:F,Xt=be/this._pixelRatio,[Wt,Zi,ze,tt]=this._leds||[];Z.val>0&&M>0&&(this._spinAngle+=this._spinSpeed*Ne/60/M);const Vt=r=>{if(this._reflexRatio>0&&!d&&!S){let y,we;this.reflexFit||ge?(y=ge&&r==0?c+E:0,we=c-F):(y=b.height-F*2,we=F),t.save(),t.globalAlpha=this.reflexAlpha,this.reflexBright!=1&&(t.filter=`brightness(${this.reflexBright})`),t.setTransform(1,0,0,-1,0,b.height),t.drawImage(b,0,m[r].channelTop,b.width,F,0,y,b.width,we),t.restore()}},Ut=()=>{this.showScaleX&&(S?(t.save(),t.translate(Y,W),this._spinSpeed&&t.rotate(this._spinAngle+ct),t.drawImage(q,-q.width>>1,-q.width>>1),t.restore()):t.drawImage(L,0,b.height-L.height))},$t=r=>{const y=r**2,we=424.36,Q=11599.29,Ue=25122.25,xe=544496.41,Re=148693636,Ce=Te=>20*Math.log10(Te);switch(v){case Ct:const Te=Re*y**2/((y+we)*Math.sqrt((y+Q)*(y+xe))*(y+Re));return 2+Ce(Te);case Tt:const Be=Re*y*r/((y+we)*Math.sqrt(y+Ue)*(y+Re));return .17+Ce(Be);case Bt:const at=Re*y/((y+we)*(y+Re));return .06+Ce(at);case kt:const $e=((103791848e-2-y)**2+108076816e-2*y)/((9837328-y)**2+11723776*y),nt=r/68966888496476e-18*Math.sqrt($e/((y+79919.29)*(y+1345600)));return Ce(nt);case It:const Ye=-4737338981378384e-39*r**6+2043828333606125e-30*r**4-1363894795463638e-22*y+1,ke=1306612257412824e-34*r**5-2118150887518656e-26*r**3+.0005559488023498642*r,oe=.0001246332637532143*r/Math.hypot(Ye,ke);return 18.2+Ce(oe)}return 0},it=(r,y,we)=>{t.beginPath(),t.moveTo(r,y),t.lineTo(r,we),t.stroke()},st=r=>{if(r&&x){const y=t.globalAlpha;t.globalAlpha=1,t.stroke(),t.globalAlpha=y}},Ae=r=>Math.max(0,(r*Wt|0)*(tt+ze)-ze),Yt=r=>{Z.val=r,Z.peak>0&&(Z.hold--,Z.hold<0&&(Z.peak+=Z.hold*ee/H/b.height*this._pixelRatio)),r>=Z.peak&&(Z.peak=r,Z.hold=B)};$&&t.clearRect(0,0,b.width,b.height);let gt=0;const mt=te.length,wt=_e?1:2;for(let r=0;r<wt;r++){const{channelTop:y,channelBottom:we,analyzerBottom:Q}=m[r],Ue=this._gradients[this._selectedGrads[r]],xe=Ue.colorStops,Re=xe.length,Ce=!fe||n&&!$?"#000":Ue.bgColor,Te=ge&&S&&r?-1:1,Be=!r&&k==-1||r&&k==1,at=!A||r&&k!=1?0:me>>(r||!Be),$e=A&&Be?-1:1,nt=()=>{const f=L.height,_=f>>1,u=I?100:p,G=I?0:X,V=I?20:5,re=F/(u-G),ve=k!=-1&&(!A||r==0||k==1),Se=k!=1&&(!A||r!=k);t.save(),t.fillStyle=Nt,t.font=`${_}px ${Ke}`,t.textAlign="right",t.lineWidth=1;for(let Ee=u;Ee>G;Ee-=V){const De=y+(u-Ee)*re,j=Ee%2==0|0;if(j){const se=De+_*(De==y?.8:.35);ve&&t.fillText(Ee,f*.85,se),Se&&t.fillText(Ee,(A?me:b.width)-f*.1,se),t.strokeStyle=Nt,t.setLineDash([2,4]),t.lineDashOffset=0}else t.strokeStyle=bi,t.setLineDash([2,8]),t.lineDashOffset=1;t.beginPath(),t.moveTo(w+f*j*ve,~~De+.5),t.lineTo(et-f*j*Se,~~De+.5),t.stroke()}t.restore()},Ye=(f,_)=>{const u=ue[f]+(f<ue.length-1?(ue[f+1]-ue[f])*_:0);return isNaN(u)?-1/0:u},ke=(f,_=$e)=>_*Ne*((f+at)/b.width)+this._spinAngle,oe=(f,_,u)=>{const G=N+_*Te,V=ke(f,u);return[Y+G*Math.cos(V),W+G*Math.sin(V)]},rt=(f,_,u,G,V)=>{t.beginPath();for(const re of k&&!A?[1,-1]:[$e]){const[ve,Se]=a?[ke(f,re),ke(f+u,re)]:[];t.moveTo(...oe(f,_,re)),t.lineTo(...oe(f,_+G,re)),a?t.arc(Y,W,N+(_+G)*Te,ve,Se,re!=1):t.lineTo(...oe(f+u,_+G,re)),t.lineTo(...oe(f+u,_,re)),a&&!V&&t.arc(Y,W,N+_*Te,Se,ve,re==1)}st(V),t.fill()},ot=(f=0,_=0)=>{let u;if(K==Je&&!He||ne==Me)u=J[r];else{const G=K==xt?_%Re:xe.findLastIndex(V=>n?Ae(f)<=Ae(V.level):f<=V.level);u=xe[G].color}t.fillStyle=t.strokeStyle=u};if(O){if(A&&!S){const f=me*(r+Be),_=Be?-1:1;t.setTransform(_,0,0,1,f,0)}if((!$||fe)&&($&&(t.globalAlpha=this.bgAlpha),t.fillStyle=Ce,(r==0||!S&&!P)&&t.fillRect(w,y-E,me,($&&this.reflexAlpha==1?F:c)+E),t.globalAlpha=1),this.showScaleY&&!d&&!S&&(r==0||!P)&&nt(),n?(t.setLineDash([tt,ze]),t.lineWidth=te[0].width):t.lineWidth=g?Math.min(x,te[0].width/2):x,t.save(),!S){const f=new Path2D;f.rect(0,y,b.width,F),t.clip(f)}}let ue=this._fftData[r];this._analyzer[r].getFloatFrequencyData(ue),v&&(ue=ue.map((f,_)=>f+$t(this._binToFreq(_)))),t.beginPath();let Xe=[];for(let f=0;f<mt;f++){const _=te[f],{posX:u,barCenter:G,width:V,freq:re,binLo:ve,binHi:Se,ratioLo:Ee,ratioHi:De}=_;let j=Math.max(Ye(ve,Ee),Ye(Se,De));for(let D=ve+1;D<Se;D++)ue[D]>j&&(j=ue[D]);if(j=this._normalizedB(j),_.value[r]=j,gt+=j,_.peak[r]>0&&_.alpha[r]>0&&(_.hold[r]--,_.hold[r]<0)){if(pe&&!Pe){const D=!h||g&&x>0?1:h?_.peak[r]:le;_.alpha[r]=D*(1+_.hold[r]/ie)}else _.peak[r]+=_.hold[r]*ee/H/Xt;_.alpha[r]<=0&&(_.peak[r]=0)}if(j>=_.peak[r]&&(_.peak[r]=j,_.hold[r]=B,_.alpha[r]=!h||g&&x>0?1:h?j:le),!O)continue;t.globalAlpha=d||h?j:g?le:1,ot(j,f);const se=d?be:n?Ae(j):j*be|0;if(ne==Me){const D=f?0:(this._normalizedB(ue[te[1].binLo])*be+se)/2;if(S){if(f==0&&(A&&t.moveTo(...oe(0,0)),t.lineTo(...oe(0,u<0?D:se))),u>=0){const he=[u,se];t.lineTo(...oe(...he)),Xe.push(he)}}else{if(f==0)if(k==-1&&!A)t.moveTo(w,Q-(u<w?D:se));else{const he=ve?this._normalizedB(ue[ve-1])*be:se;t.moveTo(w-x,Q-he)}(A||k!=-1||u>=w)&&t.lineTo(u,Q-se)}}else if(n){if(fe&&!$&&(r==0||!P)){const D=t.globalAlpha;t.strokeStyle=wi,t.globalAlpha=1,it(G,y,Q),t.strokeStyle=t.fillStyle,t.globalAlpha=D}if(He){const D=d?0:xe.findLastIndex(Ie=>Ae(j)<=Ae(Ie.level));let he=Q;for(let Ie=Re-1;Ie>=D;Ie--){t.strokeStyle=xe[Ie].color;let yt=Q-(Ie==D?se:Ae(xe[Ie].level));it(G,he,yt),he=yt-ze}}else it(G,Q,Q-se)}else if(u>=w)if(S)rt(u,0,V,se,g);else if(a){const D=V/2,he=Q+D;t.beginPath(),t.moveTo(u,he),t.lineTo(u,he-se),t.arc(G,he-se,D,pt,Ne),t.lineTo(u+V,he),st(g),t.fill()}else{const D=g?t.lineWidth:0;t.beginPath(),t.rect(u,Q+D,V,-se-D),st(g),t.fill()}const Fe=_.peak[r],vt=_.alpha[r];if(Fe>0&&vt>0&&T&&!Pe&&!d&&u>=w&&u<et){if(pe?t.globalAlpha=vt:g&&x>0?t.globalAlpha=1:h&&(t.globalAlpha=Fe),(K==St||He)&&ot(Fe),n){const D=Ae(Fe);D>=ze&&t.fillRect(u,Q-D,V,tt)}else if(!S)t.fillRect(u,Q-Fe*be,V,2);else if(ne!=Me){const D=Fe*be;rt(u,D,V,!this._radialInvert||ge||D+N>=2?-2:2)}}}if(O){if(t.globalAlpha=1,ne==Me){if(ot(),S&&!A){if(k){let f;for(;f=Xe.pop();)t.lineTo(...oe(...f,-1))}t.closePath()}if(x>0&&t.stroke(),le>0){if(S){const f=A?ke(me>>1):0,_=A?ke(me):Ne;t.moveTo(...oe(A?me>>1:0,0)),t.arc(Y,W,N,f,_,A?!Be:!0)}else t.lineTo(et,Q),t.lineTo(w,Q);t.globalAlpha=le,t.fill(),t.globalAlpha=1}if((Pe||S&&T)&&(Xe=[],t.beginPath(),te.forEach((f,_)=>{let u=f.posX,G=f.peak[r],V=_?"lineTo":"moveTo";if(S&&u<0){const re=te[_+1];G=Oi(u,G,re.posX,re.peak[r],0),u=0}G*=be,Pe?(t[V](...S?oe(u,G):[u,Q-G]),S&&k&&!A&&Xe.push([u,G])):G>0&&rt(u,G,1,-2)}),Pe)){let f;for(;f=Xe.pop();)t.lineTo(...oe(...f,-1));t.lineWidth=1,t.stroke()}}t.restore(),A&&!S&&t.setTransform(1,0,0,1,0,0),(!A&&!P||r)&&Vt(r)}}if(Yt(gt/(mt<<wt-1)),O&&(k&&!S&&!A&&(t.setTransform(-1,0,0,1,b.width-w,0),t.drawImage(b,w,0,Y,b.height,0,0,Y,b.height),t.setTransform(1,0,0,1,0,0)),t.setLineDash([]),Ut()),this.showFPS){const r=L.height;t.font=`bold ${r}px ${Ke}`,t.fillStyle=mi,t.textAlign="right",t.fillText(Math.round(M),b.width-r,r*2)}this.onCanvasDraw&&(t.save(),t.fillStyle=t.strokeStyle=J[0],this.onCanvasDraw(this,{timestamp:e,canvasGradients:J}),t.restore())}_freqScaling(e){switch(this._frequencyScale){case qe:return Math.log2(e);case ft:return 26.81*e/(1960+e)-.53;case _t:return Math.log2(1+e/700);case We:return e}}_freqToBin(e,i="round"){const s=this._analyzer[0].frequencyBinCount-1,l=Math[i](e*this.fftSize/this.audioCtx.sampleRate);return l<s?l:s}_makeGrad(){if(!this._ready)return;const{canvas:e,_ctx:i,_radial:s,_reflexRatio:l}=this,{analyzerWidth:h,centerX:o,centerY:n,initialX:d,innerRadius:R,outerRadius:g}=this._aux,{isLumi:a}=this._flg,C=this._chLayout==ye,F=1-l,Y=a?e.height:e.height*(1-l*!C)|0;for(const W of[0,1]){const m=this._gradients[this._selectedGrads[W]],c=m.colorStops,E=m.dir=="h";let w;if(s?w=i.createRadialGradient(o,n,g,o,n,R-(g-R)*C):w=i.createLinearGradient(...E?[d,0,d+h,0]:[0,0,0,Y]),c){const N=C&&!this._splitGradient&&(!E||s);for(let U=0;U<1+N;U++){const te=c.length-1;c.forEach((b,J)=>{let z=b.pos;if(N&&(z/=2),C&&!a&&!s&&!E&&(z*=F,!N&&z>.5*F&&(z+=.5*l)),U==1)if(s||a){const K=te-J;b=c[K],z=1-b.pos/2}else J==0&&z>0&&w.addColorStop(.5,b.color),z+=.5;w.addColorStop(z,b.color),C&&J==te&&z<.5&&w.addColorStop(.5,b.color)})}}this._canvasGradients[W]=w}}_normalizedB(e){const i=this._linearAmplitude,s=i?1/this._linearBoost:1,l=(d,R,g)=>d<=R?R:d>=g?g:d,h=d=>10**(d/20);let o=this.maxDecibels,n=this.minDecibels;return i&&(o=h(o),n=h(n),e=h(e)**s),l((e-n)/(o-n)**s,0,1)}_setCanvas(e){if(!this._ready)return;const{canvas:i,_ctx:s}=this,l=this._scaleX.canvas,h=window.devicePixelRatio/(this._loRes+1);let o=window.screen.width*h,n=window.screen.height*h;Math.abs(window.orientation)==90&&o<n&&([o,n]=[n,o]);const d=this.isFullscreen,R=d&&this._fsEl==i,g=R?o:(this._width||this._container.clientWidth||this._defaultWidth)*h|0,a=R?n:(this._height||this._container.clientHeight||this._defaultHeight)*h|0;this._pixelRatio=h,this._fsWidth=o,this._fsHeight=n,!(e!=Ot&&i.width==g&&i.height==a)&&(i.width=g,i.height=a,this.overlay||(s.fillStyle="#000",s.fillRect(0,0,g,a)),s.lineJoin="bevel",l.width=g,l.height=Math.max(20*h,Math.min(g,a)/32|0),this._calcBars(),this._makeGrad(),this._fsStatus!==void 0&&this._fsStatus!==d&&(e=Dt),this._fsStatus=d,this.onCanvasResize&&this.onCanvasResize(e,this))}_setGradient(e,i){if(!this._gradients.hasOwnProperty(e))throw new ce(Ei,e);[0,1].includes(i)||(this._selectedGrads[1]=e,i=0),this._selectedGrads[i]=e,this._makeGrad()}_setProps(e,i){const s=["onCanvasDraw","onCanvasResize"],l=["gradientLeft","gradientRight","stereo"],h=Object.keys(Ve).filter(o=>o!="start").concat(s,l);(i||e===void 0)&&(e={...Ve,...e});for(const o of Object.keys(e))s.includes(o)&&typeof e[o]!="function"?this[o]=void 0:h.includes(o)&&(this[o]=e[o]);e.start!==void 0&&this.toggleAnalyzer(e.start)}}const Fi={class:"flex flex-col justify-center"},Ni={class:"fullscreen-container text-white max-h-90svh",id:"screen"},Mi=["width","height"],Gi={class:"absolute top-4 left-4 text-xl select-none"},qi={key:0,class:"i-la-play"},Hi={key:1,class:"i-la-pause"},Pi={key:0,class:"i-la-arrow-left"},zi={key:1,class:"i-la-arrow-down"},Xi=de("div",{class:"i-la-trash-alt"},null,-1),Wi=[Xi],Vi={class:"flex items-center gap-2 px-2 flex-wrap"},Ui={class:"is-group flex flex-wrap gap-2 flex-1 p-2"},$i={class:"max-w-120 scale-75 max-h-60 overflow-clip relative text-white"},Yi=de("div",{class:"absolute p-2 opacity-70 touch-none select-none text-md"},"Right click here to enter Picture-In-Picture mode",-1),ji={__name:"PitchSpectrogram",setup(ae){const e=lt(),i=lt(),{mic:s,input:l}=jt(),h=lt(!1);Rt(" ",m=>{h.value=!h.value,m.preventDefault()}),Rt("Enter",m=>{g(),m.preventDefault()});let o,n,d,R;function g(){n.fillStyle="#000",n.fillRect(0,0,a.width,a.height)}const a=ii({initiated:!1,width:1600,height:1600,speed:si(()=>Math.floor(a.speedCount/100)),speedCount:Kt(100,100,500),vertical:ht("spectrogram-vertical",!1),pow:ht("spectrogram-power",1),offset:ht("spectrogram-offset",0)});function C(m){m.tap&&(h.value=!h.value),a.speedCount-=m.delta[0]/2}ai(()=>{Qt(),o=document.getElementById("spectrogram"),n=o.getContext("2d"),d=document.createElement("canvas"),R=d.getContext("2d"),d.width=a.width,d.height=a.height,n.fillStyle="#000",n.fillRect(0,0,a.width,a.height);const m=o.captureStream();i.value.srcObject=m,i.value.play().then(()=>{var c,E;return(E=(c=i.value)==null?void 0:c.requestPictureInPicture)==null?void 0:E.call(c)}).catch(c=>console.error(c))});let F;function Y(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(()=>{a.initiated=!0,F=new Di(null,{mode:1,connectSpeakers:!1,volume:0,useCanvas:!1,source:Jt.meter,onCanvasDraw(m){if(h.value)return;R.drawImage(o,0,0,a.width,a.height);let c=m.getBars();for(let E=0;E<c.length;E++)n.fillStyle=W((c[E].freqLo+c[E].freqHi)/2,c[E].value[0]),a.vertical?n.fillRect(E*(a.width/c.length),0,a.width/c.length,a.speed):n.fillRect(a.width-a.speed,a.height-(E+1)*(a.height/c.length),a.speed,a.height/c.length);a.vertical?n.translate(0,a.speed):n.translate(-a.speed,0),n.drawImage(d,0,0,a.width,a.height),n.setTransform(1,0,0,1,0,0)}}),s.open=!0,F.connectInput(l)}).catch(m=>{console.log("mic denied",m)})}function W(m,c){let E=Math.pow(c+a.offset,a.pow);return`hsl(${Zt(m)*30}, ${E*100}%, ${E*70}%)`}return(m,c)=>{const E=ti,w=ei,N=ni("drag");return Oe(),Ge("div",Fi,[de("div",Ni,[ri(de("canvas",{class:"h-full min-h-70svh w-full cursor-pointer",id:"spectrogram",ref_key:"canvasElement",ref:e,width:a.width,height:a.height},null,8,Mi),[[N,C]]),a.initiated?li("",!0):(Oe(),oi(E,{key:0,class:"absolute",onClick:c[0]||(c[0]=U=>Y())})),de("div",Gi,"x"+hi(a.speed),1),de("button",{class:"absolute bottom-4 left-4 text-xl select-none cursor-pointer",onMousedown:c[1]||(c[1]=U=>h.value=!h.value)},[h.value?(Oe(),Ge("div",qi)):(Oe(),Ge("div",Hi))],32),de("button",{class:"absolute bottom-4 right-4 text-xl select-none cursor-pointer",onMousedown:c[2]||(c[2]=U=>a.vertical=!a.vertical)},[a.vertical?(Oe(),Ge("div",zi)):(Oe(),Ge("div",Pi))],32),de("button",{class:"absolute top-4 right-4 text-xl select-none cursor-pointer",onMousedown:c[3]||(c[3]=U=>g())},Wi,32)]),de("div",Vi,[de("div",Ui,[Ze(w,{modelValue:a.pow,"onUpdate:modelValue":c[4]||(c[4]=U=>a.pow=U),min:1,max:10,step:1,fixed:0,param:"POW"},null,8,["modelValue"]),Ze(w,{modelValue:a.offset,"onUpdate:modelValue":c[5]||(c[5]=U=>a.offset=U),min:-.5,max:.5,step:1e-4,param:"OFFSET",fixed:2},null,8,["modelValue"])]),de("div",$i,[Yi,de("video",{class:"max-h-50",ref_key:"video",ref:i},null,512)])])])}}},ss=JSON.parse('{"title":"Spectrogram","description":"2.5D representation on frequency domain in time","frontmatter":{"title":"Spectrogram","description":"2.5D representation on frequency domain in time","layout":"app","date":"2022-06-16T00:00:00.000Z","cover":"spectrogram.png","usefulLinks":["https://codepen.io/hvianna/pen/ZEKWWJb","https://www.npmjs.com/package/audiomotion-analyzer","https://github.com/ListeningToWaves/SpectrogramTesting/blob/master/src/components/spectrogram.js"]},"headers":[],"relativePath":"practice/pitch/spectrogram/index.md","filePath":"practice/pitch/spectrogram/index.md","lastUpdated":1715935440000}'),Ki={name:"practice/pitch/spectrogram/index.md"},Qi=fi('<p>The colorful spectrogram is a powerful tool for visual audio analysis. Each particular frequency in the spectrum gets it&#39;s own position on the vertical axis along with the corresponding Chromatone color. The pitch spectrum is continous and the graph shows all the partials in a rather high resolution. The colors of the lines help differentiate pitches and overtones in any incoming audio signal. The quality of analysis is based primarily on the quality of the signal – thus a good microphone is recommended for best experience.</p><h2 id="how-to-use-the-spectrogram" tabindex="-1">How to use the spectrogram <a class="header-anchor" href="#how-to-use-the-spectrogram" aria-label="Permalink to &quot;How to use the spectrogram&quot;">​</a></h2><ol><li>Drag across <i class="p-3 mr-1 i-la-hand-rock"></i> the spectrogram top change the roll speed. The actual setting is at the top-left corner.</li><li>Press the <i class="p-3 mr-1 i-la-expand"></i> icon at the bottom-right corner make the spectrogram go full screen. Very useful mode for deep explorations and teaching.</li><li>You can pause <i class="p-3 mr-1 i-la-pause"></i> and resume <i class="p-3 mr-1 i-la-play"></i> the roll either by clicking anywhere at the spectrogram or by pressing the <code>Spacebar</code> button on your keyboard. Useful when comparing two or more sound spectrums – record a sound spectrum on the roll, then pause it, take another instrument and record another. The roll can fit up to 10 segments or even more.</li><li>Clear the canvas with the <i class="p-3 mr-1 i-la-trash-alt"></i> button at the top-right corner or by pressing the <code>Enter</code> button on your keyboard.</li><li>POW control changes the Power to which we raise the value of each band. It accentuates louder frequencies and dampens noise.</li><li>OFFSET control is for tuning the values before the raising to the power. It can help adjust the brightness and sensitivity of the spectroscope.</li><li>Right click the small video to open the spectrogram in Picture-In-Picture mode. You may need to press play in the floating window to see the spectrogram running.</li></ol>',3);function Ji(ae,e,i,s,l,h){const o=ji,n=_i("client-only");return Oe(),Ge("div",null,[Ze(n,null,{default:di(()=>[Ze(o)]),_:1}),Qi])}const as=ci(Ki,[["render",Ji]]);export{ss as __pageData,as as default};
