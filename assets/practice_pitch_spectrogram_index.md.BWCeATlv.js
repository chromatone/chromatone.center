import{aH as Xt,Q as Wt,aI as Vt,aJ as Ut,aB as $t,_ as Yt}from"./chunks/theme.E3Hbctnp.js";import{_ as jt}from"./chunks/ControlStart.Cksozn9b.js";import{r as at,q as mt,b as Qt,c as Kt,u as nt,o as Jt,M as Zt,E as Oe,F as Fe,G as de,N as ei,a2 as ti,T as ii,I as si,O as je,D as ai,X as ni,ar as ri,a4 as oi}from"./chunks/framework.BilnkUFq.js";/**!
 * audioMotion-analyzer
 * High-resolution real-time graphic audio spectrum analyzer JS module
 *
 * @version 4.4.0
 * @author  Henrique Avila Vianna <hvianna@gmail.com> <https://henriquevianna.com>
 * @license AGPL-3.0-or-later
 */const li="4.4.0",ft=Math.PI,Ne=2*ft,rt=ft/2,wt=8.17579892,vt="dual-combined",Ve="dual-horizontal",Le="single",we="dual-vertical",yt="bar-index",Rt="bar-level",Ye="gradient",Lt=60,bt="click",hi="fullscreenchange",Mt="resize",ci="#111",Ft="",xt="A",Et="B",St="C",At="D",Ct="468",Ue="sans-serif",di="#0f0",fi="#7f7f7f22",Me=10,Tt="create",Bt="fschange",_i="lores",ui=Mt,ot="user",gi="#000c",It="#fff",pi="#4f4",Ot="#888",mi="#555",lt="bark",Pe="linear",Ge="log",ht="mel",Dt=["#a35","#c66","#e94","#ed0","#9d5","#4d8","#2cb","#0bc","#09c","#36b"],Gt=[["classic",{colorStops:["red",{color:"yellow",level:.85,pos:.6},{color:"lime",level:.475}]}],["prism",{colorStops:Dt}],["rainbow",{dir:"h",colorStops:["#817",...Dt,"#639"]}],["orangered",{bgColor:"#3e2f29",colorStops:["OrangeRed"]}],["steelblue",{bgColor:"#222c35",colorStops:["SteelBlue"]}]],ct={alphaBars:!1,ansiBands:!1,barSpace:.1,bgAlpha:.7,channelLayout:Le,colorMode:Ye,fftSize:8192,fillAlpha:1,frequencyScale:Ge,gradient:Gt[0][0],height:void 0,ledBars:!1,linearAmplitude:!1,linearBoost:1,lineWidth:0,loRes:!1,lumiBars:!1,maxDecibels:-25,maxFPS:0,maxFreq:22e3,minDecibels:-85,minFreq:20,mirror:0,mode:0,noteLabels:!1,outlineBars:!1,overlay:!1,peakLine:!1,radial:!1,radialInvert:!1,radius:.3,reflexAlpha:.15,reflexBright:1,reflexFit:!0,reflexRatio:0,roundBars:!1,showBgColor:!0,showFPS:!1,showPeaks:!0,showScaleX:!0,showScaleY:!1,smoothing:.5,spinSpeed:0,splitGradient:!1,start:!0,trueLeds:!1,useCanvas:!0,volume:1,weightingFilter:Ft,width:void 0},wi=["ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?"],vi=["ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid"],yi=["ERR_UNKNOWN_GRADIENT","Unknown gradient"],dt=["ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1"],Ri=["ERR_INVALID_MODE","Invalid mode"],Li=["ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1"],bi=["ERR_INVALID_AUDIO_SOURCE","Audio source must be an instance of HTMLMediaElement or AudioNode"],xi=["ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string"],Ei=["ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object"],Si=["ERR_GRADIENT_MISSING_COLOR","Gradient colorStops must be a non-empty array"];class ce extends Error{constructor(e,i){const[s,o]=e;super(o+(i!==void 0?`: ${i}`:"")),this.name="AudioMotionError",this.code=s}}const kt=(ae,e)=>console.warn(`${ae} is deprecated. Use ${e} instead.`),Nt=ae=>{for(const e in ae)return!1;return!0},$e=(ae,e,i="toLowerCase")=>e[Math.max(0,e.indexOf((""+ae)[i]()))],Ai=(ae,e,i,s,o)=>e+(s-e)*(o-ae)/(i-ae);Array.prototype.findLastIndex||(Array.prototype.findLastIndex=function(ae){let e=this.length;for(;e-- >0;)if(ae(this[e]))return e;return-1});class Ci{constructor(e,i={}){this._ready=!1,this._aux={},this._canvasGradients=[],this._destroyed=!1,this._energy={val:0,peak:0,hold:0},this._flg={},this._fps=0,this._gradients={},this._last=0,this._outNodes=[],this._ownContext=!1,this._selectedGrads=[],this._sources=[],e instanceof Element||(Nt(i)&&!Nt(e)&&(i=e),e=null),this._ownCanvas=!(i.canvas instanceof HTMLCanvasElement);const s=this._ownCanvas?document.createElement("canvas"):i.canvas;s.style="max-width: 100%;",this._ctx=s.getContext("2d");for(const[a,B]of Gt)this.registerGradient(a,B);this._container=e||!this._ownCanvas&&s.parentElement||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270;let o;if(!(i.source&&(o=i.source.context))){if(!(o=i.audioCtx))try{o=new(window.AudioContext||window.webkitAudioContext),this._ownContext=!0}catch{throw new ce(wi)}}if(!o.createGain)throw new ce(vi);const d=this._analyzer=[o.createAnalyser(),o.createAnalyser()],r=this._splitter=o.createChannelSplitter(2),n=this._merger=o.createChannelMerger(2);this._input=o.createGain(),this._output=o.createGain(),i.source&&this.connectInput(i.source);for(const a of[0,1])r.connect(d[a],a);n.connect(this._output),i.connectSpeakers!==!1&&this.connectOutput();for(const a of["_scaleX","_scaleR"])this[a]=document.createElement("canvas").getContext("2d");this._fsEl=i.fsElement||s;const c=()=>{this._fsTimeout||(this._fsTimeout=window.setTimeout(()=>{this._fsChanging||(this._setCanvas(ui),this._fsTimeout=0)},Lt))};window.ResizeObserver&&(this._observer=new ResizeObserver(c),this._observer.observe(this._container)),this._controller=new AbortController;const x=this._controller.signal;window.addEventListener(Mt,c,{signal:x}),s.addEventListener(hi,()=>{this._fsChanging=!0,this._fsTimeout&&window.clearTimeout(this._fsTimeout),this._setCanvas(Bt),this._fsTimeout=window.setTimeout(()=>{this._fsChanging=!1,this._fsTimeout=0},Lt)},{signal:x});const m=()=>{o.state=="suspended"&&o.resume(),window.removeEventListener(bt,m)};window.addEventListener(bt,m),document.addEventListener("visibilitychange",()=>{document.visibilityState!="hidden"&&(this._frames=0,this._time=performance.now())},{signal:x}),this._setProps(i,!0),this.useCanvas&&this._ownCanvas&&this._container.appendChild(s),this._ready=!0,this._setCanvas(Tt)}get alphaBars(){return this._alphaBars}set alphaBars(e){this._alphaBars=!!e,this._calcBars()}get ansiBands(){return this._ansiBands}set ansiBands(e){this._ansiBands=!!e,this._calcBars()}get barSpace(){return this._barSpace}set barSpace(e){this._barSpace=+e||0,this._calcBars()}get channelLayout(){return this._chLayout}set channelLayout(e){this._chLayout=$e(e,[Le,Ve,we,vt]),this._input.disconnect(),this._input.connect(this._chLayout!=Le?this._splitter:this._analyzer[0]),this._analyzer[0].disconnect(),this._outNodes.length&&this._analyzer[0].connect(this._chLayout!=Le?this._merger:this._output),this._calcBars(),this._makeGrad()}get colorMode(){return this._colorMode}set colorMode(e){this._colorMode=$e(e,[Ye,yt,Rt])}get fftSize(){return this._analyzer[0].fftSize}set fftSize(e){for(const s of[0,1])this._analyzer[s].fftSize=e;const i=this._analyzer[0].frequencyBinCount;this._fftData=[new Float32Array(i),new Float32Array(i)],this._calcBars()}get frequencyScale(){return this._frequencyScale}set frequencyScale(e){this._frequencyScale=$e(e,[Ge,lt,ht,Pe]),this._calcBars()}get gradient(){return this._selectedGrads[0]}set gradient(e){this._setGradient(e)}get gradientLeft(){return this._selectedGrads[0]}set gradientLeft(e){this._setGradient(e,0)}get gradientRight(){return this._selectedGrads[1]}set gradientRight(e){this._setGradient(e,1)}get height(){return this._height}set height(e){this._height=e,this._setCanvas(ot)}get ledBars(){return this._showLeds}set ledBars(e){this._showLeds=!!e,this._calcBars()}get linearAmplitude(){return this._linearAmplitude}set linearAmplitude(e){this._linearAmplitude=!!e}get linearBoost(){return this._linearBoost}set linearBoost(e){this._linearBoost=e>=1?+e:1}get lineWidth(){return this._lineWidth}set lineWidth(e){this._lineWidth=+e||0}get loRes(){return this._loRes}set loRes(e){this._loRes=!!e,this._setCanvas(_i)}get lumiBars(){return this._lumiBars}set lumiBars(e){this._lumiBars=!!e,this._calcBars(),this._makeGrad()}get maxDecibels(){return this._analyzer[0].maxDecibels}set maxDecibels(e){for(const i of[0,1])this._analyzer[i].maxDecibels=e}get maxFPS(){return this._maxFPS}set maxFPS(e){this._maxFPS=e<0?0:+e||0}get maxFreq(){return this._maxFreq}set maxFreq(e){if(e<1)throw new ce(dt);this._maxFreq=Math.min(e,this.audioCtx.sampleRate/2),this._calcBars()}get minDecibels(){return this._analyzer[0].minDecibels}set minDecibels(e){for(const i of[0,1])this._analyzer[i].minDecibels=e}get minFreq(){return this._minFreq}set minFreq(e){if(e<1)throw new ce(dt);this._minFreq=+e,this._calcBars()}get mirror(){return this._mirror}set mirror(e){this._mirror=Math.sign(e)|0,this._calcBars(),this._makeGrad()}get mode(){return this._mode}set mode(e){const i=e|0;if(i>=0&&i<=10&&i!=9)this._mode=i,this._calcBars(),this._makeGrad();else throw new ce(Ri,e)}get noteLabels(){return this._noteLabels}set noteLabels(e){this._noteLabels=!!e,this._createScales()}get outlineBars(){return this._outlineBars}set outlineBars(e){this._outlineBars=!!e,this._calcBars()}get peakLine(){return this._peakLine}set peakLine(e){this._peakLine=!!e}get radial(){return this._radial}set radial(e){this._radial=!!e,this._calcBars(),this._makeGrad()}get radialInvert(){return this._radialInvert}set radialInvert(e){this._radialInvert=!!e,this._calcBars(),this._makeGrad()}get radius(){return this._radius}set radius(e){this._radius=+e||0,this._calcBars(),this._makeGrad()}get reflexRatio(){return this._reflexRatio}set reflexRatio(e){if(e=+e||0,e<0||e>=1)throw new ce(Li);this._reflexRatio=e,this._calcBars(),this._makeGrad()}get roundBars(){return this._roundBars}set roundBars(e){this._roundBars=!!e,this._calcBars()}get smoothing(){return this._analyzer[0].smoothingTimeConstant}set smoothing(e){for(const i of[0,1])this._analyzer[i].smoothingTimeConstant=e}get spinSpeed(){return this._spinSpeed}set spinSpeed(e){e=+e||0,(this._spinSpeed===void 0||e==0)&&(this._spinAngle=-rt),this._spinSpeed=e}get splitGradient(){return this._splitGradient}set splitGradient(e){this._splitGradient=!!e,this._makeGrad()}get stereo(){return kt("stereo","channelLayout"),this._chLayout!=Le}set stereo(e){kt("stereo","channelLayout"),this.channelLayout=e?we:Le}get trueLeds(){return this._trueLeds}set trueLeds(e){this._trueLeds=!!e}get volume(){return this._output.gain.value}set volume(e){this._output.gain.value=e}get weightingFilter(){return this._weightingFilter}set weightingFilter(e){this._weightingFilter=$e(e,[Ft,xt,Et,St,At,Ct],"toUpperCase")}get width(){return this._width}set width(e){this._width=e,this._setCanvas(ot)}get audioCtx(){return this._input.context}get canvas(){return this._ctx.canvas}get canvasCtx(){return this._ctx}get connectedSources(){return this._sources}get connectedTo(){return this._outNodes}get fps(){return this._fps}get fsHeight(){return this._fsHeight}get fsWidth(){return this._fsWidth}get isAlphaBars(){return this._flg.isAlpha}get isBandsMode(){return this._flg.isBands}get isDestroyed(){return this._destroyed}get isFullscreen(){return this._fsEl&&(document.fullscreenElement||document.webkitFullscreenElement)===this._fsEl}get isLedBars(){return this._flg.isLeds}get isLumiBars(){return this._flg.isLumi}get isOctaveBands(){return this._flg.isOctaves}get isOn(){return!!this._runId}get isOutlineBars(){return this._flg.isOutline}get pixelRatio(){return this._pixelRatio}get isRoundBars(){return this._flg.isRound}static get version(){return li}connectInput(e){const i=e instanceof HTMLMediaElement;if(!(i||e.connect))throw new ce(bi);const s=i?this.audioCtx.createMediaElementSource(e):e;return this._sources.includes(s)||(s.connect(this._input),this._sources.push(s)),s}connectOutput(e=this.audioCtx.destination){if(!this._outNodes.includes(e)&&(this._output.connect(e),this._outNodes.push(e),this._outNodes.length==1))for(const i of[0,1])this._analyzer[i].connect(this._chLayout==Le&&!i?this._output:this._merger,0,i)}destroy(){if(!this._ready)return;const{audioCtx:e,canvas:i,_controller:s,_input:o,_merger:d,_observer:r,_ownCanvas:n,_ownContext:c,_splitter:x}=this;this._destroyed=!0,this._ready=!1,this.stop(),s.abort(),r&&r.disconnect(),this.onCanvasResize=null,this.onCanvasDraw=null,this._fsEl=null,this.disconnectInput(),this.disconnectOutput(),o.disconnect(),x.disconnect(),d.disconnect(),c&&e.close(),n&&i.remove(),this._calcBars()}disconnectInput(e,i){e?Array.isArray(e)||(e=[e]):e=Array.from(this._sources);for(const s of e){const o=this._sources.indexOf(s);if(i&&s.mediaStream)for(const d of s.mediaStream.getAudioTracks())d.stop();o>=0&&(s.disconnect(this._input),this._sources.splice(o,1))}}disconnectOutput(e){if(!(e&&!this._outNodes.includes(e))&&(this._output.disconnect(e),this._outNodes=e?this._outNodes.filter(i=>i!==e):[],this._outNodes.length==0))for(const i of[0,1])this._analyzer[i].disconnect()}getBars(){return Array.from(this._bars,({posX:e,freq:i,freqLo:s,freqHi:o,hold:d,peak:r,value:n})=>({posX:e,freq:i,freqLo:s,freqHi:o,hold:d,peak:r,value:n}))}getEnergy(e,i){if(e===void 0)return this._energy.val;if(e!=+e){if(e=="peak")return this._energy.peak;const n={bass:[20,250],lowMid:[250,500],mid:[500,2e3],highMid:[2e3,4e3],treble:[4e3,16e3]};if(!n[e])return null;[e,i]=n[e]}const s=this._freqToBin(e),o=i?this._freqToBin(i):s,d=this._chLayout==Le?1:2;let r=0;for(let n=0;n<d;n++)for(let c=s;c<=o;c++)r+=this._normalizedB(this._fftData[n][c]);return r/(o-s+1)/d}getOptions(e){Array.isArray(e)||(e=[e]);let i={};for(const s of Object.keys(ct))e.includes(s)||(s=="gradient"&&this.gradientLeft!=this.gradientRight?(i.gradientLeft=this.gradientLeft,i.gradientRight=this.gradientRight):s!="start"&&(i[s]=this[s]));return i}registerGradient(e,i){if(typeof e!="string"||e.trim().length==0)throw new ce(xi);if(typeof i!="object")throw new ce(Ei);const{colorStops:s}=i;if(!Array.isArray(s)||!s.length)throw new ce(Si);const o=s.length,d=r=>+r!=r||r<0||r>1;s.forEach((r,n)=>{const c=n/Math.max(1,o-1);typeof r!="object"?s[n]={pos:c,color:r}:d(r.pos)&&(r.pos=c),d(r.level)&&(s[n].level=1-n/o)}),s.sort((r,n)=>r.level<n.level?1:r.level>n.level?-1:0),s[0].level=1,this._gradients[e]={bgColor:i.bgColor||ci,dir:i.dir,colorStops:s},this._selectedGrads.includes(e)&&this._makeGrad()}setCanvasSize(e,i){this._width=e,this._height=i,this._setCanvas(ot)}setFreqRange(e,i){if(e<1||i<1)throw new ce(dt);this._minFreq=Math.min(e,i),this.maxFreq=Math.max(e,i)}setLedParams(e){let i,s,o;e&&(i=e.maxLeds|0,s=+e.spaceV,o=+e.spaceH),this._ledParams=i>0&&s>0&&o>=0?[i,s,o]:void 0,this._calcBars()}setOptions(e){this._setProps(e)}setSensitivity(e,i){for(const s of[0,1])this._analyzer[s].minDecibels=Math.min(e,i),this._analyzer[s].maxDecibels=Math.max(e,i)}start(){this.toggleAnalyzer(!0)}stop(){this.toggleAnalyzer(!1)}toggleAnalyzer(e){const i=this.isOn;return e===void 0&&(e=!i),i&&!e?(cancelAnimationFrame(this._runId),this._runId=0):!i&&e&&!this._destroyed&&(this._frames=0,this._time=performance.now(),this._runId=requestAnimationFrame(s=>this._draw(s))),this.isOn}toggleFullscreen(){if(this.isFullscreen)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this._fsEl;if(!e)return;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}}_binToFreq(e){return e*this.audioCtx.sampleRate/this.fftSize||1}_calcBars(){const e=this._bars=[];if(!this._ready){this._flg={isAlpha:!1,isBands:!1,isLeds:!1,isLumi:!1,isOctaves:!1,isOutline:!1,isRound:!1,noLedGap:!1};return}const{_ansiBands:i,_barSpace:s,canvas:o,_chLayout:d,_maxFreq:r,_minFreq:n,_mirror:c,_mode:x,_radial:m,_radialInvert:a,_reflexRatio:B}=this,D=o.width>>1,U=o.height>>1,z=d==we&&!m,v=d==Ve,h=x%10!=0,A=h&&this._frequencyScale==Ge,y=this._showLeds&&h&&!m,k=this._lumiBars&&h&&!m,W=this._alphaBars&&!k&&x!=Me,te=this._outlineBars&&h&&!k&&!y,S=this._roundBars&&h&&!k&&!y,Z=d!=we||B>0&&!k,H=o.height-(z&&!y?.5:0)>>z,Q=H*(k||m?1:1-B)|0,t=o.width-D*(v||c!=0),ee=z?o.height-H*2:0,fe=D*(c==-1&&!v&&!m);let _e=Math.min(o.width,o.height)*.375*(d==we?1:this._radius)|0,P=Math.min(D,U);a&&d!=we&&([_e,P]=[P,_e]);const C=T=>e.push({...T,peak:[0,0],hold:[0],value:[0]}),G=T=>{const M=this._freqToBin(T,"floor"),w=this._binToFreq(M),E=this._binToFreq(M+1),I=Math.log2(T/w)/Math.log2(E/w);return[M,I]};let g,R,V;if(A){const T=(O,q,j)=>+O.toPrecision(j?Math.max(q,1+Math.log10(O)|0):q),M=O=>{const q=[1,1.12,1.25,1.4,1.6,1.8,2,2.24,2.5,2.8,3.15,3.55,4,4.5,5,5.6,6.3,7.1,8,9,10],j=Math.log10(O)|0,ve=O/10**j;let ne=1;for(;ne<q.length&&ve>q[ne];)ne++;return ve-q[ne-1]<q[ne]-ve&&ne--,(q[ne]*10**(j+5)|0)/1e5},w=[0,24,12,8,6,4,3,2,1][x],E=i?10**(3/(w*10)):2**(1/w),I=E**.5;let $=i?7.94328235/(w%2?1:I):wt;do{let O=$;const q=T(O/I,4,!0),j=T(O*I,4,!0),[ve,ne]=G(q),[ye,Qe]=G(j);i?O=w<4?M(O):T(O,O.toString()[0]<5?3:2):O=T(O,4,!0),O>=n&&C({posX:0,freq:O,freqLo:q,freqHi:j,binLo:ve,binHi:ye,ratioLo:ne,ratioHi:Qe}),$*=E}while($<=r);g=t/e.length,e.forEach((O,q)=>O.posX=fe+q*g);const u=e[0],Y=e[e.length-1];R=this._freqScaling(u.freqLo),V=t/(this._freqScaling(Y.freqHi)-R),u.freqLo<n&&(u.freqLo=n,[u.binLo,u.ratioLo]=G(n)),Y.freqHi>r&&(Y.freqHi=r,[Y.binHi,Y.ratioHi]=G(r))}else if(h){const T=[0,24,12,8,6,4,3,2,1][x]*10,M=w=>{switch(this._frequencyScale){case lt:return 1960/(26.81/(w+.53)-1);case ht:return 700*(2**w-1);case Pe:return w}};g=t/T,R=this._freqScaling(n),V=t/(this._freqScaling(r)-R);for(let w=0,E=0;w<T;w++,E+=g){const I=M(R+E/V),$=M(R+(E+g/2)/V),u=M(R+(E+g)/V),[Y,O]=G(I),[q,j]=G(u);C({posX:fe+E,freq:$,freqLo:I,freqHi:u,binLo:Y,binHi:q,ratioLo:O,ratioHi:j})}}else{g=1,R=this._freqScaling(n),V=t/(this._freqScaling(r)-R);const T=this._freqToBin(n,"floor"),M=this._freqToBin(r);let w=-999;for(let E=T;E<=M;E++){const I=this._binToFreq(E),$=fe+Math.round(V*(this._freqScaling(I)-R));if($>w)C({posX:$,freq:I,freqLo:I,freqHi:I,binLo:E,binHi:E,ratioLo:0,ratioHi:0}),w=$;else if(e.length){const u=e[e.length-1];u.binHi=E,u.freqHi=I,u.freq=(u.freqLo*I)**.5}}}let ie=0,L=0;if(y){const T=this._pixelRatio/(window.devicePixelRatio>1&&window.screen.height<=540?2:1),M=[[],[128,3,.45],[128,4,.225],[96,6,.225],[80,6,.225],[80,6,.125],[64,6,.125],[48,8,.125],[24,16,.125]],w=this._ledParams,[E,I,$]=w||M[x];let u,Y=Q;if(w){const O=2*T;let q;u=E+1;do u--,q=Y/u/(1+I),L=q*I;while((q<O||L<O)&&u>1)}else{const O=540/I;L=Math.min(I*T,Math.max(2,Y/O+.1|0))}Z&&(Y+=L),w||(u=Math.min(E,Y/(L*2)|0)),ie=$>=1?$:g*$,this._leds=[u,ie,L,Y/u-L]}const oe=Math.min(g-1,s*(s>0&&s<1?g:1));h&&(g-=Math.max(y?ie:0,oe)),e.forEach((T,M)=>{let w=T.posX,E=g;h&&(s==0&&!y?(w|=0,E|=0,M>0&&w>e[M-1].posX+e[M-1].width&&(w--,E++)):w+=Math.max(y?ie:0,oe)/2,T.posX=w),T.barCenter=w+(g==1?0:E/2),T.width=E});const ue=[];for(const T of[0,1]){const M=d==we?(H+ee)*T:0,w=M+H,E=M+Q-(!y||Z?0:L);ue.push({channelTop:M,channelBottom:w,analyzerBottom:E})}this._aux={analyzerHeight:Q,analyzerWidth:t,centerX:D,centerY:U,channelCoords:ue,channelHeight:H,channelGap:ee,initialX:fe,innerRadius:_e,outerRadius:P,scaleMin:R,unitWidth:V},this._flg={isAlpha:W,isBands:h,isLeds:y,isLumi:k,isOctaves:A,isOutline:te,isRound:S,noLedGap:Z},this._createScales()}_createScales(){if(!this._ready)return;const{analyzerWidth:e,initialX:i,innerRadius:s,scaleMin:o,unitWidth:d}=this._aux,{canvas:r,_frequencyScale:n,_mirror:c,_noteLabels:x,_radial:m,_scaleX:a,_scaleR:B}=this,D=a.canvas,U=B.canvas,z=[],v=this._chLayout==Ve,h=this._chLayout==we,A=Math.min(r.width,r.height),y=["C",,"D",,"E","F",,"G",,"A",,"B"],k=A/34|0,W=D.height>>1,te=k>>1,S=W*(x?.7:1.5),Z=te*(x?1:2),H=2**(1/12);if(!x&&(this._ansiBands||n!=Ge))z.push(16,31.5,63,125,250,500,1e3,2e3,4e3),n==Pe?z.push(6e3,8e3,1e4,12e3,14e3,16e3,18e3,2e4,22e3):z.push(8e3,16e3);else{let P=wt;for(let C=-1;C<11;C++)for(let G=0;G<12;G++){if(P>=this._minFreq&&P<=this._maxFreq){const g=y[G],R=g=="C";(g&&x&&!c&&!v||R)&&z.push(x?[P,g+(R?C:"")]:P)}P*=H}}U.width=U.height=Math.max(A*.15,(s<<1)+h*k);const Q=U.width>>1,t=Q-k*.7,ee=(P,C)=>{const G=Ne*(P/r.width),g=G-rt,R=t*Math.cos(g),V=t*Math.sin(g);B.save(),B.translate(Q+R,Q+V),B.rotate(G),B.fillText(C,0,0),B.restore()};D.width|=0,a.fillStyle=B.strokeStyle=gi,a.fillRect(0,0,D.width,D.height),B.arc(Q,Q,Q-k/2,0,Ne),B.lineWidth=k,B.stroke(),a.fillStyle=B.fillStyle=It,a.font=`${W}px ${Ue}`,B.font=`${te}px ${Ue}`,a.textAlign=B.textAlign="center";let fe=-S/4,_e=-Z;for(const P of z){const[C,G]=Array.isArray(P)?P:[P,P<1e3?P|0:`${(P/100|0)/10}k`],g=d*(this._freqScaling(C)-o),R=D.height*.75,V=G[0]=="C",ie=W*(x&&!c&&!v?V?1.2:.6:3);if(a.fillStyle=B.fillStyle=V&&!c&&!v?pi:It,x){const L=n==Ge,oe=n==Pe;let ue=["C"];if((L||C>2e3||!oe&&C>250||(!m||h)&&(!oe&&C>125||C>1e3))&&ue.push("G"),(L||C>4e3||!oe&&C>500||(!m||h)&&(!oe&&C>250||C>2e3))&&ue.push("E"),(oe&&C>4e3||(!m||h)&&(L||C>2e3||!oe&&C>500))&&ue.push("D","F","A","B"),!ue.includes(G[0]))continue}g>=fe+S/2&&g<=e&&(a.fillText(G,v&&c==-1?e-g:i+g,R,ie),(v||c&&(g>S||c==1))&&a.fillText(G,v&&c!=1?e+g:(i||r.width)-g,R,ie),fe=g+Math.min(ie,a.measureText(G).width)/2),g>=_e+Z&&g<e-Z&&(ee(v&&c==1?e-g:g,G),(v||c&&(g>Z||c==1))&&ee(v&&c!=-1?e+g:-g,G),_e=g)}}_draw(e){this._runId=requestAnimationFrame(l=>this._draw(l));const i=e-this._time,s=e-this._last,o=this._maxFPS?975/this._maxFPS:0;if(s<o)return;this._last=e-(o?s%o:0),this._frames++,i>=1e3&&(this._fps=this._frames/i*1e3,this._frames=0,this._time=e);const{isAlpha:d,isBands:r,isLeds:n,isLumi:c,isOctaves:x,isOutline:m,isRound:a,noLedGap:B}=this._flg,{analyzerHeight:D,centerX:U,centerY:z,channelCoords:v,channelHeight:h,channelGap:A,initialX:y,innerRadius:k,outerRadius:W}=this._aux,{_bars:te,canvas:S,_canvasGradients:Z,_chLayout:H,_colorMode:Q,_ctx:t,_energy:ee,fillAlpha:fe,_fps:_e,_linearAmplitude:P,_lineWidth:C,maxDecibels:G,minDecibels:g,_mirror:R,_mode:V,overlay:ie,_radial:L,showBgColor:oe,showPeaks:ue,useCanvas:T,_weightingFilter:M}=this,w=this._scaleX.canvas,E=this._scaleR.canvas,I=_e>>1,$=H==vt,u=H==Ve,Y=H==we,O=H==Le,q=n&&this._trueLeds&&Q==Ye,j=L?S.width:this._aux.analyzerWidth,ve=y+j,ne=ue&&this._peakLine&&V==Me,ye=L?W-k:D,[Qe,$i,qe,Ke]=this._leds||[];ee.val>0&&_e>0&&(this._spinAngle+=this._spinSpeed*Ne/60/_e);const qt=l=>{if(this._reflexRatio>0&&!c&&!L){let b,pe;this.reflexFit||Y?(b=Y&&l==0?h+A:0,pe=h-D):(b=S.height-D*2,pe=D),t.save(),t.globalAlpha=this.reflexAlpha,this.reflexBright!=1&&(t.filter=`brightness(${this.reflexBright})`),t.setTransform(1,0,0,-1,0,S.height),t.drawImage(S,0,v[l].channelTop,S.width,D,0,b,S.width,pe),t.restore()}},Ht=()=>{this.showScaleX&&(L?(t.save(),t.translate(U,z),this._spinSpeed&&t.rotate(this._spinAngle+rt),t.drawImage(E,-E.width>>1,-E.width>>1),t.restore()):t.drawImage(w,0,S.height-w.height))},Pt=l=>{const b=l**2,pe=424.36,K=11599.29,ze=25122.25,be=544496.41,Re=148693636,Ae=Ce=>20*Math.log10(Ce);switch(M){case xt:const Ce=Re*b**2/((b+pe)*Math.sqrt((b+K)*(b+be))*(b+Re));return 2+Ae(Ce);case Et:const Te=Re*b*l/((b+pe)*Math.sqrt(b+ze)*(b+Re));return .17+Ae(Te);case St:const et=Re*b/((b+pe)*(b+Re));return .06+Ae(et);case At:const Xe=((103791848e-2-b)**2+108076816e-2*b)/((9837328-b)**2+11723776*b),tt=l/68966888496476e-18*Math.sqrt(Xe/((b+79919.29)*(b+1345600)));return Ae(tt);case Ct:const We=-4737338981378384e-39*l**6+2043828333606125e-30*l**4-1363894795463638e-22*b+1,Be=1306612257412824e-34*l**5-2118150887518656e-26*l**3+.0005559488023498642*l,le=.0001246332637532143*l/Math.hypot(We,Be);return 18.2+Ae(le)}return 0},Je=(l,b,pe)=>{t.beginPath(),t.moveTo(l,b),t.lineTo(l,pe),t.stroke()},Ze=l=>{if(l&&C){const b=t.globalAlpha;t.globalAlpha=1,t.stroke(),t.globalAlpha=b}},Se=l=>Math.max(0,(l*Qe|0)*(Ke+qe)-qe),zt=l=>{ee.val=l,ee.peak>0&&(ee.hold--,ee.hold<0&&(ee.peak+=ee.hold/(I*I/2))),l>=ee.peak&&(ee.peak=l,ee.hold=I)};ie&&t.clearRect(0,0,S.width,S.height);let _t=0;const ut=te.length,gt=O?1:2;for(let l=0;l<gt;l++){const{channelTop:b,channelBottom:pe,analyzerBottom:K}=v[l],ze=this._gradients[this._selectedGrads[l]],be=ze.colorStops,Re=be.length,Ae=!oe||n&&!ie?"#000":ze.bgColor,Ce=Y&&L&&l?-1:1,Te=!l&&R==-1||l&&R==1,et=!u||l&&R!=1?0:j>>(l||!Te),Xe=u&&Te?-1:1,tt=()=>{const f=w.height,p=f>>1,_=P?100:G,N=P?0:g,X=P?20:5,re=D/(_-N),me=R!=-1&&(!u||l==0||R==1),xe=R!=1&&(!u||l!=R);t.save(),t.fillStyle=Ot,t.font=`${p}px ${Ue}`,t.textAlign="right",t.lineWidth=1;for(let Ee=_;Ee>N;Ee-=X){const De=b+(_-Ee)*re,J=Ee%2==0|0;if(J){const se=De+p*(De==b?.8:.35);me&&t.fillText(Ee,f*.85,se),xe&&t.fillText(Ee,(u?j:S.width)-f*.1,se),t.strokeStyle=Ot,t.setLineDash([2,4]),t.lineDashOffset=0}else t.strokeStyle=mi,t.setLineDash([2,8]),t.lineDashOffset=1;t.beginPath(),t.moveTo(y+f*J*me,~~De+.5),t.lineTo(ve-f*J*xe,~~De+.5),t.stroke()}t.restore()},We=(f,p)=>{const _=ge[f]+(f<ge.length-1?(ge[f+1]-ge[f])*p:0);return isNaN(_)?-1/0:_},Be=(f,p=Xe)=>p*Ne*((f+et)/S.width)+this._spinAngle,le=(f,p,_)=>{const N=k+p*Ce,X=Be(f,_);return[U+N*Math.cos(X),z+N*Math.sin(X)]},it=(f,p,_,N,X)=>{t.beginPath();for(const re of R&&!u?[1,-1]:[Xe]){const[me,xe]=a?[Be(f,re),Be(f+_,re)]:[];t.moveTo(...le(f,p,re)),t.lineTo(...le(f,p+N,re)),a?t.arc(U,z,k+(p+N)*Ce,me,xe,re!=1):t.lineTo(...le(f+_,p+N,re)),t.lineTo(...le(f+_,p,re)),a&&!X&&t.arc(U,z,k+p*Ce,xe,me,re==1)}Ze(X),t.fill()},st=(f=0,p=0)=>{let _;if(Q==Ye&&!q||V==Me)_=Z[l];else{const N=Q==yt?p%Re:be.findLastIndex(X=>n?Se(f)<=Se(X.level):f<=X.level);_=be[N].color}t.fillStyle=t.strokeStyle=_};if(T){if(u&&!L){const f=j*(l+Te),p=Te?-1:1;t.setTransform(p,0,0,1,f,0)}if((!ie||oe)&&(ie&&(t.globalAlpha=this.bgAlpha),t.fillStyle=Ae,(l==0||!L&&!$)&&t.fillRect(y,b-A,j,(ie&&this.reflexAlpha==1?D:h)+A),t.globalAlpha=1),this.showScaleY&&!c&&!L&&(l==0||!$)&&tt(),n?(t.setLineDash([Ke,qe]),t.lineWidth=te[0].width):t.lineWidth=m?Math.min(C,te[0].width/2):C,t.save(),!L){const f=new Path2D;f.rect(0,b,S.width,D),t.clip(f)}}let ge=this._fftData[l];this._analyzer[l].getFloatFrequencyData(ge),M&&(ge=ge.map((f,p)=>f+Pt(this._binToFreq(p)))),t.beginPath();let He=[];for(let f=0;f<ut;f++){const p=te[f],{posX:_,barCenter:N,width:X,freq:re,binLo:me,binHi:xe,ratioLo:Ee,ratioHi:De}=p;let J=Math.max(We(me,Ee),We(xe,De));for(let F=me+1;F<xe;F++)ge[F]>J&&(J=ge[F]);if(J=this._normalizedB(J),p.value[l]=J,_t+=J,p.peak[l]>0&&(p.hold[l]--,p.hold[l]<0&&(p.peak[l]+=p.hold[l]/(I*I/2))),J>=p.peak[l]&&(p.peak[l]=J,p.hold[l]=I),!T)continue;c||d?t.globalAlpha=J:m&&(t.globalAlpha=fe),st(J,f);const se=c?ye:n?Se(J):J*ye|0;if(V==Me){const F=f?0:(this._normalizedB(ge[te[1].binLo])*ye+se)/2;if(L){if(f==0&&(u&&t.moveTo(...le(0,0)),t.lineTo(...le(0,_<0?F:se))),_>=0){const he=[_,se];t.lineTo(...le(...he)),He.push(he)}}else{if(f==0)if(R==-1&&!u)t.moveTo(y,K-(_<y?F:se));else{const he=me?this._normalizedB(ge[me-1])*ye:se;t.moveTo(y-C,K-he)}(u||R!=-1||_>=y)&&t.lineTo(_,K-se)}}else if(n){if(oe&&!ie&&(l==0||!$)){const F=t.globalAlpha;t.strokeStyle=fi,t.globalAlpha=1,Je(N,b,K),t.strokeStyle=t.fillStyle,t.globalAlpha=F}if(q){const F=c?0:be.findLastIndex(Ie=>Se(J)<=Se(Ie.level));let he=K;for(let Ie=Re-1;Ie>=F;Ie--){t.strokeStyle=be[Ie].color;let pt=K-(Ie==F?se:Se(be[Ie].level));Je(N,he,pt),he=pt-qe}}else Je(N,K,K-se)}else if(_>=y)if(L)it(_,0,X,se,m);else if(a){const F=X/2,he=K+F;t.beginPath(),t.moveTo(_,he),t.lineTo(_,he-se),t.arc(N,he-se,F,ft,Ne),t.lineTo(_+X,he),Ze(m),t.fill()}else{const F=m?t.lineWidth:0;t.beginPath(),t.rect(_,K+F,X,-se-F),Ze(m),t.fill()}const ke=p.peak[l];if(ke>0&&ue&&!ne&&!c&&_>=y&&_<ve){if(m&&C>0?t.globalAlpha=1:d&&(t.globalAlpha=ke),(Q==Rt||q)&&st(ke),n){const F=Se(ke);F>=qe&&t.fillRect(_,K-F,X,Ke)}else if(!L)t.fillRect(_,K-ke*ye,X,2);else if(V!=Me){const F=ke*ye;it(_,F,X,!this._radialInvert||Y||F+k>=2?-2:2)}}}if(T){if(t.globalAlpha=1,V==Me){if(st(),L&&!u){if(R){let f;for(;f=He.pop();)t.lineTo(...le(...f,-1))}t.closePath()}if(C>0&&t.stroke(),fe>0){if(L){const f=u?Be(j>>1):0,p=u?Be(j):Ne;t.moveTo(...le(u?j>>1:0,0)),t.arc(U,z,k,f,p,u?!Te:!0)}else t.lineTo(ve,K),t.lineTo(y,K);t.globalAlpha=fe,t.fill(),t.globalAlpha=1}if((ne||L&&ue)&&(He=[],t.beginPath(),te.forEach((f,p)=>{let _=f.posX,N=f.peak[l],X=p?"lineTo":"moveTo";if(L&&_<0){const re=te[p+1];N=Ai(_,N,re.posX,re.peak[l],0),_=0}N*=ye,ne?(t[X](...L?le(_,N):[_,K-N]),L&&R&&!u&&He.push([_,N])):N>0&&it(_,N,1,-2)}),ne)){let f;for(;f=He.pop();)t.lineTo(...le(...f,-1));t.lineWidth=1,t.stroke()}}t.restore(),u&&!L&&t.setTransform(1,0,0,1,0,0),(!u&&!$||l)&&qt(l)}}if(zt(_t/(ut<<gt-1)),T&&(R&&!L&&!u&&(t.setTransform(-1,0,0,1,S.width-y,0),t.drawImage(S,y,0,U,S.height,0,0,U,S.height),t.setTransform(1,0,0,1,0,0)),t.setLineDash([]),Ht()),this.showFPS){const l=w.height;t.font=`bold ${l}px ${Ue}`,t.fillStyle=di,t.textAlign="right",t.fillText(Math.round(_e),S.width-l,l*2)}this.onCanvasDraw&&(t.save(),t.fillStyle=t.strokeStyle=Z[0],this.onCanvasDraw(this,{timestamp:e,canvasGradients:Z}),t.restore())}_freqScaling(e){switch(this._frequencyScale){case Ge:return Math.log2(e);case lt:return 26.81*e/(1960+e)-.53;case ht:return Math.log2(1+e/700);case Pe:return e}}_freqToBin(e,i="round"){const s=this._analyzer[0].frequencyBinCount-1,o=Math[i](e*this.fftSize/this.audioCtx.sampleRate);return o<s?o:s}_makeGrad(){if(!this._ready)return;const{canvas:e,_ctx:i,_radial:s,_reflexRatio:o}=this,{analyzerWidth:d,centerX:r,centerY:n,initialX:c,innerRadius:x,outerRadius:m}=this._aux,{isLumi:a}=this._flg,B=this._chLayout==we,D=1-o,U=a?e.height:e.height*(1-o*!B)|0;for(const z of[0,1]){const v=this._gradients[this._selectedGrads[z]],h=v.colorStops,A=v.dir=="h";let y;if(s?y=i.createRadialGradient(r,n,m,r,n,x-(m-x)*B):y=i.createLinearGradient(...A?[c,0,c+d,0]:[0,0,0,U]),h){const k=B&&!this._splitGradient&&(!A||s);for(let W=0;W<1+k;W++){const te=h.length-1;h.forEach((S,Z)=>{let H=S.pos;if(k&&(H/=2),B&&!a&&!s&&!A&&(H*=D,!k&&H>.5*D&&(H+=.5*o)),W==1)if(s||a){const Q=te-Z;S=h[Q],H=1-S.pos/2}else Z==0&&H>0&&y.addColorStop(.5,S.color),H+=.5;y.addColorStop(H,S.color),B&&Z==te&&H<.5&&y.addColorStop(.5,S.color)})}}this._canvasGradients[z]=y}}_normalizedB(e){const i=this._linearAmplitude,s=i?1/this._linearBoost:1,o=(c,x,m)=>c<=x?x:c>=m?m:c,d=c=>10**(c/20);let r=this.maxDecibels,n=this.minDecibels;return i&&(r=d(r),n=d(n),e=d(e)**s),o((e-n)/(r-n)**s,0,1)}_setCanvas(e){if(!this._ready)return;const{canvas:i,_ctx:s}=this,o=this._scaleX.canvas,d=window.devicePixelRatio/(this._loRes+1);let r=window.screen.width*d,n=window.screen.height*d;Math.abs(window.orientation)==90&&r<n&&([r,n]=[n,r]);const c=this.isFullscreen,x=c&&this._fsEl==i,m=x?r:(this._width||this._container.clientWidth||this._defaultWidth)*d|0,a=x?n:(this._height||this._container.clientHeight||this._defaultHeight)*d|0;this._pixelRatio=d,this._fsWidth=r,this._fsHeight=n,!(e!=Tt&&i.width==m&&i.height==a)&&(i.width=m,i.height=a,this.overlay||(s.fillStyle="#000",s.fillRect(0,0,m,a)),s.lineJoin="bevel",o.width=m,o.height=Math.max(20*d,Math.min(m,a)/32|0),this._calcBars(),this._makeGrad(),this._fsStatus!==void 0&&this._fsStatus!==c&&(e=Bt),this._fsStatus=c,this.onCanvasResize&&this.onCanvasResize(e,this))}_setGradient(e,i){if(!this._gradients.hasOwnProperty(e))throw new ce(yi,e);[0,1].includes(i)||(this._selectedGrads[1]=e,i=0),this._selectedGrads[i]=e,this._makeGrad()}_setProps(e,i){const s=["onCanvasDraw","onCanvasResize"],o=["gradientLeft","gradientRight","stereo"],d=Object.keys(ct).filter(r=>r!="start").concat(s,o);(i||e===void 0)&&(e={...ct,...e});for(const r of Object.keys(e))s.includes(r)&&typeof e[r]!="function"?this[r]=void 0:d.includes(r)&&(this[r]=e[r]);e.start!==void 0&&this.toggleAnalyzer(e.start)}}const Ti={class:"flex flex-col justify-center"},Bi={class:"fullscreen-container text-white max-h-90svh",id:"screen"},Ii=["width","height"],Oi={class:"absolute top-4 left-4 text-xl select-none"},Di={key:0,class:"i-la-play"},ki={key:1,class:"i-la-pause"},Ni={key:0,class:"i-la-arrow-left"},Mi={key:1,class:"i-la-arrow-down"},Fi=de("div",{class:"i-la-trash-alt"},null,-1),Gi=[Fi],qi={class:"flex items-center gap-2 px-2 flex-wrap"},Hi={class:"is-group flex flex-wrap gap-2 flex-1 p-2"},Pi={class:"max-w-120 scale-75 max-h-60 overflow-clip relative text-white"},zi=de("div",{class:"absolute p-2 opacity-70 touch-none select-none text-md"},"Right click here to enter Picture-In-Picture mode",-1),Xi={__name:"PitchSpectrogram",setup(ae){const e=at(),i=at(),{mic:s,input:o}=Xt(),d=at(!1);mt(" ",v=>{d.value=!d.value,v.preventDefault()}),mt("Enter",v=>{m(),v.preventDefault()});let r,n,c,x;function m(){n.fillStyle="#000",n.fillRect(0,0,a.width,a.height)}const a=Qt({initiated:!1,width:1600,height:1600,speed:Kt(()=>Math.floor(a.speedCount/100)),speedCount:Wt(100,100,500),vertical:nt("spectrogram-vertical",!1),pow:nt("spectrogram-power",1),offset:nt("spectrogram-offset",0)});function B(v){v.tap&&(d.value=!d.value),a.speedCount-=v.delta[0]/2}Jt(()=>{Vt(),r=document.getElementById("spectrogram"),n=r.getContext("2d"),c=document.createElement("canvas"),x=c.getContext("2d"),c.width=a.width,c.height=a.height,n.fillStyle="#000",n.fillRect(0,0,a.width,a.height);const v=r.captureStream();i.value.srcObject=v,i.value.play().then(()=>{var h,A;return(A=(h=i.value)==null?void 0:h.requestPictureInPicture)==null?void 0:A.call(h)}).catch(h=>console.error(h))});let D;function U(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(()=>{a.initiated=!0,D=new Ci(null,{mode:1,connectSpeakers:!1,volume:0,useCanvas:!1,source:Ut.meter,onCanvasDraw(v){if(d.value)return;x.drawImage(r,0,0,a.width,a.height);let h=v.getBars();for(let A=0;A<h.length;A++)n.fillStyle=z((h[A].freqLo+h[A].freqHi)/2,h[A].value[0]),a.vertical?n.fillRect(A*(a.width/h.length),0,a.width/h.length,a.speed):n.fillRect(a.width-a.speed,a.height-(A+1)*(a.height/h.length),a.speed,a.height/h.length);a.vertical?n.translate(0,a.speed):n.translate(-a.speed,0),n.drawImage(c,0,0,a.width,a.height),n.setTransform(1,0,0,1,0,0)}}),s.open=!0,D.connectInput(o)}).catch(v=>{console.log("mic denied",v)})}function z(v,h){let A=Math.pow(h+a.offset,a.pow);return`hsl(${$t(v)*30}, ${A*100}%, ${A*70}%)`}return(v,h)=>{const A=jt,y=Yt,k=Zt("drag");return Oe(),Fe("div",Ti,[de("div",Bi,[ei(de("canvas",{class:"h-full min-h-70svh w-full rounded-md cursor-pointer",id:"spectrogram",ref_key:"canvasElement",ref:e,width:a.width,height:a.height},null,8,Ii),[[k,B]]),a.initiated?ii("",!0):(Oe(),ti(A,{key:0,class:"absolute",onClick:h[0]||(h[0]=W=>U())})),de("div",Oi,"x"+si(a.speed),1),de("button",{class:"absolute bottom-4 left-4 text-xl select-none cursor-pointer",onMousedown:h[1]||(h[1]=W=>d.value=!d.value)},[d.value?(Oe(),Fe("div",Di)):(Oe(),Fe("div",ki))],32),de("button",{class:"absolute bottom-4 right-4 text-xl select-none cursor-pointer",onMousedown:h[2]||(h[2]=W=>a.vertical=!a.vertical)},[a.vertical?(Oe(),Fe("div",Mi)):(Oe(),Fe("div",Ni))],32),de("button",{class:"absolute top-4 right-4 text-xl select-none cursor-pointer",onMousedown:h[3]||(h[3]=W=>m())},Gi,32)]),de("div",qi,[de("div",Hi,[je(y,{modelValue:a.pow,"onUpdate:modelValue":h[4]||(h[4]=W=>a.pow=W),min:1,max:10,step:1,fixed:0,param:"POW"},null,8,["modelValue"]),je(y,{modelValue:a.offset,"onUpdate:modelValue":h[5]||(h[5]=W=>a.offset=W),min:-.5,max:.5,step:1e-4,param:"OFFSET",fixed:2},null,8,["modelValue"])]),de("div",Pi,[zi,de("video",{class:"max-h-50",ref_key:"video",ref:i},null,512)])])])}}},Ki=JSON.parse('{"title":"Spectrogram","description":"2.5D representation on frequency domain in time","frontmatter":{"title":"Spectrogram","description":"2.5D representation on frequency domain in time","layout":"app","date":"2022-06-16T00:00:00.000Z","cover":"spectrogram.png","usefulLinks":["https://codepen.io/hvianna/pen/ZEKWWJb","https://www.npmjs.com/package/audiomotion-analyzer","https://github.com/ListeningToWaves/SpectrogramTesting/blob/master/src/components/spectrogram.js"]},"headers":[],"relativePath":"practice/pitch/spectrogram/index.md","filePath":"practice/pitch/spectrogram/index.md","lastUpdated":1714021395000}'),Wi={name:"practice/pitch/spectrogram/index.md"},Vi=ri('<p>The colorful spectrogram is a powerful tool for visual audio analysis. Each particular frequency in the spectrum gets it&#39;s own position on the vertical axis along with the corresponding Chromatone color. The pitch spectrum is continous and the graph shows all the partials in a rather high resolution. The colors of the lines help differentiate pitches and overtones in any incoming audio signal. The quality of analysis is based primarily on the quality of the signal – thus a good microphone is recommended for best experience.</p><h2 id="how-to-use-the-spectrogram" tabindex="-1">How to use the spectrogram <a class="header-anchor" href="#how-to-use-the-spectrogram" aria-label="Permalink to &quot;How to use the spectrogram&quot;">​</a></h2><ol><li>Drag across <i class="p-3 mr-1 i-la-hand-rock"></i> the spectrogram top change the roll speed. The actual setting is at the top-left corner.</li><li>Press the <i class="p-3 mr-1 i-la-expand"></i> icon at the bottom-right corner make the spectrogram go full screen. Very useful mode for deep explorations and teaching.</li><li>You can pause <i class="p-3 mr-1 i-la-pause"></i> and resume <i class="p-3 mr-1 i-la-play"></i> the roll either by clicking anywhere at the spectrogram or by pressing the <code>Spacebar</code> button on your keyboard. Useful when comparing two or more sound spectrums – record a sound spectrum on the roll, then pause it, take another instrument and record another. The roll can fit up to 10 segments or even more.</li><li>Clear the canvas with the <i class="p-3 mr-1 i-la-trash-alt"></i> button at the top-right corner or by pressing the <code>Enter</code> button on your keyboard.</li><li>POW control changes the Power to which we raise the value of each band. It accentuates louder frequencies and dampens noise.</li><li>OFFSET control is for tuning the values before the raising to the power. It can help adjust the brightness and sensitivity of the spectroscope.</li><li>Right click the small video to open the spectrogram in Picture-In-Picture mode. You may need to press play in the floating window to see the spectrogram running.</li></ol>',3);function Ui(ae,e,i,s,o,d){const r=Xi,n=oi("client-only");return Oe(),Fe("div",null,[je(n,null,{default:ni(()=>[je(r,{class:"mb-20"})]),_:1}),Vi])}const Ji=ai(Wi,[["render",Ui]]);export{Ki as __pageData,Ji as default};
