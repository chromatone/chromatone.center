import{F as it,u as ot,ax as i,az as dt,as as V,E as O,ar as rt,aA as nt,n as at}from"./chunks/theme.DKUtGHOP.js";import{D as S,I as J,M as L,o as ut,_ as U,r as pt,q as x,t as z,u as e,f as m,s,v as $,F as B,Y as j,z as o,Z as T,$ as E,e as mt,l as A,aw as F,y as M,i as vt,j as xt}from"./chunks/framework.Bbwy4zmA.js";import{u as Y}from"./chunks/useElementary.kwxWhjY9.js";import{h as ft}from"./chunks/useDrums.SQopPSA4.js";function bt(u,l="es"){const p={},v={};for(let d in u){const t=u[d];if(p[d]=it(t?.nostore?t.value:ot(`${l}:${d}`,t.value),t.min,t.max),!t?.hidden){const y=d.split(":"),a=y.pop(),w=y.pop();v[w]=v[w]||{},v[w][a]=t}}const b=S(p),r=S(v),c=S({});return J(b,()=>{for(let d in b)c[d]=i.smooth(i.tau2pole(u[d]?.smooth||.01),i.const({key:`${l}:${d}`,value:b[d]}))},{immediate:!0}),{controls:b,cv:c,groups:r,params:u}}const G={"time:bpm":{value:120,min:30,max:250,step:1,smooth:.1},"time:steps":{value:4,min:1,max:16,step:1},"time:click":{value:0,min:0,max:1,step:1,hidden:!0},"time:volume":{value:0,min:0,max:1,step:.001},"time:playing":{value:0,nostore:!0,hidden:!0}},{controls:D,groups:gt,cv:H}=bt(G,"time"),{audio:Z,meters:ct,render:yt}=Y(),N=L(()=>Object.fromEntries(Object.entries(ct).filter(u=>u[0].startsWith("time:")).map(u=>[u[0].slice(5),u[1].max]).sort((u,l)=>u[0]<l[0]?0:1))),f=S({started:0,paused:0,play(){f.started===0?f.started=N.value.seconds:f.paused!==0&&(f.started+=N.value.seconds-f.paused,f.paused=0)},pause(){f.started!==0&&f.paused===0&&(f.paused=N.value.seconds)},stop(){f.started!==0&&(f.started=0,f.paused=0)}});function n(u,l){return i.meter({name:`time:${u}`},l)}const wt=L(()=>{let u=n("time",i.time()),l=i.meter({name:"time:sample-rate"},i.sr()),p=n("pitch",i.mod(i.const({key:"time:pitch",value:dt(D["time:bpm"]/60)}),12)),v=n("seconds",i.div(u,l)),b=n("minutes",i.div(v,60)),r=n("hours",i.div(b,60)),c=n("start",i.const({key:"time:start",value:f.started})),d=n("pause",i.const({key:"time:pause",value:f.paused})),t=n("isStarted",i.ge(c,0)),y=n("isPaused",i.ge(d,0)),a=n("isPlaying",i.and(t,i.sub(1,y))),w=n("current",i.select(t,i.select(y,i.sub(d,c),i.sub(v,c)),0)),k=n("bpm",H["time:bpm"]),g=n("bps",i.div(k,60)),h=n("beats",i.mul(w,g)),C=n("beat",i.mod(h,1)),P=n("pulse",i.le(C,.5)),I=n("steps",H["time:steps"]),Q=i.meter({name:"time:measures"},i.div(h,I)),X=i.meter({name:"time:measure"},i.mod(Q,1)),_=n("step",i.mod(h,I)),W=n("step-num",i.floor(_)),tt=n("step-first",i.le(W,1)),q=n("step-even",i.mod(W,2)),st=n("step-odd",i.eq(q,0)),et=ft(p,i.add(1e3,i.mul(1500,q)),.001,i.add(.01,i.mul(.06,tt)),i.mul(D["time:click"],P)),R=i.mul(H["time:volume"],et),lt=i.mul(0,i.add(X,p,st,P,w,a,b,r));return[R,i.add(R,lt)]});function K(){return ut(()=>{J([D,f],()=>{Z.layers.time={signal:wt.value,volume:1},Z.started=!1,yt("time")},{immediate:!0})}),{controls:D,groups:gt,params:G,time:N,transport:f}}const kt={key:0,class:"flex flex-col gap-2 bg-light-200 bg-opacity-40 dark-bg-dark-400 dark-bg-opacity-40 backdrop-blur pt-2 px-2 rounded-xl shadow-xl border-1 border-dark-200 border-opacity-20 dark-border-light-200 dark-border-opacity-30",id:"screen"},$t=["viewBox"],ht=["width","height"],Ct={class:"beats"},Mt=["transform"],St=["width","height","fill"],Ft=["stroke","y2"],Pt=["x","y","font-size","fill","font-weight"],Bt={class:"progress"},Nt=["fill","width","height"],zt=["x1","x2","y2"],Dt={class:"flex flex-wrap m-2 flex flex-wrap gap-4"},Vt={class:"is-group items-center flex p-2 flex-wrap",style:{flex:"160px"}},jt={key:0,class:"i-la-play"},Tt={key:1,class:"i-la-pause"},Et={key:0,class:"i-la-volume-up"},Ht={key:1,class:"i-la-volume-mute"},Ot={class:"p-2"},At={__name:"Metronome",setup(u){const{time:l,controls:p,groups:v,transport:b}=K(),r=S({width:100,height:22}),{audio:c}=Y(),d=L(()=>Math.round(p["time:steps"])),t=pt(!1);return(y,a)=>{const w=rt;return e(c)?.started?(m(),x("div",kt,[s("div",{class:"p-1 rounded-full",style:$({backgroundColor:e(l).pulse?"currentColor":"transparent"})},null,4),(m(),x("svg",{class:"w-full rounded select-none",viewBox:`0 0 ${r.width} ${r.height}`},[s("rect",{fill:"#8881",stroke:"#aaa","stroke-width":".2",width:r.width,height:r.height},null,8,ht),s("g",Ct,[(m(!0),x(B,null,j(d.value,(k,g)=>(m(),x("g",{class:"beat",key:g,transform:`translate(${g*r.width/d.value},0)`},[s("rect",{width:r.width/d.value,height:r.height,fill:g!=Math.floor(e(l).step)?"#6662":e(V)(g+e(l).pitch/12*d.value,d.value,1)},null,8,St),s("line",{stroke:e(V)(g+e(l).pitch/12*d.value,d.value),"stroke-width":".3",y2:r.height},null,8,Ft),s("text",{x:2-d.value/10,y:r.height-2,"font-size":16-d.value/1.5,fill:g==Math.floor(e(l).step)?"currentColor":e(V)(g+e(l).pitch/12*d.value,d.value,1),"font-weight":g==Math.floor(e(l).step)?"bold":"normal"},o(k),9,Pt)],8,Mt))),128))]),s("g",Bt,[s("rect",{fill:e(O)(e(l).pitch),"fill-opacity":".2",width:e(l).measure*r.width,height:r.height},null,8,Nt),s("line",{stroke:"currentColor","stroke-width":"1",x1:e(l).measure*r.width,x2:e(l).measure*r.width,y2:r.height},null,8,zt)])],8,$t)),s("div",Dt,[s("div",Vt,[T(s("button",{class:"text-button",onClick:a[0]||(a[0]=k=>e(l).isPlaying?e(b).pause():e(b).play())},[e(l).isPlaying?(m(),x("div",Tt)):(m(),x("div",jt))],512),[[E,t.value]]),T(s("button",{class:"text-button",onClick:a[1]||(a[1]=k=>e(b).stop())},a[3]||(a[3]=[s("div",{class:"i-la-stop"},null,-1)]),512),[[E,t.value]]),s("button",{class:"text-button",onClick:a[2]||(a[2]=k=>{t.value=!0,e(p)["time:click"]=e(p)["time:click"]?0:1})},[e(p)["time:click"]?(m(),x("div",Et)):(m(),x("div",Ht))]),T(s("div",Ot,"Press to start",512),[[E,!t.value]])]),(m(!0),x(B,null,j(e(v),(k,g)=>(m(),x("div",{class:"is-group flex flex-wrap items-center",style:{flex:"180px"},key:g},[(m(!0),x(B,null,j(k,(h,C)=>(m(),x("div",{class:"select-none relative flex flex-col gap-4 items-center",key:C},[C!="click"?(m(),mt(w,{key:0,min:h.min,max:h.max,step:h.step,modelValue:e(p)[`${g}:${C}`],"onUpdate:modelValue":P=>e(p)[`${g}:${C}`]=P,param:String(C)},null,8,["min","max","step","modelValue","onUpdate:modelValue","param"])):z("",!0)]))),128))]))),128))])])):z("",!0)}}},Lt=U(At,[["__scopeId","data-v-112010e9"]]),Ut={class:"flex flex-wrap",style:{flex:"1 1 350px"}},Yt={class:"sheet"},It={class:"p-0 font-bold"},Wt={class:"p-0 font-bold"},qt={class:"p-0 font-bold"},Rt={class:"p-0 font-bold"},Zt={class:"sheet"},Jt={class:"p-0 font-bold"},Gt={class:"p-0 font-bold"},Kt={class:"p-0 font-bold"},Qt={class:"sheet"},Xt={class:"row"},_t={key:0,class:"col-span-3 flex flex-wrap m-2 flex flex-wrap justify-center"},ts={class:"p-0 font-bold"},ss={class:"p-0 font-bold"},es={class:"p-0 font-bold"},ls={class:"sheet"},is={class:"p-0 font-bold flex items-center gap-2 justify-center"},os={class:"p-0"},ds={class:"p-0 font-bold"},rs={class:"text-left text-sm"},ns={class:"p-0 font-bold"},as={class:"p-0 font-bold"},us={class:"sheet"},ps={class:"p-0 font-bold flex items-center gap-2 justify-center"},ms={class:"p-0"},vs={class:"p-0 font-bold"},xs={class:"p-0 font-bold relative"},fs={class:"p-0 font-bold relative"},bs={__name:"Math",setup(u){const{time:l,controls:p,transport:v}=K();S({width:100,height:5});const{render:b,audio:r}=Y(),c=nt(()=>r.started,"YYYY MMM DD @ HH:MM:ss  ");return(d,t)=>{const y=Lt;return m(),x(B,null,[e(r).started?z("",!0):(m(),x("div",{key:0,class:"absolute top-18 bg-light-200 p-8 z-200 w-full cursor-pointer rounded-lg text-xl font-bold border-1 dark-bg-dark-400",onClick:t[0]||(t[0]=a=>e(b)())},"Click to start watching time passing")),s("div",{class:"p-2 flex flex-wrap gap-4 font-mono items-stretc w-full",onClick:t[8]||(t[8]=a=>e(b)()),style:$({opacity:e(r)?.started?1:.4})},[s("div",Ut,[t[9]||(t[9]=s("h2",null,"From samples to beats and measures",-1)),A(y,{class:"sticky top-2 z-100 w-full"})]),s("div",Yt,[t[10]||(t[10]=s("div",{class:"row"},"We start a timer ever increasing at a fixed rate ",-1)),t[11]||(t[11]=s("div",{class:"text-right"},"Local time: ",-1)),s("div",It,o(e(c)),1),t[12]||(t[12]=s("div",{class:"text-left text-sm"},"seconds ",-1)),t[13]||(t[13]=s("div",{class:"text-right"},"Unix time: ",-1)),s("div",Wt,o(Number(e(r)?.started).toLocaleString()),1),t[14]||(t[14]=s("div",{class:"text-left text-sm"},"milliseconds",-1)),t[15]||(t[15]=s("div",{class:"text-right"},"Sample Rate: ",-1)),s("div",qt,o(Number(e(l)?.["sample-rate"]||44100).toLocaleString()),1),t[16]||(t[16]=s("div",{class:"text-left text-sm"},"samples per second",-1)),t[17]||(t[17]=s("div",{class:"text-right"},"Timer: ",-1)),s("div",Rt,o(Number(e(l)?.time||0).toLocaleString()),1),t[18]||(t[18]=s("div",{class:"text-left text-sm"},"samples",-1))]),s("div",Zt,[t[19]||(t[19]=s("div",{class:"row"},"Divide the sample count by the sample rate to get elapsed seconds ",-1)),t[20]||(t[20]=s("div",{class:"text-right"},"Seconds: ",-1)),s("div",Jt,o(e(l)?.seconds?.toFixed(2)||0),1),t[21]||(t[21]=s("div",{class:"text-left text-sm"},"seconds",-1)),t[22]||(t[22]=s("div",{class:"text-right"},"Minutes:",-1)),s("div",Gt,o(e(l)?.minutes?.toFixed(2)||0),1),t[23]||(t[23]=s("div",{class:"text-left text-sm"},"seconds / 60",-1)),t[24]||(t[24]=s("div",{class:"text-right"},"Hours:",-1)),s("div",Kt,o(e(l)?.hours?.toFixed(2)||0),1),t[25]||(t[25]=s("div",{class:"text-left text-sm"},"minutes / 60",-1))]),s("div",Qt,[s("div",Xt,[t[29]||(t[29]=F("We need a playable and pausable transport time ")),e(r)?.started?(m(),x("div",_t,[s("button",{class:"text-button",onClick:t[1]||(t[1]=a=>e(v).play())},t[26]||(t[26]=[s("div",{class:"i-la-play"},null,-1)])),s("button",{class:"text-button",onClick:t[2]||(t[2]=a=>e(v).pause())},t[27]||(t[27]=[s("div",{class:"i-la-pause"},null,-1)])),s("button",{class:"text-button",onClick:t[3]||(t[3]=a=>e(v).stop())},t[28]||(t[28]=[s("div",{class:"i-la-stop"},null,-1)]))])):z("",!0)]),t[30]||(t[30]=s("div",{class:"text-right"},"Started At:",-1)),s("div",ts,o(e(v)?.started?.toFixed(2)||0),1),t[31]||(t[31]=s("div",{class:"text-left text-sm"},"seconds",-1)),t[32]||(t[32]=s("div",{class:"text-right"},"Paused At:",-1)),s("div",ss,o(e(v)?.paused?.toFixed(2)||0),1),t[33]||(t[33]=s("div",{class:"text-left text-sm"},"seconds",-1)),t[34]||(t[34]=s("div",{class:"text-right"},"Started:",-1)),s("div",{class:M(["p-0 font-bold",{active:e(l)?.isStarted}])},o(e(l)?.isStarted),3),t[35]||(t[35]=s("div",{class:"text-left text-sm"},"Started > 0 ?",-1)),t[36]||(t[36]=s("div",{class:"text-right"},"Paused:",-1)),s("div",{class:M(["p-0 font-bold",{active:e(l)?.isPaused}])},o(e(l)?.isPaused),3),t[37]||(t[37]=s("div",{class:"text-left text-sm"},"Paused > 0 ?",-1)),t[38]||(t[38]=s("div",{class:"text-right"},"Playing:",-1)),s("div",{class:M(["p-0 font-bold",{active:e(l)?.isPlaying}])},o(e(l)?.isPlaying),3),t[39]||(t[39]=s("div",{class:"text-left text-sm"},"Started & Not Paused",-1)),t[40]||(t[40]=s("div",{class:"row"},"Now we just subtract current time from start/pause time",-1)),t[41]||(t[41]=s("div",{class:"text-right"},"Transport time:",-1)),s("div",es,o(e(l)?.current?.toFixed(2)),1),t[42]||(t[42]=s("div",{class:"text-left text-sm"},"seconds",-1))]),s("div",ls,[t[45]||(t[45]=s("div",{class:"row"},"We want musical time, so we need to set a beat rate",-1)),t[46]||(t[46]=s("div",{class:"text-right"},"BPM:",-1)),s("div",is,[s("button",{onClick:t[4]||(t[4]=a=>e(p)["time:bpm"]--)},t[43]||(t[43]=[s("div",{class:"i-la-minus"},null,-1)])),s("div",os,o(e(l)?.bpm?.toFixed(1)||120),1),s("button",{onClick:t[5]||(t[5]=a=>e(p)["time:bpm"]++)},t[44]||(t[44]=[s("div",{class:"i-la-plus"},null,-1)]))]),t[47]||(t[47]=s("div",{class:"text-left text-sm"},"beats per minute",-1)),t[48]||(t[48]=s("div",{class:"text-right"},"BPS:",-1)),s("div",ds,o(e(l)?.bps?.toFixed(1)||2),1),t[49]||(t[49]=s("div",{class:"text-left text-sm"},"Hz",-1)),t[50]||(t[50]=s("div",{class:"text-right"},"Pitch:",-1)),s("div",{class:"p-0 font-bold relative",style:$({backgroundColor:e(O)(e(l)?.pitch+12,3,1,.5)})},[F(o(((e(l)?.pitch+12||2)*100).toFixed(1)),1),s("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${(e(l)?.pitch+12||2)*100/12}%`})},null,4)],4),t[51]||(t[51]=s("div",{class:"text-left text-sm"},"cents",-1)),t[52]||(t[52]=s("div",{class:"text-right"},"Note:",-1)),s("div",{class:"p-0 font-bold relative",style:$({color:e(O)(e(l)?.pitch+12,3)})},[F(o(e(at)[Math.round(e(l)?.pitch+12)%12]),1),s("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${50+100*((e(l)?.pitch+12)%12-Math.round(e(l)?.pitch+12)%12)}%`})},null,4)],4),s("div",rs,o((100*((e(l)?.pitch+12)%12-Math.round(e(l)?.pitch+12)%12)).toFixed(2))+" %",1),t[53]||(t[53]=s("div",{class:"row"},"Now we can calculate beats elapsed, beat progress and generate pulse",-1)),t[54]||(t[54]=s("div",{class:"text-right"},"Beats:",-1)),s("div",ns,o(e(l)?.beats?.toFixed(1)||0),1),t[55]||(t[55]=s("div",{class:"text-left text-sm"},"beats",-1)),t[56]||(t[56]=s("div",{class:"text-right"},"Beat progress:",-1)),s("div",as,o(e(l)?.beat?.toFixed(4)||0),1),t[57]||(t[57]=s("div",{class:"text-left text-sm"},"Beats % 1",-1)),t[58]||(t[58]=s("div",{class:"text-right"},"Pulse:",-1)),s("div",{class:M(["p-0 font-bold",{active:e(l)?.pulse}])},o(e(l)?.pulse||0),3),t[59]||(t[59]=s("div",{class:"text-left text-sm"},"Beat < 0.5 ?",-1))]),s("div",us,[t[62]||(t[62]=s("div",{class:"row"},"Musical rhythm has a pattern of strong and weak beats in a measure",-1)),t[63]||(t[63]=s("div",{class:"text-right"},"Beats per measure:",-1)),s("div",ps,[s("button",{onClick:t[6]||(t[6]=a=>e(p)["time:steps"]--)},t[60]||(t[60]=[s("div",{class:"i-la-minus"},null,-1)])),s("div",ms,o(e(l)?.steps?.toFixed(0)||4),1),s("button",{onClick:t[7]||(t[7]=a=>e(p)["time:steps"]++)},t[61]||(t[61]=[s("div",{class:"i-la-plus"},null,-1)]))]),t[64]||(t[64]=s("div",{class:"text-left text-sm"},"beats",-1)),t[65]||(t[65]=s("div",{class:"text-right"},"Measures:",-1)),s("div",vs,o(e(l)?.measures?.toFixed(4)||0),1),t[66]||(t[66]=s("div",{class:"text-left text-sm"},"measures",-1)),t[67]||(t[67]=s("div",{class:"row"},"Now we can get our musical time coordinates",-1)),t[68]||(t[68]=s("div",{class:"text-right"},"Measure progress:",-1)),s("div",xs,[F(o(e(l)?.measure?.toFixed(4)||0),1),s("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${e(l)?.measure*100}%`})},null,4)]),t[69]||(t[69]=s("div",{class:"text-left text-sm"},"Measures % 1",-1)),t[70]||(t[70]=s("div",{class:"text-right"},"Step:",-1)),s("div",fs,[F(o(e(l)?.["step-num"]+1||0)+" / "+o(e(l)?.steps?.toFixed(0)||4),1),s("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${e(l)?.["step-num"]/e(l)?.steps?.toFixed(0)*100}%`})},null,4)]),t[71]||(t[71]=s("div",{class:"text-left text-sm"},"Beats / Beats per measure",-1)),t[72]||(t[72]=s("div",{class:"text-right"},"First step:",-1)),s("div",{class:M(["p-0 font-bold",{active:e(l)?.["step-first"]}])},o(e(l)?.["step-first"]),3),t[73]||(t[73]=s("div",{class:"text-left text-sm"},"Step == 1?",-1)),t[74]||(t[74]=s("div",{class:"text-right"},"Odd step:",-1)),s("div",{class:M(["p-0 font-bold",{active:e(l)?.["step-odd"]}])},o(e(l)?.["step-odd"]),3),t[75]||(t[75]=s("div",{class:"text-left text-sm"},"Step % 2?",-1)),t[76]||(t[76]=s("div",{class:"text-right"},"Even step:",-1)),s("div",{class:M(["p-0 font-bold",{active:e(l)?.["step-even"]}])},o(e(l)?.["step-even"]),3),t[77]||(t[77]=s("div",{class:"text-left text-sm"},"Not Odd",-1))])],4)],64)}}},gs=U(bs,[["__scopeId","data-v-5055e139"]]),Cs=JSON.parse('{"title":"Musical transport","description":"How we subdivide time to have a rhythm","frontmatter":{"title":"Musical transport","description":"How we subdivide time to have a rhythm","date":"2018-10-30T00:00:00.000Z","layout":"app","cover":"cover.png","links":"https://discord.com/channels/826071713426178078/834787928688689172/1127958693695205387"},"headers":[],"relativePath":"practice/rhythm/time/index.md","filePath":"practice/rhythm/time/index.md","lastUpdated":1752981864000}'),cs={name:"practice/rhythm/time/index.md"};function ys(u,l,p,v,b,r){const c=gs,d=vt("client-only");return m(),x("div",null,[A(d,null,{default:xt(()=>[A(c)]),_:1})])}const Ms=U(cs,[["render",ys]]);export{Cs as __pageData,Ms as default};
