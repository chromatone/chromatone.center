import{D as Gt,as as i,au as Qt,an as Y,C as Z,am as Zt,n as Kt}from"./chunks/theme.CwHwVffe.js";import{E as Xt,H as B,J as Yt,G as X,o as _t,_,r as ts,q as x,t as R,u as e,f as m,s,v as M,F as A,Q as q,z as o,R as J,S as G,e as ss,aM as es,l as K,aI as V,y as F,i as ls,j as is}from"./chunks/framework.D01lOa8K.js";import{u as tt}from"./chunks/useElementary.DH9zyn99.js";import{h as os}from"./chunks/useDrums.CxydI1Nm.js";function ds(u,l="es"){const p={},v={};for(let n in u){const t=u[n];if(p[n]=Gt(t!=null&&t.nostore?t.value:Xt(`${l}:${n}`,t.value),t.min,t.max),!(t!=null&&t.hidden)){const $=n.split(":"),g=$.pop(),y=$.pop();v[y]=v[y]||{},v[y][g]=t}}const b=B(p),d=B(v),c=B({});return Yt(b,()=>{var n;for(let t in b)c[t]=i.smooth(i.tau2pole(((n=u[t])==null?void 0:n.smooth)||.01),i.const({key:`${l}:${t}`,value:b[t]}))},{immediate:!0}),{controls:b,cv:c,groups:d,params:u}}const qt={"time:bpm":{value:120,min:30,max:250,step:1,smooth:.1},"time:steps":{value:4,min:1,max:16,step:1},"time:click":{value:0,min:0,max:1,step:1,hidden:!0},"time:volume":{value:0,min:0,max:1,step:.001},"time:playing":{value:0,nostore:!0,hidden:!0}},{controls:W,groups:ns,cv:Q}=ds(qt,"time"),{audio:Wt,meters:rs,render:as}=tt(),I=X(()=>Object.fromEntries(Object.entries(rs).filter(u=>u[0].startsWith("time:")).map(u=>[u[0].slice(5),u[1].max]).sort((u,l)=>u[0]<l[0]?0:1))),f=B({started:0,paused:0,play(){f.started===0?f.started=I.value.seconds:f.paused!==0&&(f.started+=I.value.seconds-f.paused,f.paused=0)},pause(){f.started!==0&&f.paused===0&&(f.paused=I.value.seconds)},stop(){f.started!==0&&(f.started=0,f.paused=0)}});function r(u,l){return i.meter({name:`time:${u}`},l)}const us=X(()=>{let u=r("time",i.time()),l=i.meter({name:"time:sample-rate"},i.sr()),p=r("pitch",i.mod(i.const({key:"time:pitch",value:Qt(W["time:bpm"]/60)}),12)),v=r("seconds",i.div(u,l)),b=r("minutes",i.div(v,60)),d=r("hours",i.div(b,60)),c=r("start",i.const({key:"time:start",value:f.started})),n=r("pause",i.const({key:"time:pause",value:f.paused})),t=r("isStarted",i.ge(c,0)),$=r("isPaused",i.ge(n,0)),g=r("isPlaying",i.and(t,i.sub(1,$))),y=r("current",i.select(t,i.select($,i.sub(n,c),i.sub(v,c)),0)),S=r("bpm",Q["time:bpm"]),w=r("bps",i.div(S,60)),a=r("beats",i.mul(y,w)),h=r("beat",i.mod(a,1)),k=r("pulse",i.le(h,.5)),P=r("steps",Q["time:steps"]),j=i.meter({name:"time:measures"},i.div(a,P)),H=i.meter({name:"time:measure"},i.mod(j,1)),T=r("step",i.mod(a,P)),N=r("step-num",i.floor(T)),E=r("step-first",i.le(N,1)),z=r("step-even",i.mod(N,2)),O=r("step-odd",i.eq(z,0)),L=os(p,i.add(1e3,i.mul(1500,z)),.001,i.add(.01,i.mul(.06,E)),i.mul(W["time:click"],k)),D=i.mul(Q["time:volume"],L),U=i.mul(0,i.add(H,p,O,k,y,g,b,d));return[D,i.add(D,U)]});function Jt(){return _t(()=>{Yt([W,f],()=>{Wt.layers.time={signal:us.value,volume:1},Wt.started=!1,as("time")},{immediate:!0})}),{controls:W,groups:ns,params:qt,time:I,transport:f}}const ps={key:0,class:"flex flex-col gap-2 bg-light-200 bg-opacity-40 dark-bg-dark-400 dark-bg-opacity-40 backdrop-blur pt-2 px-2 rounded-xl shadow-xl border-1 border-dark-200 border-opacity-20 dark-border-light-200 dark-border-opacity-30",id:"screen"},ms=["viewBox"],vs=["width","height"],xs={class:"beats"},fs=["transform"],bs=["width","height","fill"],gs=["stroke","y2"],cs=["x","y","font-size","fill","font-weight"],ys={class:"progress"},ws=["fill","width","height"],ks=["x1","x2","y2"],$s={class:"flex flex-wrap m-2 flex flex-wrap gap-4"},hs={class:"is-group items-center flex p-2 flex-wrap",style:{flex:"160px"}},Cs={key:0,class:"i-la-play"},Ms={key:1,class:"i-la-pause"},Ss={key:0,class:"i-la-volume-up"},Ps={key:1,class:"i-la-volume-mute"},Fs={class:"p-2"},Bs={__name:"Metronome",setup(u){const{time:l,controls:p,groups:v,transport:b}=Jt(),d=B({width:100,height:22}),{audio:c}=tt(),n=X(()=>Math.round(p["time:steps"])),t=ts(!1);return($,g)=>{var S;const y=Zt;return(S=e(c))!=null&&S.started?(m(),x("div",ps,[s("div",{class:"p-1 rounded-full",style:M({backgroundColor:e(l).pulse?"currentColor":"transparent"})},null,4),(m(),x("svg",{class:"w-full rounded select-none",viewBox:`0 0 ${d.width} ${d.height}`},[s("rect",{fill:"#8881",stroke:"#aaa","stroke-width":".2",width:d.width,height:d.height},null,8,vs),s("g",xs,[(m(!0),x(A,null,q(n.value,(w,a)=>(m(),x("g",{class:"beat",key:a,transform:`translate(${a*d.width/n.value},0)`},[s("rect",{width:d.width/n.value,height:d.height,fill:a!=Math.floor(e(l).step)?"#6662":e(Y)(a+e(l).pitch/12*n.value,n.value,1)},null,8,bs),s("line",{stroke:e(Y)(a+e(l).pitch/12*n.value,n.value),"stroke-width":".3",y2:d.height},null,8,gs),s("text",{x:2-n.value/10,y:d.height-2,"font-size":16-n.value/1.5,fill:a==Math.floor(e(l).step)?"currentColor":e(Y)(a+e(l).pitch/12*n.value,n.value,1),"font-weight":a==Math.floor(e(l).step)?"bold":"normal"},o(w),9,cs)],8,fs))),128))]),s("g",ys,[s("rect",{fill:e(Z)(e(l).pitch),"fill-opacity":".2",width:e(l).measure*d.width,height:d.height},null,8,ws),s("line",{stroke:"currentColor","stroke-width":"1",x1:e(l).measure*d.width,x2:e(l).measure*d.width,y2:d.height},null,8,ks)])],8,ms)),s("div",$s,[s("div",hs,[J(s("button",{class:"text-button",onClick:g[0]||(g[0]=w=>e(l).isPlaying?e(b).pause():e(b).play())},[e(l).isPlaying?(m(),x("div",Ms)):(m(),x("div",Cs))],512),[[G,t.value]]),J(s("button",{class:"text-button",onClick:g[1]||(g[1]=w=>e(b).stop())},g[3]||(g[3]=[s("div",{class:"i-la-stop"},null,-1)]),512),[[G,t.value]]),s("button",{class:"text-button",onClick:g[2]||(g[2]=w=>{t.value=!0,e(p)["time:click"]=e(p)["time:click"]?0:1})},[e(p)["time:click"]?(m(),x("div",Ss)):(m(),x("div",Ps))]),J(s("div",Fs,"Press to start",512),[[G,!t.value]])]),(m(!0),x(A,null,q(e(v),(w,a)=>(m(),x("div",{class:"is-group flex flex-wrap items-center",style:{flex:"180px"},key:a},[(m(!0),x(A,null,q(w,(h,k)=>(m(),x("div",{class:"select-none relative flex flex-col gap-4 items-center",key:k},[k!="click"?(m(),ss(y,{key:0,min:h.min,max:h.max,step:h.step,modelValue:e(p)[`${a}:${k}`],"onUpdate:modelValue":P=>e(p)[`${a}:${k}`]=P,param:String(k)},null,8,["min","max","step","modelValue","onUpdate:modelValue","param"])):R("",!0)]))),128))]))),128))])])):R("",!0)}}},Ns=_(Bs,[["__scopeId","data-v-112010e9"]]),zs={class:"flex flex-wrap",style:{flex:"1 1 350px"}},Ds={class:"sheet"},Vs={class:"p-0 font-bold"},js={class:"p-0 font-bold"},Hs={class:"p-0 font-bold"},Ts={class:"p-0 font-bold"},Es={class:"sheet"},Os={class:"p-0 font-bold"},Ls={class:"p-0 font-bold"},Us={class:"p-0 font-bold"},As={class:"sheet"},Is={class:"row"},Rs={key:0,class:"col-span-3 flex flex-wrap m-2 flex flex-wrap justify-center"},Ws={class:"p-0 font-bold"},Ys={class:"p-0 font-bold"},qs={class:"p-0 font-bold"},Js={class:"sheet"},Gs={class:"p-0 font-bold flex items-center gap-2 justify-center"},Qs={class:"p-0"},Zs={class:"p-0 font-bold"},Ks={class:"text-left text-sm"},Xs={class:"p-0 font-bold"},_s={class:"p-0 font-bold"},te={class:"sheet"},se={class:"p-0 font-bold flex items-center gap-2 justify-center"},ee={class:"p-0"},le={class:"p-0 font-bold"},ie={class:"p-0 font-bold relative"},oe={class:"p-0 font-bold relative"},de={__name:"Math",setup(u){const{time:l,controls:p,transport:v}=Jt();B({width:100,height:5});const{render:b,audio:d}=tt(),c=es(()=>d.started,"YYYY MMM DD @ HH:MM:ss  ");return(n,t)=>{var g,y,S,w,a,h,k,P,j,H,T,N,E,z,O,L,D,U,st,et,lt,it,ot,dt,nt,rt,at,ut,pt,mt,vt,xt,ft,bt,gt,ct,yt,wt,kt,$t,ht,Ct,Mt,St,Pt,Ft,Bt,Nt,zt,Dt,Vt,jt,Ht,Tt,Et,Ot,Lt,Ut,At,It,Rt;const $=Ns;return m(),x(A,null,[e(d).started?R("",!0):(m(),x("div",{key:0,class:"absolute top-18 bg-light-200 p-8 z-200 w-full cursor-pointer rounded-lg text-xl font-bold border-1 dark-bg-dark-400",onClick:t[0]||(t[0]=C=>e(b)())},"Click to start watching time passing")),s("div",{class:"p-2 flex flex-wrap gap-4 font-mono items-stretc w-full",onClick:t[8]||(t[8]=C=>e(b)()),style:M({opacity:(g=e(d))!=null&&g.started?1:.4})},[s("div",zs,[t[9]||(t[9]=s("h2",null,"From samples to beats and measures",-1)),K($,{class:"sticky top-2 z-100 w-full"})]),s("div",Ds,[t[10]||(t[10]=s("div",{class:"row"},"We start a timer ever increasing at a fixed rate ",-1)),t[11]||(t[11]=s("div",{class:"text-right"},"Local time: ",-1)),s("div",Vs,o(e(c)),1),t[12]||(t[12]=s("div",{class:"text-left text-sm"},"seconds ",-1)),t[13]||(t[13]=s("div",{class:"text-right"},"Unix time: ",-1)),s("div",js,o(Number((y=e(d))==null?void 0:y.started).toLocaleString()),1),t[14]||(t[14]=s("div",{class:"text-left text-sm"},"milliseconds",-1)),t[15]||(t[15]=s("div",{class:"text-right"},"Sample Rate: ",-1)),s("div",Hs,o(Number(((S=e(l))==null?void 0:S["sample-rate"])||44100).toLocaleString()),1),t[16]||(t[16]=s("div",{class:"text-left text-sm"},"samples per second",-1)),t[17]||(t[17]=s("div",{class:"text-right"},"Timer: ",-1)),s("div",Ts,o(Number(((w=e(l))==null?void 0:w.time)||0).toLocaleString()),1),t[18]||(t[18]=s("div",{class:"text-left text-sm"},"samples",-1))]),s("div",Es,[t[19]||(t[19]=s("div",{class:"row"},"Divide the sample count by the sample rate to get elapsed seconds ",-1)),t[20]||(t[20]=s("div",{class:"text-right"},"Seconds: ",-1)),s("div",Os,o(((h=(a=e(l))==null?void 0:a.seconds)==null?void 0:h.toFixed(2))||0),1),t[21]||(t[21]=s("div",{class:"text-left text-sm"},"seconds",-1)),t[22]||(t[22]=s("div",{class:"text-right"},"Minutes:",-1)),s("div",Ls,o(((P=(k=e(l))==null?void 0:k.minutes)==null?void 0:P.toFixed(2))||0),1),t[23]||(t[23]=s("div",{class:"text-left text-sm"},"seconds / 60",-1)),t[24]||(t[24]=s("div",{class:"text-right"},"Hours:",-1)),s("div",Us,o(((H=(j=e(l))==null?void 0:j.hours)==null?void 0:H.toFixed(2))||0),1),t[25]||(t[25]=s("div",{class:"text-left text-sm"},"minutes / 60",-1))]),s("div",As,[s("div",Is,[t[29]||(t[29]=V("We need a playable and pausable transport time ")),(T=e(d))!=null&&T.started?(m(),x("div",Rs,[s("button",{class:"text-button",onClick:t[1]||(t[1]=C=>e(v).play())},t[26]||(t[26]=[s("div",{class:"i-la-play"},null,-1)])),s("button",{class:"text-button",onClick:t[2]||(t[2]=C=>e(v).pause())},t[27]||(t[27]=[s("div",{class:"i-la-pause"},null,-1)])),s("button",{class:"text-button",onClick:t[3]||(t[3]=C=>e(v).stop())},t[28]||(t[28]=[s("div",{class:"i-la-stop"},null,-1)]))])):R("",!0)]),t[30]||(t[30]=s("div",{class:"text-right"},"Started At:",-1)),s("div",Ws,o(((E=(N=e(v))==null?void 0:N.started)==null?void 0:E.toFixed(2))||0),1),t[31]||(t[31]=s("div",{class:"text-left text-sm"},"seconds",-1)),t[32]||(t[32]=s("div",{class:"text-right"},"Paused At:",-1)),s("div",Ys,o(((O=(z=e(v))==null?void 0:z.paused)==null?void 0:O.toFixed(2))||0),1),t[33]||(t[33]=s("div",{class:"text-left text-sm"},"seconds",-1)),t[34]||(t[34]=s("div",{class:"text-right"},"Started:",-1)),s("div",{class:F(["p-0 font-bold",{active:(L=e(l))==null?void 0:L.isStarted}])},o((D=e(l))==null?void 0:D.isStarted),3),t[35]||(t[35]=s("div",{class:"text-left text-sm"},"Started > 0 ?",-1)),t[36]||(t[36]=s("div",{class:"text-right"},"Paused:",-1)),s("div",{class:F(["p-0 font-bold",{active:(U=e(l))==null?void 0:U.isPaused}])},o((st=e(l))==null?void 0:st.isPaused),3),t[37]||(t[37]=s("div",{class:"text-left text-sm"},"Paused > 0 ?",-1)),t[38]||(t[38]=s("div",{class:"text-right"},"Playing:",-1)),s("div",{class:F(["p-0 font-bold",{active:(et=e(l))==null?void 0:et.isPlaying}])},o((lt=e(l))==null?void 0:lt.isPlaying),3),t[39]||(t[39]=s("div",{class:"text-left text-sm"},"Started & Not Paused",-1)),t[40]||(t[40]=s("div",{class:"row"},"Now we just subtract current time from start/pause time",-1)),t[41]||(t[41]=s("div",{class:"text-right"},"Transport time:",-1)),s("div",qs,o((ot=(it=e(l))==null?void 0:it.current)==null?void 0:ot.toFixed(2)),1),t[42]||(t[42]=s("div",{class:"text-left text-sm"},"seconds",-1))]),s("div",Js,[t[45]||(t[45]=s("div",{class:"row"},"We want musical time, so we need to set a beat rate",-1)),t[46]||(t[46]=s("div",{class:"text-right"},"BPM:",-1)),s("div",Gs,[s("button",{onClick:t[4]||(t[4]=C=>e(p)["time:bpm"]--)},t[43]||(t[43]=[s("div",{class:"i-la-minus"},null,-1)])),s("div",Qs,o(((nt=(dt=e(l))==null?void 0:dt.bpm)==null?void 0:nt.toFixed(1))||120),1),s("button",{onClick:t[5]||(t[5]=C=>e(p)["time:bpm"]++)},t[44]||(t[44]=[s("div",{class:"i-la-plus"},null,-1)]))]),t[47]||(t[47]=s("div",{class:"text-left text-sm"},"beats per minute",-1)),t[48]||(t[48]=s("div",{class:"text-right"},"BPS:",-1)),s("div",Zs,o(((at=(rt=e(l))==null?void 0:rt.bps)==null?void 0:at.toFixed(1))||2),1),t[49]||(t[49]=s("div",{class:"text-left text-sm"},"Hz",-1)),t[50]||(t[50]=s("div",{class:"text-right"},"Pitch:",-1)),s("div",{class:"p-0 font-bold relative",style:M({backgroundColor:e(Z)(((ut=e(l))==null?void 0:ut.pitch)+12,3,1,.5)})},[V(o(((((pt=e(l))==null?void 0:pt.pitch)+12||2)*100).toFixed(1)),1),s("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:M({width:`${(((mt=e(l))==null?void 0:mt.pitch)+12||2)*100/12}%`})},null,4)],4),t[51]||(t[51]=s("div",{class:"text-left text-sm"},"cents",-1)),t[52]||(t[52]=s("div",{class:"text-right"},"Note:",-1)),s("div",{class:"p-0 font-bold relative",style:M({color:e(Z)(((vt=e(l))==null?void 0:vt.pitch)+12,3)})},[V(o(e(Kt)[Math.round(((xt=e(l))==null?void 0:xt.pitch)+12)%12]),1),s("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:M({width:`${50+100*((((ft=e(l))==null?void 0:ft.pitch)+12)%12-Math.round(((bt=e(l))==null?void 0:bt.pitch)+12)%12)}%`})},null,4)],4),s("div",Ks,o((100*((((gt=e(l))==null?void 0:gt.pitch)+12)%12-Math.round(((ct=e(l))==null?void 0:ct.pitch)+12)%12)).toFixed(2))+" %",1),t[53]||(t[53]=s("div",{class:"row"},"Now we can calculate beats elapsed, beat progress and generate pulse",-1)),t[54]||(t[54]=s("div",{class:"text-right"},"Beats:",-1)),s("div",Xs,o(((wt=(yt=e(l))==null?void 0:yt.beats)==null?void 0:wt.toFixed(1))||0),1),t[55]||(t[55]=s("div",{class:"text-left text-sm"},"beats",-1)),t[56]||(t[56]=s("div",{class:"text-right"},"Beat progress:",-1)),s("div",_s,o((($t=(kt=e(l))==null?void 0:kt.beat)==null?void 0:$t.toFixed(4))||0),1),t[57]||(t[57]=s("div",{class:"text-left text-sm"},"Beats % 1",-1)),t[58]||(t[58]=s("div",{class:"text-right"},"Pulse:",-1)),s("div",{class:F(["p-0 font-bold",{active:(ht=e(l))==null?void 0:ht.pulse}])},o(((Ct=e(l))==null?void 0:Ct.pulse)||0),3),t[59]||(t[59]=s("div",{class:"text-left text-sm"},"Beat < 0.5 ?",-1))]),s("div",te,[t[62]||(t[62]=s("div",{class:"row"},"Musical rhythm has a pattern of strong and weak beats in a measure",-1)),t[63]||(t[63]=s("div",{class:"text-right"},"Beats per measure:",-1)),s("div",se,[s("button",{onClick:t[6]||(t[6]=C=>e(p)["time:steps"]--)},t[60]||(t[60]=[s("div",{class:"i-la-minus"},null,-1)])),s("div",ee,o(((St=(Mt=e(l))==null?void 0:Mt.steps)==null?void 0:St.toFixed(0))||4),1),s("button",{onClick:t[7]||(t[7]=C=>e(p)["time:steps"]++)},t[61]||(t[61]=[s("div",{class:"i-la-plus"},null,-1)]))]),t[64]||(t[64]=s("div",{class:"text-left text-sm"},"beats",-1)),t[65]||(t[65]=s("div",{class:"text-right"},"Measures:",-1)),s("div",le,o(((Ft=(Pt=e(l))==null?void 0:Pt.measures)==null?void 0:Ft.toFixed(4))||0),1),t[66]||(t[66]=s("div",{class:"text-left text-sm"},"measures",-1)),t[67]||(t[67]=s("div",{class:"row"},"Now we can get our musical time coordinates",-1)),t[68]||(t[68]=s("div",{class:"text-right"},"Measure progress:",-1)),s("div",ie,[V(o(((Nt=(Bt=e(l))==null?void 0:Bt.measure)==null?void 0:Nt.toFixed(4))||0),1),s("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:M({width:`${((zt=e(l))==null?void 0:zt.measure)*100}%`})},null,4)]),t[69]||(t[69]=s("div",{class:"text-left text-sm"},"Measures % 1",-1)),t[70]||(t[70]=s("div",{class:"text-right"},"Step:",-1)),s("div",oe,[V(o(((Dt=e(l))==null?void 0:Dt["step-num"])+1||0)+" / "+o(((jt=(Vt=e(l))==null?void 0:Vt.steps)==null?void 0:jt.toFixed(0))||4),1),s("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:M({width:`${((Ht=e(l))==null?void 0:Ht["step-num"])/((Et=(Tt=e(l))==null?void 0:Tt.steps)==null?void 0:Et.toFixed(0))*100}%`})},null,4)]),t[71]||(t[71]=s("div",{class:"text-left text-sm"},"Beats / Beats per measure",-1)),t[72]||(t[72]=s("div",{class:"text-right"},"First step:",-1)),s("div",{class:F(["p-0 font-bold",{active:(Ot=e(l))==null?void 0:Ot["step-first"]}])},o((Lt=e(l))==null?void 0:Lt["step-first"]),3),t[73]||(t[73]=s("div",{class:"text-left text-sm"},"Step == 1?",-1)),t[74]||(t[74]=s("div",{class:"text-right"},"Odd step:",-1)),s("div",{class:F(["p-0 font-bold",{active:(Ut=e(l))==null?void 0:Ut["step-odd"]}])},o((At=e(l))==null?void 0:At["step-odd"]),3),t[75]||(t[75]=s("div",{class:"text-left text-sm"},"Step % 2?",-1)),t[76]||(t[76]=s("div",{class:"text-right"},"Even step:",-1)),s("div",{class:F(["p-0 font-bold",{active:(It=e(l))==null?void 0:It["step-even"]}])},o((Rt=e(l))==null?void 0:Rt["step-even"]),3),t[77]||(t[77]=s("div",{class:"text-left text-sm"},"Not Odd",-1))])],4)],64)}}},ne=_(de,[["__scopeId","data-v-5055e139"]]),xe=JSON.parse('{"title":"Musical transport","description":"How we subdivide time to have a rhythm","frontmatter":{"title":"Musical transport","description":"How we subdivide time to have a rhythm","date":"2018-10-30T00:00:00.000Z","layout":"app","cover":"cover.png","links":"https://discord.com/channels/826071713426178078/834787928688689172/1127958693695205387"},"headers":[],"relativePath":"practice/rhythm/time/index.md","filePath":"practice/rhythm/time/index.md","lastUpdated":1741095019000}'),re={name:"practice/rhythm/time/index.md"};function ae(u,l,p,v,b,d){const c=ne,n=ls("client-only");return m(),x("div",null,[K(n,null,{default:is(()=>[K(c)]),_:1})])}const fe=_(re,[["render",ae]]);export{xe as __pageData,fe as default};
