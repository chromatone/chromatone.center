import{J as Kt,aE as i,aG as Xt,ax as q,I as J,aw as Zt,n as Qt}from"./chunks/theme.DNlGQ6Qf.js";import{u as X}from"./chunks/useElementary.C87yR9BT.js";import{u as te,b as B,d as Yt,c as Z,o as ee,q as Q,E as e,x as h,y as v,A as t,H as C,F as A,B as R,G as a,M as se,I as W,K as qt,L as Rt,az as oe,X as K,af as V,z as P,N as ie,a4 as le}from"./chunks/framework.-sYaBLvc.js";import{h as ae}from"./chunks/useDrums.BQOK0yMF.js";function de(d,o="es"){const p={},g={};for(let m in d){const l=d[m];if(p[m]=Kt(l!=null&&l.nostore?l.value:te(`${o}:${m}`,l.value),l.min,l.max),!(l!=null&&l.hidden)){const n=m.split(":"),b=n.pop(),y=n.pop();g[y]=g[y]||{},g[y][b]=l}}const u=B(p),c=B(g),f=B({});return Yt(u,()=>{var m;for(let l in u)f[l]=i.smooth(i.tau2pole(((m=d[l])==null?void 0:m.smooth)||.01),i.const({key:`${o}:${l}`,value:u[l]}))},{immediate:!0}),{controls:u,cv:f,groups:c,params:d}}const Gt={"time:bpm":{value:120,min:30,max:250,step:1,smooth:.1},"time:steps":{value:4,min:1,max:16,step:1},"time:click":{value:0,min:0,max:1,step:1,hidden:!0},"time:volume":{value:0,min:0,max:1,step:.001},"time:playing":{value:0,nostore:!0,hidden:!0}},{controls:Y,groups:ne,cv:G}=de(Gt,"time"),{audio:Wt,meters:ce,render:re}=X(),U=Z(()=>Object.fromEntries(Object.entries(ce).filter(d=>d[0].startsWith("time:")).map(d=>[d[0].slice(5),d[1].max]).sort((d,o)=>d[0]<o[0]?0:1))),x=B({started:0,paused:0,play(){x.started===0?x.started=U.value.seconds:x.paused!==0&&(x.started+=U.value.seconds-x.paused,x.paused=0)},pause(){x.started!==0&&x.paused===0&&(x.paused=U.value.seconds)},stop(){x.started!==0&&(x.started=0,x.paused=0)}});function r(d,o){return i.meter({name:`time:${d}`},o)}const _e=Z(()=>{let d=r("time",i.time()),o=i.meter({name:"time:sample-rate"},i.sr()),p=r("pitch",i.mod(i.const({key:"time:pitch",value:Xt(Y["time:bpm"]/60)}),12)),g=r("seconds",i.div(d,o)),u=r("minutes",i.div(g,60)),c=r("hours",i.div(u,60)),f=r("start",i.const({key:"time:start",value:x.started})),m=r("pause",i.const({key:"time:pause",value:x.paused})),l=r("isStarted",i.ge(f,0)),n=r("isPaused",i.ge(m,0)),b=r("isPlaying",i.and(l,i.sub(1,n))),y=r("current",i.select(l,i.select(n,i.sub(m,f),i.sub(g,f)),0)),M=r("bpm",G["time:bpm"]),w=r("bps",i.div(M,60)),_=r("beats",i.mul(y,w)),$=r("beat",i.mod(_,1)),k=r("pulse",i.le($,.5)),F=r("steps",G["time:steps"]),E=i.meter({name:"time:measures"},i.div(_,F)),H=i.meter({name:"time:measure"},i.mod(E,1)),T=r("step",i.mod(_,F)),N=r("step-num",i.floor(T)),j=r("step-first",i.le(N,1)),z=r("step-even",i.mod(N,2)),D=r("step-odd",i.eq(z,0)),L=ae(p,i.add(1e3,i.mul(1500,z)),.001,i.add(.01,i.mul(.06,j)),i.mul(Y["time:click"],k)),I=i.mul(G["time:volume"],L),O=i.mul(0,i.add(H,p,D,k,y,b,u,c));return[I,i.add(I,O)]});function Jt(){return ee(()=>{Yt([Y,x],()=>{Wt.layers.time={signal:_e.value,volume:1},Wt.started=!1,re("time")},{immediate:!0})}),{controls:Y,groups:ne,params:Gt,time:U,transport:x}}const pe=d=>(qt("data-v-98c700a9"),d=d(),Rt(),d),ue={key:0,class:"flex flex-col gap-2 bg-light-200 bg-opacity-40 dark-bg-dark-400 dark-bg-opacity-40 backdrop-blur pt-2 px-2 rounded-xl shadow-xl border-1 border-dark-200 border-opacity-20 dark-border-light-200 dark-border-opacity-30",id:"screen"},he=["viewBox"],me=["width","height"],ve={class:"beats"},xe=["transform"],fe=["width","height","fill"],be=["stroke","y2"],ge=["x","y","font-size","fill","font-weight"],ye={class:"progress"},we=["fill","width","height"],ke=["x1","x2","y2"],$e={class:"flex flex-wrap m-2 flex flex-wrap gap-4"},Se={class:"is-group items-center flex p-2 flex-wrap",style:{flex:"160px"}},Ce={key:0,class:"i-la-play"},Me={key:1,class:"i-la-pause"},Fe=pe(()=>t("div",{class:"i-la-stop"},null,-1)),Pe=[Fe],Be={key:0,class:"i-la-volume-up"},Ne={key:1,class:"i-la-volume-mute"},ze={__name:"Metronome",setup(d){const{time:o,controls:p,groups:g,transport:u}=Jt(),c=B({width:100,height:22}),{render:f,audio:m}=X(),l=Z(()=>Math.round(p["time:steps"]));return(n,b)=>{var M;const y=Zt;return(M=e(m))!=null&&M.started?(h(),v("div",ue,[t("div",{class:"p-1 rounded-full",style:C({backgroundColor:e(o).pulse?"currentColor":"transparent"})},null,4),(h(),v("svg",{class:"w-full rounded select-none",viewBox:`0 0 ${c.width} ${c.height}`},[t("rect",{fill:"#8881",stroke:"#aaa","stroke-width":".2",width:c.width,height:c.height},null,8,me),t("g",ve,[(h(!0),v(A,null,R(l.value,(w,_)=>(h(),v("g",{class:"beat",key:_,transform:`translate(${_*c.width/l.value},0)`},[t("rect",{width:c.width/l.value,height:c.height,fill:_!=Math.floor(e(o).step)?"#6662":e(q)(_+e(o).pitch/12*l.value,l.value,1)},null,8,fe),t("line",{stroke:e(q)(_+e(o).pitch/12*l.value,l.value),"stroke-width":".3",y2:c.height},null,8,be),t("text",{x:2-l.value/10,y:c.height-2,"font-size":16-l.value/1.5,fill:_==Math.floor(e(o).step)?"currentColor":e(q)(_+e(o).pitch/12*l.value,l.value,1),"font-weight":_==Math.floor(e(o).step)?"bold":"normal"},a(w),9,ge)],8,xe))),128))]),t("g",ye,[t("rect",{fill:e(J)(e(o).pitch),"fill-opacity":".2",width:e(o).measure*c.width,height:c.height},null,8,we),t("line",{stroke:"currentColor","stroke-width":"1",x1:e(o).measure*c.width,x2:e(o).measure*c.width,y2:c.height},null,8,ke)])],8,he)),t("div",$e,[t("div",Se,[t("button",{class:"text-button",onClick:b[0]||(b[0]=w=>e(o).isPlaying?e(u).pause():e(u).play())},[e(o).isPlaying?(h(),v("div",Me)):(h(),v("div",Ce))]),t("button",{class:"text-button",onClick:b[1]||(b[1]=w=>e(u).stop())},Pe),t("button",{class:"text-button",onClick:b[2]||(b[2]=w=>e(p)["time:click"]=e(p)["time:click"]?0:1)},[e(p)["time:click"]?(h(),v("div",Be)):(h(),v("div",Ne))])]),(h(!0),v(A,null,R(e(g),(w,_)=>(h(),v("div",{class:"is-group flex flex-wrap items-center",style:{flex:"180px"},key:_},[(h(!0),v(A,null,R(w,($,k)=>(h(),v("div",{class:"select-none relative flex flex-col gap-4 items-center",key:k},[k!="click"?(h(),se(y,{key:0,min:$.min,max:$.max,step:$.step,modelValue:e(p)[`${_}:${k}`],"onUpdate:modelValue":F=>e(p)[`${_}:${k}`]=F,param:String(k)},null,8,["min","max","step","modelValue","onUpdate:modelValue","param"])):W("",!0)]))),128))]))),128))])])):W("",!0)}}},Ie=Q(ze,[["__scopeId","data-v-98c700a9"]]),s=d=>(qt("data-v-19de2bab"),d=d(),Rt(),d),Ve={class:"flex flex-wrap",style:{flex:"1 1 350px"}},Ee=s(()=>t("h2",null,"From samples to beats and measures",-1)),He={class:"sheet"},Te=s(()=>t("div",{class:"row"},"We have a timer ever increasing at a fixed rate ",-1)),je=s(()=>t("div",{class:"text-right"},"Started at: ",-1)),De={class:"p-0 font-bold"},Le=s(()=>t("div",{class:"text-left text-sm"},"milliseconds",-1)),Oe=s(()=>t("div",{class:"text-right"},"Local time: ",-1)),Ae={class:"p-0 col-span-2 font-bold"},Ue=s(()=>t("div",{class:"text-right"},"Sample Rate: ",-1)),We={class:"p-0 font-bold"},Ye=s(()=>t("div",{class:"text-left text-sm"},"samples per second",-1)),qe=s(()=>t("div",{class:"text-right"},"Timer: ",-1)),Re={class:"p-0 font-bold"},Ge=s(()=>t("div",{class:"text-left text-sm"},"samples",-1)),Je={class:"sheet"},Ke=s(()=>t("div",{class:"row"},"Divide the sample count by the sample rate to get elapsed seconds ",-1)),Xe=s(()=>t("div",{class:"text-right"},"Seconds: ",-1)),Ze={class:"p-0 font-bold"},Qe=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),ts=s(()=>t("div",{class:"text-right"},"Minutes:",-1)),es={class:"p-0 font-bold"},ss=s(()=>t("div",{class:"text-left text-sm"},"seconds / 60",-1)),os=s(()=>t("div",{class:"text-right"},"Hours:",-1)),is={class:"p-0 font-bold"},ls=s(()=>t("div",{class:"text-left text-sm"},"minutes / 60",-1)),as={class:"sheet"},ds={class:"row"},ns={key:0,class:"col-span-3 flex flex-wrap m-2 flex flex-wrap justify-center"},cs=s(()=>t("div",{class:"i-la-play"},null,-1)),rs=[cs],_s=s(()=>t("div",{class:"i-la-pause"},null,-1)),ps=[_s],us=s(()=>t("div",{class:"i-la-stop"},null,-1)),hs=[us],ms=s(()=>t("div",{class:"text-right"},"Started At:",-1)),vs={class:"p-0 font-bold"},xs=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),fs=s(()=>t("div",{class:"text-right"},"Paused At:",-1)),bs={class:"p-0 font-bold"},gs=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),ys=s(()=>t("div",{class:"text-right"},"Started:",-1)),ws=s(()=>t("div",{class:"text-left text-sm"},"Started > 0 ?",-1)),ks=s(()=>t("div",{class:"text-right"},"Paused:",-1)),$s=s(()=>t("div",{class:"text-left text-sm"},"Paused > 0 ?",-1)),Ss=s(()=>t("div",{class:"text-right"},"Playing:",-1)),Cs=s(()=>t("div",{class:"text-left text-sm"},"Started & Not Paused",-1)),Ms=s(()=>t("div",{class:"row"},"Now we just subtract current time from start/pause time",-1)),Fs=s(()=>t("div",{class:"text-right"},"Transport time:",-1)),Ps={class:"p-0 font-bold"},Bs=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),Ns={class:"sheet"},zs=s(()=>t("div",{class:"row"},"We want musical time, so we need to set a beat rate",-1)),Is=s(()=>t("div",{class:"text-right"},"BPM:",-1)),Vs={class:"p-0 font-bold flex items-center gap-2 justify-center"},Es=s(()=>t("div",{class:"i-la-minus"},null,-1)),Hs=[Es],Ts={class:"p-0"},js=s(()=>t("div",{class:"i-la-plus"},null,-1)),Ds=[js],Ls=s(()=>t("div",{class:"text-left text-sm"},"beats per minute",-1)),Os=s(()=>t("div",{class:"text-right"},"BPS:",-1)),As={class:"p-0 font-bold"},Us=s(()=>t("div",{class:"text-left text-sm"},"Hz",-1)),Ws=s(()=>t("div",{class:"text-right"},"Pitch:",-1)),Ys=s(()=>t("div",{class:"text-left text-sm"},"cents",-1)),qs=s(()=>t("div",{class:"text-right"},"Note:",-1)),Rs={class:"text-left text-sm"},Gs=s(()=>t("div",{class:"row"},"Now we can calculate beats elapsed, beat progress and generate pulse",-1)),Js=s(()=>t("div",{class:"text-right"},"Beats:",-1)),Ks={class:"p-0 font-bold"},Xs=s(()=>t("div",{class:"text-left text-sm"},"beats",-1)),Zs=s(()=>t("div",{class:"text-right"},"Beat progress:",-1)),Qs={class:"p-0 font-bold"},to=s(()=>t("div",{class:"text-left text-sm"},"Beats % 1",-1)),eo=s(()=>t("div",{class:"text-right"},"Pulse:",-1)),so=s(()=>t("div",{class:"text-left text-sm"},"Beat < 0.5 ?",-1)),oo={class:"sheet"},io=s(()=>t("div",{class:"row"},"Musical rhythm has a pattern of strong and weak beats in a measure",-1)),lo=s(()=>t("div",{class:"text-right"},"Beats per measure:",-1)),ao={class:"p-0 font-bold flex items-center gap-2 justify-center"},no=s(()=>t("div",{class:"i-la-minus"},null,-1)),co=[no],ro={class:"p-0"},_o=s(()=>t("div",{class:"i-la-plus"},null,-1)),po=[_o],uo=s(()=>t("div",{class:"text-left text-sm"},"beats",-1)),ho=s(()=>t("div",{class:"text-right"},"Measures:",-1)),mo={class:"p-0 font-bold"},vo=s(()=>t("div",{class:"text-left text-sm"},"measures",-1)),xo=s(()=>t("div",{class:"row"},"Now we can get our musical time coordinates",-1)),fo=s(()=>t("div",{class:"text-right"},"Measure progress:",-1)),bo={class:"p-0 font-bold relative"},go=s(()=>t("div",{class:"text-left text-sm"},"Measures % 1",-1)),yo=s(()=>t("div",{class:"text-right"},"Step:",-1)),wo={class:"p-0 font-bold relative"},ko=s(()=>t("div",{class:"text-left text-sm"},"Beats / Beats per measure",-1)),$o=s(()=>t("div",{class:"text-right"},"First step:",-1)),So=s(()=>t("div",{class:"text-left text-sm"},"Step == 1?",-1)),Co=s(()=>t("div",{class:"text-right"},"Odd step:",-1)),Mo=s(()=>t("div",{class:"text-left text-sm"},"Step % 2?",-1)),Fo=s(()=>t("div",{class:"text-right"},"Even step:",-1)),Po=s(()=>t("div",{class:"text-left text-sm"},"Not Odd",-1)),Bo={__name:"Math",setup(d){const{time:o,controls:p,groups:g,transport:u}=Jt();B({width:100,height:5});const{render:c,audio:f}=X(),m=oe(()=>f.started,"YYYY MMM DD @ HH:MM:ss  ");return(l,n)=>{var y,M,w,_,$,k,F,E,H,T,N,j,z,D,L,I,O,tt,et,st,ot,it,lt,at,dt,nt,ct,rt,_t,pt,ut,ht,mt,vt,xt,ft,bt,gt,yt,wt,kt,$t,St,Ct,Mt,Ft,Pt,Bt,Nt,zt,It,Vt,Et,Ht,Tt,jt,Dt,Lt,Ot,At,Ut;const b=Ie;return h(),v(A,null,[e(f).started?W("",!0):(h(),v("div",{key:0,class:"absolute top-18 bg-light-200 p-8 z-200 w-full cursor-pointer rounded-lg text-xl font-bold border-1 dark-bg-dark-400",onClick:n[0]||(n[0]=S=>e(c)())},"Click to start watching time passing")),t("div",{class:"p-2 flex flex-wrap gap-4 font-mono items-stretc w-full",onClick:n[8]||(n[8]=S=>e(c)()),style:C({opacity:(y=e(f))!=null&&y.started?1:.4})},[t("div",Ve,[Ee,K(b,{class:"sticky top-2 z-100 w-full"})]),t("div",He,[Te,je,t("div",De,a(Number((M=e(f))==null?void 0:M.started).toLocaleString()),1),Le,Oe,t("div",Ae,a(e(m)),1),Ue,t("div",We,a(Number(((w=e(o))==null?void 0:w["sample-rate"])||44100).toLocaleString()),1),Ye,qe,t("div",Re,a(Number(((_=e(o))==null?void 0:_.time)||0).toLocaleString()),1),Ge]),t("div",Je,[Ke,Xe,t("div",Ze,a(((k=($=e(o))==null?void 0:$.seconds)==null?void 0:k.toFixed(2))||0),1),Qe,ts,t("div",es,a(((E=(F=e(o))==null?void 0:F.minutes)==null?void 0:E.toFixed(2))||0),1),ss,os,t("div",is,a(((T=(H=e(o))==null?void 0:H.hours)==null?void 0:T.toFixed(2))||0),1),ls]),t("div",as,[t("div",ds,[V("We need a playable and pausable transport time "),(N=e(f))!=null&&N.started?(h(),v("div",ns,[t("button",{class:"text-button",onClick:n[1]||(n[1]=S=>e(u).play())},rs),t("button",{class:"text-button",onClick:n[2]||(n[2]=S=>e(u).pause())},ps),t("button",{class:"text-button",onClick:n[3]||(n[3]=S=>e(u).stop())},hs)])):W("",!0)]),ms,t("div",vs,a(((z=(j=e(u))==null?void 0:j.started)==null?void 0:z.toFixed(2))||0),1),xs,fs,t("div",bs,a(((L=(D=e(u))==null?void 0:D.paused)==null?void 0:L.toFixed(2))||0),1),gs,ys,t("div",{class:P(["p-0 font-bold",{active:(I=e(o))==null?void 0:I.isStarted}])},a((O=e(o))==null?void 0:O.isStarted),3),ws,ks,t("div",{class:P(["p-0 font-bold",{active:(tt=e(o))==null?void 0:tt.isPaused}])},a((et=e(o))==null?void 0:et.isPaused),3),$s,Ss,t("div",{class:P(["p-0 font-bold",{active:(st=e(o))==null?void 0:st.isPlaying}])},a((ot=e(o))==null?void 0:ot.isPlaying),3),Cs,Ms,Fs,t("div",Ps,a((lt=(it=e(o))==null?void 0:it.current)==null?void 0:lt.toFixed(2)),1),Bs]),t("div",Ns,[zs,Is,t("div",Vs,[t("button",{onClick:n[4]||(n[4]=S=>e(p)["time:bpm"]--)},Hs),t("div",Ts,a(((dt=(at=e(o))==null?void 0:at.bpm)==null?void 0:dt.toFixed(1))||120),1),t("button",{onClick:n[5]||(n[5]=S=>e(p)["time:bpm"]++)},Ds)]),Ls,Os,t("div",As,a(((ct=(nt=e(o))==null?void 0:nt.bps)==null?void 0:ct.toFixed(1))||2),1),Us,Ws,t("div",{class:"p-0 font-bold relative",style:C({backgroundColor:e(J)(((rt=e(o))==null?void 0:rt.pitch)+12,3,1,.5)})},[V(a(((((_t=e(o))==null?void 0:_t.pitch)+12||2)*100).toFixed(1)),1),t("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:C({width:`${(((pt=e(o))==null?void 0:pt.pitch)+12||2)*100/12}%`})},null,4)],4),Ys,qs,t("div",{class:"p-0 font-bold relative",style:C({color:e(J)(((ut=e(o))==null?void 0:ut.pitch)+12,3)})},[V(a(e(Qt)[Math.round(((ht=e(o))==null?void 0:ht.pitch)+12)%12]),1),t("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:C({width:`${50+100*((((mt=e(o))==null?void 0:mt.pitch)+12)%12-Math.round(((vt=e(o))==null?void 0:vt.pitch)+12)%12)}%`})},null,4)],4),t("div",Rs,a((100*((((xt=e(o))==null?void 0:xt.pitch)+12)%12-Math.round(((ft=e(o))==null?void 0:ft.pitch)+12)%12)).toFixed(2))+" %",1),Gs,Js,t("div",Ks,a(((gt=(bt=e(o))==null?void 0:bt.beats)==null?void 0:gt.toFixed(1))||0),1),Xs,Zs,t("div",Qs,a(((wt=(yt=e(o))==null?void 0:yt.beat)==null?void 0:wt.toFixed(4))||0),1),to,eo,t("div",{class:P(["p-0 font-bold",{active:(kt=e(o))==null?void 0:kt.pulse}])},a((($t=e(o))==null?void 0:$t.pulse)||0),3),so]),t("div",oo,[io,lo,t("div",ao,[t("button",{onClick:n[6]||(n[6]=S=>e(p)["time:steps"]--)},co),t("div",ro,a(((Ct=(St=e(o))==null?void 0:St.steps)==null?void 0:Ct.toFixed(0))||4),1),t("button",{onClick:n[7]||(n[7]=S=>e(p)["time:steps"]++)},po)]),uo,ho,t("div",mo,a(((Ft=(Mt=e(o))==null?void 0:Mt.measures)==null?void 0:Ft.toFixed(4))||0),1),vo,xo,fo,t("div",bo,[V(a(((Bt=(Pt=e(o))==null?void 0:Pt.measure)==null?void 0:Bt.toFixed(4))||0),1),t("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:C({width:`${((Nt=e(o))==null?void 0:Nt.measure)*100}%`})},null,4)]),go,yo,t("div",wo,[V(a(((zt=e(o))==null?void 0:zt["step-num"])+1||0)+" / "+a(((Vt=(It=e(o))==null?void 0:It.steps)==null?void 0:Vt.toFixed(0))||4),1),t("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:C({width:`${((Et=e(o))==null?void 0:Et["step-num"])/((Tt=(Ht=e(o))==null?void 0:Ht.steps)==null?void 0:Tt.toFixed(0))*100}%`})},null,4)]),ko,$o,t("div",{class:P(["p-0 font-bold",{active:(jt=e(o))==null?void 0:jt["step-first"]}])},a((Dt=e(o))==null?void 0:Dt["step-first"]),3),So,Co,t("div",{class:P(["p-0 font-bold",{active:(Lt=e(o))==null?void 0:Lt["step-odd"]}])},a((Ot=e(o))==null?void 0:Ot["step-odd"]),3),Mo,Fo,t("div",{class:P(["p-0 font-bold",{active:(At=e(o))==null?void 0:At["step-even"]}])},a((Ut=e(o))==null?void 0:Ut["step-even"]),3),Po])],4)],64)}}},No=Q(Bo,[["__scopeId","data-v-19de2bab"]]),jo=JSON.parse('{"title":"Musical transport","description":"How we subdivide time to have a rhythm","frontmatter":{"title":"Musical transport","description":"How we subdivide time to have a rhythm","date":"2018-10-30T00:00:00.000Z","layout":"app","cover":"cover.png","links":"https://discord.com/channels/826071713426178078/834787928688689172/1127958693695205387"},"headers":[],"relativePath":"practice/rhythm/time/index.md","filePath":"practice/rhythm/time/index.md","lastUpdated":1724782961000}'),zo={name:"practice/rhythm/time/index.md"};function Io(d,o,p,g,u,c){const f=No,m=le("client-only");return h(),v("div",null,[K(m,null,{default:ie(()=>[K(f)]),_:1})])}const Do=Q(zo,[["render",Io]]);export{jo as __pageData,Do as default};
