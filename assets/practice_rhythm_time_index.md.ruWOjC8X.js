import{u as K,s as i}from"./chunks/useAudio.CAzp-F3k.js";import{u as qt}from"./chunks/useUI.CMZB2Jw5.js";import{aA as Jt,aL as Y,ad as J,_ as Gt,e as Kt}from"./chunks/theme.XLx-oMyN.js";import{h as Xt}from"./chunks/useDrums.BcEnh2F0.js";import{c as X,b as Z,o as Zt,d as Qt,D as Q,C as e,E as _,F as p,G as t,L as $,V as H,W as R,I as l,a2 as te,T as W,J as Wt,K as Ut,aD as ee,O as G,$ as V,P,X as se,a4 as oe}from"./chunks/framework._R7LTyWb.js";const Yt={"time:bpm":{value:120,min:30,max:250,step:1,smooth:.1},"time:steps":{value:4,min:1,max:16,step:1},"time:click":{value:0,min:0,max:1,step:1,hidden:!0},"time:volume":{value:0,min:0,max:1,step:.001},"time:playing":{value:0,nostore:!0,hidden:!0}},{controls:U,groups:ie,cv:q}=qt(Yt,"time"),{audio:le,meters:ae,render:de}=K(),E=X(()=>Object.fromEntries(Object.entries(ae).filter(n=>n[0].startsWith("time:")).map(n=>[n[0].slice(5),n[1].max]).sort((n,o)=>n[0]<o[0]?0:1))),h=Z({started:0,paused:0,play(){h.started===0?h.started=E.value.seconds:h.paused!==0&&(h.started+=E.value.seconds-h.paused,h.paused=0)},pause(){h.started!==0&&h.paused===0&&(h.paused=E.value.seconds)},stop(){h.started!==0&&(h.started=0,h.paused=0)}});function d(n,o){return i.meter({name:`time:${n}`},o)}const ne=X(()=>{let n=d("time",i.time()),o=i.meter({name:"time:sample-rate"},i.sr()),u=d("pitch",i.mod(i.const({key:"time:pitch",value:Jt(U["time:bpm"]/60)}),12)),F=d("seconds",i.div(n,o)),v=d("minutes",i.div(F,60)),c=d("hours",i.div(v,60)),x=d("start",i.const({key:"time:start",value:h.started})),y=d("pause",i.const({key:"time:pause",value:h.paused})),m=d("isStarted",i.ge(x,0)),a=d("isPaused",i.ge(y,0)),f=d("isPlaying",i.and(m,i.sub(1,a))),S=d("current",i.select(m,i.select(a,i.sub(y,x),i.sub(F,x)),0)),C=d("bpm",q["time:bpm"]),b=d("bps",i.div(C,60)),r=d("beats",i.mul(S,b)),w=d("beat",i.mod(r,1)),g=d("pulse",i.le(w,.5)),M=d("steps",q["time:steps"]),A=i.meter({name:"time:measures"},i.div(r,M)),D=i.meter({name:"time:measure"},i.mod(A,1)),I=d("step",i.mod(r,M)),B=d("step-num",i.floor(I)),z=d("step-first",i.le(B,1)),N=d("step-even",i.mod(B,2)),L=d("step-odd",i.eq(N,0)),O=Xt(u,i.add(1e3,i.mul(1500,N)),.001,i.add(.01,i.mul(.06,z)),i.mul(U["time:click"],g)),T=i.mul(q["time:volume"],O),j=i.mul(0,i.add(D,u,L,g,S,f,v,c));return[T,i.add(T,j)]});function Rt(){return Zt(()=>{Qt([U,h],()=>{le.layers.time={signal:ne.value,volume:1},de("time")},{immediate:!0})}),{controls:U,groups:ie,params:Yt,time:E,transport:h}}const ce=n=>(Wt("data-v-85b5a6f4"),n=n(),Ut(),n),re={key:0,class:"flex flex-col gap-2 bg-light-200 bg-opacity-40 dark-bg-dark-400 dark-bg-opacity-40 backdrop-blur pt-2 px-2 rounded-xl shadow-xl border-1 border-dark-200 border-opacity-20 dark-border-light-200 dark-border-opacity-30",id:"screen"},_e=["viewBox"],pe=["width","height"],he={class:"beats"},ue=["transform"],me=["width","height","fill"],ve=["stroke","y2"],xe=["x","y","font-size","fill","font-weight"],fe={class:"progress"},be=["fill","width","height"],ge=["x1","x2","y2"],ye={class:"flex flex-wrap m-2 flex flex-wrap gap-4"},we={class:"is-group items-center flex p-2 flex-wrap",style:{flex:"160px"}},ke={key:0,class:"i-la-play"},$e={key:1,class:"i-la-pause"},Se=ce(()=>t("div",{class:"i-la-stop"},null,-1)),Ce=[Se],Me={key:0,class:"i-la-volume-up"},Pe={key:1,class:"i-la-volume-mute"},Fe={__name:"AudioTimeMetronome",setup(n){const{time:o,controls:u,groups:F,transport:v}=Rt(),c=Z({width:100,height:22}),{render:x,audio:y}=K(),m=X(()=>Math.round(u["time:steps"]));return(a,f)=>{var C;const S=Gt;return(C=e(y))!=null&&C.started?(_(),p("div",re,[t("div",{class:"p-1 rounded-full",style:$({backgroundColor:e(o).pulse?"currentColor":"transparent"})},null,4),(_(),p("svg",{class:"w-full rounded select-none",viewBox:`0 0 ${c.width} ${c.height}`},[t("rect",{fill:"#8881",stroke:"#aaa","stroke-width":".2",width:c.width,height:c.height},null,8,pe),t("g",he,[(_(!0),p(H,null,R(m.value,(b,r)=>(_(),p("g",{class:"beat",key:r,transform:`translate(${r*c.width/m.value},0)`},[t("rect",{width:c.width/m.value,height:c.height,fill:r!=Math.floor(e(o).step)?"#6662":e(Y)(r+e(o).pitch/12*m.value,m.value,1)},null,8,me),t("line",{stroke:e(Y)(r+e(o).pitch/12*m.value,m.value),"stroke-width":".3",y2:c.height},null,8,ve),t("text",{x:2-m.value/10,y:c.height-2,"font-size":16-m.value/1.5,fill:r==Math.floor(e(o).step)?"currentColor":e(Y)(r+e(o).pitch/12*m.value,m.value,1),"font-weight":r==Math.floor(e(o).step)?"bold":"normal"},l(b),9,xe)],8,ue))),128))]),t("g",fe,[t("rect",{fill:e(J)(e(o).pitch),"fill-opacity":".2",width:e(o).measure*c.width,height:c.height},null,8,be),t("line",{stroke:"currentColor","stroke-width":"1",x1:e(o).measure*c.width,x2:e(o).measure*c.width,y2:c.height},null,8,ge)])],8,_e)),t("div",ye,[t("div",we,[t("button",{class:"text-button",onClick:f[0]||(f[0]=b=>e(o).isPlaying?e(v).pause():e(v).play())},[e(o).isPlaying?(_(),p("div",$e)):(_(),p("div",ke))]),t("button",{class:"text-button",onClick:f[1]||(f[1]=b=>e(v).stop())},Ce),t("button",{class:"text-button",onClick:f[2]||(f[2]=b=>e(u)["time:click"]=e(u)["time:click"]?0:1)},[e(u)["time:click"]?(_(),p("div",Me)):(_(),p("div",Pe))])]),(_(!0),p(H,null,R(e(F),(b,r)=>(_(),p("div",{class:"is-group flex flex-wrap items-center",style:{flex:"180px"},key:r},[(_(!0),p(H,null,R(b,(w,g)=>(_(),p("div",{class:"select-none relative flex flex-col gap-4 items-center",key:g},[g!="click"?(_(),te(S,{key:0,min:w.min,max:w.max,step:w.step,modelValue:e(u)[`${r}:${g}`],"onUpdate:modelValue":M=>e(u)[`${r}:${g}`]=M,param:String(g)},null,8,["min","max","step","modelValue","onUpdate:modelValue","param"])):W("",!0)]))),128))]))),128))])])):W("",!0)}}},Be=Q(Fe,[["__scopeId","data-v-85b5a6f4"]]),s=n=>(Wt("data-v-f1cfaa02"),n=n(),Ut(),n),Ne={class:"flex flex-wrap",style:{flex:"1 1 350px"}},Te=s(()=>t("h2",null,"From samples to beats and measures",-1)),Ve={class:"sheet"},Ae=s(()=>t("div",{class:"row"},"We have a timer ever increasing at a fixed rate ",-1)),De=s(()=>t("div",{class:"text-right"},"Started at: ",-1)),Ie={class:"p-0 font-bold"},ze=s(()=>t("div",{class:"text-left text-sm"},"milliseconds",-1)),Le=s(()=>t("div",{class:"text-right"},"Local time: ",-1)),Oe={class:"p-0 col-span-2 font-bold"},je=s(()=>t("div",{class:"text-right"},"Sample Rate: ",-1)),He={class:"p-0 font-bold"},Ee=s(()=>t("div",{class:"text-left text-sm"},"samples per second",-1)),We=s(()=>t("div",{class:"text-right"},"Timer: ",-1)),Ue={class:"p-0 font-bold"},Ye=s(()=>t("div",{class:"text-left text-sm"},"samples",-1)),Re={class:"sheet"},qe=s(()=>t("div",{class:"row"},"Divide the sample count by the sample rate to get elapsed seconds ",-1)),Je=s(()=>t("div",{class:"text-right"},"Seconds: ",-1)),Ge={class:"p-0 font-bold"},Ke=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),Xe=s(()=>t("div",{class:"text-right"},"Minutes:",-1)),Ze={class:"p-0 font-bold"},Qe=s(()=>t("div",{class:"text-left text-sm"},"seconds / 60",-1)),ts=s(()=>t("div",{class:"text-right"},"Hours:",-1)),es={class:"p-0 font-bold"},ss=s(()=>t("div",{class:"text-left text-sm"},"minutes / 60",-1)),os={class:"sheet"},is={class:"row"},ls={key:0,class:"col-span-3 flex flex-wrap m-2 flex flex-wrap justify-center"},as=s(()=>t("div",{class:"i-la-play"},null,-1)),ds=[as],ns=s(()=>t("div",{class:"i-la-pause"},null,-1)),cs=[ns],rs=s(()=>t("div",{class:"i-la-stop"},null,-1)),_s=[rs],ps=s(()=>t("div",{class:"text-right"},"Started At:",-1)),hs={class:"p-0 font-bold"},us=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),ms=s(()=>t("div",{class:"text-right"},"Paused At:",-1)),vs={class:"p-0 font-bold"},xs=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),fs=s(()=>t("div",{class:"text-right"},"Started:",-1)),bs=s(()=>t("div",{class:"text-left text-sm"},"Started > 0 ?",-1)),gs=s(()=>t("div",{class:"text-right"},"Paused:",-1)),ys=s(()=>t("div",{class:"text-left text-sm"},"Paused > 0 ?",-1)),ws=s(()=>t("div",{class:"text-right"},"Playing:",-1)),ks=s(()=>t("div",{class:"text-left text-sm"},"Started & Not Paused",-1)),$s=s(()=>t("div",{class:"row"},"Now we just subtract current time from start/pause time",-1)),Ss=s(()=>t("div",{class:"text-right"},"Transport time:",-1)),Cs={class:"p-0 font-bold"},Ms=s(()=>t("div",{class:"text-left text-sm"},"seconds",-1)),Ps={class:"sheet"},Fs=s(()=>t("div",{class:"row"},"We want musical time, so we need to set a beat rate",-1)),Bs=s(()=>t("div",{class:"text-right"},"BPM:",-1)),Ns={class:"p-0 font-bold flex items-center gap-2 justify-center"},Ts=s(()=>t("div",{class:"i-la-minus"},null,-1)),Vs=[Ts],As={class:"p-0"},Ds=s(()=>t("div",{class:"i-la-plus"},null,-1)),Is=[Ds],zs=s(()=>t("div",{class:"text-left text-sm"},"beats per minute",-1)),Ls=s(()=>t("div",{class:"text-right"},"BPS:",-1)),Os={class:"p-0 font-bold"},js=s(()=>t("div",{class:"text-left text-sm"},"Hz",-1)),Hs=s(()=>t("div",{class:"text-right"},"Pitch:",-1)),Es=s(()=>t("div",{class:"text-left text-sm"},"cents",-1)),Ws=s(()=>t("div",{class:"text-right"},"Note:",-1)),Us={class:"text-left text-sm"},Ys=s(()=>t("div",{class:"row"},"Now we can calculate beats elapsed, beat progress and generate pulse",-1)),Rs=s(()=>t("div",{class:"text-right"},"Beats:",-1)),qs={class:"p-0 font-bold"},Js=s(()=>t("div",{class:"text-left text-sm"},"beats",-1)),Gs=s(()=>t("div",{class:"text-right"},"Beat progress:",-1)),Ks={class:"p-0 font-bold"},Xs=s(()=>t("div",{class:"text-left text-sm"},"Beats % 1",-1)),Zs=s(()=>t("div",{class:"text-right"},"Pulse:",-1)),Qs=s(()=>t("div",{class:"text-left text-sm"},"Beat < 0.5 ?",-1)),to={class:"sheet"},eo=s(()=>t("div",{class:"row"},"Musical rhythm has a pattern of strong and weak beats in a measure",-1)),so=s(()=>t("div",{class:"text-right"},"Beats per measure:",-1)),oo={class:"p-0 font-bold flex items-center gap-2 justify-center"},io=s(()=>t("div",{class:"i-la-minus"},null,-1)),lo=[io],ao={class:"p-0"},no=s(()=>t("div",{class:"i-la-plus"},null,-1)),co=[no],ro=s(()=>t("div",{class:"text-left text-sm"},"beats",-1)),_o=s(()=>t("div",{class:"text-right"},"Measures:",-1)),po={class:"p-0 font-bold"},ho=s(()=>t("div",{class:"text-left text-sm"},"measures",-1)),uo=s(()=>t("div",{class:"row"},"Now we can get our musical time coordinates",-1)),mo=s(()=>t("div",{class:"text-right"},"Measure progress:",-1)),vo={class:"p-0 font-bold relative"},xo=s(()=>t("div",{class:"text-left text-sm"},"Measures % 1",-1)),fo=s(()=>t("div",{class:"text-right"},"Step:",-1)),bo={class:"p-0 font-bold relative"},go=s(()=>t("div",{class:"text-left text-sm"},"Beats / Beats per measure",-1)),yo=s(()=>t("div",{class:"text-right"},"First step:",-1)),wo=s(()=>t("div",{class:"text-left text-sm"},"Step == 1?",-1)),ko=s(()=>t("div",{class:"text-right"},"Odd step:",-1)),$o=s(()=>t("div",{class:"text-left text-sm"},"Step % 2?",-1)),So=s(()=>t("div",{class:"text-right"},"Even step:",-1)),Co=s(()=>t("div",{class:"text-left text-sm"},"Not Odd",-1)),Mo={__name:"AudioTimeMath",setup(n){const{time:o,controls:u,groups:F,transport:v}=Rt();Z({width:100,height:5});const{render:c,audio:x}=K(),y=ee(()=>x.started,"YYYY MMM DD @ HH:MM:ss  ");return(m,a)=>{var f,S,C,b,r,w,g,M,A,D,I,B,z,N,L,O,T,j,tt,et,st,ot,it,lt,at,dt,nt,ct,rt,_t,pt,ht,ut,mt,vt,xt,ft,bt,gt,yt,wt,kt,$t,St,Ct,Mt,Pt,Ft,Bt,Nt,Tt,Vt,At,Dt,It,zt,Lt,Ot,jt,Ht,Et;return _(),p(H,null,[e(x).started?W("",!0):(_(),p("div",{key:0,class:"absolute top-18 bg-light-200 p-8 z-200 w-full cursor-pointer rounded-lg text-xl font-bold border-1 dark-bg-dark-400",onClick:a[0]||(a[0]=k=>e(c)())},"Click to start watching time passing")),t("div",{class:"p-2 flex flex-wrap gap-4 font-mono items-stretc w-full",onClick:a[8]||(a[8]=k=>e(c)()),style:$({opacity:(f=e(x))!=null&&f.started?1:.4})},[t("div",Ne,[Te,G(Be,{class:"sticky top-2 z-100 w-full"})]),t("div",Ve,[Ae,De,t("div",Ie,l(Number((S=e(x))==null?void 0:S.started).toLocaleString()),1),ze,Le,t("div",Oe,l(e(y)),1),je,t("div",He,l(Number(((C=e(o))==null?void 0:C["sample-rate"])||44100).toLocaleString()),1),Ee,We,t("div",Ue,l(Number(((b=e(o))==null?void 0:b.time)||0).toLocaleString()),1),Ye]),t("div",Re,[qe,Je,t("div",Ge,l(((w=(r=e(o))==null?void 0:r.seconds)==null?void 0:w.toFixed(2))||0),1),Ke,Xe,t("div",Ze,l(((M=(g=e(o))==null?void 0:g.minutes)==null?void 0:M.toFixed(2))||0),1),Qe,ts,t("div",es,l(((D=(A=e(o))==null?void 0:A.hours)==null?void 0:D.toFixed(2))||0),1),ss]),t("div",os,[t("div",is,[V("We need a playable and pausable transport time "),(I=e(x))!=null&&I.started?(_(),p("div",ls,[t("button",{class:"text-button",onClick:a[1]||(a[1]=k=>e(v).play())},ds),t("button",{class:"text-button",onClick:a[2]||(a[2]=k=>e(v).pause())},cs),t("button",{class:"text-button",onClick:a[3]||(a[3]=k=>e(v).stop())},_s)])):W("",!0)]),ps,t("div",hs,l(((z=(B=e(v))==null?void 0:B.started)==null?void 0:z.toFixed(2))||0),1),us,ms,t("div",vs,l(((L=(N=e(v))==null?void 0:N.paused)==null?void 0:L.toFixed(2))||0),1),xs,fs,t("div",{class:P(["p-0 font-bold",{active:(O=e(o))==null?void 0:O.isStarted}])},l((T=e(o))==null?void 0:T.isStarted),3),bs,gs,t("div",{class:P(["p-0 font-bold",{active:(j=e(o))==null?void 0:j.isPaused}])},l((tt=e(o))==null?void 0:tt.isPaused),3),ys,ws,t("div",{class:P(["p-0 font-bold",{active:(et=e(o))==null?void 0:et.isPlaying}])},l((st=e(o))==null?void 0:st.isPlaying),3),ks,$s,Ss,t("div",Cs,l((it=(ot=e(o))==null?void 0:ot.current)==null?void 0:it.toFixed(2)),1),Ms]),t("div",Ps,[Fs,Bs,t("div",Ns,[t("button",{onClick:a[4]||(a[4]=k=>e(u)["time:bpm"]--)},Vs),t("div",As,l(((at=(lt=e(o))==null?void 0:lt.bpm)==null?void 0:at.toFixed(1))||120),1),t("button",{onClick:a[5]||(a[5]=k=>e(u)["time:bpm"]++)},Is)]),zs,Ls,t("div",Os,l(((nt=(dt=e(o))==null?void 0:dt.bps)==null?void 0:nt.toFixed(1))||2),1),js,Hs,t("div",{class:"p-0 font-bold relative",style:$({backgroundColor:e(J)(((ct=e(o))==null?void 0:ct.pitch)+12,3,1,.5)})},[V(l(((((rt=e(o))==null?void 0:rt.pitch)+12||2)*100).toFixed(1)),1),t("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${(((_t=e(o))==null?void 0:_t.pitch)+12||2)*100/12}%`})},null,4)],4),Es,Ws,t("div",{class:"p-0 font-bold relative",style:$({color:e(J)(((pt=e(o))==null?void 0:pt.pitch)+12,3)})},[V(l(e(Kt)[Math.round(((ht=e(o))==null?void 0:ht.pitch)+12)%12]),1),t("div",{class:"absolute top-0 bottom-0 left-0 w-full border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${50+100*((((ut=e(o))==null?void 0:ut.pitch)+12)%12-Math.round(((mt=e(o))==null?void 0:mt.pitch)+12)%12)}%`})},null,4)],4),t("div",Us,l((100*((((vt=e(o))==null?void 0:vt.pitch)+12)%12-Math.round(((xt=e(o))==null?void 0:xt.pitch)+12)%12)).toFixed(2))+" %",1),Ys,Rs,t("div",qs,l(((bt=(ft=e(o))==null?void 0:ft.beats)==null?void 0:bt.toFixed(1))||0),1),Js,Gs,t("div",Ks,l(((yt=(gt=e(o))==null?void 0:gt.beat)==null?void 0:yt.toFixed(4))||0),1),Xs,Zs,t("div",{class:P(["p-0 font-bold",{active:(wt=e(o))==null?void 0:wt.pulse}])},l(((kt=e(o))==null?void 0:kt.pulse)||0),3),Qs]),t("div",to,[eo,so,t("div",oo,[t("button",{onClick:a[6]||(a[6]=k=>e(u)["time:steps"]--)},lo),t("div",ao,l(((St=($t=e(o))==null?void 0:$t.steps)==null?void 0:St.toFixed(0))||4),1),t("button",{onClick:a[7]||(a[7]=k=>e(u)["time:steps"]++)},co)]),ro,_o,t("div",po,l(((Mt=(Ct=e(o))==null?void 0:Ct.measures)==null?void 0:Mt.toFixed(4))||0),1),ho,uo,mo,t("div",vo,[V(l(((Ft=(Pt=e(o))==null?void 0:Pt.measure)==null?void 0:Ft.toFixed(4))||0),1),t("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${((Bt=e(o))==null?void 0:Bt.measure)*100}%`})},null,4)]),xo,fo,t("div",bo,[V(l(((Nt=e(o))==null?void 0:Nt["step-num"])+1||0)+" / "+l(((Vt=(Tt=e(o))==null?void 0:Tt.steps)==null?void 0:Vt.toFixed(0))||4),1),t("div",{class:"absolute top-0 bottom-0 left-0 active border-r-2 border-dark-900 dark-border-light-900",style:$({width:`${((At=e(o))==null?void 0:At["step-num"])/((It=(Dt=e(o))==null?void 0:Dt.steps)==null?void 0:It.toFixed(0))*100}%`})},null,4)]),go,yo,t("div",{class:P(["p-0 font-bold",{active:(zt=e(o))==null?void 0:zt["step-first"]}])},l((Lt=e(o))==null?void 0:Lt["step-first"]),3),wo,ko,t("div",{class:P(["p-0 font-bold",{active:(Ot=e(o))==null?void 0:Ot["step-odd"]}])},l((jt=e(o))==null?void 0:jt["step-odd"]),3),$o,So,t("div",{class:P(["p-0 font-bold",{active:(Ht=e(o))==null?void 0:Ht["step-even"]}])},l((Et=e(o))==null?void 0:Et["step-even"]),3),Co])],4)],64)}}},Po=Q(Mo,[["__scopeId","data-v-f1cfaa02"]]),Io=JSON.parse('{"title":"Musical transport","description":"How we subdivide time to have a rhythm","frontmatter":{"title":"Musical transport","description":"How we subdivide time to have a rhythm","date":"2018-10-30T00:00:00.000Z","layout":"app","cover":"cover.png","links":"https://discord.com/channels/826071713426178078/834787928688689172/1127958693695205387"},"headers":[],"relativePath":"practice/rhythm/time/index.md","filePath":"practice/rhythm/time/index.md","lastUpdated":1714652013000}'),Fo={name:"practice/rhythm/time/index.md"};function Bo(n,o,u,F,v,c){const x=Po,y=oe("client-only");return _(),p("div",null,[G(y,null,{default:se(()=>[G(x)]),_:1})])}const zo=Q(Fo,[["render",Bo]]);export{Io as __pageData,zo as default};
