import{r as I,p as X,f as B}from"./chunks/calculations.2bac3e9a.js";import{n as H,g as T}from"./chunks/colors.93330ee5.js";import{n as L}from"./chunks/theory.61e5aadb.js";import{_ as N,k as $,o as c,c as u,F as S,r as C,z as R,A as E,h as F,t as _,L as J,j as p,w as j,v as A,m as W,x as Z,a as l,y as P,d as z,g as b,C as U,p as G,e as K}from"./chunks/framework.2f46aeb8.js";import{_ as Q}from"./chunks/ControlRotary.7f343947.js";import{t as tt,S as O,F as V}from"./chunks/index.3012fc8f.js";import{c as et}from"./chunks/audio.e0c178f7.js";import"./chunks/index.654bd828.js";import"./chunks/midi.0fea24b9.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.b30cd6d2.js";import"./chunks/synth.05e847c0.js";import"./chunks/Scale.355f6405.js";import"./chunks/Subtract.f884a3f3.js";import"./chunks/PingPongDelay.89305ffe.js";import"./chunks/AutoPanner.e1652306.js";import"./chunks/MonoSynth.fec20097.js";import"./chunks/Filter.1fb23e5e.js";import"./chunks/index.be2db0d7.js";import"./chunks/index.86652af6.js";const ot={class:"flex justify-center min-h-2rem"},nt=["onMouseover","onMouseleave","onClick"],st={__name:"ControlPiano",props:{pitch:{type:Number,default:0},chroma:String,size:{type:String,default:"2"},names:Boolean},emits:["update:pitch"],setup(f,{emit:o}){const x=f,y=[...L].map((g,k)=>({name:g,pitch:k})),n=$({notes:I(y,3)});function q(g){if(x.chroma)return I(x.chroma.split(""),-x.pitch)[g]==1}return(g,k)=>(c(),u("div",ot,[(c(!0),u(S,null,C(n.notes,r=>(c(),u("div",{class:R(["key",{black:r.name.length==2,tonic:r.pitch==f.pitch}]),key:r,onMouseover:i=>r.active=!0,onMouseleave:i=>r.active=!1,onClick:i=>o("update:pitch",r.pitch),style:E({backgroundColor:q(r.pitch)||r.active||r.pitch==f.pitch?F(H)(r.pitch,4,r.pitch==f.pitch?1:.4):""})},_(f.names?r.name:""),47,nt))),128))]))}},it=N(st,[["__scopeId","data-v-377ff691"]]);const rt=f=>(G("data-v-29d21fde"),f=f(),K(),f),at={class:"flex flex-col fullscreen-container rounded-3xl",id:"screen"},lt={class:"controls flex flex-wrap justify-center -mb-8 z-2 mt-8"},ct={class:"is-group flex items-center mr-2 gap-2"},ut={key:0,class:"i-la-play"},dt={key:1,class:"i-la-pause"},pt={class:"is-group flex items-center gap-2"},ht={class:"relative flex flex-col items-center"},mt=rt(()=>l("div",{class:"i-bi-volume-up"},null,-1)),ft=[mt],vt=["viewBox"],_t={id:"edges"},xt=["y2"],yt=["x1","x2","y2"],gt=["y","width","height","fill","opacity"],wt=["stroke-width"],$t=["fill"],bt=["cx","fill"],kt={fill:"currentColor",x:-2,"text-anchor":"end",y:"2","font-size":"4px"},Mt=["x"],Pt=["data-num","transform","onMouseenter","onMouseover","onMouseleave","onMousedown","onTouchstart","onMouseup","onTouchend","onTouchcancel"],St=["y","width","height","fill","opacity"],Ct=["stroke-width"],qt={fill:"currentColor",x:-2,"text-anchor":"end",y:"-3","font-size":"4px","font-weight":"bold"},Tt={fill:"currentColor",x:-2,"text-anchor":"end",y:"2","font-size":"4px"},zt=["x"],Vt=["x"],Ft=["cx","r","fill"],Nt=["x1","x2","y1","stroke","opacity"],Yt={__name:"SoundOvertones",setup(f){const o=$({width:150,height:200,padX:30,padY:20,x:0,y:0,stroke:"currentColor",fill:"none","stroke-width":.2});let x=null,y=null;const n=$({started:!1,enabled:!1,async init(){if(n.started){n.enabled=!n.enabled;return}await tt(),n.started=!0,n.enabled=!0;const{channel:a}=et("overtones");x=new O({oscillator:{type:"sine"},volume:-10,envelope:{attack:.1,decay:.01,sustain:1,release:4}}).connect(a),y=new O({oscillator:{type:"sawtooth8"},volume:-10,envelope:{attack:.1,decay:.01,sustain:1,release:4}}).connect(a)},playSaw(a){if(!n.enabled)return n.init(),null;y.triggerAttack(a)},stopSaw(){n.enabled&&y.triggerRelease()},play(a,t){if(!n.enabled)return n.init(),null;y.volume.rampTo(-10-100*t,.01),x.triggerAttack(a,"+0.1",(s.count-t)/s.count)},stop(){n.enabled&&x.triggerRelease()},change(a,t){n.enabled&&(y.volume.rampTo(-10-100*t,.01),x.setNote(a))}}),{timestamp:q,pause:g,resume:k}=J({controls:!0,offset:-Date.now()}),r=$({phase:p(()=>r.speed*(q.value/100)%100/100),speed:1,move:!0});j(()=>r.move,a=>{a?k():g()},{immediate:!0});const i=$({pitch:0,octave:A("overtones-octave",2),frequency:p(()=>X(T.tonic,i.octave)),points:p(()=>{let a=[];for(let t=0;t<=o.width;t+=1){let d=0;for(let w=0;w<=s.count;w++)d=d+Y(w,t,r.phase)/Math.exp(w/2+1);let m=o.height/(3*s.count)*d*5;a[t]=`${t},${m}`}return a.join(" ")}),stroke:p(()=>B(i.frequency)),note:p(()=>V(i.frequency).toNote()),cents:p(()=>D(i.frequency,V(i.note).toFrequency()))}),s=$({count:A("overtones-count",7),min:2,max:15,list:[],intervals:["P8","P8+P5","2P8","2P8+M3","2P8+P5","2P8+m7","3P8","3P8+M2","3P8+M3","3P8+TT","3P8+P5","3P8+n6","3P8+P5+m3","3P8+M7","4P8"]});j(()=>s.count,a=>{s.list=[];for(let t=1;t<=a;t++)s.list[t-1]={frequency:p(()=>i.frequency*(t+1)),note:p(()=>{let d=s.list[t-1].frequency;return V(d).toNote()}),cents:p(()=>D(i.frequency,s.list[t-1].frequency).toFixed(0)),centDiff:p(()=>s.list[t-1].cents-Math.round(s.list[t-1].cents/100)*100),position:p(()=>t*(o.height-o.padY)/s.count),stroke:p(()=>B(s.list[t-1].frequency)),amplitude:p(()=>o.height/(3*a*t/2)),points:p(()=>{let d=[];for(let m=0;m<=o.width;m+=1){let w=s.list[t-1].amplitude*Y(t,m,r.phase);d[m]=`${m},${w}`}return d.join(" ")}),dots:p(()=>{let d=[];for(let m=0;m<=t;m++)d.push(o.width/t*m);return d})}},{immediate:!0});function Y(a,t,d){return Math.sin(Math.PI*a*t/o.width)*Math.cos(d*a*2*Math.PI)}function D(a,t){return-(1200/Math.log10(2))*Math.log10(a/t)%1200}return(a,t)=>{const d=Q,m=it,w=W("overtones-guitar"),M=Z("tooltip");return c(),u("div",at,[l("div",lt,[l("div",ct,[P((c(),u("button",{class:"shadow p-3 m-1 border-1 border-current rounded",onClick:t[0]||(t[0]=e=>r.move=!r.move)},[r.move?z("",!0):(c(),u("div",ut)),r.move?(c(),u("div",dt)):z("",!0)])),[[M,"Toggle animation",void 0,{bottom:!0}]]),P(b(d,{modelValue:s.count,"onUpdate:modelValue":t[1]||(t[1]=e=>s.count=e),min:s.min,max:s.max,step:1,fixed:0,param:"count"},null,8,["modelValue","min","max"]),[[M,"Number of harmonics",void 0,{bottom:!0}]]),P(b(d,{modelValue:r.speed,"onUpdate:modelValue":t[2]||(t[2]=e=>r.speed=e),min:.2,max:2,step:.1,fixed:1,param:"speed"},null,8,["modelValue"]),[[M,"Speed of animation",void 0,{bottom:!0}]])]),l("div",pt,[P(b(m,{pitch:F(T).tonic,"onUpdate:pitch":t[3]||(t[3]=e=>F(T).tonic=e)},null,8,["pitch"]),[[M,"Fundamental pitch",void 0,{bottom:!0}]]),P(b(d,{modelValue:i.octave,"onUpdate:modelValue":t[4]||(t[4]=e=>i.octave=e),min:1,max:5,step:1,fixed:0,param:"octave"},null,8,["modelValue"]),[[M,"Octave of the fundamental pitch",void 0,{bottom:!0}]])])]),l("div",ht,[n.enabled?z("",!0):(c(),u("button",{key:0,class:"shadow p-3 m-1 border-1 border-current rounded absolute top-80",onClick:t[5]||(t[5]=e=>n.init())},ft))]),(c(),u("svg",{class:"w-full max-h-90vh",id:"overtones",version:"1.1",baseProfile:"full",viewBox:`${-o.padX} ${-3*o.padY} ${o.width+2*o.padX} ${o.height+3*o.padY}`,xmlns:"http://www.w3.org/2000/svg","font-family":"Commissioner, sans-serif",onMouseleave:t[13]||(t[13]=e=>n.stop())},[b(w,{length:o.width,transform:"translate(0,-1) rotate(180) translate(-150, -12)"},null,8,["length","transform"]),l("g",_t,[l("line",{x1:"0",x2:"0",y1:"0",y2:o.height-8,stroke:"gray","stroke-width":"0.2"},null,8,xt),l("line",{x1:o.width,x2:o.width,y1:"0",y2:o.height-8,stroke:"gray","stroke-width":"0.2"},null,8,yt)]),l("g",{class:"cursor-pointer",id:"fundamental",onMouseover:t[6]||(t[6]=e=>i.hover=!0),onMouseleave:t[7]||(t[7]=e=>{i.hover=!1,n.stopSaw()}),onMousedown:t[8]||(t[8]=e=>n.playSaw(i.frequency,!0)),onTouchstart:t[9]||(t[9]=e=>n.playSaw(i.frequency,!0)),onMouseup:t[10]||(t[10]=e=>n.stopSaw()),onTouchend:t[11]||(t[11]=e=>n.stopSaw()),onTouchcancel:t[12]||(t[12]=e=>n.stopSaw())},[l("rect",{class:"transition-all duration-200",x:"0",y:-.5*(o.height-o.padY)/s.count,width:o.width,height:(o.height-o.padY)/s.count,fill:i.stroke,opacity:i.hover?.2:.05},null,8,gt),l("polyline",U({fill:"none"},i,{"stroke-width":i.hover?2:1}),null,16,wt),l("circle",{cx:"0",cy:"0",r:"1",fill:i.stroke},null,8,$t),l("circle",{cx:o.width,cy:"0",r:"1",fill:i.stroke},null,8,bt),l("text",kt,_(i.frequency.toFixed(1))+" Hz ",1),l("text",{fill:"currentColor",x:o.width+2,"text-anchor":"start",y:"2","font-size":"4px"},_(i.note)+" ("+_(i.cents.toFixed(0))+" cents)",9,Mt)],32),(c(!0),u(S,null,C(s.list,(e,v)=>(c(),u("g",{class:"overtone cursor-pointer",key:e,"data-num":v+1,transform:`translate(0, ${e.position})`,onMouseenter:h=>n.change(e.frequency,v),onMouseover:h=>e.hover=!0,onMouseleave:h=>e.hover=!1,onMousedown:h=>{n.play(e.frequency,v),e.active=!0},onTouchstart:h=>{n.play(e.frequency,v),e.active=!0},onMouseup:h=>{n.stop(),e.active=!1},onTouchend:h=>{n.stop(),e.active=!1},onTouchcancel:h=>{n.stop(),e.active=!1}},[l("rect",{class:"transition-all duration-200",x:"0",y:-.5*(o.height-o.padY)/s.count,width:o.width,height:(o.height-o.padY)/s.count,fill:e.stroke,opacity:e.hover?.2:.05},null,8,St),l("polyline",U({class:"transition-all duration-200"},e,{fill:"none","stroke-width":e.hover?e.active?2:1:.5}),null,16,Ct),l("text",qt,_(v+1),1),l("text",Tt,_(e.frequency.toFixed(1))+" Hz",1),l("text",{"font-weight":"bold",fill:"currentColor",x:o.width+2,"text-anchor":"start",y:"-3","font-size":"4px"},_(s.intervals[v]),9,zt),l("text",{fill:"currentColor",x:o.width+2,"text-anchor":"start",y:"2","font-size":"4px"},_(e.note)+" ("+_(e.centDiff>0?"+":"")+_(e.centDiff)+" cents)",9,Vt),(c(!0),u(S,null,C(e.dots,h=>(c(),u("circle",{class:"transition-all duration-200",key:h,cy:"0",cx:h,r:e.hover?1.2:1,fill:e.stroke},null,8,Ft))),128))],40,Pt))),128)),(c(!0),u(S,null,C(s.list,(e,v)=>(c(),u("g",{class:"lines",key:v},[(c(!0),u(S,null,C(e.dots,h=>(c(),u("line",{key:h,x1:h,x2:h,y1:(v+1)*(o.height-o.padY)/s.count,y2:0,stroke:e.stroke,"stroke-width":"0.2",opacity:1-v/(s.count+2)},null,8,Nt))),128))]))),128))],40,vt))])}}},Dt=N(Yt,[["__scopeId","data-v-29d21fde"]]),re=JSON.parse('{"title":"String overtones","description":"String standing waves interactive visualization","frontmatter":{"title":"String overtones","description":"String standing waves interactive visualization","date":"2021-08-12T00:00:00.000Z","cover":"overtones.png"},"headers":[],"relativePath":"practice/sound/overtones/index.md","filePath":"practice/sound/overtones/index.md","lastUpdated":1694022443000}'),It={name:"practice/sound/overtones/index.md"},Bt=l("p",null,"A string fixed from both ends produces a harmonic set of incremental frequency partials, also called harmonics.",-1);function jt(f,o,x,y,n,q){const g=Dt;return c(),u("div",null,[b(g),Bt])}const ae=N(It,[["render",jt]]);export{re as __pageData,ae as default};
