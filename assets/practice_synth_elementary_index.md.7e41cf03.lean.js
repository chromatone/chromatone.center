import{_ as E}from"./chunks/ControlRotary.fd7ee63d.js";import{_ as P}from"./chunks/AnalysisScope.9e3019d1.js";import{_ as j}from"./chunks/AnalysisFFT.d5059f12.js";import{k as B,w as M,A as U,B as z,j as C,o as c,c as y,a as d,f as h,F as k,r as $,x as F,g as l,l as A,t as I,e as D,_ as T,m as O,n as J}from"./chunks/framework.88db3c26.js";import"./chunks/tuner.5a4b9afc.js";import"./chunks/audio.e7507cf6.js";import{a as N}from"./chunks/calculations.2bac3e9a.js";import"./chunks/colors.71e97f2b.js";import{u as q}from"./chunks/midi.b5556f9f.js";import"./chunks/loop.88bd9d68.js";import"./chunks/mic.dc5fa472.js";import"./chunks/midiRender.1914f0ed.js";import"./chunks/Midi.1f918097.js";import"./chunks/tempo.84043c62.js";import"./chunks/noise.4e878d58.js";import"./chunks/index.e98b5e67.js";import"./chunks/sequence.8d866e24.js";import{c as S}from"./chunks/synth.9919606b.js";import"./chunks/theory.f78bd4d6.js";import{s as e,u as K}from"./chunks/useAudio.3e05580d.js";import{u as L}from"./chunks/useUI.6a125045.js";import{w as R}from"./chunks/index.654bd828.js";import"./chunks/index.c020f286.js";import"./chunks/index.edce5462.js";import"./chunks/index.70261d75.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/index.78e9bb27.js";import"./chunks/Sequence.873f0209.js";import"./chunks/Loop.14cab9e9.js";import"./chunks/UserMedia.9dadeb85.js";import"./chunks/Subtract.109130cb.js";import"./chunks/OnePoleFilter.8566943f.js";import"./chunks/BitCrusher.b9cad20b.js";import"./chunks/Filter.ca6be54c.js";import"./chunks/AutoPanner.fd8dabdc.js";import"./chunks/Scale.b6214b1d.js";import"./chunks/PingPongDelay.7799470c.js";import"./chunks/MonoSynth.c00b1270.js";import"./chunks/index.28e8ae3d.js";function Z(f,o){return e.mul(440,e.pow(2,e.smooth(e.tau2pole(.001),e.const({key:`${o}:frequency`,value:(f-69)/12}))))}const G={"main:volume":{value:.2,min:0,max:1,step:.01},"osc:gain":{value:.5,min:0,max:1,step:.01},"osc:cut-off":{value:4,min:1,max:8,step:.5},"osc:cut-q":{value:1.1,min:0,max:5,step:.01},"osc:attack":{value:.01,min:.001,max:5,step:.01},"osc:decay":{value:.01,min:.001,max:4,step:.01},"osc:sustain":{value:.5,min:0,max:1,step:.01},"osc:release":{value:.01,min:.001,max:10,step:.01},"noise:gain":{value:.5,min:0,max:1,step:.01},"noise:band-q":{value:50,min:0,max:100,step:.1},"noise:attack":{value:.01,min:.001,max:5,step:.01},"noise:decay":{value:.01,min:.001,max:4,step:.01},"noise:sustain":{value:.5,min:0,max:1,step:.01},"noise:release":{value:.01,min:.001,max:10,step:.01},"fx:pingPong":{value:.3,min:0,max:1,step:.01}};function H(f=12){const o=B({list:Array(f).fill(!0).map((t,i)=>({key:`v${i}`,gate:0,midi:69,vel:0})),next:0,overflow:0});function u(t=60,i=0){if(i){do if(o.next++,o.next>=o.list.length&&(o.next=0,o.overflow++),o.overflow>3)break;while(o.list[o.next].gate==1);o.overflow=0,o.list[o.next].gate=1,o.list[o.next].midi=t,o.list[o.next].vel=i/127}else o.list.forEach(m=>{m.midi==t&&(m.gate=0)})}function g(t){o.list.forEach(i=>i.gate=0)}return{voices:o,cycleNote:u,stopAll:g}}function Q(){const{audio:f,render:o}=K(),{controls:u,groups:g,cv:t}=L(G,"synth"),{voices:i,cycleNote:m,stopAll:x}=H();M([i,u],()=>{f.layers.synth={volume:1,signal:w(e.scope({name:"synth",size:512},b(i.list)))},o("synth")});const{midi:v}=q();M(()=>v.note,n=>m(n.number,n.velocity));function a(n){let s=Z(n.midi,n.key),r=e.mul(t["osc:gain"],e.adsr(t["osc:attack"],t["osc:decay"],t["osc:sustain"],t["osc:release"],e.const({key:`${n.key}:gate`,value:n.gate})),e.lowpass(e.mul(t["osc:cut-off"],s),t["osc:cut-q"],e.blepsaw(s))),p=e.mul(t["noise:gain"],e.adsr(t["noise:attack"],t["noise:decay"],t["noise:sustain"],t["noise:release"],e.const({key:`${n.key}:gate`,value:n.gate})),e.bandpass(s,t["noise:band-q"],e.noise()));return e.mul(e.const({key:`${n.key}:vel`,value:n.vel}),e.add(r,p))}function b(n=i.list){return e.mul(t["main:volume"],e.mul(e.sqrt(e.const({key:"voice-count",value:1/n.length})),e.add(...n.map(s=>a(s)))))}function w(n){return Array(2).fill(null).map((s,r)=>e.add(n,e.mul(t["fx:pingPong"],e.delay({size:44100},e.ms2samps(300*(1+r*.75)),.2,n))))}return{groups:g,controls:u,voices:i,cycleNote:m,stopAll:x}}const W={class:"flex flex-col gap-2 is-group p-2 bg-light-200 dark-bg-dark-200 shadow rounded gap-6 select-none"},X={class:"flex flex-col relative select-none gap-4"},Y={class:"flex flex-wrap gap-1 font-mono w-full justify-around"},ee=["onMousedown","onMouseup","onMouseleave"],te={class:"flex flex-wrap gap-2 flex-1"},oe=d("div",{class:"i-la-play"},null,-1),se=[oe],ne=d("div",{class:"i-la-stop"},null,-1),ae=[ne],ie={class:"text-sm uppercase absolute -top-4 bg-light-300 dark-bg-dark-300 p-1 rounded"},le={__name:"SynthMain",setup(f){U(()=>{S.state.midi=!1}),z(()=>{S.state.midi=!0});const{groups:o,controls:u,voices:g,cycleNote:t,stopAll:i}=Q(),{midi:m}=q(),x=C(()=>Object.entries(m.activeNotes).reduce((v,a)=>(v=R(v).mix(N((Number(a[0])-9)%12),Number(a[1])/3).toRgbString(),v),"#888"));return(v,a)=>{const b=j,w=P,n=E;return c(),y("div",W,[d("div",X,[h(b),h(w,{class:"absolute top-8 pointer-events-none",name:"synth",color:x.value},null,8,["color"])]),d("div",Y,[(c(!0),y(k,null,$(l(g).list,(s,r)=>(c(),y("div",{class:"text-sm flex min-w-6 min-h-4 flex-1 text-center rounded-full justify-center items-center transition cursor-pointer",key:r,style:F({backgroundColor:l(N)(s.midi-9-24,3,void 0,s.gate?1:.2),opacity:s.gate?1:.5}),onMousedown:p=>s.gate=1,onMouseup:p=>s.gate=0,onMouseleave:p=>s.gate=0},null,44,ee))),128))]),d("div",te,[d("button",{class:"text-button",onMousedownPassive:a[0]||(a[0]=s=>l(t)(69,120)),onMouseupPassive:a[1]||(a[1]=s=>l(t)(69)),onTouchstart:a[2]||(a[2]=A(s=>l(t)(69,120),["prevent","stop"])),onTouchend:a[3]||(a[3]=A(s=>l(t)(69),["prevent","stop"])),onMouseleave:a[4]||(a[4]=s=>l(t)(69))},se,32),d("button",{class:"text-button",onClick:a[5]||(a[5]=s=>l(i)())},ae),(c(!0),y(k,null,$(l(o),(s,r)=>(c(),y("div",{class:"flex flex-wrap is-group p-2 gap-2 items-center relative",key:r},[d("div",ie,I(r),1),(c(!0),y(k,null,$(s,(p,_)=>(c(),D(n,{key:_,step:p.step,modelValue:l(u)[`${r}:${_}`],"onUpdate:modelValue":V=>l(u)[`${r}:${_}`]=V,min:p.min,max:p.max,param:_},null,8,["step","modelValue","onUpdate:modelValue","min","max","param"]))),128))]))),128))])])}}},He=JSON.parse('{"title":"Elementary synth","description":"MIDI enabled synthesizer built with Elementary audio library","frontmatter":{"title":"Elementary synth","description":"MIDI enabled synthesizer built with Elementary audio library","date":"2023-06-23T00:00:00.000Z","cover":"lockup.svg","layout":"app","links":["https://www.elementary.audio/docs/guides/Understanding_Keys","https://www.elementary.audio/docs/reference/Math","https://github.com/elemaudio/web-examples","https://github.com/bgins/coincident-spectra/blob/main/src/lib/audio/audio.ts","https://github.com/teetow/elementary_grid","https://www.nickwritesablog.com/drum-synthesis-in-javascript/","https://github.com/elemaudio/web-examples/blob/master/planets/app.js","https://github.com/teetow/elementary_grid/blob/master/src/lib/useSynth.tsx"]},"headers":[],"relativePath":"practice/synth/elementary/index.md","filePath":"practice/synth/elementary/index.md","lastUpdated":1699514985000}'),re={name:"practice/synth/elementary/index.md"};function me(f,o,u,g,t,i){const m=le,x=O("client-only");return c(),y("div",null,[h(x,null,{default:J(()=>[h(m)]),_:1})])}const Qe=T(re,[["render",me]]);export{He as __pageData,Qe as default};
