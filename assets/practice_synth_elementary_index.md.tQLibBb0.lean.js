import{_ as V}from"./chunks/MidiKeys.qqaO71Ng.js";import{_ as P}from"./chunks/ControlRotary.hLiHeOC0.js";import{_ as j}from"./chunks/AnalysisScope.R6qEf9z7.js";import{_ as U}from"./chunks/AnalysisFFT.ZxbKcu3X.js";import{k as z,w as M,E as B,G as C,j as F,o as d,c as g,a as f,f as x,F as k,r as $,A as I,g as l,l as A,t as D,e as T,_ as K,m as O,n as G}from"./chunks/framework.1uYGFCry.js";import"./chunks/tuner.Ezt5vaUc.js";import"./chunks/audio.MFPk3EpQ.js";import{a as N}from"./chunks/calculations.uITx2GSi.js";import"./chunks/colors.DQ3Nq55L.js";import{u as q}from"./chunks/midi.JUoUGMo3.js";import"./chunks/loop.D0hV7T70.js";import"./chunks/mic.qHB2ZCa_.js";import"./chunks/midiRender.uVc9GHxZ.js";import"./chunks/Midi.6fTTQsck.js";import"./chunks/tempo.tDAToNwG.js";import"./chunks/noise.eEwbfwiD.js";import"./chunks/index.RYxauP_R.js";import"./chunks/sequence.FcV5CLma.js";import{c as S}from"./chunks/synth.CftW3DNb.js";import"./chunks/theory.dOWEiwk1.js";import{s as e,u as J}from"./chunks/useAudio.v4d6K4-c.js";import{u as L}from"./chunks/useUI.iCAqI7r-.js";import{w as R}from"./chunks/index.kn6emmbE.js";import"./chunks/index.n8vJ2pLY.js";import"./chunks/index.Br-81dzg.js";import"./chunks/commonjsHelpers.4gQjN7DL.js";import"./chunks/index.dVM4alBU.js";import"./chunks/Sequence.kPz-JF-q.js";import"./chunks/Loop.bmxnTff3.js";import"./chunks/UserMedia.XqLXAXtE.js";import"./chunks/Subtract.6yvEFIfU.js";import"./chunks/OnePoleFilter.5ASB6TIv.js";import"./chunks/BitCrusher.SBH4EJwJ.js";import"./chunks/Filter.CUstuK5R.js";import"./chunks/AutoPanner.gYtD10Of.js";import"./chunks/Scale.nioafpJK.js";import"./chunks/PingPongDelay.cuD3qQq0.js";import"./chunks/MonoSynth.pp_JS1sF.js";import"./chunks/index.PseKhLT9.js";function Z(y,o){return e.mul(440,e.pow(2,e.smooth(e.tau2pole(.001),e.const({key:`${o}:frequency`,value:(y-69)/12}))))}const H={"main:volume":{value:.2,min:0,max:1,step:.01},"osc:gain":{value:.5,min:0,max:1,step:.01},"osc:cut-off":{value:4,min:1,max:8,step:.5},"osc:cut-q":{value:1.1,min:0,max:5,step:.01},"osc:attack":{value:.01,min:.001,max:5,step:.01},"osc:decay":{value:.01,min:.001,max:4,step:.01},"osc:sustain":{value:.5,min:0,max:1,step:.01},"osc:release":{value:.01,min:.001,max:10,step:.01},"noise:gain":{value:.5,min:0,max:1,step:.01},"noise:band-q":{value:50,min:0,max:100,step:.1},"noise:attack":{value:.01,min:.001,max:5,step:.01},"noise:decay":{value:.01,min:.001,max:4,step:.01},"noise:sustain":{value:.5,min:0,max:1,step:.01},"noise:release":{value:.01,min:.001,max:10,step:.01},"fx:pingPong":{value:.3,min:0,max:1,step:.01}};function Q(y=12){const o=z({list:Array(y).fill(!0).map((t,i)=>({key:`v${i}`,gate:0,midi:69,vel:0})),next:0,overflow:0});function u(t=60,i=0){if(i){do if(o.next++,o.next>=o.list.length&&(o.next=0,o.overflow++),o.overflow>3)break;while(o.list[o.next].gate==1);o.overflow=0,o.list[o.next].gate=1,o.list[o.next].midi=t,o.list[o.next].vel=i/127}else o.list.forEach(m=>{m.midi==t&&(m.gate=0)})}function _(t){o.list.forEach(i=>i.gate=0)}return{voices:o,cycleNote:u,stopAll:_}}function W(){const{audio:y,render:o}=J(),{controls:u,groups:_,cv:t}=L(H,"synth"),{voices:i,cycleNote:m,stopAll:v}=Q();M([i,u],()=>{y.layers.synth={volume:1,signal:w(e.scope({name:"synth",size:512},b(i.list)))},o("synth")});const{midi:p}=q();M(()=>p.note,n=>m(n.number,n.velocity));function a(n){let s=Z(n.midi,n.key),r=e.mul(t["osc:gain"],e.adsr(t["osc:attack"],t["osc:decay"],t["osc:sustain"],t["osc:release"],e.const({key:`${n.key}:gate`,value:n.gate})),e.lowpass(e.mul(t["osc:cut-off"],s),t["osc:cut-q"],e.blepsaw(s))),c=e.mul(t["noise:gain"],e.adsr(t["noise:attack"],t["noise:decay"],t["noise:sustain"],t["noise:release"],e.const({key:`${n.key}:gate`,value:n.gate})),e.bandpass(s,t["noise:band-q"],e.noise()));return e.mul(e.const({key:`${n.key}:vel`,value:n.vel}),e.add(r,c))}function b(n=i.list){return e.mul(t["main:volume"],e.mul(e.sqrt(e.const({key:"voice-count",value:1/n.length})),e.add(...n.map(s=>a(s)))))}function w(n){return Array(2).fill(null).map((s,r)=>e.add(n,e.mul(t["fx:pingPong"],e.delay({size:44100},e.ms2samps(300*(1+r*.75)),.2,n))))}return{groups:_,controls:u,voices:i,cycleNote:m,stopAll:v}}const X={class:"flex flex-col gap-2 is-group p-2 bg-light-200 dark-bg-dark-200 shadow rounded gap-6 select-none"},Y={class:"flex flex-col relative select-none gap-4"},ee={class:"flex flex-wrap gap-1 font-mono w-full justify-around"},te=["onMousedown","onMouseup","onMouseleave"],oe={class:"flex flex-wrap gap-2 flex-1"},se=f("div",{class:"i-la-play"},null,-1),ne=[se],ae=f("div",{class:"i-la-stop"},null,-1),ie=[ae],le={class:"text-sm uppercase absolute -top-4 bg-light-300 dark-bg-dark-300 p-1 rounded"},re={__name:"SynthMain",setup(y){B(()=>{S.state.midi=!1}),C(()=>{S.state.midi=!0});const{groups:o,controls:u,voices:_,cycleNote:t,stopAll:i}=W(),{midi:m}=q(),v=F(()=>Object.entries(m.activeNotes).reduce((p,a)=>(p=R(p).mix(N((Number(a[0])-9)%12),Number(a[1])/3).toRgbString(),p),"#888"));return(p,a)=>{const b=U,w=j,n=P;return d(),g("div",X,[f("div",Y,[x(b),x(w,{class:"absolute top-8 pointer-events-none",name:"synth",color:v.value},null,8,["color"])]),f("div",ee,[(d(!0),g(k,null,$(l(_).list,(s,r)=>(d(),g("div",{class:"text-sm flex min-w-6 min-h-4 flex-1 text-center rounded-full justify-center items-center transition cursor-pointer",key:r,style:I({backgroundColor:l(N)(s.midi-9-24,3,void 0,s.gate?1:.2),opacity:s.gate?1:.5}),onMousedown:c=>s.gate=1,onMouseup:c=>s.gate=0,onMouseleave:c=>s.gate=0},null,44,te))),128))]),f("div",oe,[f("button",{class:"text-button",onMousedownPassive:a[0]||(a[0]=s=>l(t)(69,120)),onMouseupPassive:a[1]||(a[1]=s=>l(t)(69)),onTouchstart:a[2]||(a[2]=A(s=>l(t)(69,120),["prevent","stop"])),onTouchend:a[3]||(a[3]=A(s=>l(t)(69),["prevent","stop"])),onMouseleave:a[4]||(a[4]=s=>l(t)(69))},ne,32),f("button",{class:"text-button",onClick:a[5]||(a[5]=s=>l(i)())},ie),(d(!0),g(k,null,$(l(o),(s,r)=>(d(),g("div",{class:"flex flex-wrap is-group p-2 gap-2 items-center relative",key:r},[f("div",le,D(r),1),(d(!0),g(k,null,$(s,(c,h)=>(d(),T(n,{key:h,step:c.step,modelValue:l(u)[`${r}:${h}`],"onUpdate:modelValue":E=>l(u)[`${r}:${h}`]=E,min:c.min,max:c.max,param:h},null,8,["step","modelValue","onUpdate:modelValue","min","max","param"]))),128))]))),128))])])}}},Qe=JSON.parse('{"title":"Elementary synth","description":"MIDI enabled synthesizer built with Elementary audio library","frontmatter":{"title":"Elementary synth","description":"MIDI enabled synthesizer built with Elementary audio library","date":"2023-06-23T00:00:00.000Z","cover":"lockup.svg","layout":"app","links":["https://www.elementary.audio/docs/guides/Understanding_Keys","https://www.elementary.audio/docs/reference/Math","https://github.com/elemaudio/web-examples","https://github.com/bgins/coincident-spectra/blob/main/src/lib/audio/audio.ts","https://github.com/teetow/elementary_grid","https://www.nickwritesablog.com/drum-synthesis-in-javascript/","https://github.com/elemaudio/web-examples/blob/master/planets/app.js","https://github.com/teetow/elementary_grid/blob/master/src/lib/useSynth.tsx"]},"headers":[],"relativePath":"practice/synth/elementary/index.md","filePath":"practice/synth/elementary/index.md","lastUpdated":1702998731000}'),me={name:"practice/synth/elementary/index.md"};function ue(y,o,u,_,t,i){const m=re,v=V,p=O("client-only");return d(),g("div",null,[x(p,null,{default:G(()=>[x(m),x(v)]),_:1})])}const We=K(me,[["render",ue]]);export{Qe as __pageData,We as default};
