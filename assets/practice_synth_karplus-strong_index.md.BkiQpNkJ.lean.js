import{_ as T}from"./chunks/MidiKeys.C9KfZh6p.js";import{aS as b,u as w,M as B}from"./chunks/theme.C2LY6ZKr.js";import{_ as F}from"./chunks/AnalysisFFT.BMb5g6V-.js";import{u as M,s as t}from"./chunks/useAudio.Deufqage.js";import{u as V}from"./chunks/useParams.B1BT8APE.js";import{o as U,Q as C,d as $,D as r,v as l,x as m,W as d,z as N,F as q,A as z,q as D}from"./chunks/framework.ivEh5B39.js";const O={key:1,class:"flex flex-col gap-6 p-2"},E={class:"flex flex-wrap p-2 gap-4"},J={__name:"StringSynth",setup(A){U(()=>b.state.midi=!1),C(()=>b.state.midi=!0);const{midi:y}=w(),c={"string:volume":{value:.8,min:0,max:1,step:.01},"string:smooth":{value:.8,min:1e-4,max:.1,step:.001,fixed:3},"string:feedback":{value:.995,min:.9,max:.9999,step:.001,fixed:3}},h={"string:trigger":{value:0,min:0,max:1,step:1,nostore:!0},"string:midi":{value:42,min:1,max:127,step:1,nostore:!0},"string:velocity":{value:0,min:1,max:127,step:1,nostore:!0}},{audio:i,render:k}=M(),{controls:o,cv:u}=V(c,"string"),{controls:p,cv:g}=V(h,"string-midi");return $(()=>y.note,e=>{p["string:trigger"]=e.velocity>0?1:0,p["string:midi"]=e==null?void 0:e.number,p["string:velocity"]=(e==null?void 0:e.velocity)/127}),$(()=>i.initiated,()=>{if(!i.initiated)return;let e=t.mul(440,t.pow(2,t.div(t.sub(g["string:midi"],69),12))),a=t.mul(t.div(1,e),1e3),_=t.adsr(1e-4,.2,.01,.2,g["string:trigger"]),f=t.mul(_,t.noise(),g["string:velocity"]),x=t.lowpass(880,6,f),s=t.adsr(.005,.2,0,.1,1),n=t.mul(s,t.cycle(t.mul(1,e)),.2),v=t.delay({size:44100},t.smooth(t.tau2pole(u["string:smooth"]),t.ms2samps(a)),u["string:feedback"],x),P=t.add(v,n),K=t.tanh(P);const S=t.mul(u["string:volume"],K);i.layers.string={volume:1,signal:[S,S]}}),(e,a)=>{const _=F,f=B,x=T;return r(i).started?(l(),m("div",O,[d(_),N("div",E,[(l(),m(q,null,z(c,(s,n)=>d(f,{param:n.split(":")[1],modelValue:r(o)[n],"onUpdate:modelValue":v=>r(o)[n]=v,min:s.min,max:s.max,fixed:s.fixed,step:s.step},null,8,["param","modelValue","onUpdate:modelValue","min","max","fixed","step"])),64))]),d(x)])):(l(),m("button",{key:0,class:"p-40 text-2xl font-bold bg-light-900 dark-bg-dark-700",onClick:a[0]||(a[0]=s=>r(k)())},"START "))}}},I=JSON.parse('{"title":"Karplus–Strong synthesis","description":"Pratical KS synth","frontmatter":{"title":"Karplus–Strong synthesis","description":"Pratical KS synth","date":"2024-06-01T00:00:00.000Z","cover":"ksa.png","layout":"app"},"headers":[],"relativePath":"practice/synth/karplus-strong/index.md","filePath":"practice/synth/karplus-strong/index.md","lastUpdated":1716918790000}'),L={name:"practice/synth/karplus-strong/index.md"};function Q(A,y,c,h,i,k){const o=J;return l(),m("div",null,[d(o)])}const X=D(L,[["render",Q]]);export{I as __pageData,X as default};
