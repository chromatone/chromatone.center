import{u as St}from"./chunks/audio.e7507cf6.js";import{c as Mt}from"./chunks/midi.b5556f9f.js";import{u as Et}from"./chunks/index.70261d75.js";import{k as Pt,w as dt,i as Rt,j as Ct,o as P,c as R,a as Y,t as ht,F as It,r as Tt,v as Lt,g as at,A as Ot,B as Wt,m as Gt,f as pt,n as Ut}from"./chunks/framework.88db3c26.js";import"./chunks/tuner.5a4b9afc.js";import"./chunks/colors.71e97f2b.js";import"./chunks/loop.88bd9d68.js";import"./chunks/mic.dc5fa472.js";import"./chunks/midiRender.1914f0ed.js";import"./chunks/Midi.1f918097.js";import"./chunks/tempo.84043c62.js";import"./chunks/noise.4e878d58.js";import"./chunks/index.e98b5e67.js";import"./chunks/sequence.8d866e24.js";import{c as ft}from"./chunks/synth.9919606b.js";import"./chunks/theory.f78bd4d6.js";import"./chunks/index.edce5462.js";import"./chunks/commonjsHelpers.de833af9.js";import"./chunks/calculations.2bac3e9a.js";import"./chunks/index.654bd828.js";import"./chunks/index.78e9bb27.js";import"./chunks/Sequence.873f0209.js";import"./chunks/Loop.14cab9e9.js";import"./chunks/UserMedia.9dadeb85.js";import"./chunks/Subtract.109130cb.js";import"./chunks/OnePoleFilter.8566943f.js";import"./chunks/BitCrusher.b9cad20b.js";import"./chunks/Filter.ca6be54c.js";import"./chunks/AutoPanner.fd8dabdc.js";import"./chunks/Scale.b6214b1d.js";import"./chunks/PingPongDelay.7799470c.js";import"./chunks/MonoSynth.c00b1270.js";import"./chunks/index.28e8ae3d.js";var zt=Object.defineProperty,jt=Object.defineProperties,Nt=Object.getOwnPropertyDescriptors,_t=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable,yt=(t,i,e)=>i in t?zt(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,tt=(t,i)=>{for(var e in i||(i={}))Ht.call(i,e)&&yt(t,e,i[e]);if(_t)for(var e of _t(i))Vt.call(i,e)&&yt(t,e,i[e]);return t},et=(t,i)=>jt(t,Nt(i)),gt=(t,i,e)=>{if(!i.has(t))throw TypeError("Cannot "+e)},o=(t,i,e)=>(gt(t,i,"read from private field"),e?e.call(t):i.get(t)),p=(t,i,e)=>{if(i.has(t))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(t):i.set(t,e)},u=(t,i,e,n)=>(gt(t,i,"write to private field"),n?n.call(t,e):i.set(t,e),e),O=(t,i,e)=>new Promise((n,r)=>{var s=l=>{try{c(e.next(l))}catch(d){r(d)}},a=l=>{try{c(e.throw(l))}catch(d){r(d)}},c=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,a);c((e=e.apply(t,i)).next())});function it(t){const i=t.filter(e=>!!e);return i.reduce((e,n)=>{const r="output"in e?e.output:e,s="input"in n?n.input:n;return r.connect(s),n}),()=>{i.reduce((e,n)=>{const r="output"in e?e.output:e,s="input"in n?n.input:n;return r.disconnect(s),n})}}function Ft(t){let i=t;const e=new Set;function n(a){return e.add(a),a(i),()=>{e.delete(a)}}function r(a){i=a,e.forEach(c=>c(i))}function s(){return i}return{subscribe:n,set:r,get:s}}function qt(){const t=new Set;function i(n){return t.add(n),()=>{t.delete(n)}}function e(n){t.forEach(r=>r(n))}return{subscribe:i,trigger:e}}function $t(t){let i=!1;return()=>{i||(i=!0,t.forEach(e=>e==null?void 0:e()))}}function Dt(t){return t*t/16129}function Bt(t){return Math.pow(10,t/20)}var x,D,C,I,nt,A,S,Jt=class{constructor(t,i){this.context=t,p(this,x,void 0),p(this,D,void 0),p(this,C,void 0),p(this,I,void 0),p(this,nt,void 0),p(this,A,void 0),p(this,S,!1);var e,n,r;u(this,A,{destination:(e=i==null?void 0:i.destination)!=null?e:t.destination,volume:(n=i==null?void 0:i.volume)!=null?n:100,volumeToGain:(r=i==null?void 0:i.volumeToGain)!=null?r:Dt}),this.input=t.createGain(),u(this,x,t.createGain()),u(this,I,it([this.input,o(this,x),o(this,A).destination]));const s=Ft(o(this,A).volume);this.setVolume=s.set,u(this,nt,s.subscribe(a=>{o(this,x).gain.value=o(this,A).volumeToGain(a)}))}addInsert(t){var i;if(o(this,S))throw Error("Can't add insert to disconnected channel");(i=o(this,C))!=null||u(this,C,[]),o(this,C).push(t),o(this,I).call(this),u(this,I,it([this.input,...o(this,C),o(this,x),o(this,A).destination]))}addEffect(t,i,e){var n;if(o(this,S))throw Error("Can't add effect to disconnected channel");const r=new GainNode(this.context);r.gain.value=e;const s="input"in i?i.input:i,a=it([o(this,x),r,s]);(n=o(this,D))!=null||u(this,D,[]),o(this,D).push({name:t,mix:r,disconnect:a})}sendEffect(t,i){var e;if(o(this,S))throw Error("Can't send effect to disconnected channel");const n=(e=o(this,D))==null?void 0:e.find(r=>r.name===t);n?n.mix.gain.value=i:console.warn("Send bus not found: "+t)}disconnect(){var t;o(this,S)||(u(this,S,!0),o(this,I).call(this),o(this,nt).call(this),(t=o(this,D))==null||t.forEach(i=>i.disconnect()),u(this,D,void 0))}};x=new WeakMap;D=new WeakMap;C=new WeakMap;I=new WeakMap;nt=new WeakMap;A=new WeakMap;S=new WeakMap;var y,Kt=class{constructor(t){this.compare=t,p(this,y,[])}push(t){const i=o(this,y).length;let e=0,n=i-1,r=i;for(;e<=n;){const s=Math.floor((e+n)/2);this.compare(t,o(this,y)[s])<0?(r=s,n=s-1):e=s+1}o(this,y).splice(r,0,t)}pop(){return o(this,y).shift()}peek(){return o(this,y)[0]}removeAll(t){const i=o(this,y).length;return u(this,y,o(this,y).filter(e=>!t(e))),o(this,y).length!==i}clear(){u(this,y,[])}size(){return o(this,y).length}};y=new WeakMap;function vt(t,i){return t&&i?e=>{t(e),i(e)}:t??i}function Qt(t){var i,e;const n={scheduleLookaheadMs:(i=t.scheduleLookaheadMs)!=null?i:200,scheduleIntervalMs:(e=t.scheduleIntervalMs)!=null?e:50,onStart:t.onStart,onEnded:t.onEnded};if(n.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(n.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(n.scheduleLookaheadMs<n.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return n}var M,m,E,Xt=class{constructor(t,i={}){p(this,M,void 0),p(this,m,void 0),p(this,E,void 0),u(this,M,Qt(i)),u(this,m,new Kt((e,n)=>e.time-n.time)),this.player=t}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return o(this,E)!==void 0}start(t){var i;const e=this.player.context,n=e.currentTime,r=(i=t.time)!=null?i:n,s=o(this,M).scheduleLookaheadMs/1e3;return t.onStart=vt(t.onStart,o(this,M).onStart),t.onEnded=vt(t.onEnded,o(this,M).onEnded),r<n+s?this.player.start(t):(o(this,m).push(et(tt({},t),{time:r})),o(this,E)||u(this,E,setInterval(()=>{const a=e.currentTime+s;for(;o(this,m).size()&&o(this,m).peek().time<=a;){const c=o(this,m).pop();c&&this.player.start(c)}o(this,m).size()||(clearInterval(o(this,E)),u(this,E,void 0))},o(this,M).scheduleIntervalMs)),a=>{!a||a<r?o(this,m).removeAll(c=>c===t)||this.player.stop(et(tt({},t),{time:a})):this.player.stop(et(tt({},t),{time:a}))})}stop(t){var i;if(this.player.stop(t),!t){o(this,m).clear();return}const e=(i=t==null?void 0:t.time)!=null?i:0,n=t==null?void 0:t.stopId;n?o(this,m).removeAll(r=>r.time>=e&&r.stopId?r.stopId===n:r.note===n):o(this,m).removeAll(r=>r.time>=e)}disconnect(){this.player.disconnect()}};M=new WeakMap;m=new WeakMap;E=new WeakMap;var N,T,H,Zt=class{constructor(t,i){this.context=t,this.options=i,p(this,N,void 0),p(this,T,!1),p(this,H,void 0);var e,n;u(this,N,{velocityToGain:(e=i.velocityToGain)!=null?e:Dt,destination:(n=i.destination)!=null?n:t.destination}),this.buffers={},u(this,H,qt())}start(t){var i,e,n,r,s,a,c,l,d,h,v,W,G,U;if(o(this,T))throw new Error("Can't start a sample on disconnected player");const g=this.context,w=t.name&&this.buffers[t.name]||this.buffers[t.note];if(!w)return console.warn(`Sample not found: '${t.note}'`),()=>{};const _=g.createBufferSource();_.buffer=w,_.detune.value=(e=(i=t.detune)!=null?i:this.options.detune)!=null?e:0;const F=((n=t.lpfCutoffHz)!=null?n:this.options.lpfCutoffHz)?new BiquadFilterNode(g,{type:"lowpass",frequency:t.lpfCutoffHz}):void 0,z=g.createGain(),q=(s=(r=t.velocity)!=null?r:this.options.velocity)!=null?s:100;z.gain.value=o(this,N).velocityToGain(q),((a=t.loop)!=null?a:this.options.loop)&&(_.loop=!0,_.loopStart=(c=t.loopStart)!=null?c:0,_.loopEnd=(l=t.loopEnd)!=null?l:w.duration);const $=(d=t.decayTime)!=null?d:this.options.decayTime,[B,J]=Yt(g,$);function k(f){if(f??(f=g.currentTime),f<=j)_.stop(f);else{const ct=J(f);_.stop(ct)}}const K=t.gainOffset?new GainNode(g,{gain:t.gainOffset}):void 0,Q=(h=t.stopId)!=null?h:t.note,X=$t([it([_,F,z,B,K,o(this,N).destination]),(v=t.stop)==null?void 0:v.call(t,k),o(this,H).subscribe(f=>{(!f||f.stopId===void 0||f.stopId===Q)&&k(f==null?void 0:f.time)})]);_.onended=()=>{var f;X(),(f=t.onEnded)==null||f.call(t,t)},(W=t.onStart)==null||W.call(t,t);const j=Math.max((G=t.time)!=null?G:0,g.currentTime);_.start(t.time);let Z=(U=t.duration)!=null?U:w.duration;return typeof t.duration=="number"&&k(j+Z),k}stop(t){o(this,H).trigger(t)}disconnect(){o(this,T)||(u(this,T,!0),this.stop(),Object.keys(this.buffers).forEach(t=>{delete this.buffers[t]}))}get connected(){return!o(this,T)}};N=new WeakMap;T=new WeakMap;H=new WeakMap;function Yt(t,i=.2){let e=0;const n=new GainNode(t,{gain:1});function r(s){if(e)return e;n.gain.cancelScheduledValues(s);const a=s||t.currentTime;return e=a+i,n.gain.setValueAtTime(1,a),n.gain.linearRampToValueAtTime(0,e),e}return[n,r]}var te=class{constructor(t,i){this.context=t;const e=new Jt(t,i);this.player=new Xt(new Zt(t,et(tt({},i),{destination:e.input})),i),this.output=e}get buffers(){return this.player.buffers}start(t){return this.player.start(t)}stop(t){this.player.stop(typeof t=="object"?t:t!==void 0?{stopId:t}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function ee(t){if(typeof document>"u")return null;const i=document.createElement("audio");for(let e=0;e<t.length;e++){const n=t[e],r=i.canPlayType(`audio/${n}`);if(r==="probably"||r==="maybe")return n;if(n==="m4a"){const s=i.canPlayType("audio/aac");if(s==="probably"||s==="maybe")return n}}return null}var ie={fetch(t){return fetch(t)}};function ne(t){const e=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(t);if(!e)return;const n=e[1].toUpperCase();if(!n)return;const r=e[2],s=r[0]==="b"?-r.length:r.length,a=e[3]?+e[3]:4,c=(n.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][c]+s+12*(a+1)}function lt(t){return t===void 0?void 0:typeof t=="number"?t:ne(t)}function re(t={}){return{regions:[],sample:t}}function se(t,i,e){const n=lt(i.note);if(n!==void 0)for(const r of t.regions){const s=oe(n,e??0,i,r,t.sample);if(s)return s}}function oe(t,i,e,n,r){var s,a,c,l,d,h,v,W,G,U,g,w,_,st,F,z,q,ot,$,B,J,k,K,Q,X,j,Z;if(!(t>=((s=n.midiLow)!=null?s:0)&&t<=((a=n.midiHigh)!=null?a:127))||!(e.velocity===void 0||e.velocity>=((c=n.velLow)!=null?c:0)&&e.velocity<=((l=n.velHigh)!=null?l:127)))return;if(n.seqLength){const xt=i%n.seqLength,At=((d=n.seqPosition)!=null?d:1)-1;if(xt!==At)return}const bt=t-n.midiPitch,ut=(h=e.velocity)!=null?h:r.velocity,wt=n.volume?Bt(n.volume):0,kt=(W=(v=e.gainOffset)!=null?v:r.gainOffset)!=null?W:0;return{decayTime:(g=(U=e==null?void 0:e.decayTime)!=null?U:(G=n.sample)==null?void 0:G.decayTime)!=null?g:r.decayTime,detune:100*(bt+((w=n.tune)!=null?w:0)),duration:(F=(st=e==null?void 0:e.duration)!=null?st:(_=n.sample)==null?void 0:_.duration)!=null?F:r.duration,gainOffset:kt+wt||void 0,loop:(ot=(q=e==null?void 0:e.loop)!=null?q:(z=n.sample)==null?void 0:z.loop)!=null?ot:r.loop,loopEnd:(J=(B=e==null?void 0:e.loopEnd)!=null?B:($=n.sample)==null?void 0:$.loopEnd)!=null?J:r.loopEnd,loopStart:(Q=(K=e==null?void 0:e.loopStart)!=null?K:(k=n.sample)==null?void 0:k.loopStart)!=null?Q:r.loopStart,lpfCutoffHz:(Z=(j=e==null?void 0:e.lpfCutoffHz)!=null?j:(X=n.sample)==null?void 0:X.lpfCutoffHz)!=null?Z:r.lpfCutoffHz,name:n.sampleName,note:t,onEnded:e.onEnded,onStart:e.onStart,stopId:e.name,time:e.time,velocity:ut??void 0}}function ae(t){if(t.length===0)return[];if(t.sort((i,e)=>i.midiPitch-e.midiPitch),t[0].midiLow=0,t[0].midiHigh=127,t.length===1)return t;for(let i=1;i<t.length;i++){const e=t[i-1],n=t[i],r=Math.floor((e.midiPitch+n.midiPitch)/2);e.midiHigh=r,n.midiLow=r+1}return t[t.length-1].midiHigh=127,t}var le='"use strict";(()=>{var f=class extends AudioWorkletProcessor{_pDLength;_preDelay;_pDWrite;_lp1;_lp2;_lp3;_excPhase;_taps;_Delays;sampleRate;static get parameterDescriptors(){return[["preDelay",0,0,sampleRate-1,"k-rate"],["bandwidth",.9999,0,1,"k-rate"],["inputDiffusion1",.75,0,1,"k-rate"],["inputDiffusion2",.625,0,1,"k-rate"],["decay",.5,0,1,"k-rate"],["decayDiffusion1",.7,0,.999999,"k-rate"],["decayDiffusion2",.5,0,.999999,"k-rate"],["damping",.005,0,1,"k-rate"],["excursionRate",.5,0,2,"k-rate"],["excursionDepth",.7,0,2,"k-rate"],["wet",1,0,1,"k-rate"],["dry",0,0,1,"k-rate"]].map(e=>new Object({name:e[0],defaultValue:e[1],minValue:e[2],maxValue:e[3],automationRate:e[4]}))}constructor(e){super(),this.sampleRate=sampleRate,this._Delays=[],this._pDLength=sampleRate+(128-sampleRate%128),this._preDelay=new Float32Array(this._pDLength),this._pDWrite=0,this._lp1=0,this._lp2=0,this._lp3=0,this._excPhase=0,[.004771345,.003595309,.012734787,.009307483,.022579886,.149625349,.060481839,.1249958,.030509727,.141695508,.089244313,.106280031].forEach(a=>this.makeDelay(a,sampleRate)),this._taps=Int16Array.from([.008937872,.099929438,.064278754,.067067639,.066866033,.006283391,.035818689,.011861161,.121870905,.041262054,.08981553,.070931756,.011256342,.004065724],a=>Math.round(a*sampleRate))}makeDelay(e,a){let t=Math.round(e*a),s=2**Math.ceil(Math.log2(t));this._Delays.push([new Float32Array(s),t-1,0,s-1])}writeDelay(e,a){return this._Delays[e][0][this._Delays[e][1]]=a}readDelay(e){return this._Delays[e][0][this._Delays[e][2]]}readDelayAt(e,a){let t=this._Delays[e];return t[0][t[2]+a&t[3]]}readDelayCAt(e,a){let t=this._Delays[e],s=a-~~a,d=~~a+t[2]-1,r=t[3],D=t[0][d++&r],l=t[0][d++&r],h=t[0][d++&r],y=t[0][d&r],u=(3*(l-h)-D+y)/2,m=2*h+D-(5*l+y)/2,c=(h-D)/2;return((u*s+m)*s+c)*s+l}process(e,a,t){let s=~~t.preDelay[0],d=t.bandwidth[0],r=t.inputDiffusion1[0],D=t.inputDiffusion2[0],l=t.decay[0],h=t.decayDiffusion1[0],y=t.decayDiffusion2[0],u=1-t.damping[0],m=t.excursionRate[0]/sampleRate,c=t.excursionDepth[0]*sampleRate/1e3,w=t.wet[0]*.6,A=t.dry[0];if(e[0].length==2)for(let i=127;i>=0;i--)this._preDelay[this._pDWrite+i]=(e[0][0][i]+e[0][1][i])*.5,a[0][0][i]=e[0][0][i]*A,a[0][1][i]=e[0][1][i]*A;else if(e[0].length>0){this._preDelay.set(e[0][0],this._pDWrite);for(let i=127;i>=0;i--)a[0][0][i]=a[0][1][i]=e[0][0][i]*A}else this._preDelay.set(new Float32Array(128),this._pDWrite);let o=0;for(;o<128;){let i=0,b=0;this._lp1+=d*(this._preDelay[(this._pDLength+this._pDWrite-s+o)%this._pDLength]-this._lp1);let p=this.writeDelay(0,this._lp1-r*this.readDelay(0));p=this.writeDelay(1,r*(p-this.readDelay(1))+this.readDelay(0)),p=this.writeDelay(2,r*p+this.readDelay(1)-D*this.readDelay(2)),p=this.writeDelay(3,D*(p-this.readDelay(3))+this.readDelay(2));let k=D*p+this.readDelay(3),g=c*(1+Math.cos(this._excPhase*6.28)),x=c*(1+Math.sin(this._excPhase*6.2847)),_=this.writeDelay(4,k+l*this.readDelay(11)+h*this.readDelayCAt(4,g));this.writeDelay(5,this.readDelayCAt(4,g)-h*_),this._lp2+=u*(this.readDelay(5)-this._lp2),_=this.writeDelay(6,l*this._lp2-y*this.readDelay(6)),this.writeDelay(7,this.readDelay(6)+y*_),_=this.writeDelay(8,k+l*this.readDelay(7)+h*this.readDelayCAt(8,x)),this.writeDelay(9,this.readDelayCAt(8,x)-h*_),this._lp3+=u*(this.readDelay(9)-this._lp3),_=this.writeDelay(10,l*this._lp3-y*this.readDelay(10)),this.writeDelay(11,this.readDelay(10)+y*_),i=this.readDelayAt(9,this._taps[0])+this.readDelayAt(9,this._taps[1])-this.readDelayAt(10,this._taps[2])+this.readDelayAt(11,this._taps[3])-this.readDelayAt(5,this._taps[4])-this.readDelayAt(6,this._taps[5])-this.readDelayAt(7,this._taps[6]),b=this.readDelayAt(5,this._taps[7])+this.readDelayAt(5,this._taps[8])-this.readDelayAt(6,this._taps[9])+this.readDelayAt(7,this._taps[10])-this.readDelayAt(9,this._taps[11])-this.readDelayAt(10,this._taps[12])-this.readDelayAt(11,this._taps[13]),a[0][0][o]+=i*w,a[0][1][o]+=b*w,this._excPhase+=m,o++;for(let R=0,n=this._Delays[0];R<this._Delays.length;n=this._Delays[++R])n[1]=n[1]+1&n[3],n[2]=n[2]+1&n[3]}return this._pDWrite=(this._pDWrite+128)%this._pDLength,!0}};registerProcessor("DattorroReverb",f);})();',ce=["preDelay","bandwidth","inputDiffusion1","inputDiffusion2","decay","decayDiffusion1","decayDiffusion2","damping","excursionRate","excursionDepth","wet","dry"],mt=new WeakMap;function ue(t){return O(this,null,function*(){let i=mt.get(t);if(!i){const n=new Blob([le],{type:"application/javascript"}),r=URL.createObjectURL(n);i=t.audioWorklet.addModule(r),mt.set(t,i)}return yield i,new AudioWorkletNode(t,"DattorroReverb",{outputChannelCount:[2]})})}var b,rt,L,de=class{constructor(t){p(this,b,void 0),p(this,rt,void 0),p(this,L,void 0),this.input=t.createGain(),u(this,L,t.destination),u(this,rt,ue(t).then(i=>(this.input.connect(i),i.connect(o(this,L)),u(this,b,i),this)))}get paramNames(){return ce}getParam(t){var i;return(i=o(this,b))==null?void 0:i.parameters.get("preDelay")}get isReady(){return o(this,b)!==void 0}ready(){return o(this,rt)}connect(t){o(this,b)&&(o(this,b).disconnect(o(this,L)),o(this,b).connect(t)),u(this,L,t)}};b=new WeakMap;rt=new WeakMap;L=new WeakMap;function he(t,i){var e;const n=(e=ee(["ogg","mp3"]))!=null?e:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${i}/${t}-${n}.js`}function pe(t,i,e){return(n,r)=>O(this,null,function*(){const s=yield(yield r.fetch(t)).text(),a=fe(s),c=Object.keys(a);yield Promise.all(c.map(l=>O(this,null,function*(){const d=lt(l);if(!d)return;const h=ye(_e(a[l])),v=yield n.decodeAudioData(h);i[l]=v,e.regions.push({sampleName:l,midiPitch:d})}))),ae(e.regions)})}function fe(t){const i=t.indexOf("MIDI.Soundfont.");if(i<0)throw Error("Invalid MIDI.js Soundfont format");const e=t.indexOf("=",i)+2,n=t.lastIndexOf(",");return JSON.parse(t.slice(e,n)+"}")}function _e(t){return t.slice(t.indexOf(",")+1)}function ye(t){const i=window.atob(t),e=i.length,n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=i.charCodeAt(r);return n.buffer}var ve=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function me(t,i){if(!t.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${i}/${t}-loop.json`}function ge(t){return O(this,null,function*(){if(t)try{const i=yield fetch(t);if(i.status!==200)return;const e=yield i.json(),n={},r=41e3;return Object.keys(e).forEach(s=>{const a=lt(s);if(a){const c=e[s];n[a]=[c[0]/r,c[1]/r]}}),n}catch{return}})}function De(){return ve}var V,be=class{constructor(t,i){this.context=t,p(this,V,void 0),this.config=ke(i),this.player=new te(t,i),this.group=re(),u(this,V,!1);const e=we(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=e(t,this.config.storage).then(r=>(u(this,V,r),this));const n=new GainNode(t,{gain:this.config.extraGain});this.player.output.addInsert(n)}get output(){return this.player.output}get hasLoops(){return o(this,V)}loaded(){return O(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(t){const i=se(this.group,typeof t=="object"?t:{note:t});return i?this.player.start(i):()=>{}}stop(t){return this.player.stop(t)}};V=new WeakMap;function we(t,i,e,n){const r=pe(t,e,n);return(s,a)=>O(this,null,function*(){const[c,l]=yield Promise.all([r(s,a),ge(i)]);return l&&n.regions.forEach(d=>{var h;const v=l[d.midiPitch];v&&((h=d.sample)!=null||(d.sample={}),d.sample.loop=!0,d.sample.loopStart=v[0],d.sample.loopEnd=v[1])}),!!l})}function ke(t){var i,e,n,r;if(!t.instrument&&!t.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");const s={kit:"MusyngKite",instrument:t.instrument,storage:(i=t.storage)!=null?i:ie,extraGain:(e=t.extraGain)!=null?e:5,loadLoopData:(n=t.loadLoopData)!=null?n:!1,loopDataUrl:t.loopDataUrl,instrumentUrl:(r=t.instrumentUrl)!=null?r:""};return s.instrument&&s.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),s.instrumentUrl=s.instrument,s.instrument=void 0),s.instrument&&!s.instrumentUrl&&(s.instrumentUrl=he(s.instrument,s.kit)),s.loadLoopData&&s.instrument&&!s.loopDataUrl&&(s.loopDataUrl=me(s.instrument,s.kit)),s}const xe={class:"flex flex-col gap-2"},Ae={class:"p-2 flex flex gap-2 items-center justify-center"},Se={class:"font-bold capitalize"},Me={class:"flex text-xs"},Ee={key:0,class:"i-la-spinner animate-pulse"},Pe={key:1,class:"i-la-check"},Re={class:"flex flex-wrap gap-1 px-8"},Ce=["onClick"],Ie={__name:"SynthFont",setup(t){const i=Et("sound-font","marimba"),e=Pt([]),{master:n}=St();dt(i,l=>{e[l]=!0});const r=Rt(!1),s=n.context,a=new de(s),c=Ct(()=>{r.value=!1;const l=new be(s,{instrument:i.value});return l.output.addEffect("reverb",a,.8),l.load.then(()=>{r.value=!0}),l});return dt(()=>Mt.note,l=>{r.value&&(l.type=="noteon"?c.value.start({note:l.number,velocity:l.velocity}):c.value.stop(l.number))}),(l,d)=>(P(),R("div",xe,[Y("div",Ae,[Y("div",Se,ht(c.value.config.instrument.replaceAll("_"," ")),1),Y("div",Me,[r.value?(P(),R("div",Pe,"Loaded!")):(P(),R("div",Ee))])]),Y("div",Re,[(P(!0),R(It,null,Tt(at(De)(),h=>(P(),R("button",{class:Lt(["transition p-1 text-sm cursor-pointer border-1 border-dark-900 border-opacity-10 rounded shadow flex-auto capitalize dark-border-light-200 dark-border-opacity-20",{"border-opacity-100 dark-border-opacity-90 scale-150":h==at(i),"opacity-50":h==at(i)&&!r.value,"bg-light-100 dark-bg-dark-900":!e[h],"bg-light-900 dark-bg-dark-100":e==null?void 0:e[h]}]),key:h,onClick:v=>i.value=h},ht(h.replaceAll("_"," ")),11,Ce))),128))])]))}},pi=JSON.parse('{"title":"Sampled soundfonts","description":"SMPLR - A modern soundfont library explorations","frontmatter":{"title":"Sampled soundfonts","description":"SMPLR - A modern soundfont library explorations","date":"2021-10-31T00:00:00.000Z","cover":"cover.png"},"headers":[],"relativePath":"practice/synth/sound-font/index.md","filePath":"practice/synth/sound-font/index.md","lastUpdated":1699971868000}'),Te={name:"practice/synth/sound-font/index.md"},fi=Object.assign(Te,{setup(t){return Ot(()=>{ft.state.midi=!1}),Wt(()=>{ft.state.midi=!0}),(i,e)=>{const n=Ie,r=Gt("client-only");return P(),R("div",null,[pt(r,null,{default:Ut(()=>[pt(n)]),_:1})])}}});export{pi as __pageData,fi as default};
