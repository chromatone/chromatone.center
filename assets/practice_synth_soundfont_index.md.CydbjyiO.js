import{_ as Et}from"./chunks/MidiKeys.D72g0oyo.js";import{ar as Pt,ap as Rt,aJ as _t}from"./chunks/theme.DSsKat3F.js";import{u as Ot,b as It,d as ft,r as Tt,c as Ct,x as I,y as T,A as et,F as Lt,B as Wt,z as Gt,E as lt,G as pt,o as Ut,R as zt,X as ct,N as jt,a1 as Ht}from"./chunks/framework.BY0U24KH.js";var Nt=Object.defineProperty,Vt=Object.defineProperties,Ft=Object.getOwnPropertyDescriptors,yt=Object.getOwnPropertySymbols,qt=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable,vt=(t,n,e)=>n in t?Nt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,nt=(t,n)=>{for(var e in n||(n={}))qt.call(n,e)&&vt(t,e,n[e]);if(yt)for(var e of yt(n))Bt.call(n,e)&&vt(t,e,n[e]);return t},it=(t,n)=>Vt(t,Ft(n)),Dt=(t,n,e)=>{if(!n.has(t))throw TypeError("Cannot "+e)},a=(t,n,e)=>(Dt(t,n,"read from private field"),e?e.call(t):n.get(t)),_=(t,n,e)=>{if(n.has(t))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(t):n.set(t,e)},u=(t,n,e,i)=>(Dt(t,n,"write to private field"),i?i.call(t,e):n.set(t,e),e),U=(t,n,e)=>new Promise((i,r)=>{var s=l=>{try{c(e.next(l))}catch(d){r(d)}},o=l=>{try{c(e.throw(l))}catch(d){r(d)}},c=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,o);c((e=e.apply(t,n)).next())});function rt(t){const n=t.filter(e=>!!e);return n.reduce((e,i)=>{const r="output"in e?e.output:e,s="input"in i?i.input:i;return r.connect(s),i}),()=>{n.reduce((e,i)=>{const r="output"in e?e.output:e,s="input"in i?i.input:i;return r.disconnect(s),i})}}function $t(t){let n=t;const e=new Set;function i(o){return e.add(o),o(n),()=>{e.delete(o)}}function r(o){n=o,e.forEach(c=>c(n))}function s(){return n}return{subscribe:i,set:r,get:s}}function Jt(){const t=new Set;function n(i){return t.add(i),()=>{t.delete(i)}}function e(i){t.forEach(r=>r(i))}return{subscribe:n,trigger:e}}function Kt(t){let n=!1;return()=>{n||(n=!0,t.forEach(e=>e==null?void 0:e()))}}function bt(t){return t*t/16129}function Xt(t){return Math.pow(10,t/20)}var A,b,C,L,st,M,E,Qt=class{constructor(t,n){this.context=t,_(this,A,void 0),_(this,b,void 0),_(this,C,void 0),_(this,L,void 0),_(this,st,void 0),_(this,M,void 0),_(this,E,!1);var e,i,r;u(this,M,{destination:(e=n==null?void 0:n.destination)!=null?e:t.destination,volume:(i=n==null?void 0:n.volume)!=null?i:100,volumeToGain:(r=n==null?void 0:n.volumeToGain)!=null?r:bt}),this.input=t.createGain(),u(this,A,t.createGain()),u(this,L,rt([this.input,a(this,A),a(this,M).destination]));const s=$t(a(this,M).volume);this.setVolume=s.set,u(this,st,s.subscribe(o=>{a(this,A).gain.value=a(this,M).volumeToGain(o)}))}addInsert(t){var n;if(a(this,E))throw Error("Can't add insert to disconnected channel");(n=a(this,C))!=null||u(this,C,[]),a(this,C).push(t),a(this,L).call(this),u(this,L,rt([this.input,...a(this,C),a(this,A),a(this,M).destination]))}addEffect(t,n,e){var i;if(a(this,E))throw Error("Can't add effect to disconnected channel");const r=this.context.createGain();r.gain.value=e;const s="input"in n?n.input:n,o=rt([a(this,A),r,s]);(i=a(this,b))!=null||u(this,b,[]),a(this,b).push({name:t,mix:r,disconnect:o})}sendEffect(t,n){var e;if(a(this,E))throw Error("Can't send effect to disconnected channel");const i=(e=a(this,b))==null?void 0:e.find(r=>r.name===t);i?i.mix.gain.value=n:console.warn("Send bus not found: "+t)}disconnect(){var t;a(this,E)||(u(this,E,!0),a(this,L).call(this),a(this,st).call(this),(t=a(this,b))==null||t.forEach(n=>n.disconnect()),u(this,b,void 0))}};A=new WeakMap;b=new WeakMap;C=new WeakMap;L=new WeakMap;st=new WeakMap;M=new WeakMap;E=new WeakMap;var y,Zt=class{constructor(t){this.compare=t,_(this,y,[])}push(t){const n=a(this,y).length;let e=0,i=n-1,r=n;for(;e<=i;){const s=Math.floor((e+i)/2);this.compare(t,a(this,y)[s])<0?(r=s,i=s-1):e=s+1}a(this,y).splice(r,0,t)}pop(){return a(this,y).shift()}peek(){return a(this,y)[0]}removeAll(t){const n=a(this,y).length;return u(this,y,a(this,y).filter(e=>!t(e))),a(this,y).length!==n}clear(){u(this,y,[])}size(){return a(this,y).length}};y=new WeakMap;function mt(t,n){return t&&n?e=>{t(e),n(e)}:t??n}function Yt(t){var n,e,i;const r={disableScheduler:(n=t.disableScheduler)!=null?n:!1,scheduleLookaheadMs:(e=t.scheduleLookaheadMs)!=null?e:200,scheduleIntervalMs:(i=t.scheduleIntervalMs)!=null?i:50,onStart:t.onStart,onEnded:t.onEnded};if(r.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(r.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(r.scheduleLookaheadMs<r.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return r}var D,m,P,te=class{constructor(t,n={}){_(this,D,void 0),_(this,m,void 0),_(this,P,void 0),u(this,D,Yt(n)),u(this,m,new Zt((e,i)=>e.time-i.time)),this.player=t}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return a(this,P)!==void 0}start(t){var n;if(a(this,D).disableScheduler)return this.player.start(t);const e=this.player.context,i=e.currentTime,r=(n=t.time)!=null?n:i,s=a(this,D).scheduleLookaheadMs/1e3;return t.onStart=mt(t.onStart,a(this,D).onStart),t.onEnded=mt(t.onEnded,a(this,D).onEnded),r<i+s?this.player.start(t):(a(this,m).push(it(nt({},t),{time:r})),a(this,P)||u(this,P,setInterval(()=>{const o=e.currentTime+s;for(;a(this,m).size()&&a(this,m).peek().time<=o;){const c=a(this,m).pop();c&&this.player.start(c)}a(this,m).size()||(clearInterval(a(this,P)),u(this,P,void 0))},a(this,D).scheduleIntervalMs)),o=>{!o||o<r?a(this,m).removeAll(c=>c===t)||this.player.stop(it(nt({},t),{time:o})):this.player.stop(it(nt({},t),{time:o}))})}stop(t){var n;if(a(this,D).disableScheduler)return this.player.stop(t);if(this.player.stop(t),!t){a(this,m).clear();return}const e=(n=t==null?void 0:t.time)!=null?n:0,i=t==null?void 0:t.stopId;i?a(this,m).removeAll(r=>r.time>=e&&r.stopId?r.stopId===i:r.note===i):a(this,m).removeAll(r=>r.time>=e)}disconnect(){this.player.disconnect()}};D=new WeakMap;m=new WeakMap;P=new WeakMap;var q,W,B,ee=class{constructor(t,n){this.context=t,this.options=n,_(this,q,void 0),_(this,W,!1),_(this,B,void 0);var e,i;u(this,q,{velocityToGain:(e=n.velocityToGain)!=null?e:bt,destination:(i=n.destination)!=null?i:t.destination}),this.buffers={},u(this,B,Jt())}start(t){var n,e,i,r,s,o,c,l,d,h,v,z,j,H;if(a(this,W))throw new Error("Can't start a sample on disconnected player");const g=this.context,k=t.name&&this.buffers[t.name]||this.buffers[t.note];if(!k)return console.warn(`Sample not found: '${t.note}'`),()=>{};const f=g.createBufferSource();f.buffer=k;const N=(e=(n=t.detune)!=null?n:this.options.detune)!=null?e:0;f.detune?f.detune.value=N:f.playbackRate&&(f.playbackRate.value=Math.pow(2,N/1200));const R=(i=t.lpfCutoffHz)!=null?i:this.options.lpfCutoffHz,x=R?g.createBiquadFilter():void 0;R&&x&&(x.type="lowpass",x.frequency.value=R);const V=g.createGain(),J=(s=(r=t.velocity)!=null?r:this.options.velocity)!=null?s:100;V.gain.value=a(this,q).velocityToGain(J),((o=t.loop)!=null?o:this.options.loop)&&(f.loop=!0,f.loopStart=(c=t.loopStart)!=null?c:0,f.loopEnd=(l=t.loopEnd)!=null?l:k.duration);const K=(d=t.decayTime)!=null?d:this.options.decayTime,[X,Q]=ne(g,K);function S(p){if(p??(p=g.currentTime),p<=F)f.stop(p);else{const dt=Q(p);f.stop(dt)}}const O=t.gainOffset?g.createGain():void 0;O&&t.gainOffset&&(O.gain.value=t.gainOffset);const Z=(h=t.stopId)!=null?h:t.note,Y=Kt([rt([f,x,V,X,O,a(this,q).destination]),(v=t.stop)==null?void 0:v.call(t,S),a(this,B).subscribe(p=>{(!p||p.stopId===void 0||p.stopId===Z)&&S(p==null?void 0:p.time)})]);f.onended=()=>{var p;Y(),(p=t.onEnded)==null||p.call(t,t)},(z=t.onStart)==null||z.call(t,t);const F=Math.max((j=t.time)!=null?j:0,g.currentTime);f.start(t.time);let tt=(H=t.duration)!=null?H:k.duration;return typeof t.duration=="number"&&S(F+tt),S}stop(t){a(this,B).trigger(t)}disconnect(){a(this,W)||(u(this,W,!0),this.stop(),Object.keys(this.buffers).forEach(t=>{delete this.buffers[t]}))}get connected(){return!a(this,W)}};q=new WeakMap;W=new WeakMap;B=new WeakMap;function ne(t,n=.2){let e=0;const i=t.createGain();i.gain.value=1;function r(s){if(e)return e;i.gain.cancelScheduledValues(s);const o=s||t.currentTime;return e=o+n,i.gain.setValueAtTime(1,o),i.gain.linearRampToValueAtTime(0,e),e}return[i,r]}var ie=class{constructor(t,n){this.context=t;const e=new Qt(t,n);this.player=new te(new ee(t,it(nt({},n),{destination:e.input})),n),this.output=e}get buffers(){return this.player.buffers}start(t){return this.player.start(t)}stop(t){this.player.stop(typeof t=="object"?t:t!==void 0?{stopId:t}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function re(t){if(typeof document>"u")return null;const n=document.createElement("audio");for(let e=0;e<t.length;e++){const i=t[e],r=n.canPlayType(`audio/${i}`);if(r==="probably"||r==="maybe")return i;if(i==="m4a"){const s=n.canPlayType("audio/aac");if(s==="probably"||s==="maybe")return i}}return null}var se={fetch(t){return fetch(t)}};function ae(t){const e=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(t);if(!e)return;const i=e[1].toUpperCase();if(!i)return;const r=e[2],s=r[0]==="b"?-r.length:r.length,o=e[3]?+e[3]:4,c=(i.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][c]+s+12*(o+1)}function ut(t){return t===void 0?void 0:typeof t=="number"?t:ae(t)}function oe(){return{regions:[]}}function le(t,n,e,i){const r=ut(n.note);if(r!==void 0)for(const s of t.regions){const o=ce(r,e??0,n,s,i);if(o)return o}}function ce(t,n,e,i,r){var s,o,c,l,d,h,v,z,j,H,g,k,f,N,R,x,V,J,ot,K,X,Q,S,O,Z,Y,F,tt;if(!(t>=((s=i.midiLow)!=null?s:0)&&t<((o=i.midiHigh)!=null?o:127)+1)||!(e.velocity===void 0||e.velocity>=((c=i.velLow)!=null?c:0)&&e.velocity<=((l=i.velHigh)!=null?l:127)))return;if(i.seqLength){const At=n%i.seqLength,Mt=((d=i.seqPosition)!=null?d:1)-1;if(At!==Mt)return}const wt=t-i.midiPitch,ht=(h=e.velocity)!=null?h:r==null?void 0:r.velocity,kt=i.volume?Xt(i.volume):0,xt=(z=(v=e.gainOffset)!=null?v:r==null?void 0:r.gainOffset)!=null?z:0,St=(j=e.detune)!=null?j:0;return{decayTime:(k=(g=e==null?void 0:e.decayTime)!=null?g:(H=i.sample)==null?void 0:H.decayTime)!=null?k:r==null?void 0:r.decayTime,detune:100*(wt+((f=i.tune)!=null?f:0))+St,duration:(x=(R=e==null?void 0:e.duration)!=null?R:(N=i.sample)==null?void 0:N.duration)!=null?x:r==null?void 0:r.duration,gainOffset:xt+kt||void 0,loop:(ot=(J=e==null?void 0:e.loop)!=null?J:(V=i.sample)==null?void 0:V.loop)!=null?ot:r==null?void 0:r.loop,loopEnd:(Q=(X=e==null?void 0:e.loopEnd)!=null?X:(K=i.sample)==null?void 0:K.loopEnd)!=null?Q:r==null?void 0:r.loopEnd,loopStart:(Z=(O=e==null?void 0:e.loopStart)!=null?O:(S=i.sample)==null?void 0:S.loopStart)!=null?Z:r==null?void 0:r.loopStart,lpfCutoffHz:(tt=(F=e==null?void 0:e.lpfCutoffHz)!=null?F:(Y=i.sample)==null?void 0:Y.lpfCutoffHz)!=null?tt:r==null?void 0:r.lpfCutoffHz,name:i.sampleName,note:t,onEnded:e.onEnded,onStart:e.onStart,stopId:e.name,time:e.time,velocity:ht??void 0}}function ue(t){if(t.length===0)return[];if(t.sort((n,e)=>n.midiPitch-e.midiPitch),t[0].midiLow=0,t[0].midiHigh=127,t.length===1)return t;for(let n=1;n<t.length;n++){const e=t[n-1],i=t[n],r=Math.floor((e.midiPitch+i.midiPitch)/2);e.midiHigh=r,i.midiLow=r+1}return t[t.length-1].midiHigh=127,t}var de='"use strict";(()=>{var f=class extends AudioWorkletProcessor{_pDLength;_preDelay;_pDWrite;_lp1;_lp2;_lp3;_excPhase;_taps;_Delays;sampleRate;static get parameterDescriptors(){return[["preDelay",0,0,sampleRate-1,"k-rate"],["bandwidth",.9999,0,1,"k-rate"],["inputDiffusion1",.75,0,1,"k-rate"],["inputDiffusion2",.625,0,1,"k-rate"],["decay",.5,0,1,"k-rate"],["decayDiffusion1",.7,0,.999999,"k-rate"],["decayDiffusion2",.5,0,.999999,"k-rate"],["damping",.005,0,1,"k-rate"],["excursionRate",.5,0,2,"k-rate"],["excursionDepth",.7,0,2,"k-rate"],["wet",1,0,1,"k-rate"],["dry",0,0,1,"k-rate"]].map(e=>new Object({name:e[0],defaultValue:e[1],minValue:e[2],maxValue:e[3],automationRate:e[4]}))}constructor(e){super(),this.sampleRate=sampleRate,this._Delays=[],this._pDLength=sampleRate+(128-sampleRate%128),this._preDelay=new Float32Array(this._pDLength),this._pDWrite=0,this._lp1=0,this._lp2=0,this._lp3=0,this._excPhase=0,[.004771345,.003595309,.012734787,.009307483,.022579886,.149625349,.060481839,.1249958,.030509727,.141695508,.089244313,.106280031].forEach(a=>this.makeDelay(a,sampleRate)),this._taps=Int16Array.from([.008937872,.099929438,.064278754,.067067639,.066866033,.006283391,.035818689,.011861161,.121870905,.041262054,.08981553,.070931756,.011256342,.004065724],a=>Math.round(a*sampleRate))}makeDelay(e,a){let t=Math.round(e*a),s=2**Math.ceil(Math.log2(t));this._Delays.push([new Float32Array(s),t-1,0,s-1])}writeDelay(e,a){return this._Delays[e][0][this._Delays[e][1]]=a}readDelay(e){return this._Delays[e][0][this._Delays[e][2]]}readDelayAt(e,a){let t=this._Delays[e];return t[0][t[2]+a&t[3]]}readDelayCAt(e,a){let t=this._Delays[e],s=a-~~a,d=~~a+t[2]-1,r=t[3],D=t[0][d++&r],l=t[0][d++&r],h=t[0][d++&r],y=t[0][d&r],u=(3*(l-h)-D+y)/2,m=2*h+D-(5*l+y)/2,c=(h-D)/2;return((u*s+m)*s+c)*s+l}process(e,a,t){let s=~~t.preDelay[0],d=t.bandwidth[0],r=t.inputDiffusion1[0],D=t.inputDiffusion2[0],l=t.decay[0],h=t.decayDiffusion1[0],y=t.decayDiffusion2[0],u=1-t.damping[0],m=t.excursionRate[0]/sampleRate,c=t.excursionDepth[0]*sampleRate/1e3,w=t.wet[0]*.6,A=t.dry[0];if(e[0].length==2)for(let i=127;i>=0;i--)this._preDelay[this._pDWrite+i]=(e[0][0][i]+e[0][1][i])*.5,a[0][0][i]=e[0][0][i]*A,a[0][1][i]=e[0][1][i]*A;else if(e[0].length>0){this._preDelay.set(e[0][0],this._pDWrite);for(let i=127;i>=0;i--)a[0][0][i]=a[0][1][i]=e[0][0][i]*A}else this._preDelay.set(new Float32Array(128),this._pDWrite);let o=0;for(;o<128;){let i=0,b=0;this._lp1+=d*(this._preDelay[(this._pDLength+this._pDWrite-s+o)%this._pDLength]-this._lp1);let p=this.writeDelay(0,this._lp1-r*this.readDelay(0));p=this.writeDelay(1,r*(p-this.readDelay(1))+this.readDelay(0)),p=this.writeDelay(2,r*p+this.readDelay(1)-D*this.readDelay(2)),p=this.writeDelay(3,D*(p-this.readDelay(3))+this.readDelay(2));let k=D*p+this.readDelay(3),g=c*(1+Math.cos(this._excPhase*6.28)),x=c*(1+Math.sin(this._excPhase*6.2847)),_=this.writeDelay(4,k+l*this.readDelay(11)+h*this.readDelayCAt(4,g));this.writeDelay(5,this.readDelayCAt(4,g)-h*_),this._lp2+=u*(this.readDelay(5)-this._lp2),_=this.writeDelay(6,l*this._lp2-y*this.readDelay(6)),this.writeDelay(7,this.readDelay(6)+y*_),_=this.writeDelay(8,k+l*this.readDelay(7)+h*this.readDelayCAt(8,x)),this.writeDelay(9,this.readDelayCAt(8,x)-h*_),this._lp3+=u*(this.readDelay(9)-this._lp3),_=this.writeDelay(10,l*this._lp3-y*this.readDelay(10)),this.writeDelay(11,this.readDelay(10)+y*_),i=this.readDelayAt(9,this._taps[0])+this.readDelayAt(9,this._taps[1])-this.readDelayAt(10,this._taps[2])+this.readDelayAt(11,this._taps[3])-this.readDelayAt(5,this._taps[4])-this.readDelayAt(6,this._taps[5])-this.readDelayAt(7,this._taps[6]),b=this.readDelayAt(5,this._taps[7])+this.readDelayAt(5,this._taps[8])-this.readDelayAt(6,this._taps[9])+this.readDelayAt(7,this._taps[10])-this.readDelayAt(9,this._taps[11])-this.readDelayAt(10,this._taps[12])-this.readDelayAt(11,this._taps[13]),a[0][0][o]+=i*w,a[0][1][o]+=b*w,this._excPhase+=m,o++;for(let R=0,n=this._Delays[0];R<this._Delays.length;n=this._Delays[++R])n[1]=n[1]+1&n[3],n[2]=n[2]+1&n[3]}return this._pDWrite=(this._pDWrite+128)%this._pDLength,!0}};registerProcessor("DattorroReverb",f);})();',he=["preDelay","bandwidth","inputDiffusion1","inputDiffusion2","decay","decayDiffusion1","decayDiffusion2","damping","excursionRate","excursionDepth","wet","dry"],gt=new WeakMap;function _e(t){return U(this,null,function*(){let n=gt.get(t);if(!n){const i=new Blob([de],{type:"application/javascript"}),r=URL.createObjectURL(i);n=t.audioWorklet.addModule(r),gt.set(t,n)}return yield n,new AudioWorkletNode(t,"DattorroReverb",{outputChannelCount:[2]})})}var w,at,G,fe=class{constructor(t){_(this,w,void 0),_(this,at,void 0),_(this,G,void 0),this.input=t.createGain(),u(this,G,t.destination),u(this,at,_e(t).then(n=>(this.input.connect(n),n.connect(a(this,G)),u(this,w,n),this)))}get paramNames(){return he}getParam(t){var n;return(n=a(this,w))==null?void 0:n.parameters.get("preDelay")}get isReady(){return a(this,w)!==void 0}ready(){return a(this,at)}connect(t){a(this,w)&&(a(this,w).disconnect(a(this,G)),a(this,w).connect(t)),u(this,G,t)}};w=new WeakMap;at=new WeakMap;G=new WeakMap;function pe(t,n){var e;const i=(e=re(["ogg","mp3"]))!=null?e:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${n}/${t}-${i}.js`}function ye(t,n,e){return(i,r)=>U(this,null,function*(){const s=yield(yield r.fetch(t)).text(),o=ve(s),c=Object.keys(o);yield Promise.all(c.map(l=>U(this,null,function*(){const d=ut(l);if(!d)return;const h=ge(me(o[l])),v=yield i.decodeAudioData(h);n[l]=v,e.regions.push({sampleName:l,midiPitch:d})}))),ue(e.regions)})}function ve(t){const n=t.indexOf("MIDI.Soundfont.");if(n<0)throw Error("Invalid MIDI.js Soundfont format");const e=t.indexOf("=",n)+2,i=t.lastIndexOf(",");return JSON.parse(t.slice(e,i)+"}")}function me(t){return t.slice(t.indexOf(",")+1)}function ge(t){const n=window.atob(t),e=n.length,i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=n.charCodeAt(r);return i.buffer}var De=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function be(t,n){if(!t.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${n}/${t}-loop.json`}function we(t,n=44100){return U(this,null,function*(){if(t)try{const e=yield fetch(t);if(e.status!==200)return;const i=yield e.json(),r={};return Object.keys(i).forEach(s=>{const o=ut(s);if(o){const c=i[s];r[o]=[c[0]/n,c[1]/n]}}),r}catch{return}})}function ke(){return De}var $,xe=class{constructor(t,n){this.context=t,_(this,$,void 0),this.config=Ae(n),this.player=new ie(t,n),this.group=oe(),u(this,$,!1);const e=Se(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=e(t,this.config.storage).then(r=>(u(this,$,r),this));const i=t.createGain();i.gain.value=this.config.extraGain,this.player.output.addInsert(i)}get output(){return this.player.output}get hasLoops(){return a(this,$)}loaded(){return U(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(t){const n=le(this.group,typeof t=="object"?t:{note:t});return n?this.player.start(n):()=>{}}stop(t){return this.player.stop(t)}};$=new WeakMap;function Se(t,n,e,i){const r=ye(t,e,i);return(s,o)=>U(this,null,function*(){const[c,l]=yield Promise.all([r(s,o),we(n)]);return l&&i.regions.forEach(d=>{var h;const v=l[d.midiPitch];v&&((h=d.sample)!=null||(d.sample={}),d.sample.loop=!0,d.sample.loopStart=v[0],d.sample.loopEnd=v[1])}),!!l})}function Ae(t){var n,e,i,r;if(!t.instrument&&!t.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");const s={kit:"MusyngKite",instrument:t.instrument,storage:(n=t.storage)!=null?n:se,extraGain:(e=t.extraGain)!=null?e:5,loadLoopData:(i=t.loadLoopData)!=null?i:!1,loopDataUrl:t.loopDataUrl,instrumentUrl:(r=t.instrumentUrl)!=null?r:""};return s.instrument&&s.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),s.instrumentUrl=s.instrument,s.instrument=void 0),s.instrument&&!s.instrumentUrl&&(s.instrumentUrl=pe(s.instrument,s.kit)),s.loadLoopData&&s.instrument&&!s.loopDataUrl&&(s.loopDataUrl=be(s.instrument,s.kit)),s}const Me={class:"flex flex-col border my-2 bg-light-900 dark-bg-dark-100 rounded-lg"},Ee={class:"flex flex-wrap gap-1 p-2 max-h-40vh overflow-scroll"},Pe=["onClick"],Re={class:"flex flex gap-2 items-center justify-center p-2"},Oe={class:"font-bold capitalize text-xl"},Ie={class:"flex text-"},Te={key:0,class:"i-la-spinner animate-pulse"},Ce={key:1,class:"i-la-check"},Le={__name:"SynthFont",setup(t){const n=Ot("sound-font","marimba"),e=It([]),{master:i}=Pt();ft(n,l=>{e[l]=!0});const r=Tt(!1),s=i.context,o=new fe(s),c=Ct(()=>{r.value=!1;const l=new xe(s,{instrument:n.value});return l.output.addEffect("reverb",o,.9),l.load.then(()=>{r.value=!0}),l});return ft(()=>Rt.note,l=>{r.value&&(l.type=="noteon"?c.value.start({note:l.number,velocity:l.velocity}):c.value.stop(l.number))}),(l,d)=>(I(),T("div",Me,[et("div",Ee,[(I(!0),T(Lt,null,Wt(lt(ke)(),h=>(I(),T("button",{class:Gt(["transition p-1 text-sm cursor-pointer border-1 border-dark-900 border-opacity-10 rounded shadow flex-auto capitalize dark-border-light-200 dark-border-opacity-20",{"border-opacity-100 dark-border-opacity-90 filter filter-invert":h==lt(n),"opacity-50":h==lt(n)&&!r.value,"bg-light-100 dark-bg-dark-900":!e[h],"bg-light-900 dark-bg-dark-100":e==null?void 0:e[h]}]),key:h,onClick:v=>n.value=h},pt(h.replaceAll("_"," ")),11,Pe))),128))]),et("div",Re,[et("div",Oe,pt(c.value.config.instrument.replaceAll("_"," ")),1),et("div",Ie,[r.value?(I(),T("div",Ce,"Loaded!")):(I(),T("div",Te))])])]))}},je=JSON.parse('{"title":"Soundfont sampler synth","description":"Open source sample-based online synthesizer","frontmatter":{"title":"Soundfont sampler synth","description":"Open source sample-based online synthesizer","date":"2024-06-10T00:00:00.000Z","layout":"app","cover":"cover.png","links":["https://github.com/danigb/smplr"]},"headers":[],"relativePath":"practice/synth/soundfont/index.md","filePath":"practice/synth/soundfont/index.md","lastUpdated":1722271409000}'),We={name:"practice/synth/soundfont/index.md"},He=Object.assign(We,{setup(t){return Ut(()=>_t.value=!1),zt(()=>_t.value=!0),(n,e)=>{const i=Le,r=Et,s=Ht("client-only");return I(),T("div",null,[ct(s,null,{default:jt(()=>[ct(i,{class:"m-2"}),ct(r)]),_:1})])}}});export{je as __pageData,He as default};
